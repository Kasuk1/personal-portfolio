(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function UA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var XN={exports:{}},J1={},YN={exports:{}},Ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug=Symbol.for("react.element"),Tj=Symbol.for("react.portal"),Cj=Symbol.for("react.fragment"),Pj=Symbol.for("react.strict_mode"),Rj=Symbol.for("react.profiler"),Lj=Symbol.for("react.provider"),Dj=Symbol.for("react.context"),Ij=Symbol.for("react.forward_ref"),Oj=Symbol.for("react.suspense"),Nj=Symbol.for("react.memo"),kj=Symbol.for("react.lazy"),fP=Symbol.iterator;function Uj(t){return t===null||typeof t!="object"?null:(t=fP&&t[fP]||t["@@iterator"],typeof t=="function"?t:null)}var ZN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},KN=Object.assign,QN={};function lf(t,e,n){this.props=t,this.context=e,this.refs=QN,this.updater=n||ZN}lf.prototype.isReactComponent={};lf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};lf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function JN(){}JN.prototype=lf.prototype;function zA(t,e,n){this.props=t,this.context=e,this.refs=QN,this.updater=n||ZN}var FA=zA.prototype=new JN;FA.constructor=zA;KN(FA,lf.prototype);FA.isPureReactComponent=!0;var pP=Array.isArray,ek=Object.prototype.hasOwnProperty,BA={current:null},tk={key:!0,ref:!0,__self:!0,__source:!0};function nk(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)ek.call(e,i)&&!tk.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:ug,type:t,key:s,ref:o,props:r,_owner:BA.current}}function zj(t,e){return{$$typeof:ug,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function VA(t){return typeof t=="object"&&t!==null&&t.$$typeof===ug}function Fj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mP=/\/+/g;function gw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Fj(""+t.key):e.toString(36)}function my(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ug:case Tj:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+gw(o,0):i,pP(r)?(n="",t!=null&&(n=t.replace(mP,"$&/")+"/"),my(r,e,n,"",function(u){return u})):r!=null&&(VA(r)&&(r=zj(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(mP,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",pP(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+gw(s,a);o+=my(s,e,n,l,r)}else if(l=Uj(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+gw(s,a++),o+=my(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function L0(t,e,n){if(t==null)return t;var i=[],r=0;return my(t,i,"","",function(s){return e.call(n,s,r++)}),i}function Bj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ar={current:null},gy={transition:null},Vj={ReactCurrentDispatcher:Ar,ReactCurrentBatchConfig:gy,ReactCurrentOwner:BA};Ht.Children={map:L0,forEach:function(t,e,n){L0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return L0(t,function(){e++}),e},toArray:function(t){return L0(t,function(e){return e})||[]},only:function(t){if(!VA(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ht.Component=lf;Ht.Fragment=Cj;Ht.Profiler=Rj;Ht.PureComponent=zA;Ht.StrictMode=Pj;Ht.Suspense=Oj;Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vj;Ht.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=KN({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=BA.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ek.call(e,l)&&!tk.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:ug,type:t.type,key:r,ref:s,props:i,_owner:o}};Ht.createContext=function(t){return t={$$typeof:Dj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Lj,_context:t},t.Consumer=t};Ht.createElement=nk;Ht.createFactory=function(t){var e=nk.bind(null,t);return e.type=t,e};Ht.createRef=function(){return{current:null}};Ht.forwardRef=function(t){return{$$typeof:Ij,render:t}};Ht.isValidElement=VA;Ht.lazy=function(t){return{$$typeof:kj,_payload:{_status:-1,_result:t},_init:Bj}};Ht.memo=function(t,e){return{$$typeof:Nj,type:t,compare:e===void 0?null:e}};Ht.startTransition=function(t){var e=gy.transition;gy.transition={};try{t()}finally{gy.transition=e}};Ht.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ht.useCallback=function(t,e){return Ar.current.useCallback(t,e)};Ht.useContext=function(t){return Ar.current.useContext(t)};Ht.useDebugValue=function(){};Ht.useDeferredValue=function(t){return Ar.current.useDeferredValue(t)};Ht.useEffect=function(t,e){return Ar.current.useEffect(t,e)};Ht.useId=function(){return Ar.current.useId()};Ht.useImperativeHandle=function(t,e,n){return Ar.current.useImperativeHandle(t,e,n)};Ht.useInsertionEffect=function(t,e){return Ar.current.useInsertionEffect(t,e)};Ht.useLayoutEffect=function(t,e){return Ar.current.useLayoutEffect(t,e)};Ht.useMemo=function(t,e){return Ar.current.useMemo(t,e)};Ht.useReducer=function(t,e,n){return Ar.current.useReducer(t,e,n)};Ht.useRef=function(t){return Ar.current.useRef(t)};Ht.useState=function(t){return Ar.current.useState(t)};Ht.useSyncExternalStore=function(t,e,n){return Ar.current.useSyncExternalStore(t,e,n)};Ht.useTransition=function(){return Ar.current.useTransition()};Ht.version="18.2.0";YN.exports=Ht;var Se=YN.exports;const ik=UA(Se);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jj=Se,Gj=Symbol.for("react.element"),Hj=Symbol.for("react.fragment"),Wj=Object.prototype.hasOwnProperty,$j=jj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qj={key:!0,ref:!0,__self:!0,__source:!0};function rk(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Wj.call(e,i)&&!qj.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:Gj,type:t,key:s,ref:o,props:r,_owner:$j.current}}J1.Fragment=Hj;J1.jsx=rk;J1.jsxs=rk;XN.exports=J1;var F=XN.exports,sk={exports:{}},hs={},ok={exports:{}},ak={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,V){var j=N.length;N.push(V);e:for(;0<j;){var z=j-1>>>1,$=N[z];if(0<r($,V))N[z]=V,N[j]=$,j=z;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var V=N[0],j=N.pop();if(j!==V){N[0]=j;e:for(var z=0,$=N.length,te=$>>>1;z<te;){var Q=2*(z+1)-1,J=N[Q],ie=Q+1,se=N[ie];if(0>r(J,j))ie<$&&0>r(se,J)?(N[z]=se,N[ie]=j,z=ie):(N[z]=J,N[Q]=j,z=Q);else if(ie<$&&0>r(se,j))N[z]=se,N[ie]=j,z=ie;else break e}}return V}function r(N,V){var j=N.sortIndex-V.sortIndex;return j!==0?j:N.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,f=!1,m=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var V=n(u);V!==null;){if(V.callback===null)i(u);else if(V.startTime<=N)i(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(N){if(x=!1,w(N),!m)if(n(l)!==null)m=!0,K(E);else{var V=n(u);V!==null&&q(b,V.startTime-N)}}function E(N,V){m=!1,x&&(x=!1,v(L),L=-1),f=!0;var j=h;try{for(w(V),c=n(l);c!==null&&(!(c.expirationTime>V)||N&&!D());){var z=c.callback;if(typeof z=="function"){c.callback=null,h=c.priorityLevel;var $=z(c.expirationTime<=V);V=t.unstable_now(),typeof $=="function"?c.callback=$:c===n(l)&&i(l),w(V)}else i(l);c=n(l)}if(c!==null)var te=!0;else{var Q=n(u);Q!==null&&q(b,Q.startTime-V),te=!1}return te}finally{c=null,h=j,f=!1}}var A=!1,T=null,L=-1,P=5,C=-1;function D(){return!(t.unstable_now()-C<P)}function U(){if(T!==null){var N=t.unstable_now();C=N;var V=!0;try{V=T(!0,N)}finally{V?G():(A=!1,T=null)}}else A=!1}var G;if(typeof _=="function")G=function(){_(U)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,H=k.port2;k.port1.onmessage=U,G=function(){H.postMessage(null)}}else G=function(){y(U,0)};function K(N){T=N,A||(A=!0,G())}function q(N,V){L=y(function(){N(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,K(E))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var j=h;h=V;try{return N()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,V){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=h;h=N;try{return V()}finally{h=j}},t.unstable_scheduleCallback=function(N,V,j){var z=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?z+j:z):j=z,N){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=j+$,N={id:d++,callback:V,priorityLevel:N,startTime:j,expirationTime:$,sortIndex:-1},j>z?(N.sortIndex=j,e(u,N),n(l)===null&&N===n(u)&&(x?(v(L),L=-1):x=!0,q(b,j-z))):(N.sortIndex=$,e(l,N),m||f||(m=!0,K(E))),N},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(N){var V=h;return function(){var j=h;h=V;try{return N.apply(this,arguments)}finally{h=j}}}})(ak);ok.exports=ak;var Xj=ok.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lk=Se,ls=Xj;function ze(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uk=new Set,hm={};function Dc(t,e){kd(t,e),kd(t+"Capture",e)}function kd(t,e){for(hm[t]=e,t=0;t<e.length;t++)uk.add(e[t])}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kb=Object.prototype.hasOwnProperty,Yj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gP={},vP={};function Zj(t){return kb.call(vP,t)?!0:kb.call(gP,t)?!1:Yj.test(t)?vP[t]=!0:(gP[t]=!0,!1)}function Kj(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Qj(t,e,n,i){if(e===null||typeof e>"u"||Kj(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Er(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ji={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ji[t]=new Er(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ji[e]=new Er(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ji[t]=new Er(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ji[t]=new Er(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ji[t]=new Er(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ji[t]=new Er(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ji[t]=new Er(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ji[t]=new Er(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ji[t]=new Er(t,5,!1,t.toLowerCase(),null,!1,!1)});var jA=/[\-:]([a-z])/g;function GA(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(jA,GA);ji[e]=new Er(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(jA,GA);ji[e]=new Er(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(jA,GA);ji[e]=new Er(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ji[t]=new Er(t,1,!1,t.toLowerCase(),null,!1,!1)});ji.xlinkHref=new Er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ji[t]=new Er(t,1,!1,t.toLowerCase(),null,!0,!0)});function HA(t,e,n,i){var r=ji.hasOwnProperty(e)?ji[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Qj(e,n,r,i)&&(n=null),i||r===null?Zj(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Ka=lk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D0=Symbol.for("react.element"),Yh=Symbol.for("react.portal"),Zh=Symbol.for("react.fragment"),WA=Symbol.for("react.strict_mode"),Ub=Symbol.for("react.profiler"),ck=Symbol.for("react.provider"),hk=Symbol.for("react.context"),$A=Symbol.for("react.forward_ref"),zb=Symbol.for("react.suspense"),Fb=Symbol.for("react.suspense_list"),qA=Symbol.for("react.memo"),_l=Symbol.for("react.lazy"),dk=Symbol.for("react.offscreen"),yP=Symbol.iterator;function $f(t){return t===null||typeof t!="object"?null:(t=yP&&t[yP]||t["@@iterator"],typeof t=="function"?t:null)}var Un=Object.assign,vw;function Tp(t){if(vw===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);vw=e&&e[1]||""}return`
`+vw+t}var yw=!1;function xw(t,e){if(!t||yw)return"";yw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{yw=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Tp(t):""}function Jj(t){switch(t.tag){case 5:return Tp(t.type);case 16:return Tp("Lazy");case 13:return Tp("Suspense");case 19:return Tp("SuspenseList");case 0:case 2:case 15:return t=xw(t.type,!1),t;case 11:return t=xw(t.type.render,!1),t;case 1:return t=xw(t.type,!0),t;default:return""}}function Bb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zh:return"Fragment";case Yh:return"Portal";case Ub:return"Profiler";case WA:return"StrictMode";case zb:return"Suspense";case Fb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hk:return(t.displayName||"Context")+".Consumer";case ck:return(t._context.displayName||"Context")+".Provider";case $A:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qA:return e=t.displayName||null,e!==null?e:Bb(t.type)||"Memo";case _l:e=t._payload,t=t._init;try{return Bb(t(e))}catch{}}return null}function eG(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bb(e);case 8:return e===WA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function tu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tG(t){var e=fk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function I0(t){t._valueTracker||(t._valueTracker=tG(t))}function pk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=fk(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Vy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vb(t,e){var n=e.checked;return Un({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xP(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=tu(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mk(t,e){e=e.checked,e!=null&&HA(t,"checked",e,!1)}function jb(t,e){mk(t,e);var n=tu(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Gb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Gb(t,e.type,tu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _P(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Gb(t,e,n){(e!=="number"||Vy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Cp=Array.isArray;function gd(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+tu(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Hb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ze(91));return Un({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ze(92));if(Cp(n)){if(1<n.length)throw Error(ze(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:tu(n)}}function gk(t,e){var n=tu(e.value),i=tu(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function SP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var O0,yk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(O0=O0||document.createElement("div"),O0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=O0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dm(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nG=["Webkit","ms","Moz","O"];Object.keys(Fp).forEach(function(t){nG.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fp[e]=Fp[t]})});function xk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fp.hasOwnProperty(t)&&Fp[t]?(""+e).trim():e+"px"}function _k(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=xk(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var iG=Un({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $b(t,e){if(e){if(iG[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ze(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ze(62))}}function qb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xb=null;function XA(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yb=null,vd=null,yd=null;function bP(t){if(t=dg(t)){if(typeof Yb!="function")throw Error(ze(280));var e=t.stateNode;e&&(e=rx(e),Yb(t.stateNode,t.type,e))}}function wk(t){vd?yd?yd.push(t):yd=[t]:vd=t}function Sk(){if(vd){var t=vd,e=yd;if(yd=vd=null,bP(t),e)for(t=0;t<e.length;t++)bP(e[t])}}function bk(t,e){return t(e)}function Mk(){}var _w=!1;function Ak(t,e,n){if(_w)return t(e,n);_w=!0;try{return bk(t,e,n)}finally{_w=!1,(vd!==null||yd!==null)&&(Mk(),Sk())}}function fm(t,e){var n=t.stateNode;if(n===null)return null;var i=rx(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ze(231,e,typeof n));return n}var Zb=!1;if(Va)try{var qf={};Object.defineProperty(qf,"passive",{get:function(){Zb=!0}}),window.addEventListener("test",qf,qf),window.removeEventListener("test",qf,qf)}catch{Zb=!1}function rG(t,e,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Bp=!1,jy=null,Gy=!1,Kb=null,sG={onError:function(t){Bp=!0,jy=t}};function oG(t,e,n,i,r,s,o,a,l){Bp=!1,jy=null,rG.apply(sG,arguments)}function aG(t,e,n,i,r,s,o,a,l){if(oG.apply(this,arguments),Bp){if(Bp){var u=jy;Bp=!1,jy=null}else throw Error(ze(198));Gy||(Gy=!0,Kb=u)}}function Ic(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ek(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function MP(t){if(Ic(t)!==t)throw Error(ze(188))}function lG(t){var e=t.alternate;if(!e){if(e=Ic(t),e===null)throw Error(ze(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return MP(r),t;if(s===i)return MP(r),e;s=s.sibling}throw Error(ze(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(ze(189))}}if(n.alternate!==i)throw Error(ze(190))}if(n.tag!==3)throw Error(ze(188));return n.stateNode.current===n?t:e}function Tk(t){return t=lG(t),t!==null?Ck(t):null}function Ck(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ck(t);if(e!==null)return e;t=t.sibling}return null}var Pk=ls.unstable_scheduleCallback,AP=ls.unstable_cancelCallback,uG=ls.unstable_shouldYield,cG=ls.unstable_requestPaint,ii=ls.unstable_now,hG=ls.unstable_getCurrentPriorityLevel,YA=ls.unstable_ImmediatePriority,Rk=ls.unstable_UserBlockingPriority,Hy=ls.unstable_NormalPriority,dG=ls.unstable_LowPriority,Lk=ls.unstable_IdlePriority,ex=null,Zo=null;function fG(t){if(Zo&&typeof Zo.onCommitFiberRoot=="function")try{Zo.onCommitFiberRoot(ex,t,void 0,(t.current.flags&128)===128)}catch{}}var uo=Math.clz32?Math.clz32:gG,pG=Math.log,mG=Math.LN2;function gG(t){return t>>>=0,t===0?32:31-(pG(t)/mG|0)|0}var N0=64,k0=4194304;function Pp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wy(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=Pp(a):(s&=o,s!==0&&(i=Pp(s)))}else o=n&~r,o!==0?i=Pp(o):s!==0&&(i=Pp(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-uo(e),r=1<<n,i|=t[n],e&=~r;return i}function vG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yG(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-uo(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=vG(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Qb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dk(){var t=N0;return N0<<=1,!(N0&4194240)&&(N0=64),t}function ww(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-uo(e),t[e]=n}function xG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-uo(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function ZA(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-uo(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var cn=0;function Ik(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ok,KA,Nk,kk,Uk,Jb=!1,U0=[],Bl=null,Vl=null,jl=null,pm=new Map,mm=new Map,bl=[],_G="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function EP(t,e){switch(t){case"focusin":case"focusout":Bl=null;break;case"dragenter":case"dragleave":Vl=null;break;case"mouseover":case"mouseout":jl=null;break;case"pointerover":case"pointerout":pm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":mm.delete(e.pointerId)}}function Xf(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=dg(e),e!==null&&KA(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function wG(t,e,n,i,r){switch(e){case"focusin":return Bl=Xf(Bl,t,e,n,i,r),!0;case"dragenter":return Vl=Xf(Vl,t,e,n,i,r),!0;case"mouseover":return jl=Xf(jl,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return pm.set(s,Xf(pm.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,mm.set(s,Xf(mm.get(s)||null,t,e,n,i,r)),!0}return!1}function zk(t){var e=ec(t.target);if(e!==null){var n=Ic(e);if(n!==null){if(e=n.tag,e===13){if(e=Ek(n),e!==null){t.blockedOn=e,Uk(t.priority,function(){Nk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=eM(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Xb=i,n.target.dispatchEvent(i),Xb=null}else return e=dg(n),e!==null&&KA(e),t.blockedOn=n,!1;e.shift()}return!0}function TP(t,e,n){vy(t)&&n.delete(e)}function SG(){Jb=!1,Bl!==null&&vy(Bl)&&(Bl=null),Vl!==null&&vy(Vl)&&(Vl=null),jl!==null&&vy(jl)&&(jl=null),pm.forEach(TP),mm.forEach(TP)}function Yf(t,e){t.blockedOn===e&&(t.blockedOn=null,Jb||(Jb=!0,ls.unstable_scheduleCallback(ls.unstable_NormalPriority,SG)))}function gm(t){function e(r){return Yf(r,t)}if(0<U0.length){Yf(U0[0],t);for(var n=1;n<U0.length;n++){var i=U0[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Bl!==null&&Yf(Bl,t),Vl!==null&&Yf(Vl,t),jl!==null&&Yf(jl,t),pm.forEach(e),mm.forEach(e),n=0;n<bl.length;n++)i=bl[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<bl.length&&(n=bl[0],n.blockedOn===null);)zk(n),n.blockedOn===null&&bl.shift()}var xd=Ka.ReactCurrentBatchConfig,$y=!0;function bG(t,e,n,i){var r=cn,s=xd.transition;xd.transition=null;try{cn=1,QA(t,e,n,i)}finally{cn=r,xd.transition=s}}function MG(t,e,n,i){var r=cn,s=xd.transition;xd.transition=null;try{cn=4,QA(t,e,n,i)}finally{cn=r,xd.transition=s}}function QA(t,e,n,i){if($y){var r=eM(t,e,n,i);if(r===null)Lw(t,e,i,qy,n),EP(t,i);else if(wG(r,t,e,n,i))i.stopPropagation();else if(EP(t,i),e&4&&-1<_G.indexOf(t)){for(;r!==null;){var s=dg(r);if(s!==null&&Ok(s),s=eM(t,e,n,i),s===null&&Lw(t,e,i,qy,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Lw(t,e,i,null,n)}}var qy=null;function eM(t,e,n,i){if(qy=null,t=XA(i),t=ec(t),t!==null)if(e=Ic(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ek(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qy=t,null}function Fk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hG()){case YA:return 1;case Rk:return 4;case Hy:case dG:return 16;case Lk:return 536870912;default:return 16}default:return 16}}var Pl=null,JA=null,yy=null;function Bk(){if(yy)return yy;var t,e=JA,n=e.length,i,r="value"in Pl?Pl.value:Pl.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return yy=r.slice(t,1<i?1-i:void 0)}function xy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function z0(){return!0}function CP(){return!1}function ds(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?z0:CP,this.isPropagationStopped=CP,this}return Un(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=z0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=z0)},persist:function(){},isPersistent:z0}),e}var uf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eE=ds(uf),hg=Un({},uf,{view:0,detail:0}),AG=ds(hg),Sw,bw,Zf,tx=Un({},hg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zf&&(Zf&&t.type==="mousemove"?(Sw=t.screenX-Zf.screenX,bw=t.screenY-Zf.screenY):bw=Sw=0,Zf=t),Sw)},movementY:function(t){return"movementY"in t?t.movementY:bw}}),PP=ds(tx),EG=Un({},tx,{dataTransfer:0}),TG=ds(EG),CG=Un({},hg,{relatedTarget:0}),Mw=ds(CG),PG=Un({},uf,{animationName:0,elapsedTime:0,pseudoElement:0}),RG=ds(PG),LG=Un({},uf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),DG=ds(LG),IG=Un({},uf,{data:0}),RP=ds(IG),OG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UG(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kG[t])?!!e[t]:!1}function tE(){return UG}var zG=Un({},hg,{key:function(t){if(t.key){var e=OG[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?NG[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tE,charCode:function(t){return t.type==="keypress"?xy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),FG=ds(zG),BG=Un({},tx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LP=ds(BG),VG=Un({},hg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tE}),jG=ds(VG),GG=Un({},uf,{propertyName:0,elapsedTime:0,pseudoElement:0}),HG=ds(GG),WG=Un({},tx,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$G=ds(WG),qG=[9,13,27,32],nE=Va&&"CompositionEvent"in window,Vp=null;Va&&"documentMode"in document&&(Vp=document.documentMode);var XG=Va&&"TextEvent"in window&&!Vp,Vk=Va&&(!nE||Vp&&8<Vp&&11>=Vp),DP=String.fromCharCode(32),IP=!1;function jk(t,e){switch(t){case"keyup":return qG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Kh=!1;function YG(t,e){switch(t){case"compositionend":return Gk(e);case"keypress":return e.which!==32?null:(IP=!0,DP);case"textInput":return t=e.data,t===DP&&IP?null:t;default:return null}}function ZG(t,e){if(Kh)return t==="compositionend"||!nE&&jk(t,e)?(t=Bk(),yy=JA=Pl=null,Kh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Vk&&e.locale!=="ko"?null:e.data;default:return null}}var KG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!KG[t.type]:e==="textarea"}function Hk(t,e,n,i){wk(i),e=Xy(e,"onChange"),0<e.length&&(n=new eE("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var jp=null,vm=null;function QG(t){tU(t,0)}function nx(t){var e=ed(t);if(pk(e))return t}function JG(t,e){if(t==="change")return e}var Wk=!1;if(Va){var Aw;if(Va){var Ew="oninput"in document;if(!Ew){var NP=document.createElement("div");NP.setAttribute("oninput","return;"),Ew=typeof NP.oninput=="function"}Aw=Ew}else Aw=!1;Wk=Aw&&(!document.documentMode||9<document.documentMode)}function kP(){jp&&(jp.detachEvent("onpropertychange",$k),vm=jp=null)}function $k(t){if(t.propertyName==="value"&&nx(vm)){var e=[];Hk(e,vm,t,XA(t)),Ak(QG,e)}}function eH(t,e,n){t==="focusin"?(kP(),jp=e,vm=n,jp.attachEvent("onpropertychange",$k)):t==="focusout"&&kP()}function tH(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nx(vm)}function nH(t,e){if(t==="click")return nx(e)}function iH(t,e){if(t==="input"||t==="change")return nx(e)}function rH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vo=typeof Object.is=="function"?Object.is:rH;function ym(t,e){if(vo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!kb.call(e,r)||!vo(t[r],e[r]))return!1}return!0}function UP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zP(t,e){var n=UP(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=UP(n)}}function qk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?qk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xk(){for(var t=window,e=Vy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vy(t.document)}return e}function iE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sH(t){var e=Xk(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&qk(n.ownerDocument.documentElement,n)){if(i!==null&&iE(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=zP(n,s);var o=zP(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oH=Va&&"documentMode"in document&&11>=document.documentMode,Qh=null,tM=null,Gp=null,nM=!1;function FP(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nM||Qh==null||Qh!==Vy(i)||(i=Qh,"selectionStart"in i&&iE(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Gp&&ym(Gp,i)||(Gp=i,i=Xy(tM,"onSelect"),0<i.length&&(e=new eE("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Qh)))}function F0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jh={animationend:F0("Animation","AnimationEnd"),animationiteration:F0("Animation","AnimationIteration"),animationstart:F0("Animation","AnimationStart"),transitionend:F0("Transition","TransitionEnd")},Tw={},Yk={};Va&&(Yk=document.createElement("div").style,"AnimationEvent"in window||(delete Jh.animationend.animation,delete Jh.animationiteration.animation,delete Jh.animationstart.animation),"TransitionEvent"in window||delete Jh.transitionend.transition);function ix(t){if(Tw[t])return Tw[t];if(!Jh[t])return t;var e=Jh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Yk)return Tw[t]=e[n];return t}var Zk=ix("animationend"),Kk=ix("animationiteration"),Qk=ix("animationstart"),Jk=ix("transitionend"),eU=new Map,BP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cu(t,e){eU.set(t,e),Dc(e,[t])}for(var Cw=0;Cw<BP.length;Cw++){var Pw=BP[Cw],aH=Pw.toLowerCase(),lH=Pw[0].toUpperCase()+Pw.slice(1);cu(aH,"on"+lH)}cu(Zk,"onAnimationEnd");cu(Kk,"onAnimationIteration");cu(Qk,"onAnimationStart");cu("dblclick","onDoubleClick");cu("focusin","onFocus");cu("focusout","onBlur");cu(Jk,"onTransitionEnd");kd("onMouseEnter",["mouseout","mouseover"]);kd("onMouseLeave",["mouseout","mouseover"]);kd("onPointerEnter",["pointerout","pointerover"]);kd("onPointerLeave",["pointerout","pointerover"]);Dc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rp));function VP(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,aG(i,e,void 0,t),t.currentTarget=null}function tU(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;VP(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;VP(r,a,u),s=l}}}if(Gy)throw t=Kb,Gy=!1,Kb=null,t}function _n(t,e){var n=e[aM];n===void 0&&(n=e[aM]=new Set);var i=t+"__bubble";n.has(i)||(nU(e,t,2,!1),n.add(i))}function Rw(t,e,n){var i=0;e&&(i|=4),nU(n,t,i,e)}var B0="_reactListening"+Math.random().toString(36).slice(2);function xm(t){if(!t[B0]){t[B0]=!0,uk.forEach(function(n){n!=="selectionchange"&&(uH.has(n)||Rw(n,!1,t),Rw(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[B0]||(e[B0]=!0,Rw("selectionchange",!1,e))}}function nU(t,e,n,i){switch(Fk(e)){case 1:var r=bG;break;case 4:r=MG;break;default:r=QA}n=r.bind(null,e,n,t),r=void 0,!Zb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Lw(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ec(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}Ak(function(){var u=s,d=XA(n),c=[];e:{var h=eU.get(t);if(h!==void 0){var f=eE,m=t;switch(t){case"keypress":if(xy(n)===0)break e;case"keydown":case"keyup":f=FG;break;case"focusin":m="focus",f=Mw;break;case"focusout":m="blur",f=Mw;break;case"beforeblur":case"afterblur":f=Mw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=PP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=TG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=jG;break;case Zk:case Kk:case Qk:f=RG;break;case Jk:f=HG;break;case"scroll":f=AG;break;case"wheel":f=$G;break;case"copy":case"cut":case"paste":f=DG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=LP}var x=(e&4)!==0,y=!x&&t==="scroll",v=x?h!==null?h+"Capture":null:h;x=[];for(var _=u,w;_!==null;){w=_;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,v!==null&&(b=fm(_,v),b!=null&&x.push(_m(_,b,w)))),y)break;_=_.return}0<x.length&&(h=new f(h,m,null,n,d),c.push({event:h,listeners:x}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Xb&&(m=n.relatedTarget||n.fromElement)&&(ec(m)||m[ja]))break e;if((f||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=u,m=m?ec(m):null,m!==null&&(y=Ic(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(x=PP,b="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=LP,b="onPointerLeave",v="onPointerEnter",_="pointer"),y=f==null?h:ed(f),w=m==null?h:ed(m),h=new x(b,_+"leave",f,n,d),h.target=y,h.relatedTarget=w,b=null,ec(d)===u&&(x=new x(v,_+"enter",m,n,d),x.target=w,x.relatedTarget=y,b=x),y=b,f&&m)t:{for(x=f,v=m,_=0,w=x;w;w=hh(w))_++;for(w=0,b=v;b;b=hh(b))w++;for(;0<_-w;)x=hh(x),_--;for(;0<w-_;)v=hh(v),w--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=hh(x),v=hh(v)}x=null}else x=null;f!==null&&jP(c,h,f,x,!1),m!==null&&y!==null&&jP(c,y,m,x,!0)}}e:{if(h=u?ed(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var E=JG;else if(OP(h))if(Wk)E=iH;else{E=tH;var A=eH}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=nH);if(E&&(E=E(t,u))){Hk(c,E,n,d);break e}A&&A(t,h,u),t==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&Gb(h,"number",h.value)}switch(A=u?ed(u):window,t){case"focusin":(OP(A)||A.contentEditable==="true")&&(Qh=A,tM=u,Gp=null);break;case"focusout":Gp=tM=Qh=null;break;case"mousedown":nM=!0;break;case"contextmenu":case"mouseup":case"dragend":nM=!1,FP(c,n,d);break;case"selectionchange":if(oH)break;case"keydown":case"keyup":FP(c,n,d)}var T;if(nE)e:{switch(t){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Kh?jk(t,n)&&(L="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(Vk&&n.locale!=="ko"&&(Kh||L!=="onCompositionStart"?L==="onCompositionEnd"&&Kh&&(T=Bk()):(Pl=d,JA="value"in Pl?Pl.value:Pl.textContent,Kh=!0)),A=Xy(u,L),0<A.length&&(L=new RP(L,t,null,n,d),c.push({event:L,listeners:A}),T?L.data=T:(T=Gk(n),T!==null&&(L.data=T)))),(T=XG?YG(t,n):ZG(t,n))&&(u=Xy(u,"onBeforeInput"),0<u.length&&(d=new RP("onBeforeInput","beforeinput",null,n,d),c.push({event:d,listeners:u}),d.data=T))}tU(c,e)})}function _m(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xy(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=fm(t,n),s!=null&&i.unshift(_m(t,s,r)),s=fm(t,e),s!=null&&i.push(_m(t,s,r))),t=t.return}return i}function hh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jP(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=fm(n,s),l!=null&&o.unshift(_m(n,l,a))):r||(l=fm(n,s),l!=null&&o.push(_m(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var cH=/\r\n?/g,hH=/\u0000|\uFFFD/g;function GP(t){return(typeof t=="string"?t:""+t).replace(cH,`
`).replace(hH,"")}function V0(t,e,n){if(e=GP(e),GP(t)!==e&&n)throw Error(ze(425))}function Yy(){}var iM=null,rM=null;function sM(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var oM=typeof setTimeout=="function"?setTimeout:void 0,dH=typeof clearTimeout=="function"?clearTimeout:void 0,HP=typeof Promise=="function"?Promise:void 0,fH=typeof queueMicrotask=="function"?queueMicrotask:typeof HP<"u"?function(t){return HP.resolve(null).then(t).catch(pH)}:oM;function pH(t){setTimeout(function(){throw t})}function Dw(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),gm(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);gm(e)}function Gl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function WP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var cf=Math.random().toString(36).slice(2),Ho="__reactFiber$"+cf,wm="__reactProps$"+cf,ja="__reactContainer$"+cf,aM="__reactEvents$"+cf,mH="__reactListeners$"+cf,gH="__reactHandles$"+cf;function ec(t){var e=t[Ho];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ja]||n[Ho]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=WP(t);t!==null;){if(n=t[Ho])return n;t=WP(t)}return e}t=n,n=t.parentNode}return null}function dg(t){return t=t[Ho]||t[ja],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ed(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ze(33))}function rx(t){return t[wm]||null}var lM=[],td=-1;function hu(t){return{current:t}}function bn(t){0>td||(t.current=lM[td],lM[td]=null,td--)}function yn(t,e){td++,lM[td]=t.current,t.current=e}var nu={},ir=hu(nu),Vr=hu(!1),yc=nu;function Ud(t,e){var n=t.type.contextTypes;if(!n)return nu;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function jr(t){return t=t.childContextTypes,t!=null}function Zy(){bn(Vr),bn(ir)}function $P(t,e,n){if(ir.current!==nu)throw Error(ze(168));yn(ir,e),yn(Vr,n)}function iU(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(ze(108,eG(t)||"Unknown",r));return Un({},n,i)}function Ky(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||nu,yc=ir.current,yn(ir,t),yn(Vr,Vr.current),!0}function qP(t,e,n){var i=t.stateNode;if(!i)throw Error(ze(169));n?(t=iU(t,e,yc),i.__reactInternalMemoizedMergedChildContext=t,bn(Vr),bn(ir),yn(ir,t)):bn(Vr),yn(Vr,n)}var Ca=null,sx=!1,Iw=!1;function rU(t){Ca===null?Ca=[t]:Ca.push(t)}function vH(t){sx=!0,rU(t)}function du(){if(!Iw&&Ca!==null){Iw=!0;var t=0,e=cn;try{var n=Ca;for(cn=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ca=null,sx=!1}catch(r){throw Ca!==null&&(Ca=Ca.slice(t+1)),Pk(YA,du),r}finally{cn=e,Iw=!1}}return null}var nd=[],id=0,Qy=null,Jy=0,Ls=[],Ds=0,xc=null,Ia=1,Oa="";function Bu(t,e){nd[id++]=Jy,nd[id++]=Qy,Qy=t,Jy=e}function sU(t,e,n){Ls[Ds++]=Ia,Ls[Ds++]=Oa,Ls[Ds++]=xc,xc=t;var i=Ia;t=Oa;var r=32-uo(i)-1;i&=~(1<<r),n+=1;var s=32-uo(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Ia=1<<32-uo(e)+r|n<<r|i,Oa=s+t}else Ia=1<<s|n<<r|i,Oa=t}function rE(t){t.return!==null&&(Bu(t,1),sU(t,1,0))}function sE(t){for(;t===Qy;)Qy=nd[--id],nd[id]=null,Jy=nd[--id],nd[id]=null;for(;t===xc;)xc=Ls[--Ds],Ls[Ds]=null,Oa=Ls[--Ds],Ls[Ds]=null,Ia=Ls[--Ds],Ls[Ds]=null}var ss=null,is=null,En=!1,ro=null;function oU(t,e){var n=Us(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function XP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ss=t,is=Gl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ss=t,is=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xc!==null?{id:Ia,overflow:Oa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Us(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ss=t,is=null,!0):!1;default:return!1}}function uM(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cM(t){if(En){var e=is;if(e){var n=e;if(!XP(t,e)){if(uM(t))throw Error(ze(418));e=Gl(n.nextSibling);var i=ss;e&&XP(t,e)?oU(i,n):(t.flags=t.flags&-4097|2,En=!1,ss=t)}}else{if(uM(t))throw Error(ze(418));t.flags=t.flags&-4097|2,En=!1,ss=t}}}function YP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ss=t}function j0(t){if(t!==ss)return!1;if(!En)return YP(t),En=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sM(t.type,t.memoizedProps)),e&&(e=is)){if(uM(t))throw aU(),Error(ze(418));for(;e;)oU(t,e),e=Gl(e.nextSibling)}if(YP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ze(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){is=Gl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}is=null}}else is=ss?Gl(t.stateNode.nextSibling):null;return!0}function aU(){for(var t=is;t;)t=Gl(t.nextSibling)}function zd(){is=ss=null,En=!1}function oE(t){ro===null?ro=[t]:ro.push(t)}var yH=Ka.ReactCurrentBatchConfig;function to(t,e){if(t&&t.defaultProps){e=Un({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var e1=hu(null),t1=null,rd=null,aE=null;function lE(){aE=rd=t1=null}function uE(t){var e=e1.current;bn(e1),t._currentValue=e}function hM(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function _d(t,e){t1=t,aE=rd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Fr=!0),t.firstContext=null)}function Bs(t){var e=t._currentValue;if(aE!==t)if(t={context:t,memoizedValue:e,next:null},rd===null){if(t1===null)throw Error(ze(308));rd=t,t1.dependencies={lanes:0,firstContext:t}}else rd=rd.next=t;return e}var tc=null;function cE(t){tc===null?tc=[t]:tc.push(t)}function lU(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,cE(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ga(t,i)}function Ga(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var wl=!1;function hE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uU(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ka(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hl(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Kt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Ga(t,n)}return r=i.interleaved,r===null?(e.next=e,cE(i)):(e.next=r.next,r.next=e),i.interleaved=e,Ga(t,n)}function _y(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZA(t,n)}}function ZP(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function n1(t,e,n,i){var r=t.updateQueue;wl=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var c=r.baseState;o=0,d=u=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((i&h)===h){d!==null&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,x=a;switch(h=e,f=n,x.tag){case 1:if(m=x.payload,typeof m=="function"){c=m.call(f,c,h);break e}c=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,h=typeof m=="function"?m.call(f,c,h):m,h==null)break e;c=Un({},c,h);break e;case 2:wl=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=f,l=c):d=d.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(1);if(d===null&&(l=c),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);wc|=o,t.lanes=o,t.memoizedState=c}}function KP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(ze(191,r));r.call(i)}}}var cU=new lk.Component().refs;function dM(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Un({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ox={isMounted:function(t){return(t=t._reactInternals)?Ic(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=wr(),r=$l(t),s=ka(i,r);s.payload=e,n!=null&&(s.callback=n),e=Hl(t,s,r),e!==null&&(co(e,t,r,i),_y(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=wr(),r=$l(t),s=ka(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Hl(t,s,r),e!==null&&(co(e,t,r,i),_y(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=wr(),i=$l(t),r=ka(n,i);r.tag=2,e!=null&&(r.callback=e),e=Hl(t,r,i),e!==null&&(co(e,t,i,n),_y(e,t,i))}};function QP(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!ym(n,i)||!ym(r,s):!0}function hU(t,e,n){var i=!1,r=nu,s=e.contextType;return typeof s=="object"&&s!==null?s=Bs(s):(r=jr(e)?yc:ir.current,i=e.contextTypes,s=(i=i!=null)?Ud(t,r):nu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ox,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function JP(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ox.enqueueReplaceState(e,e.state,null)}function fM(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=cU,hE(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Bs(s):(s=jr(e)?yc:ir.current,r.context=Ud(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(dM(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ox.enqueueReplaceState(r,r.state,null),n1(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Kf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ze(309));var i=n.stateNode}if(!i)throw Error(ze(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===cU&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ze(284));if(!n._owner)throw Error(ze(290,t))}return t}function G0(t,e){throw t=Object.prototype.toString.call(e),Error(ze(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function eR(t){var e=t._init;return e(t._payload)}function dU(t){function e(v,_){if(t){var w=v.deletions;w===null?(v.deletions=[_],v.flags|=16):w.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function i(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function r(v,_){return v=ql(v,_),v.index=0,v.sibling=null,v}function s(v,_,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<_?(v.flags|=2,_):w):(v.flags|=2,_)):(v.flags|=1048576,_)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,_,w,b){return _===null||_.tag!==6?(_=Bw(w,v.mode,b),_.return=v,_):(_=r(_,w),_.return=v,_)}function l(v,_,w,b){var E=w.type;return E===Zh?d(v,_,w.props.children,b,w.key):_!==null&&(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===_l&&eR(E)===_.type)?(b=r(_,w.props),b.ref=Kf(v,_,w),b.return=v,b):(b=Ey(w.type,w.key,w.props,null,v.mode,b),b.ref=Kf(v,_,w),b.return=v,b)}function u(v,_,w,b){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=Vw(w,v.mode,b),_.return=v,_):(_=r(_,w.children||[]),_.return=v,_)}function d(v,_,w,b,E){return _===null||_.tag!==7?(_=hc(w,v.mode,b,E),_.return=v,_):(_=r(_,w),_.return=v,_)}function c(v,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Bw(""+_,v.mode,w),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case D0:return w=Ey(_.type,_.key,_.props,null,v.mode,w),w.ref=Kf(v,null,_),w.return=v,w;case Yh:return _=Vw(_,v.mode,w),_.return=v,_;case _l:var b=_._init;return c(v,b(_._payload),w)}if(Cp(_)||$f(_))return _=hc(_,v.mode,w,null),_.return=v,_;G0(v,_)}return null}function h(v,_,w,b){var E=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:a(v,_,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case D0:return w.key===E?l(v,_,w,b):null;case Yh:return w.key===E?u(v,_,w,b):null;case _l:return E=w._init,h(v,_,E(w._payload),b)}if(Cp(w)||$f(w))return E!==null?null:d(v,_,w,b,null);G0(v,w)}return null}function f(v,_,w,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(w)||null,a(_,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case D0:return v=v.get(b.key===null?w:b.key)||null,l(_,v,b,E);case Yh:return v=v.get(b.key===null?w:b.key)||null,u(_,v,b,E);case _l:var A=b._init;return f(v,_,w,A(b._payload),E)}if(Cp(b)||$f(b))return v=v.get(w)||null,d(_,v,b,E,null);G0(_,b)}return null}function m(v,_,w,b){for(var E=null,A=null,T=_,L=_=0,P=null;T!==null&&L<w.length;L++){T.index>L?(P=T,T=null):P=T.sibling;var C=h(v,T,w[L],b);if(C===null){T===null&&(T=P);break}t&&T&&C.alternate===null&&e(v,T),_=s(C,_,L),A===null?E=C:A.sibling=C,A=C,T=P}if(L===w.length)return n(v,T),En&&Bu(v,L),E;if(T===null){for(;L<w.length;L++)T=c(v,w[L],b),T!==null&&(_=s(T,_,L),A===null?E=T:A.sibling=T,A=T);return En&&Bu(v,L),E}for(T=i(v,T);L<w.length;L++)P=f(T,v,L,w[L],b),P!==null&&(t&&P.alternate!==null&&T.delete(P.key===null?L:P.key),_=s(P,_,L),A===null?E=P:A.sibling=P,A=P);return t&&T.forEach(function(D){return e(v,D)}),En&&Bu(v,L),E}function x(v,_,w,b){var E=$f(w);if(typeof E!="function")throw Error(ze(150));if(w=E.call(w),w==null)throw Error(ze(151));for(var A=E=null,T=_,L=_=0,P=null,C=w.next();T!==null&&!C.done;L++,C=w.next()){T.index>L?(P=T,T=null):P=T.sibling;var D=h(v,T,C.value,b);if(D===null){T===null&&(T=P);break}t&&T&&D.alternate===null&&e(v,T),_=s(D,_,L),A===null?E=D:A.sibling=D,A=D,T=P}if(C.done)return n(v,T),En&&Bu(v,L),E;if(T===null){for(;!C.done;L++,C=w.next())C=c(v,C.value,b),C!==null&&(_=s(C,_,L),A===null?E=C:A.sibling=C,A=C);return En&&Bu(v,L),E}for(T=i(v,T);!C.done;L++,C=w.next())C=f(T,v,L,C.value,b),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?L:C.key),_=s(C,_,L),A===null?E=C:A.sibling=C,A=C);return t&&T.forEach(function(U){return e(v,U)}),En&&Bu(v,L),E}function y(v,_,w,b){if(typeof w=="object"&&w!==null&&w.type===Zh&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case D0:e:{for(var E=w.key,A=_;A!==null;){if(A.key===E){if(E=w.type,E===Zh){if(A.tag===7){n(v,A.sibling),_=r(A,w.props.children),_.return=v,v=_;break e}}else if(A.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===_l&&eR(E)===A.type){n(v,A.sibling),_=r(A,w.props),_.ref=Kf(v,A,w),_.return=v,v=_;break e}n(v,A);break}else e(v,A);A=A.sibling}w.type===Zh?(_=hc(w.props.children,v.mode,b,w.key),_.return=v,v=_):(b=Ey(w.type,w.key,w.props,null,v.mode,b),b.ref=Kf(v,_,w),b.return=v,v=b)}return o(v);case Yh:e:{for(A=w.key;_!==null;){if(_.key===A)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){n(v,_.sibling),_=r(_,w.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=Vw(w,v.mode,b),_.return=v,v=_}return o(v);case _l:return A=w._init,y(v,_,A(w._payload),b)}if(Cp(w))return m(v,_,w,b);if($f(w))return x(v,_,w,b);G0(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,_!==null&&_.tag===6?(n(v,_.sibling),_=r(_,w),_.return=v,v=_):(n(v,_),_=Bw(w,v.mode,b),_.return=v,v=_),o(v)):n(v,_)}return y}var Fd=dU(!0),fU=dU(!1),fg={},Ko=hu(fg),Sm=hu(fg),bm=hu(fg);function nc(t){if(t===fg)throw Error(ze(174));return t}function dE(t,e){switch(yn(bm,e),yn(Sm,t),yn(Ko,fg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wb(e,t)}bn(Ko),yn(Ko,e)}function Bd(){bn(Ko),bn(Sm),bn(bm)}function pU(t){nc(bm.current);var e=nc(Ko.current),n=Wb(e,t.type);e!==n&&(yn(Sm,t),yn(Ko,n))}function fE(t){Sm.current===t&&(bn(Ko),bn(Sm))}var Dn=hu(0);function i1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ow=[];function pE(){for(var t=0;t<Ow.length;t++)Ow[t]._workInProgressVersionPrimary=null;Ow.length=0}var wy=Ka.ReactCurrentDispatcher,Nw=Ka.ReactCurrentBatchConfig,_c=0,kn=null,mi=null,Ii=null,r1=!1,Hp=!1,Mm=0,xH=0;function Zi(){throw Error(ze(321))}function mE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vo(t[n],e[n]))return!1;return!0}function gE(t,e,n,i,r,s){if(_c=s,kn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wy.current=t===null||t.memoizedState===null?bH:MH,t=n(i,r),Hp){s=0;do{if(Hp=!1,Mm=0,25<=s)throw Error(ze(301));s+=1,Ii=mi=null,e.updateQueue=null,wy.current=AH,t=n(i,r)}while(Hp)}if(wy.current=s1,e=mi!==null&&mi.next!==null,_c=0,Ii=mi=kn=null,r1=!1,e)throw Error(ze(300));return t}function vE(){var t=Mm!==0;return Mm=0,t}function jo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ii===null?kn.memoizedState=Ii=t:Ii=Ii.next=t,Ii}function Vs(){if(mi===null){var t=kn.alternate;t=t!==null?t.memoizedState:null}else t=mi.next;var e=Ii===null?kn.memoizedState:Ii.next;if(e!==null)Ii=e,mi=t;else{if(t===null)throw Error(ze(310));mi=t,t={memoizedState:mi.memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},Ii===null?kn.memoizedState=Ii=t:Ii=Ii.next=t}return Ii}function Am(t,e){return typeof e=="function"?e(t):e}function kw(t){var e=Vs(),n=e.queue;if(n===null)throw Error(ze(311));n.lastRenderedReducer=t;var i=mi,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((_c&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var c={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=c,o=i):l=l.next=c,kn.lanes|=d,wc|=d}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,vo(i,e.memoizedState)||(Fr=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,kn.lanes|=s,wc|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Uw(t){var e=Vs(),n=e.queue;if(n===null)throw Error(ze(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);vo(s,e.memoizedState)||(Fr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function mU(){}function gU(t,e){var n=kn,i=Vs(),r=e(),s=!vo(i.memoizedState,r);if(s&&(i.memoizedState=r,Fr=!0),i=i.queue,yE(xU.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Ii!==null&&Ii.memoizedState.tag&1){if(n.flags|=2048,Em(9,yU.bind(null,n,i,r,e),void 0,null),Oi===null)throw Error(ze(349));_c&30||vU(n,e,r)}return r}function vU(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kn.updateQueue,e===null?(e={lastEffect:null,stores:null},kn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yU(t,e,n,i){e.value=n,e.getSnapshot=i,_U(e)&&wU(t)}function xU(t,e,n){return n(function(){_U(e)&&wU(t)})}function _U(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vo(t,n)}catch{return!0}}function wU(t){var e=Ga(t,1);e!==null&&co(e,t,1,-1)}function tR(t){var e=jo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Am,lastRenderedState:t},e.queue=t,t=t.dispatch=SH.bind(null,kn,t),[e.memoizedState,t]}function Em(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=kn.updateQueue,e===null?(e={lastEffect:null,stores:null},kn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function SU(){return Vs().memoizedState}function Sy(t,e,n,i){var r=jo();kn.flags|=t,r.memoizedState=Em(1|e,n,void 0,i===void 0?null:i)}function ax(t,e,n,i){var r=Vs();i=i===void 0?null:i;var s=void 0;if(mi!==null){var o=mi.memoizedState;if(s=o.destroy,i!==null&&mE(i,o.deps)){r.memoizedState=Em(e,n,s,i);return}}kn.flags|=t,r.memoizedState=Em(1|e,n,s,i)}function nR(t,e){return Sy(8390656,8,t,e)}function yE(t,e){return ax(2048,8,t,e)}function bU(t,e){return ax(4,2,t,e)}function MU(t,e){return ax(4,4,t,e)}function AU(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function EU(t,e,n){return n=n!=null?n.concat([t]):null,ax(4,4,AU.bind(null,e,t),n)}function xE(){}function TU(t,e){var n=Vs();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&mE(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function CU(t,e){var n=Vs();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&mE(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function PU(t,e,n){return _c&21?(vo(n,e)||(n=Dk(),kn.lanes|=n,wc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Fr=!0),t.memoizedState=n)}function _H(t,e){var n=cn;cn=n!==0&&4>n?n:4,t(!0);var i=Nw.transition;Nw.transition={};try{t(!1),e()}finally{cn=n,Nw.transition=i}}function RU(){return Vs().memoizedState}function wH(t,e,n){var i=$l(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},LU(t))DU(e,n);else if(n=lU(t,e,n,i),n!==null){var r=wr();co(n,t,i,r),IU(n,e,i)}}function SH(t,e,n){var i=$l(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(LU(t))DU(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,vo(a,o)){var l=e.interleaved;l===null?(r.next=r,cE(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=lU(t,e,r,i),n!==null&&(r=wr(),co(n,t,i,r),IU(n,e,i))}}function LU(t){var e=t.alternate;return t===kn||e!==null&&e===kn}function DU(t,e){Hp=r1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function IU(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZA(t,n)}}var s1={readContext:Bs,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useInsertionEffect:Zi,useLayoutEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useMutableSource:Zi,useSyncExternalStore:Zi,useId:Zi,unstable_isNewReconciler:!1},bH={readContext:Bs,useCallback:function(t,e){return jo().memoizedState=[t,e===void 0?null:e],t},useContext:Bs,useEffect:nR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Sy(4194308,4,AU.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Sy(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sy(4,2,t,e)},useMemo:function(t,e){var n=jo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=jo();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=wH.bind(null,kn,t),[i.memoizedState,t]},useRef:function(t){var e=jo();return t={current:t},e.memoizedState=t},useState:tR,useDebugValue:xE,useDeferredValue:function(t){return jo().memoizedState=t},useTransition:function(){var t=tR(!1),e=t[0];return t=_H.bind(null,t[1]),jo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=kn,r=jo();if(En){if(n===void 0)throw Error(ze(407));n=n()}else{if(n=e(),Oi===null)throw Error(ze(349));_c&30||vU(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,nR(xU.bind(null,i,s,t),[t]),i.flags|=2048,Em(9,yU.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=jo(),e=Oi.identifierPrefix;if(En){var n=Oa,i=Ia;n=(i&~(1<<32-uo(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Mm++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=xH++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},MH={readContext:Bs,useCallback:TU,useContext:Bs,useEffect:yE,useImperativeHandle:EU,useInsertionEffect:bU,useLayoutEffect:MU,useMemo:CU,useReducer:kw,useRef:SU,useState:function(){return kw(Am)},useDebugValue:xE,useDeferredValue:function(t){var e=Vs();return PU(e,mi.memoizedState,t)},useTransition:function(){var t=kw(Am)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:mU,useSyncExternalStore:gU,useId:RU,unstable_isNewReconciler:!1},AH={readContext:Bs,useCallback:TU,useContext:Bs,useEffect:yE,useImperativeHandle:EU,useInsertionEffect:bU,useLayoutEffect:MU,useMemo:CU,useReducer:Uw,useRef:SU,useState:function(){return Uw(Am)},useDebugValue:xE,useDeferredValue:function(t){var e=Vs();return mi===null?e.memoizedState=t:PU(e,mi.memoizedState,t)},useTransition:function(){var t=Uw(Am)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:mU,useSyncExternalStore:gU,useId:RU,unstable_isNewReconciler:!1};function Vd(t,e){try{var n="",i=e;do n+=Jj(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function zw(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pM(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var EH=typeof WeakMap=="function"?WeakMap:Map;function OU(t,e,n){n=ka(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){a1||(a1=!0,MM=i),pM(t,e)},n}function NU(t,e,n){n=ka(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){pM(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){pM(t,e),typeof i!="function"&&(Wl===null?Wl=new Set([this]):Wl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function iR(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new EH;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=BH.bind(null,t,e,n),e.then(t,t))}function rR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sR(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ka(-1,1),e.tag=2,Hl(n,e,1))),n.lanes|=1),t)}var TH=Ka.ReactCurrentOwner,Fr=!1;function fr(t,e,n,i){e.child=t===null?fU(e,null,n,i):Fd(e,t.child,n,i)}function oR(t,e,n,i,r){n=n.render;var s=e.ref;return _d(e,r),i=gE(t,e,n,i,s,r),n=vE(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r)):(En&&n&&rE(e),e.flags|=1,fr(t,e,i,r),e.child)}function aR(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!TE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,kU(t,e,s,i,r)):(t=Ey(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ym,n(o,i)&&t.ref===e.ref)return Ha(t,e,r)}return e.flags|=1,t=ql(s,i),t.ref=e.ref,t.return=e,e.child=t}function kU(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(ym(s,i)&&t.ref===e.ref)if(Fr=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Fr=!0);else return e.lanes=t.lanes,Ha(t,e,r)}return mM(t,e,n,i,r)}function UU(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yn(od,es),es|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yn(od,es),es|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,yn(od,es),es|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,yn(od,es),es|=i;return fr(t,e,r,n),e.child}function zU(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mM(t,e,n,i,r){var s=jr(n)?yc:ir.current;return s=Ud(e,s),_d(e,r),n=gE(t,e,n,i,s,r),i=vE(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r)):(En&&i&&rE(e),e.flags|=1,fr(t,e,n,r),e.child)}function lR(t,e,n,i,r){if(jr(n)){var s=!0;Ky(e)}else s=!1;if(_d(e,r),e.stateNode===null)by(t,e),hU(e,n,i),fM(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Bs(u):(u=jr(n)?yc:ir.current,u=Ud(e,u));var d=n.getDerivedStateFromProps,c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&JP(e,o,i,u),wl=!1;var h=e.memoizedState;o.state=h,n1(e,i,o,r),l=e.memoizedState,a!==i||h!==l||Vr.current||wl?(typeof d=="function"&&(dM(e,n,d,i),l=e.memoizedState),(a=wl||QP(e,n,a,i,h,l,u))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,uU(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:to(e.type,a),o.props=u,c=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Bs(l):(l=jr(n)?yc:ir.current,l=Ud(e,l));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==c||h!==l)&&JP(e,o,i,l),wl=!1,h=e.memoizedState,o.state=h,n1(e,i,o,r);var m=e.memoizedState;a!==c||h!==m||Vr.current||wl?(typeof f=="function"&&(dM(e,n,f,i),m=e.memoizedState),(u=wl||QP(e,n,u,i,h,m,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),o.props=i,o.state=m,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),i=!1)}return gM(t,e,n,i,s,r)}function gM(t,e,n,i,r,s){zU(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&qP(e,n,!1),Ha(t,e,s);i=e.stateNode,TH.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=Fd(e,t.child,null,s),e.child=Fd(e,null,a,s)):fr(t,e,a,s),e.memoizedState=i.state,r&&qP(e,n,!0),e.child}function FU(t){var e=t.stateNode;e.pendingContext?$P(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$P(t,e.context,!1),dE(t,e.containerInfo)}function uR(t,e,n,i,r){return zd(),oE(r),e.flags|=256,fr(t,e,n,i),e.child}var vM={dehydrated:null,treeContext:null,retryLane:0};function yM(t){return{baseLanes:t,cachePool:null,transitions:null}}function BU(t,e,n){var i=e.pendingProps,r=Dn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),yn(Dn,r&1),t===null)return cM(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cx(o,i,0,null),t=hc(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=yM(n),e.memoizedState=vM,t):_E(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return CH(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=ql(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=ql(a,s):(s=hc(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?yM(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vM,i}return s=t.child,t=s.sibling,i=ql(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function _E(t,e){return e=cx({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function H0(t,e,n,i){return i!==null&&oE(i),Fd(e,t.child,null,n),t=_E(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function CH(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=zw(Error(ze(422))),H0(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=cx({mode:"visible",children:i.children},r,0,null),s=hc(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Fd(e,t.child,null,o),e.child.memoizedState=yM(o),e.memoizedState=vM,s);if(!(e.mode&1))return H0(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(ze(419)),i=zw(s,i,void 0),H0(t,e,o,i)}if(a=(o&t.childLanes)!==0,Fr||a){if(i=Oi,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ga(t,r),co(i,t,r,-1))}return EE(),i=zw(Error(ze(421))),H0(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=VH.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,is=Gl(r.nextSibling),ss=e,En=!0,ro=null,t!==null&&(Ls[Ds++]=Ia,Ls[Ds++]=Oa,Ls[Ds++]=xc,Ia=t.id,Oa=t.overflow,xc=e),e=_E(e,i.children),e.flags|=4096,e)}function cR(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),hM(t.return,e,n)}function Fw(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function VU(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(fr(t,e,i.children,n),i=Dn.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cR(t,n,e);else if(t.tag===19)cR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(yn(Dn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&i1(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Fw(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&i1(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Fw(e,!0,n,null,s);break;case"together":Fw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function by(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ha(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ze(153));if(e.child!==null){for(t=e.child,n=ql(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ql(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function PH(t,e,n){switch(e.tag){case 3:FU(e),zd();break;case 5:pU(e);break;case 1:jr(e.type)&&Ky(e);break;case 4:dE(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;yn(e1,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(yn(Dn,Dn.current&1),e.flags|=128,null):n&e.child.childLanes?BU(t,e,n):(yn(Dn,Dn.current&1),t=Ha(t,e,n),t!==null?t.sibling:null);yn(Dn,Dn.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return VU(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),yn(Dn,Dn.current),i)break;return null;case 22:case 23:return e.lanes=0,UU(t,e,n)}return Ha(t,e,n)}var jU,xM,GU,HU;jU=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xM=function(){};GU=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,nc(Ko.current);var s=null;switch(n){case"input":r=Vb(t,r),i=Vb(t,i),s=[];break;case"select":r=Un({},r,{value:void 0}),i=Un({},i,{value:void 0}),s=[];break;case"textarea":r=Hb(t,r),i=Hb(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Yy)}$b(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hm.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hm.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&_n("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};HU=function(t,e,n,i){n!==i&&(e.flags|=4)};function Qf(t,e){if(!En)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ki(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function RH(t,e,n){var i=e.pendingProps;switch(sE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ki(e),null;case 1:return jr(e.type)&&Zy(),Ki(e),null;case 3:return i=e.stateNode,Bd(),bn(Vr),bn(ir),pE(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(j0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ro!==null&&(TM(ro),ro=null))),xM(t,e),Ki(e),null;case 5:fE(e);var r=nc(bm.current);if(n=e.type,t!==null&&e.stateNode!=null)GU(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ze(166));return Ki(e),null}if(t=nc(Ko.current),j0(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Ho]=e,i[wm]=s,t=(e.mode&1)!==0,n){case"dialog":_n("cancel",i),_n("close",i);break;case"iframe":case"object":case"embed":_n("load",i);break;case"video":case"audio":for(r=0;r<Rp.length;r++)_n(Rp[r],i);break;case"source":_n("error",i);break;case"img":case"image":case"link":_n("error",i),_n("load",i);break;case"details":_n("toggle",i);break;case"input":xP(i,s),_n("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},_n("invalid",i);break;case"textarea":wP(i,s),_n("invalid",i)}$b(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&V0(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&V0(i.textContent,a,t),r=["children",""+a]):hm.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&_n("scroll",i)}switch(n){case"input":I0(i),_P(i,s,!0);break;case"textarea":I0(i),SP(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Yy)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[Ho]=e,t[wm]=i,jU(t,e,!1,!1),e.stateNode=t;e:{switch(o=qb(n,i),n){case"dialog":_n("cancel",t),_n("close",t),r=i;break;case"iframe":case"object":case"embed":_n("load",t),r=i;break;case"video":case"audio":for(r=0;r<Rp.length;r++)_n(Rp[r],t);r=i;break;case"source":_n("error",t),r=i;break;case"img":case"image":case"link":_n("error",t),_n("load",t),r=i;break;case"details":_n("toggle",t),r=i;break;case"input":xP(t,i),r=Vb(t,i),_n("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Un({},i,{value:void 0}),_n("invalid",t);break;case"textarea":wP(t,i),r=Hb(t,i),_n("invalid",t);break;default:r=i}$b(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?_k(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&yk(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&dm(t,l):typeof l=="number"&&dm(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hm.hasOwnProperty(s)?l!=null&&s==="onScroll"&&_n("scroll",t):l!=null&&HA(t,s,l,o))}switch(n){case"input":I0(t),_P(t,i,!1);break;case"textarea":I0(t),SP(t);break;case"option":i.value!=null&&t.setAttribute("value",""+tu(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?gd(t,!!i.multiple,s,!1):i.defaultValue!=null&&gd(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Yy)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ki(e),null;case 6:if(t&&e.stateNode!=null)HU(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ze(166));if(n=nc(bm.current),nc(Ko.current),j0(e)){if(i=e.stateNode,n=e.memoizedProps,i[Ho]=e,(s=i.nodeValue!==n)&&(t=ss,t!==null))switch(t.tag){case 3:V0(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&V0(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Ho]=e,e.stateNode=i}return Ki(e),null;case 13:if(bn(Dn),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(En&&is!==null&&e.mode&1&&!(e.flags&128))aU(),zd(),e.flags|=98560,s=!1;else if(s=j0(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(ze(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ze(317));s[Ho]=e}else zd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ki(e),s=!1}else ro!==null&&(TM(ro),ro=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Dn.current&1?vi===0&&(vi=3):EE())),e.updateQueue!==null&&(e.flags|=4),Ki(e),null);case 4:return Bd(),xM(t,e),t===null&&xm(e.stateNode.containerInfo),Ki(e),null;case 10:return uE(e.type._context),Ki(e),null;case 17:return jr(e.type)&&Zy(),Ki(e),null;case 19:if(bn(Dn),s=e.memoizedState,s===null)return Ki(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Qf(s,!1);else{if(vi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=i1(t),o!==null){for(e.flags|=128,Qf(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return yn(Dn,Dn.current&1|2),e.child}t=t.sibling}s.tail!==null&&ii()>jd&&(e.flags|=128,i=!0,Qf(s,!1),e.lanes=4194304)}else{if(!i)if(t=i1(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Qf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!En)return Ki(e),null}else 2*ii()-s.renderingStartTime>jd&&n!==1073741824&&(e.flags|=128,i=!0,Qf(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ii(),e.sibling=null,n=Dn.current,yn(Dn,i?n&1|2:n&1),e):(Ki(e),null);case 22:case 23:return AE(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?es&1073741824&&(Ki(e),e.subtreeFlags&6&&(e.flags|=8192)):Ki(e),null;case 24:return null;case 25:return null}throw Error(ze(156,e.tag))}function LH(t,e){switch(sE(e),e.tag){case 1:return jr(e.type)&&Zy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bd(),bn(Vr),bn(ir),pE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fE(e),null;case 13:if(bn(Dn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ze(340));zd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return bn(Dn),null;case 4:return Bd(),null;case 10:return uE(e.type._context),null;case 22:case 23:return AE(),null;case 24:return null;default:return null}}var W0=!1,er=!1,DH=typeof WeakSet=="function"?WeakSet:Set,nt=null;function sd(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Gn(t,e,i)}else n.current=null}function _M(t,e,n){try{n()}catch(i){Gn(t,e,i)}}var hR=!1;function IH(t,e){if(iM=$y,t=Xk(),iE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,c=t,h=null;t:for(;;){for(var f;c!==n||r!==0&&c.nodeType!==3||(a=o+r),c!==s||i!==0&&c.nodeType!==3||(l=o+i),c.nodeType===3&&(o+=c.nodeValue.length),(f=c.firstChild)!==null;)h=c,c=f;for(;;){if(c===t)break t;if(h===n&&++u===r&&(a=o),h===s&&++d===i&&(l=o),(f=c.nextSibling)!==null)break;c=h,h=c.parentNode}c=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(rM={focusedElem:t,selectionRange:n},$y=!1,nt=e;nt!==null;)if(e=nt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,nt=t;else for(;nt!==null;){e=nt;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,y=m.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:to(e.type,x),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(b){Gn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,nt=t;break}nt=e.return}return m=hR,hR=!1,m}function Wp(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&_M(e,n,s)}r=r.next}while(r!==i)}}function lx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function wM(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function WU(t){var e=t.alternate;e!==null&&(t.alternate=null,WU(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ho],delete e[wm],delete e[aM],delete e[mH],delete e[gH])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $U(t){return t.tag===5||t.tag===3||t.tag===4}function dR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$U(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function SM(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Yy));else if(i!==4&&(t=t.child,t!==null))for(SM(t,e,n),t=t.sibling;t!==null;)SM(t,e,n),t=t.sibling}function bM(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(bM(t,e,n),t=t.sibling;t!==null;)bM(t,e,n),t=t.sibling}var zi=null,io=!1;function ul(t,e,n){for(n=n.child;n!==null;)qU(t,e,n),n=n.sibling}function qU(t,e,n){if(Zo&&typeof Zo.onCommitFiberUnmount=="function")try{Zo.onCommitFiberUnmount(ex,n)}catch{}switch(n.tag){case 5:er||sd(n,e);case 6:var i=zi,r=io;zi=null,ul(t,e,n),zi=i,io=r,zi!==null&&(io?(t=zi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):zi.removeChild(n.stateNode));break;case 18:zi!==null&&(io?(t=zi,n=n.stateNode,t.nodeType===8?Dw(t.parentNode,n):t.nodeType===1&&Dw(t,n),gm(t)):Dw(zi,n.stateNode));break;case 4:i=zi,r=io,zi=n.stateNode.containerInfo,io=!0,ul(t,e,n),zi=i,io=r;break;case 0:case 11:case 14:case 15:if(!er&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&_M(n,e,o),r=r.next}while(r!==i)}ul(t,e,n);break;case 1:if(!er&&(sd(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Gn(n,e,a)}ul(t,e,n);break;case 21:ul(t,e,n);break;case 22:n.mode&1?(er=(i=er)||n.memoizedState!==null,ul(t,e,n),er=i):ul(t,e,n);break;default:ul(t,e,n)}}function fR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new DH),e.forEach(function(i){var r=jH.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Ys(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:zi=a.stateNode,io=!1;break e;case 3:zi=a.stateNode.containerInfo,io=!0;break e;case 4:zi=a.stateNode.containerInfo,io=!0;break e}a=a.return}if(zi===null)throw Error(ze(160));qU(s,o,r),zi=null,io=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Gn(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XU(e,t),e=e.sibling}function XU(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ys(e,t),Io(t),i&4){try{Wp(3,t,t.return),lx(3,t)}catch(x){Gn(t,t.return,x)}try{Wp(5,t,t.return)}catch(x){Gn(t,t.return,x)}}break;case 1:Ys(e,t),Io(t),i&512&&n!==null&&sd(n,n.return);break;case 5:if(Ys(e,t),Io(t),i&512&&n!==null&&sd(n,n.return),t.flags&32){var r=t.stateNode;try{dm(r,"")}catch(x){Gn(t,t.return,x)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&mk(r,s),qb(a,o);var u=qb(a,s);for(o=0;o<l.length;o+=2){var d=l[o],c=l[o+1];d==="style"?_k(r,c):d==="dangerouslySetInnerHTML"?yk(r,c):d==="children"?dm(r,c):HA(r,d,c,u)}switch(a){case"input":jb(r,s);break;case"textarea":gk(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?gd(r,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?gd(r,!!s.multiple,s.defaultValue,!0):gd(r,!!s.multiple,s.multiple?[]:"",!1))}r[wm]=s}catch(x){Gn(t,t.return,x)}}break;case 6:if(Ys(e,t),Io(t),i&4){if(t.stateNode===null)throw Error(ze(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(x){Gn(t,t.return,x)}}break;case 3:if(Ys(e,t),Io(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{gm(e.containerInfo)}catch(x){Gn(t,t.return,x)}break;case 4:Ys(e,t),Io(t);break;case 13:Ys(e,t),Io(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(bE=ii())),i&4&&fR(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(er=(u=er)||d,Ys(e,t),er=u):Ys(e,t),Io(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(nt=t,d=t.child;d!==null;){for(c=nt=d;nt!==null;){switch(h=nt,f=h.child,h.tag){case 0:case 11:case 14:case 15:Wp(4,h,h.return);break;case 1:sd(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){i=h,n=h.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(x){Gn(i,n,x)}}break;case 5:sd(h,h.return);break;case 22:if(h.memoizedState!==null){mR(c);continue}}f!==null?(f.return=h,nt=f):mR(c)}d=d.sibling}e:for(d=null,c=t;;){if(c.tag===5){if(d===null){d=c;try{r=c.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=xk("display",o))}catch(x){Gn(t,t.return,x)}}}else if(c.tag===6){if(d===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(x){Gn(t,t.return,x)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Ys(e,t),Io(t),i&4&&fR(t);break;case 21:break;default:Ys(e,t),Io(t)}}function Io(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($U(n)){var i=n;break e}n=n.return}throw Error(ze(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(dm(r,""),i.flags&=-33);var s=dR(t);bM(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=dR(t);SM(t,a,o);break;default:throw Error(ze(161))}}catch(l){Gn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OH(t,e,n){nt=t,YU(t)}function YU(t,e,n){for(var i=(t.mode&1)!==0;nt!==null;){var r=nt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||W0;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||er;a=W0;var u=er;if(W0=o,(er=l)&&!u)for(nt=r;nt!==null;)o=nt,l=o.child,o.tag===22&&o.memoizedState!==null?gR(r):l!==null?(l.return=o,nt=l):gR(r);for(;s!==null;)nt=s,YU(s),s=s.sibling;nt=r,W0=a,er=u}pR(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,nt=s):pR(t)}}function pR(t){for(;nt!==null;){var e=nt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:er||lx(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!er)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:to(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&KP(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}KP(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var c=d.dehydrated;c!==null&&gm(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}er||e.flags&512&&wM(e)}catch(h){Gn(e,e.return,h)}}if(e===t){nt=null;break}if(n=e.sibling,n!==null){n.return=e.return,nt=n;break}nt=e.return}}function mR(t){for(;nt!==null;){var e=nt;if(e===t){nt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,nt=n;break}nt=e.return}}function gR(t){for(;nt!==null;){var e=nt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lx(4,e)}catch(l){Gn(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Gn(e,r,l)}}var s=e.return;try{wM(e)}catch(l){Gn(e,s,l)}break;case 5:var o=e.return;try{wM(e)}catch(l){Gn(e,o,l)}}}catch(l){Gn(e,e.return,l)}if(e===t){nt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,nt=a;break}nt=e.return}}var NH=Math.ceil,o1=Ka.ReactCurrentDispatcher,wE=Ka.ReactCurrentOwner,Fs=Ka.ReactCurrentBatchConfig,Kt=0,Oi=null,ui=null,Vi=0,es=0,od=hu(0),vi=0,Tm=null,wc=0,ux=0,SE=0,$p=null,Ir=null,bE=0,jd=1/0,Ma=null,a1=!1,MM=null,Wl=null,$0=!1,Rl=null,l1=0,qp=0,AM=null,My=-1,Ay=0;function wr(){return Kt&6?ii():My!==-1?My:My=ii()}function $l(t){return t.mode&1?Kt&2&&Vi!==0?Vi&-Vi:yH.transition!==null?(Ay===0&&(Ay=Dk()),Ay):(t=cn,t!==0||(t=window.event,t=t===void 0?16:Fk(t.type)),t):1}function co(t,e,n,i){if(50<qp)throw qp=0,AM=null,Error(ze(185));cg(t,n,i),(!(Kt&2)||t!==Oi)&&(t===Oi&&(!(Kt&2)&&(ux|=n),vi===4&&Ml(t,Vi)),Gr(t,i),n===1&&Kt===0&&!(e.mode&1)&&(jd=ii()+500,sx&&du()))}function Gr(t,e){var n=t.callbackNode;yG(t,e);var i=Wy(t,t===Oi?Vi:0);if(i===0)n!==null&&AP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&AP(n),e===1)t.tag===0?vH(vR.bind(null,t)):rU(vR.bind(null,t)),fH(function(){!(Kt&6)&&du()}),n=null;else{switch(Ik(i)){case 1:n=YA;break;case 4:n=Rk;break;case 16:n=Hy;break;case 536870912:n=Lk;break;default:n=Hy}n=iz(n,ZU.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ZU(t,e){if(My=-1,Ay=0,Kt&6)throw Error(ze(327));var n=t.callbackNode;if(wd()&&t.callbackNode!==n)return null;var i=Wy(t,t===Oi?Vi:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=u1(t,i);else{e=i;var r=Kt;Kt|=2;var s=QU();(Oi!==t||Vi!==e)&&(Ma=null,jd=ii()+500,cc(t,e));do try{zH();break}catch(a){KU(t,a)}while(1);lE(),o1.current=s,Kt=r,ui!==null?e=0:(Oi=null,Vi=0,e=vi)}if(e!==0){if(e===2&&(r=Qb(t),r!==0&&(i=r,e=EM(t,r))),e===1)throw n=Tm,cc(t,0),Ml(t,i),Gr(t,ii()),n;if(e===6)Ml(t,i);else{if(r=t.current.alternate,!(i&30)&&!kH(r)&&(e=u1(t,i),e===2&&(s=Qb(t),s!==0&&(i=s,e=EM(t,s))),e===1))throw n=Tm,cc(t,0),Ml(t,i),Gr(t,ii()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(ze(345));case 2:Vu(t,Ir,Ma);break;case 3:if(Ml(t,i),(i&130023424)===i&&(e=bE+500-ii(),10<e)){if(Wy(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){wr(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=oM(Vu.bind(null,t,Ir,Ma),e);break}Vu(t,Ir,Ma);break;case 4:if(Ml(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-uo(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=ii()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*NH(i/1960))-i,10<i){t.timeoutHandle=oM(Vu.bind(null,t,Ir,Ma),i);break}Vu(t,Ir,Ma);break;case 5:Vu(t,Ir,Ma);break;default:throw Error(ze(329))}}}return Gr(t,ii()),t.callbackNode===n?ZU.bind(null,t):null}function EM(t,e){var n=$p;return t.current.memoizedState.isDehydrated&&(cc(t,e).flags|=256),t=u1(t,e),t!==2&&(e=Ir,Ir=n,e!==null&&TM(e)),t}function TM(t){Ir===null?Ir=t:Ir.push.apply(Ir,t)}function kH(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!vo(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ml(t,e){for(e&=~SE,e&=~ux,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-uo(e),i=1<<n;t[n]=-1,e&=~i}}function vR(t){if(Kt&6)throw Error(ze(327));wd();var e=Wy(t,0);if(!(e&1))return Gr(t,ii()),null;var n=u1(t,e);if(t.tag!==0&&n===2){var i=Qb(t);i!==0&&(e=i,n=EM(t,i))}if(n===1)throw n=Tm,cc(t,0),Ml(t,e),Gr(t,ii()),n;if(n===6)throw Error(ze(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vu(t,Ir,Ma),Gr(t,ii()),null}function ME(t,e){var n=Kt;Kt|=1;try{return t(e)}finally{Kt=n,Kt===0&&(jd=ii()+500,sx&&du())}}function Sc(t){Rl!==null&&Rl.tag===0&&!(Kt&6)&&wd();var e=Kt;Kt|=1;var n=Fs.transition,i=cn;try{if(Fs.transition=null,cn=1,t)return t()}finally{cn=i,Fs.transition=n,Kt=e,!(Kt&6)&&du()}}function AE(){es=od.current,bn(od)}function cc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dH(n)),ui!==null)for(n=ui.return;n!==null;){var i=n;switch(sE(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Zy();break;case 3:Bd(),bn(Vr),bn(ir),pE();break;case 5:fE(i);break;case 4:Bd();break;case 13:bn(Dn);break;case 19:bn(Dn);break;case 10:uE(i.type._context);break;case 22:case 23:AE()}n=n.return}if(Oi=t,ui=t=ql(t.current,null),Vi=es=e,vi=0,Tm=null,SE=ux=wc=0,Ir=$p=null,tc!==null){for(e=0;e<tc.length;e++)if(n=tc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}tc=null}return t}function KU(t,e){do{var n=ui;try{if(lE(),wy.current=s1,r1){for(var i=kn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}r1=!1}if(_c=0,Ii=mi=kn=null,Hp=!1,Mm=0,wE.current=null,n===null||n.return===null){vi=1,Tm=e,ui=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Vi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,c=d.tag;if(!(d.mode&1)&&(c===0||c===11||c===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=rR(o);if(f!==null){f.flags&=-257,sR(f,o,a,s,e),f.mode&1&&iR(s,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var x=new Set;x.add(l),e.updateQueue=x}else m.add(l);break e}else{if(!(e&1)){iR(s,u,e),EE();break e}l=Error(ze(426))}}else if(En&&a.mode&1){var y=rR(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),sR(y,o,a,s,e),oE(Vd(l,a));break e}}s=l=Vd(l,a),vi!==4&&(vi=2),$p===null?$p=[s]:$p.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=OU(s,l,e);ZP(s,v);break e;case 1:a=l;var _=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Wl===null||!Wl.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=NU(s,a,e);ZP(s,b);break e}}s=s.return}while(s!==null)}ez(n)}catch(E){e=E,ui===n&&n!==null&&(ui=n=n.return);continue}break}while(1)}function QU(){var t=o1.current;return o1.current=s1,t===null?s1:t}function EE(){(vi===0||vi===3||vi===2)&&(vi=4),Oi===null||!(wc&268435455)&&!(ux&268435455)||Ml(Oi,Vi)}function u1(t,e){var n=Kt;Kt|=2;var i=QU();(Oi!==t||Vi!==e)&&(Ma=null,cc(t,e));do try{UH();break}catch(r){KU(t,r)}while(1);if(lE(),Kt=n,o1.current=i,ui!==null)throw Error(ze(261));return Oi=null,Vi=0,vi}function UH(){for(;ui!==null;)JU(ui)}function zH(){for(;ui!==null&&!uG();)JU(ui)}function JU(t){var e=nz(t.alternate,t,es);t.memoizedProps=t.pendingProps,e===null?ez(t):ui=e,wE.current=null}function ez(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=LH(n,e),n!==null){n.flags&=32767,ui=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vi=6,ui=null;return}}else if(n=RH(n,e,es),n!==null){ui=n;return}if(e=e.sibling,e!==null){ui=e;return}ui=e=t}while(e!==null);vi===0&&(vi=5)}function Vu(t,e,n){var i=cn,r=Fs.transition;try{Fs.transition=null,cn=1,FH(t,e,n,i)}finally{Fs.transition=r,cn=i}return null}function FH(t,e,n,i){do wd();while(Rl!==null);if(Kt&6)throw Error(ze(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ze(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(xG(t,s),t===Oi&&(ui=Oi=null,Vi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||$0||($0=!0,iz(Hy,function(){return wd(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Fs.transition,Fs.transition=null;var o=cn;cn=1;var a=Kt;Kt|=4,wE.current=null,IH(t,n),XU(n,t),sH(rM),$y=!!iM,rM=iM=null,t.current=n,OH(n),cG(),Kt=a,cn=o,Fs.transition=s}else t.current=n;if($0&&($0=!1,Rl=t,l1=r),s=t.pendingLanes,s===0&&(Wl=null),fG(n.stateNode),Gr(t,ii()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(a1)throw a1=!1,t=MM,MM=null,t;return l1&1&&t.tag!==0&&wd(),s=t.pendingLanes,s&1?t===AM?qp++:(qp=0,AM=t):qp=0,du(),null}function wd(){if(Rl!==null){var t=Ik(l1),e=Fs.transition,n=cn;try{if(Fs.transition=null,cn=16>t?16:t,Rl===null)var i=!1;else{if(t=Rl,Rl=null,l1=0,Kt&6)throw Error(ze(331));var r=Kt;for(Kt|=4,nt=t.current;nt!==null;){var s=nt,o=s.child;if(nt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(nt=u;nt!==null;){var d=nt;switch(d.tag){case 0:case 11:case 15:Wp(8,d,s)}var c=d.child;if(c!==null)c.return=d,nt=c;else for(;nt!==null;){d=nt;var h=d.sibling,f=d.return;if(WU(d),d===u){nt=null;break}if(h!==null){h.return=f,nt=h;break}nt=f}}}var m=s.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}nt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,nt=o;else e:for(;nt!==null;){if(s=nt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wp(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,nt=v;break e}nt=s.return}}var _=t.current;for(nt=_;nt!==null;){o=nt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,nt=w;else e:for(o=_;nt!==null;){if(a=nt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lx(9,a)}}catch(E){Gn(a,a.return,E)}if(a===o){nt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,nt=b;break e}nt=a.return}}if(Kt=r,du(),Zo&&typeof Zo.onPostCommitFiberRoot=="function")try{Zo.onPostCommitFiberRoot(ex,t)}catch{}i=!0}return i}finally{cn=n,Fs.transition=e}}return!1}function yR(t,e,n){e=Vd(n,e),e=OU(t,e,1),t=Hl(t,e,1),e=wr(),t!==null&&(cg(t,1,e),Gr(t,e))}function Gn(t,e,n){if(t.tag===3)yR(t,t,n);else for(;e!==null;){if(e.tag===3){yR(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Wl===null||!Wl.has(i))){t=Vd(n,t),t=NU(e,t,1),e=Hl(e,t,1),t=wr(),e!==null&&(cg(e,1,t),Gr(e,t));break}}e=e.return}}function BH(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=wr(),t.pingedLanes|=t.suspendedLanes&n,Oi===t&&(Vi&n)===n&&(vi===4||vi===3&&(Vi&130023424)===Vi&&500>ii()-bE?cc(t,0):SE|=n),Gr(t,e)}function tz(t,e){e===0&&(t.mode&1?(e=k0,k0<<=1,!(k0&130023424)&&(k0=4194304)):e=1);var n=wr();t=Ga(t,e),t!==null&&(cg(t,e,n),Gr(t,n))}function VH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),tz(t,n)}function jH(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(ze(314))}i!==null&&i.delete(e),tz(t,n)}var nz;nz=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vr.current)Fr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Fr=!1,PH(t,e,n);Fr=!!(t.flags&131072)}else Fr=!1,En&&e.flags&1048576&&sU(e,Jy,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;by(t,e),t=e.pendingProps;var r=Ud(e,ir.current);_d(e,n),r=gE(null,e,i,t,r,n);var s=vE();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jr(i)?(s=!0,Ky(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,hE(e),r.updater=ox,e.stateNode=r,r._reactInternals=e,fM(e,i,t,n),e=gM(null,e,i,!0,s,n)):(e.tag=0,En&&s&&rE(e),fr(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(by(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=HH(i),t=to(i,t),r){case 0:e=mM(null,e,i,t,n);break e;case 1:e=lR(null,e,i,t,n);break e;case 11:e=oR(null,e,i,t,n);break e;case 14:e=aR(null,e,i,to(i.type,t),n);break e}throw Error(ze(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:to(i,r),mM(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:to(i,r),lR(t,e,i,r,n);case 3:e:{if(FU(e),t===null)throw Error(ze(387));i=e.pendingProps,s=e.memoizedState,r=s.element,uU(t,e),n1(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Vd(Error(ze(423)),e),e=uR(t,e,i,n,r);break e}else if(i!==r){r=Vd(Error(ze(424)),e),e=uR(t,e,i,n,r);break e}else for(is=Gl(e.stateNode.containerInfo.firstChild),ss=e,En=!0,ro=null,n=fU(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zd(),i===r){e=Ha(t,e,n);break e}fr(t,e,i,n)}e=e.child}return e;case 5:return pU(e),t===null&&cM(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,sM(i,r)?o=null:s!==null&&sM(i,s)&&(e.flags|=32),zU(t,e),fr(t,e,o,n),e.child;case 6:return t===null&&cM(e),null;case 13:return BU(t,e,n);case 4:return dE(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Fd(e,null,i,n):fr(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:to(i,r),oR(t,e,i,r,n);case 7:return fr(t,e,e.pendingProps,n),e.child;case 8:return fr(t,e,e.pendingProps.children,n),e.child;case 12:return fr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,yn(e1,i._currentValue),i._currentValue=o,s!==null)if(vo(s.value,o)){if(s.children===r.children&&!Vr.current){e=Ha(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=ka(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),hM(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ze(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),hM(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}fr(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,_d(e,n),r=Bs(r),i=i(r),e.flags|=1,fr(t,e,i,n),e.child;case 14:return i=e.type,r=to(i,e.pendingProps),r=to(i.type,r),aR(t,e,i,r,n);case 15:return kU(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:to(i,r),by(t,e),e.tag=1,jr(i)?(t=!0,Ky(e)):t=!1,_d(e,n),hU(e,i,r),fM(e,i,r,n),gM(null,e,i,!0,t,n);case 19:return VU(t,e,n);case 22:return UU(t,e,n)}throw Error(ze(156,e.tag))};function iz(t,e){return Pk(t,e)}function GH(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(t,e,n,i){return new GH(t,e,n,i)}function TE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HH(t){if(typeof t=="function")return TE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$A)return 11;if(t===qA)return 14}return 2}function ql(t,e){var n=t.alternate;return n===null?(n=Us(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ey(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")TE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Zh:return hc(n.children,r,s,e);case WA:o=8,r|=8;break;case Ub:return t=Us(12,n,e,r|2),t.elementType=Ub,t.lanes=s,t;case zb:return t=Us(13,n,e,r),t.elementType=zb,t.lanes=s,t;case Fb:return t=Us(19,n,e,r),t.elementType=Fb,t.lanes=s,t;case dk:return cx(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ck:o=10;break e;case hk:o=9;break e;case $A:o=11;break e;case qA:o=14;break e;case _l:o=16,i=null;break e}throw Error(ze(130,t==null?t:typeof t,""))}return e=Us(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function hc(t,e,n,i){return t=Us(7,t,i,e),t.lanes=n,t}function cx(t,e,n,i){return t=Us(22,t,i,e),t.elementType=dk,t.lanes=n,t.stateNode={isHidden:!1},t}function Bw(t,e,n){return t=Us(6,t,null,e),t.lanes=n,t}function Vw(t,e,n){return e=Us(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WH(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ww(0),this.expirationTimes=ww(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ww(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function CE(t,e,n,i,r,s,o,a,l){return t=new WH(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Us(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hE(s),t}function $H(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yh,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function rz(t){if(!t)return nu;t=t._reactInternals;e:{if(Ic(t)!==t||t.tag!==1)throw Error(ze(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ze(171))}if(t.tag===1){var n=t.type;if(jr(n))return iU(t,n,e)}return e}function sz(t,e,n,i,r,s,o,a,l){return t=CE(n,i,!0,t,r,s,o,a,l),t.context=rz(null),n=t.current,i=wr(),r=$l(n),s=ka(i,r),s.callback=e??null,Hl(n,s,r),t.current.lanes=r,cg(t,r,i),Gr(t,i),t}function hx(t,e,n,i){var r=e.current,s=wr(),o=$l(r);return n=rz(n),e.context===null?e.context=n:e.pendingContext=n,e=ka(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Hl(r,e,o),t!==null&&(co(t,r,o,s),_y(t,r,o)),o}function c1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function PE(t,e){xR(t,e),(t=t.alternate)&&xR(t,e)}function qH(){return null}var oz=typeof reportError=="function"?reportError:function(t){console.error(t)};function RE(t){this._internalRoot=t}dx.prototype.render=RE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ze(409));hx(t,e,null,null)};dx.prototype.unmount=RE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Sc(function(){hx(null,t,null,null)}),e[ja]=null}};function dx(t){this._internalRoot=t}dx.prototype.unstable_scheduleHydration=function(t){if(t){var e=kk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<bl.length&&e!==0&&e<bl[n].priority;n++);bl.splice(n,0,t),n===0&&zk(t)}};function LE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _R(){}function XH(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=c1(o);s.call(u)}}var o=sz(e,i,t,0,null,!1,!1,"",_R);return t._reactRootContainer=o,t[ja]=o.current,xm(t.nodeType===8?t.parentNode:t),Sc(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=c1(l);a.call(u)}}var l=CE(t,0,!1,null,null,!1,!1,"",_R);return t._reactRootContainer=l,t[ja]=l.current,xm(t.nodeType===8?t.parentNode:t),Sc(function(){hx(e,l,n,i)}),l}function px(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=c1(o);a.call(l)}}hx(e,o,t,r)}else o=XH(n,e,t,r,i);return c1(o)}Ok=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Pp(e.pendingLanes);n!==0&&(ZA(e,n|1),Gr(e,ii()),!(Kt&6)&&(jd=ii()+500,du()))}break;case 13:Sc(function(){var i=Ga(t,1);if(i!==null){var r=wr();co(i,t,1,r)}}),PE(t,1)}};KA=function(t){if(t.tag===13){var e=Ga(t,134217728);if(e!==null){var n=wr();co(e,t,134217728,n)}PE(t,134217728)}};Nk=function(t){if(t.tag===13){var e=$l(t),n=Ga(t,e);if(n!==null){var i=wr();co(n,t,e,i)}PE(t,e)}};kk=function(){return cn};Uk=function(t,e){var n=cn;try{return cn=t,e()}finally{cn=n}};Yb=function(t,e,n){switch(e){case"input":if(jb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=rx(i);if(!r)throw Error(ze(90));pk(i),jb(i,r)}}}break;case"textarea":gk(t,n);break;case"select":e=n.value,e!=null&&gd(t,!!n.multiple,e,!1)}};bk=ME;Mk=Sc;var YH={usingClientEntryPoint:!1,Events:[dg,ed,rx,wk,Sk,ME]},Jf={findFiberByHostInstance:ec,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ZH={bundleType:Jf.bundleType,version:Jf.version,rendererPackageName:Jf.rendererPackageName,rendererConfig:Jf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ka.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Tk(t),t===null?null:t.stateNode},findFiberByHostInstance:Jf.findFiberByHostInstance||qH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{ex=q0.inject(ZH),Zo=q0}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YH;hs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!LE(e))throw Error(ze(200));return $H(t,e,null,n)};hs.createRoot=function(t,e){if(!LE(t))throw Error(ze(299));var n=!1,i="",r=oz;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=CE(t,1,!1,null,null,n,!1,i,r),t[ja]=e.current,xm(t.nodeType===8?t.parentNode:t),new RE(e)};hs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ze(188)):(t=Object.keys(t).join(","),Error(ze(268,t)));return t=Tk(e),t=t===null?null:t.stateNode,t};hs.flushSync=function(t){return Sc(t)};hs.hydrate=function(t,e,n){if(!fx(e))throw Error(ze(200));return px(null,t,e,!0,n)};hs.hydrateRoot=function(t,e,n){if(!LE(t))throw Error(ze(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=oz;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=sz(e,null,t,1,n??null,r,!1,s,o),t[ja]=e.current,xm(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new dx(e)};hs.render=function(t,e,n){if(!fx(e))throw Error(ze(200));return px(null,t,e,!1,n)};hs.unmountComponentAtNode=function(t){if(!fx(t))throw Error(ze(40));return t._reactRootContainer?(Sc(function(){px(null,null,t,!1,function(){t._reactRootContainer=null,t[ja]=null})}),!0):!1};hs.unstable_batchedUpdates=ME;hs.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!fx(n))throw Error(ze(200));if(t==null||t._reactInternals===void 0)throw Error(ze(38));return px(t,e,n,!1,i)};hs.version="18.2.0-next-9e3b772b8-20220608";function az(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(az)}catch(t){console.error(t)}}az(),sk.exports=hs;var KH=sk.exports,lz,wR=KH;lz=wR.createRoot,wR.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const mx="158",QH={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},JH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},uz=0,CM=1,cz=2,eW=3,hz=0,gx=1,Xp=2,no=3,Wa=0,Sr=1,so=2,tW=2,Ua=0,Xl=1,PM=2,RM=3,LM=4,dz=5,Al=100,fz=101,pz=102,DM=103,IM=104,mz=200,gz=201,vz=202,yz=203,h1=204,d1=205,xz=206,_z=207,wz=208,Sz=209,bz=210,Mz=211,Az=212,Ez=213,Tz=214,Cz=0,Pz=1,Rz=2,Cm=3,Lz=4,Dz=5,Iz=6,Oz=7,pg=0,Nz=1,kz=2,Qo=0,Uz=1,zz=2,Fz=3,DE=4,Bz=5,OM="attached",Vz="detached",vx=300,ia=301,$a=302,Pm=303,Rm=304,Oc=306,Lm=1e3,tr=1001,Dm=1002,ti=1003,f1=1004,nW=1004,Yp=1005,iW=1005,In=1006,IE=1007,rW=1007,iu=1008,sW=1008,Jo=1009,jz=1010,Gz=1011,yx=1012,OE=1013,$o=1014,rs=1015,ru=1016,NE=1017,kE=1018,Yl=1020,Hz=1021,vr=1023,Wz=1024,$z=1025,Zl=1026,bc=1027,qz=1028,UE=1029,p1=1030,zE=1031,xx=1033,Ty=33776,Cy=33777,Py=33778,Ry=33779,NM=35840,kM=35841,UM=35842,zM=35843,Xz=36196,FM=37492,BM=37496,VM=37808,jM=37809,GM=37810,HM=37811,WM=37812,$M=37813,qM=37814,XM=37815,YM=37816,ZM=37817,KM=37818,QM=37819,JM=37820,e2=37821,Ly=36492,t2=36494,n2=36495,Yz=36283,i2=36284,r2=36285,s2=36286,Zz=2200,Kz=2201,Qz=2202,Im=2300,Om=2301,Dy=2302,ic=2400,rc=2401,Nm=2402,_x=2500,FE=2501,oW=0,aW=1,lW=2,Gd=3e3,ea=3001,Jz=3200,eF=3201,fu=0,tF=1,ns="",ni="srgb",yo="srgb-linear",wx="display-p3",mg="display-p3-linear",km="linear",gn="srgb",Um="rec709",zm="p3",uW=0,ju=7680,cW=7681,hW=7682,dW=7683,fW=34055,pW=34056,mW=5386,gW=512,vW=513,yW=514,xW=515,_W=516,wW=517,SW=518,o2=519,nF=512,iF=513,rF=514,sF=515,oF=516,aF=517,lF=518,uF=519,Fm=35044,cF=35048,bW=35040,MW=35045,AW=35049,EW=35041,TW=35046,CW=35050,PW=35042,RW="100",a2="300 es",m1=1035,qo=2e3,Bm=2001;class sa{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Qi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let SR=1234567;const dc=Math.PI/180,Hd=180/Math.PI;function os(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Qi[t&255]+Qi[t>>8&255]+Qi[t>>16&255]+Qi[t>>24&255]+"-"+Qi[e&255]+Qi[e>>8&255]+"-"+Qi[e>>16&15|64]+Qi[e>>24&255]+"-"+Qi[n&63|128]+Qi[n>>8&255]+"-"+Qi[n>>16&255]+Qi[n>>24&255]+Qi[i&255]+Qi[i>>8&255]+Qi[i>>16&255]+Qi[i>>24&255]).toLowerCase()}function Hn(t,e,n){return Math.max(e,Math.min(n,t))}function BE(t,e){return(t%e+e)%e}function LW(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function DW(t,e,n){return t!==e?(n-t)/(e-t):0}function Zp(t,e,n){return(1-n)*t+n*e}function IW(t,e,n,i){return Zp(t,e,1-Math.exp(-n*i))}function OW(t,e=1){return e-Math.abs(BE(t,e*2)-e)}function NW(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function kW(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function UW(t,e){return t+Math.floor(Math.random()*(e-t+1))}function zW(t,e){return t+Math.random()*(e-t)}function FW(t){return t*(.5-Math.random())}function BW(t){t!==void 0&&(SR=t);let e=SR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function VW(t){return t*dc}function jW(t){return t*Hd}function l2(t){return(t&t-1)===0&&t!==0}function hF(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function g1(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function GW(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),u=s((e+i)/2),d=o((e+i)/2),c=s((e-i)/2),h=o((e-i)/2),f=s((i-e)/2),m=o((i-e)/2);switch(r){case"XYX":t.set(a*d,l*c,l*h,a*u);break;case"YZY":t.set(l*h,a*d,l*c,a*u);break;case"ZXZ":t.set(l*c,l*h,a*d,a*u);break;case"XZX":t.set(a*d,l*m,l*f,a*u);break;case"YXY":t.set(l*f,a*d,l*m,a*u);break;case"ZYZ":t.set(l*m,l*f,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function kr(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function kt(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Ut={DEG2RAD:dc,RAD2DEG:Hd,generateUUID:os,clamp:Hn,euclideanModulo:BE,mapLinear:LW,inverseLerp:DW,lerp:Zp,damp:IW,pingpong:OW,smoothstep:NW,smootherstep:kW,randInt:UW,randFloat:zW,randFloatSpread:FW,seededRandom:BW,degToRad:VW,radToDeg:jW,isPowerOfTwo:l2,ceilPowerOfTwo:hF,floorPowerOfTwo:g1,setQuaternionFromProperEuler:GW,normalize:kt,denormalize:kr};class ee{constructor(e=0,n=0){ee.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Hn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class St{constructor(e,n,i,r,s,o,a,l,u){St.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,u)}set(e,n,i,r,s,o,a,l,u){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=n,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],d=i[4],c=i[7],h=i[2],f=i[5],m=i[8],x=r[0],y=r[3],v=r[6],_=r[1],w=r[4],b=r[7],E=r[2],A=r[5],T=r[8];return s[0]=o*x+a*_+l*E,s[3]=o*y+a*w+l*A,s[6]=o*v+a*b+l*T,s[1]=u*x+d*_+c*E,s[4]=u*y+d*w+c*A,s[7]=u*v+d*b+c*T,s[2]=h*x+f*_+m*E,s[5]=h*y+f*w+m*A,s[8]=h*v+f*b+m*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8];return n*o*d-n*a*u-i*s*d+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],c=d*o-a*u,h=a*l-d*s,f=u*s-o*l,m=n*c+i*h+r*f;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/m;return e[0]=c*x,e[1]=(r*u-d*i)*x,e[2]=(a*i-r*o)*x,e[3]=h*x,e[4]=(d*n-r*l)*x,e[5]=(r*s-a*n)*x,e[6]=f*x,e[7]=(i*l-u*n)*x,e[8]=(o*n-i*s)*x,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(jw.makeScale(e,n)),this}rotate(e){return this.premultiply(jw.makeRotation(-e)),this}translate(e,n){return this.premultiply(jw.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const jw=new St;function dF(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const HW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ad(t,e){return new HW[t](e)}function Vm(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function fF(){const t=Vm("canvas");return t.style.display="block",t}const bR={};function Kp(t){t in bR||(bR[t]=!0,console.warn(t))}const MR=new St().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),AR=new St().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),X0={[yo]:{transfer:km,primaries:Um,toReference:t=>t,fromReference:t=>t},[ni]:{transfer:gn,primaries:Um,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[mg]:{transfer:km,primaries:zm,toReference:t=>t.applyMatrix3(AR),fromReference:t=>t.applyMatrix3(MR)},[wx]:{transfer:gn,primaries:zm,toReference:t=>t.convertSRGBToLinear().applyMatrix3(AR),fromReference:t=>t.applyMatrix3(MR).convertLinearToSRGB()}},WW=new Set([yo,mg]),ln={enabled:!0,_workingColorSpace:yo,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!WW.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=X0[e].toReference,r=X0[n].fromReference;return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return X0[t].primaries},getTransfer:function(t){return t===ns?km:X0[t].transfer}};function Sd(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Gw(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let dh;class VE{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{dh===void 0&&(dh=Vm("canvas")),dh.width=e.width,dh.height=e.height;const i=dh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=dh}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Vm("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Sd(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(Sd(n[i]/255)*255):n[i]=Sd(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let $W=0;class sc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$W++}),this.uuid=os(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Hw(r[o].image)):s.push(Hw(r[o]))}else s=Hw(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function Hw(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?VE.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let qW=0;class Tn extends sa{constructor(e=Tn.DEFAULT_IMAGE,n=Tn.DEFAULT_MAPPING,i=tr,r=tr,s=In,o=iu,a=vr,l=Jo,u=Tn.DEFAULT_ANISOTROPY,d=ns){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:qW++}),this.uuid=os(),this.name="",this.source=new sc(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new ee(0,0),this.repeat=new ee(1,1),this.center=new ee(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new St,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(Kp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===ea?ni:ns),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vx)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Lm:e.x=e.x-Math.floor(e.x);break;case tr:e.x=e.x<0?0:1;break;case Dm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Lm:e.y=e.y-Math.floor(e.y);break;case tr:e.y=e.y<0?0:1;break;case Dm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Kp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ni?ea:Gd}set encoding(e){Kp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===ea?ni:ns}}Tn.DEFAULT_IMAGE=null;Tn.DEFAULT_MAPPING=vx;Tn.DEFAULT_ANISOTROPY=1;class Ct{constructor(e=0,n=0,i=0,r=1){Ct.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,u=l[0],d=l[4],c=l[8],h=l[1],f=l[5],m=l[9],x=l[2],y=l[6],v=l[10];if(Math.abs(d-h)<.01&&Math.abs(c-x)<.01&&Math.abs(m-y)<.01){if(Math.abs(d+h)<.1&&Math.abs(c+x)<.1&&Math.abs(m+y)<.1&&Math.abs(u+f+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const w=(u+1)/2,b=(f+1)/2,E=(v+1)/2,A=(d+h)/4,T=(c+x)/4,L=(m+y)/4;return w>b&&w>E?w<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(w),r=A/i,s=T/i):b>E?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=A/r,s=L/r):E<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(E),i=T/s,r=L/s),this.set(i,r,s,n),this}let _=Math.sqrt((y-m)*(y-m)+(c-x)*(c-x)+(h-d)*(h-d));return Math.abs(_)<.001&&(_=1),this.x=(y-m)/_,this.y=(c-x)/_,this.z=(h-d)/_,this.w=Math.acos((u+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class pF extends sa{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Ct(0,0,e,n),this.scissorTest=!1,this.viewport=new Ct(0,0,e,n);const r={width:e,height:n,depth:1};i.encoding!==void 0&&(Kp("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===ea?ni:ns),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:In,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Tn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new sc(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class js extends pF{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class Sx extends Tn{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=tr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class XW extends js{constructor(e=1,n=1,i=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Sx(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class jE extends Tn{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=tr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class YW extends js{constructor(e=1,n=1,i=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new jE(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class ZW extends js{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=n,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,i=e.texture.length;n<i;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class xi{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],u=i[r+1],d=i[r+2],c=i[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],x=s[o+3];if(a===0){e[n+0]=l,e[n+1]=u,e[n+2]=d,e[n+3]=c;return}if(a===1){e[n+0]=h,e[n+1]=f,e[n+2]=m,e[n+3]=x;return}if(c!==x||l!==h||u!==f||d!==m){let y=1-a;const v=l*h+u*f+d*m+c*x,_=v>=0?1:-1,w=1-v*v;if(w>Number.EPSILON){const E=Math.sqrt(w),A=Math.atan2(E,v*_);y=Math.sin(y*A)/E,a=Math.sin(a*A)/E}const b=a*_;if(l=l*y+h*b,u=u*y+f*b,d=d*y+m*b,c=c*y+x*b,y===1-a){const E=1/Math.sqrt(l*l+u*u+d*d+c*c);l*=E,u*=E,d*=E,c*=E}}e[n]=l,e[n+1]=u,e[n+2]=d,e[n+3]=c}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],d=i[r+3],c=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[n]=a*m+d*c+l*f-u*h,e[n+1]=l*m+d*h+u*c-a*f,e[n+2]=u*m+d*f+a*h-l*c,e[n+3]=d*m-a*c-l*h-u*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),d=a(r/2),c=a(s/2),h=l(i/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*d*c+u*f*m,this._y=u*f*c-h*d*m,this._z=u*d*m+h*f*c,this._w=u*d*c-h*f*m;break;case"YXZ":this._x=h*d*c+u*f*m,this._y=u*f*c-h*d*m,this._z=u*d*m-h*f*c,this._w=u*d*c+h*f*m;break;case"ZXY":this._x=h*d*c-u*f*m,this._y=u*f*c+h*d*m,this._z=u*d*m+h*f*c,this._w=u*d*c-h*f*m;break;case"ZYX":this._x=h*d*c-u*f*m,this._y=u*f*c+h*d*m,this._z=u*d*m-h*f*c,this._w=u*d*c+h*f*m;break;case"YZX":this._x=h*d*c+u*f*m,this._y=u*f*c+h*d*m,this._z=u*d*m-h*f*c,this._w=u*d*c-h*f*m;break;case"XZY":this._x=h*d*c-u*f*m,this._y=u*f*c-h*d*m,this._z=u*d*m+h*f*c,this._w=u*d*c+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],u=n[2],d=n[6],c=n[10],h=i+a+c;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(d-l)*f,this._y=(s-u)*f,this._z=(o-r)*f}else if(i>a&&i>c){const f=2*Math.sqrt(1+i-a-c);this._w=(d-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+u)/f}else if(a>c){const f=2*Math.sqrt(1+a-i-c);this._w=(s-u)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+d)/f}else{const f=2*Math.sqrt(1+c-i-a);this._w=(o-r)/f,this._x=(s+u)/f,this._y=(l+d)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Hn(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,u=n._z,d=n._w;return this._x=i*d+o*a+r*u-s*l,this._y=r*d+o*l+s*a-i*u,this._z=s*d+o*u+i*l-r*a,this._w=o*d-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-n;return this._w=f*o+n*this._w,this._x=f*i+n*this._x,this._y=f*r+n*this._y,this._z=f*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),d=Math.atan2(u,a),c=Math.sin((1-n)*d)/u,h=Math.sin(n*d)/u;return this._w=o*c+this._w*h,this._x=i*c+this._x*h,this._y=r*c+this._y*h,this._z=s*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class O{constructor(e=0,n=0,i=0){O.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(ER.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(ER.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),d=2*(a*n-s*r),c=2*(s*i-o*n);return this.x=n+l*u+o*c-a*d,this.y=i+l*d+a*u-s*c,this.z=r+l*c+s*d-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Ww.copy(this).projectOnVector(e),this.sub(Ww)}reflect(e){return this.sub(Ww.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Hn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ww=new O,ER=new xi;class Hi{constructor(e=new O(1/0,1/0,1/0),n=new O(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Zs.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Zs.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Zs.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Zs):Zs.fromBufferAttribute(s,o),Zs.applyMatrix4(e.matrixWorld),this.expandByPoint(Zs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Y0.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Y0.copy(i.boundingBox)),Y0.applyMatrix4(e.matrixWorld),this.union(Y0)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Zs),Zs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ep),Z0.subVectors(this.max,ep),fh.subVectors(e.a,ep),ph.subVectors(e.b,ep),mh.subVectors(e.c,ep),cl.subVectors(ph,fh),hl.subVectors(mh,ph),Eu.subVectors(fh,mh);let n=[0,-cl.z,cl.y,0,-hl.z,hl.y,0,-Eu.z,Eu.y,cl.z,0,-cl.x,hl.z,0,-hl.x,Eu.z,0,-Eu.x,-cl.y,cl.x,0,-hl.y,hl.x,0,-Eu.y,Eu.x,0];return!$w(n,fh,ph,mh,Z0)||(n=[1,0,0,0,1,0,0,0,1],!$w(n,fh,ph,mh,Z0))?!1:(K0.crossVectors(cl,hl),n=[K0.x,K0.y,K0.z],$w(n,fh,ph,mh,Z0))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Zs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Zs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(pa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),pa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),pa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),pa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),pa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),pa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),pa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),pa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(pa),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const pa=[new O,new O,new O,new O,new O,new O,new O,new O],Zs=new O,Y0=new Hi,fh=new O,ph=new O,mh=new O,cl=new O,hl=new O,Eu=new O,ep=new O,Z0=new O,K0=new O,Tu=new O;function $w(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Tu.fromArray(t,s);const a=r.x*Math.abs(Tu.x)+r.y*Math.abs(Tu.y)+r.z*Math.abs(Tu.z),l=e.dot(Tu),u=n.dot(Tu),d=i.dot(Tu);if(Math.max(-Math.max(l,u,d),Math.min(l,u,d))>a)return!1}return!0}const KW=new Hi,tp=new O,qw=new O;class Gi{constructor(e=new O,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):KW.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;tp.subVectors(e,this.center);const n=tp.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(tp,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(qw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(tp.copy(e.center).add(qw)),this.expandByPoint(tp.copy(e.center).sub(qw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ma=new O,Xw=new O,Q0=new O,dl=new O,Yw=new O,J0=new O,Zw=new O;class Qa{constructor(e=new O,n=new O(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ma)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=ma.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(ma.copy(this.origin).addScaledVector(this.direction,n),ma.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){Xw.copy(e).add(n).multiplyScalar(.5),Q0.copy(n).sub(e).normalize(),dl.copy(this.origin).sub(Xw);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Q0),a=dl.dot(this.direction),l=-dl.dot(Q0),u=dl.lengthSq(),d=Math.abs(1-o*o);let c,h,f,m;if(d>0)if(c=o*l-a,h=o*a-l,m=s*d,c>=0)if(h>=-m)if(h<=m){const x=1/d;c*=x,h*=x,f=c*(c+o*h+2*a)+h*(o*c+h+2*l)+u}else h=s,c=Math.max(0,-(o*h+a)),f=-c*c+h*(h+2*l)+u;else h=-s,c=Math.max(0,-(o*h+a)),f=-c*c+h*(h+2*l)+u;else h<=-m?(c=Math.max(0,-(-o*s+a)),h=c>0?-s:Math.min(Math.max(-s,-l),s),f=-c*c+h*(h+2*l)+u):h<=m?(c=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+u):(c=Math.max(0,-(o*s+a)),h=c>0?s:Math.min(Math.max(-s,-l),s),f=-c*c+h*(h+2*l)+u);else h=o>0?-s:s,c=Math.max(0,-(o*h+a)),f=-c*c+h*(h+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,c),r&&r.copy(Xw).addScaledVector(Q0,h),f}intersectSphere(e,n){ma.subVectors(e.center,this.origin);const i=ma.dot(this.direction),r=ma.dot(ma)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l;const u=1/this.direction.x,d=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(i=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(i=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),c>=0?(a=(e.min.z-h.z)*c,l=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,l=(e.min.z-h.z)*c),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,ma)!==null}intersectTriangle(e,n,i,r,s){Yw.subVectors(n,e),J0.subVectors(i,e),Zw.crossVectors(Yw,J0);let o=this.direction.dot(Zw),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;dl.subVectors(this.origin,e);const l=a*this.direction.dot(J0.crossVectors(dl,J0));if(l<0)return null;const u=a*this.direction.dot(Yw.cross(dl));if(u<0||l+u>o)return null;const d=-a*dl.dot(Zw);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ue{constructor(e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y){Ue.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y)}set(e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y){const v=this.elements;return v[0]=e,v[4]=n,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=u,v[6]=d,v[10]=c,v[14]=h,v[3]=f,v[7]=m,v[11]=x,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ue().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/gh.setFromMatrixColumn(e,0).length(),s=1/gh.setFromMatrixColumn(e,1).length(),o=1/gh.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),d=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const h=o*d,f=o*c,m=a*d,x=a*c;n[0]=l*d,n[4]=-l*c,n[8]=u,n[1]=f+m*u,n[5]=h-x*u,n[9]=-a*l,n[2]=x-h*u,n[6]=m+f*u,n[10]=o*l}else if(e.order==="YXZ"){const h=l*d,f=l*c,m=u*d,x=u*c;n[0]=h+x*a,n[4]=m*a-f,n[8]=o*u,n[1]=o*c,n[5]=o*d,n[9]=-a,n[2]=f*a-m,n[6]=x+h*a,n[10]=o*l}else if(e.order==="ZXY"){const h=l*d,f=l*c,m=u*d,x=u*c;n[0]=h-x*a,n[4]=-o*c,n[8]=m+f*a,n[1]=f+m*a,n[5]=o*d,n[9]=x-h*a,n[2]=-o*u,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const h=o*d,f=o*c,m=a*d,x=a*c;n[0]=l*d,n[4]=m*u-f,n[8]=h*u+x,n[1]=l*c,n[5]=x*u+h,n[9]=f*u-m,n[2]=-u,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const h=o*l,f=o*u,m=a*l,x=a*u;n[0]=l*d,n[4]=x-h*c,n[8]=m*c+f,n[1]=c,n[5]=o*d,n[9]=-a*d,n[2]=-u*d,n[6]=f*c+m,n[10]=h-x*c}else if(e.order==="XZY"){const h=o*l,f=o*u,m=a*l,x=a*u;n[0]=l*d,n[4]=-c,n[8]=u*d,n[1]=h*c+x,n[5]=o*d,n[9]=f*c-m,n[2]=m*c-f,n[6]=a*d,n[10]=x*c+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(QW,e,JW)}lookAt(e,n,i){const r=this.elements;return Qr.subVectors(e,n),Qr.lengthSq()===0&&(Qr.z=1),Qr.normalize(),fl.crossVectors(i,Qr),fl.lengthSq()===0&&(Math.abs(i.z)===1?Qr.x+=1e-4:Qr.z+=1e-4,Qr.normalize(),fl.crossVectors(i,Qr)),fl.normalize(),ev.crossVectors(Qr,fl),r[0]=fl.x,r[4]=ev.x,r[8]=Qr.x,r[1]=fl.y,r[5]=ev.y,r[9]=Qr.y,r[2]=fl.z,r[6]=ev.z,r[10]=Qr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],d=i[1],c=i[5],h=i[9],f=i[13],m=i[2],x=i[6],y=i[10],v=i[14],_=i[3],w=i[7],b=i[11],E=i[15],A=r[0],T=r[4],L=r[8],P=r[12],C=r[1],D=r[5],U=r[9],G=r[13],k=r[2],H=r[6],K=r[10],q=r[14],N=r[3],V=r[7],j=r[11],z=r[15];return s[0]=o*A+a*C+l*k+u*N,s[4]=o*T+a*D+l*H+u*V,s[8]=o*L+a*U+l*K+u*j,s[12]=o*P+a*G+l*q+u*z,s[1]=d*A+c*C+h*k+f*N,s[5]=d*T+c*D+h*H+f*V,s[9]=d*L+c*U+h*K+f*j,s[13]=d*P+c*G+h*q+f*z,s[2]=m*A+x*C+y*k+v*N,s[6]=m*T+x*D+y*H+v*V,s[10]=m*L+x*U+y*K+v*j,s[14]=m*P+x*G+y*q+v*z,s[3]=_*A+w*C+b*k+E*N,s[7]=_*T+w*D+b*H+E*V,s[11]=_*L+w*U+b*K+E*j,s[15]=_*P+w*G+b*q+E*z,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],d=e[2],c=e[6],h=e[10],f=e[14],m=e[3],x=e[7],y=e[11],v=e[15];return m*(+s*l*c-r*u*c-s*a*h+i*u*h+r*a*f-i*l*f)+x*(+n*l*f-n*u*h+s*o*h-r*o*f+r*u*d-s*l*d)+y*(+n*u*c-n*a*f-s*o*c+i*o*f+s*a*d-i*u*d)+v*(-r*a*d-n*l*c+n*a*h+r*o*c-i*o*h+i*l*d)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],c=e[9],h=e[10],f=e[11],m=e[12],x=e[13],y=e[14],v=e[15],_=c*y*u-x*h*u+x*l*f-a*y*f-c*l*v+a*h*v,w=m*h*u-d*y*u-m*l*f+o*y*f+d*l*v-o*h*v,b=d*x*u-m*c*u+m*a*f-o*x*f-d*a*v+o*c*v,E=m*c*l-d*x*l-m*a*h+o*x*h+d*a*y-o*c*y,A=n*_+i*w+r*b+s*E;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/A;return e[0]=_*T,e[1]=(x*h*s-c*y*s-x*r*f+i*y*f+c*r*v-i*h*v)*T,e[2]=(a*y*s-x*l*s+x*r*u-i*y*u-a*r*v+i*l*v)*T,e[3]=(c*l*s-a*h*s-c*r*u+i*h*u+a*r*f-i*l*f)*T,e[4]=w*T,e[5]=(d*y*s-m*h*s+m*r*f-n*y*f-d*r*v+n*h*v)*T,e[6]=(m*l*s-o*y*s-m*r*u+n*y*u+o*r*v-n*l*v)*T,e[7]=(o*h*s-d*l*s+d*r*u-n*h*u-o*r*f+n*l*f)*T,e[8]=b*T,e[9]=(m*c*s-d*x*s-m*i*f+n*x*f+d*i*v-n*c*v)*T,e[10]=(o*x*s-m*a*s+m*i*u-n*x*u-o*i*v+n*a*v)*T,e[11]=(d*a*s-o*c*s-d*i*u+n*c*u+o*i*f-n*a*f)*T,e[12]=E*T,e[13]=(d*x*r-m*c*r+m*i*h-n*x*h-d*i*y+n*c*y)*T,e[14]=(m*a*r-o*x*r-m*i*l+n*x*l+o*i*y-n*a*y)*T,e[15]=(o*c*r-d*a*r+d*i*l-n*c*l-o*i*h+n*a*h)*T,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,d=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,d*a+i,d*l-r*o,0,u*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,u=s+s,d=o+o,c=a+a,h=s*u,f=s*d,m=s*c,x=o*d,y=o*c,v=a*c,_=l*u,w=l*d,b=l*c,E=i.x,A=i.y,T=i.z;return r[0]=(1-(x+v))*E,r[1]=(f+b)*E,r[2]=(m-w)*E,r[3]=0,r[4]=(f-b)*A,r[5]=(1-(h+v))*A,r[6]=(y+_)*A,r[7]=0,r[8]=(m+w)*T,r[9]=(y-_)*T,r[10]=(1-(h+x))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=gh.set(r[0],r[1],r[2]).length();const o=gh.set(r[4],r[5],r[6]).length(),a=gh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ks.copy(this);const u=1/s,d=1/o,c=1/a;return Ks.elements[0]*=u,Ks.elements[1]*=u,Ks.elements[2]*=u,Ks.elements[4]*=d,Ks.elements[5]*=d,Ks.elements[6]*=d,Ks.elements[8]*=c,Ks.elements[9]*=c,Ks.elements[10]*=c,n.setFromRotationMatrix(Ks),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o,a=qo){const l=this.elements,u=2*s/(n-e),d=2*s/(i-r),c=(n+e)/(n-e),h=(i+r)/(i-r);let f,m;if(a===qo)f=-(o+s)/(o-s),m=-2*o*s/(o-s);else if(a===Bm)f=-o/(o-s),m=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=c,l[12]=0,l[1]=0,l[5]=d,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,n,i,r,s,o,a=qo){const l=this.elements,u=1/(n-e),d=1/(i-r),c=1/(o-s),h=(n+e)*u,f=(i+r)*d;let m,x;if(a===qo)m=(o+s)*c,x=-2*c;else if(a===Bm)m=s*c,x=-1*c;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=x,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const gh=new O,Ks=new Ue,QW=new O(0,0,0),JW=new O(1,1,1),fl=new O,ev=new O,Qr=new O,TR=new Ue,CR=new xi;class ta{constructor(e=0,n=0,i=0,r=ta.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],d=r[9],c=r[2],h=r[6],f=r[10];switch(n){case"XYZ":this._y=Math.asin(Hn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Hn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(Hn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Hn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Hn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Hn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return TR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(TR,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return CR.setFromEuler(this),this.setFromQuaternion(CR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ta.DEFAULT_ORDER="XYZ";class fc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let e8=0;const PR=new O,vh=new xi,ga=new Ue,tv=new O,np=new O,t8=new O,n8=new xi,RR=new O(1,0,0),LR=new O(0,1,0),DR=new O(0,0,1),i8={type:"added"},r8={type:"removed"};class jt extends sa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:e8++}),this.uuid=os(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=jt.DEFAULT_UP.clone();const e=new O,n=new ta,i=new xi,r=new O(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ue},normalMatrix:{value:new St}}),this.matrix=new Ue,this.matrixWorld=new Ue,this.matrixAutoUpdate=jt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new fc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return vh.setFromAxisAngle(e,n),this.quaternion.multiply(vh),this}rotateOnWorldAxis(e,n){return vh.setFromAxisAngle(e,n),this.quaternion.premultiply(vh),this}rotateX(e){return this.rotateOnAxis(RR,e)}rotateY(e){return this.rotateOnAxis(LR,e)}rotateZ(e){return this.rotateOnAxis(DR,e)}translateOnAxis(e,n){return PR.copy(e).applyQuaternion(this.quaternion),this.position.add(PR.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(RR,e)}translateY(e){return this.translateOnAxis(LR,e)}translateZ(e){return this.translateOnAxis(DR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ga.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?tv.copy(e):tv.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),np.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ga.lookAt(np,tv,this.up):ga.lookAt(tv,np,this.up),this.quaternion.setFromRotationMatrix(ga),r&&(ga.extractRotation(r.matrixWorld),vh.setFromRotationMatrix(ga),this.quaternion.premultiply(vh.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(i8)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(r8)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ga.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ga.multiply(e.parent.matrixWorld)),e.applyMatrix4(ga),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n){let i=[];this[e]===n&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,n);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,e,t8),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,n8,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++){const s=n[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){const c=l[u];s(e.shapes,c)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),d=o(e.images),c=o(e.shapes),h=o(e.skeletons),f=o(e.animations),m=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),d.length>0&&(i.images=d),c.length>0&&(i.shapes=c),h.length>0&&(i.skeletons=h),f.length>0&&(i.animations=f),m.length>0&&(i.nodes=m)}return i.object=r,i;function o(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}jt.DEFAULT_UP=new O(0,1,0);jt.DEFAULT_MATRIX_AUTO_UPDATE=!0;jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Qs=new O,va=new O,Kw=new O,ya=new O,yh=new O,xh=new O,IR=new O,Qw=new O,Jw=new O,eS=new O;let nv=!1;class Bi{constructor(e=new O,n=new O,i=new O){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Qs.subVectors(e,n),r.cross(Qs);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Qs.subVectors(r,n),va.subVectors(i,n),Kw.subVectors(e,n);const o=Qs.dot(Qs),a=Qs.dot(va),l=Qs.dot(Kw),u=va.dot(va),d=va.dot(Kw),c=o*u-a*a;if(c===0)return s.set(-2,-1,-1);const h=1/c,f=(u*l-a*d)*h,m=(o*d-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,ya),ya.x>=0&&ya.y>=0&&ya.x+ya.y<=1}static getUV(e,n,i,r,s,o,a,l){return nv===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nv=!0),this.getInterpolation(e,n,i,r,s,o,a,l)}static getInterpolation(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,ya),l.setScalar(0),l.addScaledVector(s,ya.x),l.addScaledVector(o,ya.y),l.addScaledVector(a,ya.z),l}static isFrontFacing(e,n,i,r){return Qs.subVectors(i,n),va.subVectors(e,n),Qs.cross(va).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qs.subVectors(this.c,this.b),va.subVectors(this.a,this.b),Qs.cross(va).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Bi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Bi.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return nv===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nv=!0),Bi.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}getInterpolation(e,n,i,r,s){return Bi.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Bi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Bi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let o,a;yh.subVectors(r,i),xh.subVectors(s,i),Qw.subVectors(e,i);const l=yh.dot(Qw),u=xh.dot(Qw);if(l<=0&&u<=0)return n.copy(i);Jw.subVectors(e,r);const d=yh.dot(Jw),c=xh.dot(Jw);if(d>=0&&c<=d)return n.copy(r);const h=l*c-d*u;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),n.copy(i).addScaledVector(yh,o);eS.subVectors(e,s);const f=yh.dot(eS),m=xh.dot(eS);if(m>=0&&f<=m)return n.copy(s);const x=f*u-l*m;if(x<=0&&u>=0&&m<=0)return a=u/(u-m),n.copy(i).addScaledVector(xh,a);const y=d*m-f*c;if(y<=0&&c-d>=0&&f-m>=0)return IR.subVectors(s,r),a=(c-d)/(c-d+(f-m)),n.copy(r).addScaledVector(IR,a);const v=1/(y+x+h);return o=x*v,a=h*v,n.copy(i).addScaledVector(yh,o).addScaledVector(xh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const mF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pl={h:0,s:0,l:0},iv={h:0,s:0,l:0};function tS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class We{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ni){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ln.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=ln.workingColorSpace){return this.r=e,this.g=n,this.b=i,ln.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=ln.workingColorSpace){if(e=BE(e,1),n=Hn(n,0,1),i=Hn(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=tS(o,s,e+1/3),this.g=tS(o,s,e),this.b=tS(o,s,e-1/3)}return ln.toWorkingColorSpace(this,r),this}setStyle(e,n=ni){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ni){const i=mF[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Sd(e.r),this.g=Sd(e.g),this.b=Sd(e.b),this}copyLinearToSRGB(e){return this.r=Gw(e.r),this.g=Gw(e.g),this.b=Gw(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ni){return ln.fromWorkingColorSpace(Ji.copy(this),e),Math.round(Hn(Ji.r*255,0,255))*65536+Math.round(Hn(Ji.g*255,0,255))*256+Math.round(Hn(Ji.b*255,0,255))}getHexString(e=ni){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=ln.workingColorSpace){ln.fromWorkingColorSpace(Ji.copy(this),n);const i=Ji.r,r=Ji.g,s=Ji.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const d=(a+o)/2;if(a===o)l=0,u=0;else{const c=o-a;switch(u=d<=.5?c/(o+a):c/(2-o-a),o){case i:l=(r-s)/c+(r<s?6:0);break;case r:l=(s-i)/c+2;break;case s:l=(i-r)/c+4;break}l/=6}return e.h=l,e.s=u,e.l=d,e}getRGB(e,n=ln.workingColorSpace){return ln.fromWorkingColorSpace(Ji.copy(this),n),e.r=Ji.r,e.g=Ji.g,e.b=Ji.b,e}getStyle(e=ni){ln.fromWorkingColorSpace(Ji.copy(this),e);const n=Ji.r,i=Ji.g,r=Ji.b;return e!==ni?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(pl),this.setHSL(pl.h+e,pl.s+n,pl.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(pl),e.getHSL(iv);const i=Zp(pl.h,iv.h,n),r=Zp(pl.s,iv.s,n),s=Zp(pl.l,iv.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ji=new We;We.NAMES=mF;let s8=0;class Wi extends sa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:s8++}),this.uuid=os(),this.name="",this.type="Material",this.blending=Xl,this.side=Wa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=h1,this.blendDst=d1,this.blendEquation=Al,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new We(0,0,0),this.blendAlpha=0,this.depthFunc=Cm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=o2,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ju,this.stencilZFail=ju,this.stencilZPass=ju,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Xl&&(i.blending=this.blending),this.side!==Wa&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==h1&&(i.blendSrc=this.blendSrc),this.blendDst!==d1&&(i.blendDst=this.blendDst),this.blendEquation!==Al&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Cm&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==o2&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ju&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ju&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ju&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class oa extends Wi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new We(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const La=o8();function o8(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,d=0;for(;!(u&8388608);)u<<=1,d-=8388608;u&=-8388609,d+=947912704,s[l]=u|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Lr(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Hn(t,-65504,65504),La.floatView[0]=t;const e=La.uint32View[0],n=e>>23&511;return La.baseTable[n]+((e&8388607)>>La.shiftTable[n])}function Lp(t){const e=t>>10;return La.uint32View[0]=La.mantissaTable[La.offsetTable[e]+(t&1023)]+La.exponentTable[e],La.floatView[0]}const gF={toHalfFloat:Lr,fromHalfFloat:Lp},ai=new O,rv=new ee;class ht{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=Fm,this.updateRange={offset:0,count:-1},this.gpuType=rs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)rv.fromBufferAttribute(this,n),rv.applyMatrix3(e),this.setXY(n,rv.x,rv.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)ai.fromBufferAttribute(this,n),ai.applyMatrix3(e),this.setXYZ(n,ai.x,ai.y,ai.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)ai.fromBufferAttribute(this,n),ai.applyMatrix4(e),this.setXYZ(n,ai.x,ai.y,ai.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ai.fromBufferAttribute(this,n),ai.applyNormalMatrix(e),this.setXYZ(n,ai.x,ai.y,ai.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ai.fromBufferAttribute(this,n),ai.transformDirection(e),this.setXYZ(n,ai.x,ai.y,ai.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=kr(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=kt(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=kr(n,this.array)),n}setX(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=kr(n,this.array)),n}setY(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=kr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=kr(n,this.array)),n}setW(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array),s=kt(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Fm&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class a8 extends ht{constructor(e,n,i){super(new Int8Array(e),n,i)}}class l8 extends ht{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class u8 extends ht{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class c8 extends ht{constructor(e,n,i){super(new Int16Array(e),n,i)}}class GE extends ht{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class h8 extends ht{constructor(e,n,i){super(new Int32Array(e),n,i)}}class pc extends ht{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class d8 extends ht{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=Lp(this.array[e*this.itemSize]);return this.normalized&&(n=kr(n,this.array)),n}setX(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize]=Lr(n),this}getY(e){let n=Lp(this.array[e*this.itemSize+1]);return this.normalized&&(n=kr(n,this.array)),n}setY(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+1]=Lr(n),this}getZ(e){let n=Lp(this.array[e*this.itemSize+2]);return this.normalized&&(n=kr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+2]=Lr(n),this}getW(e){let n=Lp(this.array[e*this.itemSize+3]);return this.normalized&&(n=kr(n,this.array)),n}setW(e,n){return this.normalized&&(n=kt(n,this.array)),this.array[e*this.itemSize+3]=Lr(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array)),this.array[e+0]=Lr(n),this.array[e+1]=Lr(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array)),this.array[e+0]=Lr(n),this.array[e+1]=Lr(i),this.array[e+2]=Lr(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array),s=kt(s,this.array)),this.array[e+0]=Lr(n),this.array[e+1]=Lr(i),this.array[e+2]=Lr(r),this.array[e+3]=Lr(s),this}}class Ne extends ht{constructor(e,n,i){super(new Float32Array(e),n,i)}}class f8 extends ht{constructor(e,n,i){super(new Float64Array(e),n,i)}}let p8=0;const Ms=new Ue,nS=new jt,_h=new O,Jr=new Hi,ip=new Hi,Ri=new O;class Ke extends sa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:p8++}),this.uuid=os(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dF(e)?pc:GE)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new St().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ms.makeRotationFromQuaternion(e),this.applyMatrix4(Ms),this}rotateX(e){return Ms.makeRotationX(e),this.applyMatrix4(Ms),this}rotateY(e){return Ms.makeRotationY(e),this.applyMatrix4(Ms),this}rotateZ(e){return Ms.makeRotationZ(e),this.applyMatrix4(Ms),this}translate(e,n,i){return Ms.makeTranslation(e,n,i),this.applyMatrix4(Ms),this}scale(e,n,i){return Ms.makeScale(e,n,i),this.applyMatrix4(Ms),this}lookAt(e){return nS.lookAt(e),nS.updateMatrix(),this.applyMatrix4(nS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_h).negate(),this.translate(_h.x,_h.y,_h.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ne(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hi);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new O(-1/0,-1/0,-1/0),new O(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Jr.setFromBufferAttribute(s),this.morphTargetsRelative?(Ri.addVectors(this.boundingBox.min,Jr.min),this.boundingBox.expandByPoint(Ri),Ri.addVectors(this.boundingBox.max,Jr.max),this.boundingBox.expandByPoint(Ri)):(this.boundingBox.expandByPoint(Jr.min),this.boundingBox.expandByPoint(Jr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gi);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new O,1/0);return}if(e){const i=this.boundingSphere.center;if(Jr.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];ip.setFromBufferAttribute(a),this.morphTargetsRelative?(Ri.addVectors(Jr.min,ip.min),Jr.expandByPoint(Ri),Ri.addVectors(Jr.max,ip.max),Jr.expandByPoint(Ri)):(Jr.expandByPoint(ip.min),Jr.expandByPoint(ip.max))}Jr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ri.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ri));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)Ri.fromBufferAttribute(a,u),l&&(_h.fromBufferAttribute(e,u),Ri.add(_h)),r=Math.max(r,i.distanceToSquared(Ri))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ht(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],d=[];for(let C=0;C<a;C++)u[C]=new O,d[C]=new O;const c=new O,h=new O,f=new O,m=new ee,x=new ee,y=new ee,v=new O,_=new O;function w(C,D,U){c.fromArray(r,C*3),h.fromArray(r,D*3),f.fromArray(r,U*3),m.fromArray(o,C*2),x.fromArray(o,D*2),y.fromArray(o,U*2),h.sub(c),f.sub(c),x.sub(m),y.sub(m);const G=1/(x.x*y.y-y.x*x.y);isFinite(G)&&(v.copy(h).multiplyScalar(y.y).addScaledVector(f,-x.y).multiplyScalar(G),_.copy(f).multiplyScalar(x.x).addScaledVector(h,-y.x).multiplyScalar(G),u[C].add(v),u[D].add(v),u[U].add(v),d[C].add(_),d[D].add(_),d[U].add(_))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let C=0,D=b.length;C<D;++C){const U=b[C],G=U.start,k=U.count;for(let H=G,K=G+k;H<K;H+=3)w(i[H+0],i[H+1],i[H+2])}const E=new O,A=new O,T=new O,L=new O;function P(C){T.fromArray(s,C*3),L.copy(T);const D=u[C];E.copy(D),E.sub(T.multiplyScalar(T.dot(D))).normalize(),A.crossVectors(L,D);const G=A.dot(d[C])<0?-1:1;l[C*4]=E.x,l[C*4+1]=E.y,l[C*4+2]=E.z,l[C*4+3]=G}for(let C=0,D=b.length;C<D;++C){const U=b[C],G=U.start,k=U.count;for(let H=G,K=G+k;H<K;H+=3)P(i[H+0]),P(i[H+1]),P(i[H+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ht(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new O,s=new O,o=new O,a=new O,l=new O,u=new O,d=new O,c=new O;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),x=e.getX(h+1),y=e.getX(h+2);r.fromBufferAttribute(n,m),s.fromBufferAttribute(n,x),o.fromBufferAttribute(n,y),d.subVectors(o,s),c.subVectors(r,s),d.cross(c),a.fromBufferAttribute(i,m),l.fromBufferAttribute(i,x),u.fromBufferAttribute(i,y),a.add(d),l.add(d),u.add(d),i.setXYZ(m,a.x,a.y,a.z),i.setXYZ(x,l.x,l.y,l.z),i.setXYZ(y,u.x,u.y,u.z)}else for(let h=0,f=n.count;h<f;h+=3)r.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),o.fromBufferAttribute(n,h+2),d.subVectors(o,s),c.subVectors(r,s),d.cross(c),i.setXYZ(h+0,d.x,d.y,d.z),i.setXYZ(h+1,d.x,d.y,d.z),i.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Ri.fromBufferAttribute(e,n),Ri.normalize(),e.setXYZ(n,Ri.x,Ri.y,Ri.z)}toNonIndexed(){function e(a,l){const u=a.array,d=a.itemSize,c=a.normalized,h=new u.constructor(l.length*d);let f=0,m=0;for(let x=0,y=l.length;x<y;x++){a.isInterleavedBufferAttribute?f=l[x]*a.data.stride+a.offset:f=l[x]*d;for(let v=0;v<d;v++)h[m++]=u[f++]}return new ht(h,d,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Ke,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);n.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let d=0,c=u.length;d<c;d++){const h=u[d],f=e(h,i);l.push(f)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],d=[];for(let c=0,h=u.length;c<h;c++){const f=u[c];d.push(f.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const u in r){const d=r[u];this.setAttribute(u,d.clone(n))}const s=e.morphAttributes;for(const u in s){const d=[],c=s[u];for(let h=0,f=c.length;h<f;h++)d.push(c[h].clone(n));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const c=o[u];this.addGroup(c.start,c.count,c.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const OR=new Ue,Cu=new Qa,sv=new Gi,NR=new O,wh=new O,Sh=new O,bh=new O,iS=new O,ov=new O,av=new ee,lv=new ee,uv=new ee,kR=new O,UR=new O,zR=new O,cv=new O,hv=new O;class yi extends jt{constructor(e=new Ke,n=new oa){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){ov.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const d=a[l],c=s[l];d!==0&&(iS.fromBufferAttribute(c,e),o?ov.addScaledVector(iS,d):ov.addScaledVector(iS.sub(n),d))}n.add(ov)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),sv.copy(i.boundingSphere),sv.applyMatrix4(s),Cu.copy(e.ray).recast(e.near),!(sv.containsPoint(Cu.origin)===!1&&(Cu.intersectSphere(sv,NR)===null||Cu.origin.distanceToSquared(NR)>(e.far-e.near)**2))&&(OR.copy(s).invert(),Cu.copy(e.ray).applyMatrix4(OR),!(i.boundingBox!==null&&Cu.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Cu)))}_computeIntersections(e,n,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,d=s.attributes.uv1,c=s.attributes.normal,h=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let m=0,x=h.length;m<x;m++){const y=h[m],v=o[y.materialIndex],_=Math.max(y.start,f.start),w=Math.min(a.count,Math.min(y.start+y.count,f.start+f.count));for(let b=_,E=w;b<E;b+=3){const A=a.getX(b),T=a.getX(b+1),L=a.getX(b+2);r=dv(this,v,e,i,u,d,c,A,T,L),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const m=Math.max(0,f.start),x=Math.min(a.count,f.start+f.count);for(let y=m,v=x;y<v;y+=3){const _=a.getX(y),w=a.getX(y+1),b=a.getX(y+2);r=dv(this,o,e,i,u,d,c,_,w,b),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let m=0,x=h.length;m<x;m++){const y=h[m],v=o[y.materialIndex],_=Math.max(y.start,f.start),w=Math.min(l.count,Math.min(y.start+y.count,f.start+f.count));for(let b=_,E=w;b<E;b+=3){const A=b,T=b+1,L=b+2;r=dv(this,v,e,i,u,d,c,A,T,L),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const m=Math.max(0,f.start),x=Math.min(l.count,f.start+f.count);for(let y=m,v=x;y<v;y+=3){const _=y,w=y+1,b=y+2;r=dv(this,o,e,i,u,d,c,_,w,b),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}}}function m8(t,e,n,i,r,s,o,a){let l;if(e.side===Sr?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Wa,a),l===null)return null;hv.copy(a),hv.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(hv);return u<n.near||u>n.far?null:{distance:u,point:hv.clone(),object:t}}function dv(t,e,n,i,r,s,o,a,l,u){t.getVertexPosition(a,wh),t.getVertexPosition(l,Sh),t.getVertexPosition(u,bh);const d=m8(t,e,n,i,wh,Sh,bh,cv);if(d){r&&(av.fromBufferAttribute(r,a),lv.fromBufferAttribute(r,l),uv.fromBufferAttribute(r,u),d.uv=Bi.getInterpolation(cv,wh,Sh,bh,av,lv,uv,new ee)),s&&(av.fromBufferAttribute(s,a),lv.fromBufferAttribute(s,l),uv.fromBufferAttribute(s,u),d.uv1=Bi.getInterpolation(cv,wh,Sh,bh,av,lv,uv,new ee),d.uv2=d.uv1),o&&(kR.fromBufferAttribute(o,a),UR.fromBufferAttribute(o,l),zR.fromBufferAttribute(o,u),d.normal=Bi.getInterpolation(cv,wh,Sh,bh,kR,UR,zR,new O),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const c={a,b:l,c:u,normal:new O,materialIndex:0};Bi.getNormal(wh,Sh,bh,c.normal),d.face=c}return d}class us extends Ke{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],d=[],c=[];let h=0,f=0;m("z","y","x",-1,-1,i,n,e,o,s,0),m("z","y","x",1,-1,i,n,-e,o,s,1),m("x","z","y",1,1,e,i,n,r,o,2),m("x","z","y",1,-1,e,i,-n,r,o,3),m("x","y","z",1,-1,e,n,i,r,s,4),m("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ne(u,3)),this.setAttribute("normal",new Ne(d,3)),this.setAttribute("uv",new Ne(c,2));function m(x,y,v,_,w,b,E,A,T,L,P){const C=b/T,D=E/L,U=b/2,G=E/2,k=A/2,H=T+1,K=L+1;let q=0,N=0;const V=new O;for(let j=0;j<K;j++){const z=j*D-G;for(let $=0;$<H;$++){const te=$*C-U;V[x]=te*_,V[y]=z*w,V[v]=k,u.push(V.x,V.y,V.z),V[x]=0,V[y]=0,V[v]=A>0?1:-1,d.push(V.x,V.y,V.z),c.push($/T),c.push(1-j/L),q+=1}}for(let j=0;j<L;j++)for(let z=0;z<T;z++){const $=h+z+H*j,te=h+z+H*(j+1),Q=h+(z+1)+H*(j+1),J=h+(z+1)+H*j;l.push($,te,J),l.push(te,Q,J),N+=6}a.addGroup(f,N,P),f+=N,h+=q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new us(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Wd(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function hr(t){const e={};for(let n=0;n<t.length;n++){const i=Wd(t[n]);for(const r in i)e[r]=i[r]}return e}function g8(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function vF(t){return t.getRenderTarget()===null?t.outputColorSpace:ln.workingColorSpace}const Nc={clone:Wd,merge:hr};var v8=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,y8=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Gs extends Wi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=v8,this.fragmentShader=y8,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Wd(e.uniforms),this.uniformsGroups=g8(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class kc extends jt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ue,this.projectionMatrix=new Ue,this.projectionMatrixInverse=new Ue,this.coordinateSystem=qo}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let gi=class extends kc{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Hd*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(dc*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Hd*2*Math.atan(Math.tan(dc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(dc*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const Mh=-90,Ah=1;class yF extends jt{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new gi(Mh,Ah,e,n);r.layers=this.layers,this.add(r);const s=new gi(Mh,Ah,e,n);s.layers=this.layers,this.add(s);const o=new gi(Mh,Ah,e,n);o.layers=this.layers,this.add(o);const a=new gi(Mh,Ah,e,n);a.layers=this.layers,this.add(a);const l=new gi(Mh,Ah,e,n);l.layers=this.layers,this.add(l);const u=new gi(Mh,Ah,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,o,a,l]=n;for(const u of n)this.remove(u);if(e===qo)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Bm)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,d]=this.children,c=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;const x=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,o),e.setRenderTarget(i,2,r),e.render(n,a),e.setRenderTarget(i,3,r),e.render(n,l),e.setRenderTarget(i,4,r),e.render(n,u),i.texture.generateMipmaps=x,e.setRenderTarget(i,5,r),e.render(n,d),e.setRenderTarget(c,h,f),e.xr.enabled=m,i.texture.needsPMREMUpdate=!0}}class hf extends Tn{constructor(e,n,i,r,s,o,a,l,u,d){e=e!==void 0?e:[],n=n!==void 0?n:ia,super(e,n,i,r,s,o,a,l,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class xF extends js{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];n.encoding!==void 0&&(Kp("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===ea?ni:ns),this.texture=new hf(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:In}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new us(5,5,5),s=new Gs({name:"CubemapFromEquirect",uniforms:Wd(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Sr,blending:Ua});s.uniforms.tEquirect.value=n;const o=new yi(r,s),a=n.minFilter;return n.minFilter===iu&&(n.minFilter=In),new yF(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}}const rS=new O,x8=new O,_8=new St;class Pa{constructor(e=new O(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=rS.subVectors(i,n).cross(x8.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(rS),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||_8.getNormalMatrix(e),r=this.coplanarPoint(rS).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Pu=new Gi,fv=new O;class bx{constructor(e=new Pa,n=new Pa,i=new Pa,r=new Pa,s=new Pa,o=new Pa){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=qo){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],d=r[5],c=r[6],h=r[7],f=r[8],m=r[9],x=r[10],y=r[11],v=r[12],_=r[13],w=r[14],b=r[15];if(i[0].setComponents(l-s,h-u,y-f,b-v).normalize(),i[1].setComponents(l+s,h+u,y+f,b+v).normalize(),i[2].setComponents(l+o,h+d,y+m,b+_).normalize(),i[3].setComponents(l-o,h-d,y-m,b-_).normalize(),i[4].setComponents(l-a,h-c,y-x,b-w).normalize(),n===qo)i[5].setComponents(l+a,h+c,y+x,b+w).normalize();else if(n===Bm)i[5].setComponents(a,c,x,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Pu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Pu.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Pu)}intersectsSprite(e){return Pu.center.set(0,0,0),Pu.radius=.7071067811865476,Pu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Pu)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(fv.x=r.normal.x>0?e.max.x:e.min.x,fv.y=r.normal.y>0?e.max.y:e.min.y,fv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(fv)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function _F(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function w8(t,e){const n=e.isWebGL2,i=new WeakMap;function r(u,d){const c=u.array,h=u.usage,f=t.createBuffer();t.bindBuffer(d,f),t.bufferData(d,c,h),u.onUploadCallback();let m;if(c instanceof Float32Array)m=t.FLOAT;else if(c instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(n)m=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else m=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=t.SHORT;else if(c instanceof Uint32Array)m=t.UNSIGNED_INT;else if(c instanceof Int32Array)m=t.INT;else if(c instanceof Int8Array)m=t.BYTE;else if(c instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:f,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:u.version}}function s(u,d,c){const h=d.array,f=d.updateRange;t.bindBuffer(c,u),f.count===-1?t.bufferSubData(c,0,h):(n?t.bufferSubData(c,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):t.bufferSubData(c,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),d.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=i.get(u);d&&(t.deleteBuffer(d.buffer),i.delete(u))}function l(u,d){if(u.isGLBufferAttribute){const h=i.get(u);(!h||h.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const c=i.get(u);c===void 0?i.set(u,r(u,d)):c.version<u.version&&(s(c.buffer,u,d),c.version=u.version)}return{get:o,remove:a,update:l}}class Uc extends Ke{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),u=a+1,d=l+1,c=e/a,h=n/l,f=[],m=[],x=[],y=[];for(let v=0;v<d;v++){const _=v*h-o;for(let w=0;w<u;w++){const b=w*c-s;m.push(b,-_,0),x.push(0,0,1),y.push(w/a),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let _=0;_<a;_++){const w=_+u*v,b=_+u*(v+1),E=_+1+u*(v+1),A=_+1+u*v;f.push(w,b,A),f.push(b,E,A)}this.setIndex(f),this.setAttribute("position",new Ne(m,3)),this.setAttribute("normal",new Ne(x,3)),this.setAttribute("uv",new Ne(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uc(e.width,e.height,e.widthSegments,e.heightSegments)}}var S8=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,b8=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,M8=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,A8=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,E8=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,T8=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,C8=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,P8=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,R8=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,L8=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,D8=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,I8=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,O8=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,N8=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,k8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,U8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,z8=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,F8=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,B8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,V8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,j8=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,G8=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,H8=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,W8=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,$8=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,q8=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,X8=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Y8=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Z8="gl_FragColor = linearToOutputTexel( gl_FragColor );",K8=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Q8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,J8=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,e9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,t9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,n9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,i9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,r9=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,s9=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,o9=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,a9=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,l9=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,u9=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,c9=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,h9=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,d9=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,f9=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,p9=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,m9=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,g9=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,v9=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,y9=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,x9=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,_9=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,w9=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,S9=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,b9=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,M9=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,A9=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,E9=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,T9=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,C9=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,P9=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,R9=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,L9=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,D9=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,I9=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,O9=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,N9=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,k9=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,U9=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,z9=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,F9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,B9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,V9=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,j9=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,G9=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,H9=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,W9=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,$9=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,q9=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,X9=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Y9=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Z9=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,K9=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Q9=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,J9=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,e7=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,t7=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,n7=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,i7=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,r7=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,s7=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,o7=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,a7=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,l7=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,u7=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,c7=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,h7=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,d7=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,f7=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,p7=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,m7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,g7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,v7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,y7=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const x7=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,_7=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,w7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,S7=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,b7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,M7=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,A7=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,E7=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,T7=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,C7=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,P7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,R7=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,L7=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,D7=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,I7=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,O7=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N7=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,k7=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,U7=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,z7=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,B7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,V7=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,j7=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,G7=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,H7=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,W7=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$7=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,q7=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,X7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Y7=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Z7=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,K7=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Q7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Tt={alphahash_fragment:S8,alphahash_pars_fragment:b8,alphamap_fragment:M8,alphamap_pars_fragment:A8,alphatest_fragment:E8,alphatest_pars_fragment:T8,aomap_fragment:C8,aomap_pars_fragment:P8,begin_vertex:R8,beginnormal_vertex:L8,bsdfs:D8,iridescence_fragment:I8,bumpmap_pars_fragment:O8,clipping_planes_fragment:N8,clipping_planes_pars_fragment:k8,clipping_planes_pars_vertex:U8,clipping_planes_vertex:z8,color_fragment:F8,color_pars_fragment:B8,color_pars_vertex:V8,color_vertex:j8,common:G8,cube_uv_reflection_fragment:H8,defaultnormal_vertex:W8,displacementmap_pars_vertex:$8,displacementmap_vertex:q8,emissivemap_fragment:X8,emissivemap_pars_fragment:Y8,colorspace_fragment:Z8,colorspace_pars_fragment:K8,envmap_fragment:Q8,envmap_common_pars_fragment:J8,envmap_pars_fragment:e9,envmap_pars_vertex:t9,envmap_physical_pars_fragment:f9,envmap_vertex:n9,fog_vertex:i9,fog_pars_vertex:r9,fog_fragment:s9,fog_pars_fragment:o9,gradientmap_pars_fragment:a9,lightmap_fragment:l9,lightmap_pars_fragment:u9,lights_lambert_fragment:c9,lights_lambert_pars_fragment:h9,lights_pars_begin:d9,lights_toon_fragment:p9,lights_toon_pars_fragment:m9,lights_phong_fragment:g9,lights_phong_pars_fragment:v9,lights_physical_fragment:y9,lights_physical_pars_fragment:x9,lights_fragment_begin:_9,lights_fragment_maps:w9,lights_fragment_end:S9,logdepthbuf_fragment:b9,logdepthbuf_pars_fragment:M9,logdepthbuf_pars_vertex:A9,logdepthbuf_vertex:E9,map_fragment:T9,map_pars_fragment:C9,map_particle_fragment:P9,map_particle_pars_fragment:R9,metalnessmap_fragment:L9,metalnessmap_pars_fragment:D9,morphcolor_vertex:I9,morphnormal_vertex:O9,morphtarget_pars_vertex:N9,morphtarget_vertex:k9,normal_fragment_begin:U9,normal_fragment_maps:z9,normal_pars_fragment:F9,normal_pars_vertex:B9,normal_vertex:V9,normalmap_pars_fragment:j9,clearcoat_normal_fragment_begin:G9,clearcoat_normal_fragment_maps:H9,clearcoat_pars_fragment:W9,iridescence_pars_fragment:$9,opaque_fragment:q9,packing:X9,premultiplied_alpha_fragment:Y9,project_vertex:Z9,dithering_fragment:K9,dithering_pars_fragment:Q9,roughnessmap_fragment:J9,roughnessmap_pars_fragment:e7,shadowmap_pars_fragment:t7,shadowmap_pars_vertex:n7,shadowmap_vertex:i7,shadowmask_pars_fragment:r7,skinbase_vertex:s7,skinning_pars_vertex:o7,skinning_vertex:a7,skinnormal_vertex:l7,specularmap_fragment:u7,specularmap_pars_fragment:c7,tonemapping_fragment:h7,tonemapping_pars_fragment:d7,transmission_fragment:f7,transmission_pars_fragment:p7,uv_pars_fragment:m7,uv_pars_vertex:g7,uv_vertex:v7,worldpos_vertex:y7,background_vert:x7,background_frag:_7,backgroundCube_vert:w7,backgroundCube_frag:S7,cube_vert:b7,cube_frag:M7,depth_vert:A7,depth_frag:E7,distanceRGBA_vert:T7,distanceRGBA_frag:C7,equirect_vert:P7,equirect_frag:R7,linedashed_vert:L7,linedashed_frag:D7,meshbasic_vert:I7,meshbasic_frag:O7,meshlambert_vert:N7,meshlambert_frag:k7,meshmatcap_vert:U7,meshmatcap_frag:z7,meshnormal_vert:F7,meshnormal_frag:B7,meshphong_vert:V7,meshphong_frag:j7,meshphysical_vert:G7,meshphysical_frag:H7,meshtoon_vert:W7,meshtoon_frag:$7,points_vert:q7,points_frag:X7,shadow_vert:Y7,shadow_frag:Z7,sprite_vert:K7,sprite_frag:Q7},Ve={common:{diffuse:{value:new We(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new St},alphaMap:{value:null},alphaMapTransform:{value:new St},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new St}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new St}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new St}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new St},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new St},normalScale:{value:new ee(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new St},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new St}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new St}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new St}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new We(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new We(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new St},alphaTest:{value:0},uvTransform:{value:new St}},sprite:{diffuse:{value:new We(16777215)},opacity:{value:1},center:{value:new ee(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new St},alphaMap:{value:null},alphaMapTransform:{value:new St},alphaTest:{value:0}}},Is={basic:{uniforms:hr([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.fog]),vertexShader:Tt.meshbasic_vert,fragmentShader:Tt.meshbasic_frag},lambert:{uniforms:hr([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new We(0)}}]),vertexShader:Tt.meshlambert_vert,fragmentShader:Tt.meshlambert_frag},phong:{uniforms:hr([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new We(0)},specular:{value:new We(1118481)},shininess:{value:30}}]),vertexShader:Tt.meshphong_vert,fragmentShader:Tt.meshphong_frag},standard:{uniforms:hr([Ve.common,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.roughnessmap,Ve.metalnessmap,Ve.fog,Ve.lights,{emissive:{value:new We(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tt.meshphysical_vert,fragmentShader:Tt.meshphysical_frag},toon:{uniforms:hr([Ve.common,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.gradientmap,Ve.fog,Ve.lights,{emissive:{value:new We(0)}}]),vertexShader:Tt.meshtoon_vert,fragmentShader:Tt.meshtoon_frag},matcap:{uniforms:hr([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,{matcap:{value:null}}]),vertexShader:Tt.meshmatcap_vert,fragmentShader:Tt.meshmatcap_frag},points:{uniforms:hr([Ve.points,Ve.fog]),vertexShader:Tt.points_vert,fragmentShader:Tt.points_frag},dashed:{uniforms:hr([Ve.common,Ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tt.linedashed_vert,fragmentShader:Tt.linedashed_frag},depth:{uniforms:hr([Ve.common,Ve.displacementmap]),vertexShader:Tt.depth_vert,fragmentShader:Tt.depth_frag},normal:{uniforms:hr([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,{opacity:{value:1}}]),vertexShader:Tt.meshnormal_vert,fragmentShader:Tt.meshnormal_frag},sprite:{uniforms:hr([Ve.sprite,Ve.fog]),vertexShader:Tt.sprite_vert,fragmentShader:Tt.sprite_frag},background:{uniforms:{uvTransform:{value:new St},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Tt.background_vert,fragmentShader:Tt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Tt.backgroundCube_vert,fragmentShader:Tt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Tt.cube_vert,fragmentShader:Tt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tt.equirect_vert,fragmentShader:Tt.equirect_frag},distanceRGBA:{uniforms:hr([Ve.common,Ve.displacementmap,{referencePosition:{value:new O},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tt.distanceRGBA_vert,fragmentShader:Tt.distanceRGBA_frag},shadow:{uniforms:hr([Ve.lights,Ve.fog,{color:{value:new We(0)},opacity:{value:1}}]),vertexShader:Tt.shadow_vert,fragmentShader:Tt.shadow_frag}};Is.physical={uniforms:hr([Is.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new St},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new St},clearcoatNormalScale:{value:new ee(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new St},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new St},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new St},sheen:{value:0},sheenColor:{value:new We(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new St},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new St},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new St},transmissionSamplerSize:{value:new ee},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new St},attenuationDistance:{value:0},attenuationColor:{value:new We(0)},specularColor:{value:new We(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new St},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new St},anisotropyVector:{value:new ee},anisotropyMap:{value:null},anisotropyMapTransform:{value:new St}}]),vertexShader:Tt.meshphysical_vert,fragmentShader:Tt.meshphysical_frag};const pv={r:0,b:0,g:0};function J7(t,e,n,i,r,s,o){const a=new We(0);let l=s===!0?0:1,u,d,c=null,h=0,f=null;function m(y,v){let _=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?n:e).get(w)),w===null?x(a,l):w&&w.isColor&&(x(w,1),_=!0);const b=t.xr.getEnvironmentBlendMode();b==="additive"?i.buffers.color.setClear(0,0,0,1,o):b==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||_)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Oc)?(d===void 0&&(d=new yi(new us(1,1,1),new Gs({name:"BackgroundCubeMaterial",uniforms:Wd(Is.backgroundCube.uniforms),vertexShader:Is.backgroundCube.vertexShader,fragmentShader:Is.backgroundCube.fragmentShader,side:Sr,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(E,A,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=w,d.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,d.material.toneMapped=ln.getTransfer(w.colorSpace)!==gn,(c!==w||h!==w.version||f!==t.toneMapping)&&(d.material.needsUpdate=!0,c=w,h=w.version,f=t.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null)):w&&w.isTexture&&(u===void 0&&(u=new yi(new Uc(2,2),new Gs({name:"BackgroundMaterial",uniforms:Wd(Is.background.uniforms),vertexShader:Is.background.vertexShader,fragmentShader:Is.background.fragmentShader,side:Wa,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=w,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=ln.getTransfer(w.colorSpace)!==gn,w.matrixAutoUpdate===!0&&w.updateMatrix(),u.material.uniforms.uvTransform.value.copy(w.matrix),(c!==w||h!==w.version||f!==t.toneMapping)&&(u.material.needsUpdate=!0,c=w,h=w.version,f=t.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}function x(y,v){y.getRGB(pv,vF(t)),i.buffers.color.setClear(pv.r,pv.g,pv.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(y,v=1){a.set(y),l=v,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,x(a,l)},render:m}}function e$(t,e,n,i){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=y(null);let u=l,d=!1;function c(k,H,K,q,N){let V=!1;if(o){const j=x(q,K,H);u!==j&&(u=j,f(u.object)),V=v(k,q,K,N),V&&_(k,q,K,N)}else{const j=H.wireframe===!0;(u.geometry!==q.id||u.program!==K.id||u.wireframe!==j)&&(u.geometry=q.id,u.program=K.id,u.wireframe=j,V=!0)}N!==null&&n.update(N,t.ELEMENT_ARRAY_BUFFER),(V||d)&&(d=!1,L(k,H,K,q),N!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(N).buffer))}function h(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(k){return i.isWebGL2?t.bindVertexArray(k):s.bindVertexArrayOES(k)}function m(k){return i.isWebGL2?t.deleteVertexArray(k):s.deleteVertexArrayOES(k)}function x(k,H,K){const q=K.wireframe===!0;let N=a[k.id];N===void 0&&(N={},a[k.id]=N);let V=N[H.id];V===void 0&&(V={},N[H.id]=V);let j=V[q];return j===void 0&&(j=y(h()),V[q]=j),j}function y(k){const H=[],K=[],q=[];for(let N=0;N<r;N++)H[N]=0,K[N]=0,q[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:K,attributeDivisors:q,object:k,attributes:{},index:null}}function v(k,H,K,q){const N=u.attributes,V=H.attributes;let j=0;const z=K.getAttributes();for(const $ in z)if(z[$].location>=0){const Q=N[$];let J=V[$];if(J===void 0&&($==="instanceMatrix"&&k.instanceMatrix&&(J=k.instanceMatrix),$==="instanceColor"&&k.instanceColor&&(J=k.instanceColor)),Q===void 0||Q.attribute!==J||J&&Q.data!==J.data)return!0;j++}return u.attributesNum!==j||u.index!==q}function _(k,H,K,q){const N={},V=H.attributes;let j=0;const z=K.getAttributes();for(const $ in z)if(z[$].location>=0){let Q=V[$];Q===void 0&&($==="instanceMatrix"&&k.instanceMatrix&&(Q=k.instanceMatrix),$==="instanceColor"&&k.instanceColor&&(Q=k.instanceColor));const J={};J.attribute=Q,Q&&Q.data&&(J.data=Q.data),N[$]=J,j++}u.attributes=N,u.attributesNum=j,u.index=q}function w(){const k=u.newAttributes;for(let H=0,K=k.length;H<K;H++)k[H]=0}function b(k){E(k,0)}function E(k,H){const K=u.newAttributes,q=u.enabledAttributes,N=u.attributeDivisors;K[k]=1,q[k]===0&&(t.enableVertexAttribArray(k),q[k]=1),N[k]!==H&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,H),N[k]=H)}function A(){const k=u.newAttributes,H=u.enabledAttributes;for(let K=0,q=H.length;K<q;K++)H[K]!==k[K]&&(t.disableVertexAttribArray(K),H[K]=0)}function T(k,H,K,q,N,V,j){j===!0?t.vertexAttribIPointer(k,H,K,N,V):t.vertexAttribPointer(k,H,K,q,N,V)}function L(k,H,K,q){if(i.isWebGL2===!1&&(k.isInstancedMesh||q.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const N=q.attributes,V=K.getAttributes(),j=H.defaultAttributeValues;for(const z in V){const $=V[z];if($.location>=0){let te=N[z];if(te===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(te=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(te=k.instanceColor)),te!==void 0){const Q=te.normalized,J=te.itemSize,ie=n.get(te);if(ie===void 0)continue;const se=ie.buffer,pe=ie.type,le=ie.bytesPerElement,Ae=i.isWebGL2===!0&&(pe===t.INT||pe===t.UNSIGNED_INT||te.gpuType===OE);if(te.isInterleavedBufferAttribute){const ae=te.data,W=ae.stride,me=te.offset;if(ae.isInstancedInterleavedBuffer){for(let ue=0;ue<$.locationSize;ue++)E($.location+ue,ae.meshPerAttribute);k.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let ue=0;ue<$.locationSize;ue++)b($.location+ue);t.bindBuffer(t.ARRAY_BUFFER,se);for(let ue=0;ue<$.locationSize;ue++)T($.location+ue,J/$.locationSize,pe,Q,W*le,(me+J/$.locationSize*ue)*le,Ae)}else{if(te.isInstancedBufferAttribute){for(let ae=0;ae<$.locationSize;ae++)E($.location+ae,te.meshPerAttribute);k.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let ae=0;ae<$.locationSize;ae++)b($.location+ae);t.bindBuffer(t.ARRAY_BUFFER,se);for(let ae=0;ae<$.locationSize;ae++)T($.location+ae,J/$.locationSize,pe,Q,J*le,J/$.locationSize*ae*le,Ae)}}else if(j!==void 0){const Q=j[z];if(Q!==void 0)switch(Q.length){case 2:t.vertexAttrib2fv($.location,Q);break;case 3:t.vertexAttrib3fv($.location,Q);break;case 4:t.vertexAttrib4fv($.location,Q);break;default:t.vertexAttrib1fv($.location,Q)}}}}A()}function P(){U();for(const k in a){const H=a[k];for(const K in H){const q=H[K];for(const N in q)m(q[N].object),delete q[N];delete H[K]}delete a[k]}}function C(k){if(a[k.id]===void 0)return;const H=a[k.id];for(const K in H){const q=H[K];for(const N in q)m(q[N].object),delete q[N];delete H[K]}delete a[k.id]}function D(k){for(const H in a){const K=a[H];if(K[k.id]===void 0)continue;const q=K[k.id];for(const N in q)m(q[N].object),delete q[N];delete K[k.id]}}function U(){G(),d=!0,u!==l&&(u=l,f(u.object))}function G(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:c,reset:U,resetDefaultState:G,dispose:P,releaseStatesOfGeometry:C,releaseStatesOfProgram:D,initAttributes:w,enableAttribute:b,disableUnusedAttributes:A}}function t$(t,e,n,i){const r=i.isWebGL2;let s;function o(u){s=u}function a(u,d){t.drawArrays(s,u,d),n.update(d,s,1)}function l(u,d,c){if(c===0)return;let h,f;if(r)h=t,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[f](s,u,d,c),n.update(d,s,c)}this.setMode=o,this.render=a,this.renderInstances=l}function n$(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=n.precision!==void 0?n.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),d=n.logarithmicDepthBuffer===!0,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),m=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),x=t.getParameter(t.MAX_VERTEX_ATTRIBS),y=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),v=t.getParameter(t.MAX_VARYING_VECTORS),_=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),w=h>0,b=o||e.has("OES_texture_float"),E=w&&b,A=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:c,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:x,maxVertexUniforms:y,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:E,maxSamples:A}}function i$(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Pa,a=new St,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(c,h){const f=c.length!==0||h||i!==0||r;return r=h,i=c.length,f},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(c,h){n=d(c,h,0)},this.setState=function(c,h,f){const m=c.clippingPlanes,x=c.clipIntersection,y=c.clipShadows,v=t.get(c);if(!r||m===null||m.length===0||s&&!y)s?d(null):u();else{const _=s?0:i,w=_*4;let b=v.clippingState||null;l.value=b,b=d(m,h,w,f);for(let E=0;E!==w;++E)b[E]=n[E];v.clippingState=b,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=_}};function u(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(c,h,f,m){const x=c!==null?c.length:0;let y=null;if(x!==0){if(y=l.value,m!==!0||y===null){const v=f+x*4,_=h.matrixWorldInverse;a.getNormalMatrix(_),(y===null||y.length<v)&&(y=new Float32Array(v));for(let w=0,b=f;w!==x;++w,b+=4)o.copy(c[w]).applyMatrix4(_,a),o.normal.toArray(y,b),y[b+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,y}}function r$(t){let e=new WeakMap;function n(o,a){return a===Pm?o.mapping=ia:a===Rm&&(o.mapping=$a),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Pm||a===Rm)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new xF(l.height/2);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",r),n(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class df extends kc{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const ld=4,FR=[.125,.215,.35,.446,.526,.582],Zu=20,sS=new df,BR=new We;let oS=null,aS=0,lS=0;const Gu=(1+Math.sqrt(5))/2,Eh=1/Gu,VR=[new O(1,1,1),new O(-1,1,1),new O(1,1,-1),new O(-1,1,-1),new O(0,Gu,Eh),new O(0,Gu,-Eh),new O(Eh,0,Gu),new O(-Eh,0,Gu),new O(Gu,Eh,0),new O(-Gu,Eh,0)];class u2{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){oS=this._renderer.getRenderTarget(),aS=this._renderer.getActiveCubeFace(),lS=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=HR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=GR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(oS,aS,lS),e.scissorTest=!1,mv(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===ia||e.mapping===$a?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),oS=this._renderer.getRenderTarget(),aS=this._renderer.getActiveCubeFace(),lS=this._renderer.getActiveMipmapLevel();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:In,minFilter:In,generateMipmaps:!1,type:ru,format:vr,colorSpace:yo,depthBuffer:!1},r=jR(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=jR(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=s$(s)),this._blurMaterial=o$(s,e,n)}return r}_compileMaterial(e){const n=new yi(this._lodPlanes[0],e);this._renderer.compile(n,sS)}_sceneToCubeUV(e,n,i,r){const a=new gi(90,1,n,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,c=d.autoClear,h=d.toneMapping;d.getClearColor(BR),d.toneMapping=Qo,d.autoClear=!1;const f=new oa({name:"PMREM.Background",side:Sr,depthWrite:!1,depthTest:!1}),m=new yi(new us,f);let x=!1;const y=e.background;y?y.isColor&&(f.color.copy(y),e.background=null,x=!0):(f.color.copy(BR),x=!0);for(let v=0;v<6;v++){const _=v%3;_===0?(a.up.set(0,l[v],0),a.lookAt(u[v],0,0)):_===1?(a.up.set(0,0,l[v]),a.lookAt(0,u[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,u[v]));const w=this._cubeSize;mv(r,_*w,v>2?w:0,w,w),d.setRenderTarget(r),x&&d.render(m,a),d.render(e,a)}m.geometry.dispose(),m.material.dispose(),d.toneMapping=h,d.autoClear=c,e.background=y}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===ia||e.mapping===$a;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=HR()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=GR());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new yi(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;mv(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,sS)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=VR[(r-1)%VR.length];this._blur(e,r-1,r,s,o)}n.autoClear=i}_blur(e,n,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,c=new yi(this._lodPlanes[r],u),h=u.uniforms,f=this._sizeLods[i]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Zu-1),x=s/m,y=isFinite(s)?1+Math.floor(d*x):Zu;y>Zu&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Zu}`);const v=[];let _=0;for(let T=0;T<Zu;++T){const L=T/x,P=Math.exp(-L*L/2);v.push(P),T===0?_+=P:T<y&&(_+=2*P)}for(let T=0;T<v.length;T++)v[T]=v[T]/_;h.envMap.value=e.texture,h.samples.value=y,h.weights.value=v,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:w}=this;h.dTheta.value=m,h.mipInt.value=w-i;const b=this._sizeLods[r],E=3*b*(r>w-ld?r-w+ld:0),A=4*(this._cubeSize-b);mv(n,E,A,3*b,2*b),l.setRenderTarget(n),l.render(c,sS)}}function s$(t){const e=[],n=[],i=[];let r=t;const s=t-ld+1+FR.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);n.push(a);let l=1/a;o>t-ld?l=FR[o-t+ld-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),d=-u,c=1+u,h=[d,d,c,d,c,c,d,d,c,c,d,c],f=6,m=6,x=3,y=2,v=1,_=new Float32Array(x*m*f),w=new Float32Array(y*m*f),b=new Float32Array(v*m*f);for(let A=0;A<f;A++){const T=A%3*2/3-1,L=A>2?0:-1,P=[T,L,0,T+2/3,L,0,T+2/3,L+1,0,T,L,0,T+2/3,L+1,0,T,L+1,0];_.set(P,x*m*A),w.set(h,y*m*A);const C=[A,A,A,A,A,A];b.set(C,v*m*A)}const E=new Ke;E.setAttribute("position",new ht(_,x)),E.setAttribute("uv",new ht(w,y)),E.setAttribute("faceIndex",new ht(b,v)),e.push(E),r>ld&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function jR(t,e,n){const i=new js(t,e,n);return i.texture.mapping=Oc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function mv(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function o$(t,e,n){const i=new Float32Array(Zu),r=new O(0,1,0);return new Gs({name:"SphericalGaussianBlur",defines:{n:Zu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:HE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ua,depthTest:!1,depthWrite:!1})}function GR(){return new Gs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:HE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ua,depthTest:!1,depthWrite:!1})}function HR(){return new Gs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:HE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ua,depthTest:!1,depthWrite:!1})}function HE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function a$(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===Pm||l===Rm,d=l===ia||l===$a;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let c=e.get(a);return n===null&&(n=new u2(t)),c=u?n.fromEquirectangular(a,c):n.fromCubemap(a,c),e.set(a,c),c.texture}else{if(e.has(a))return e.get(a).texture;{const c=a.image;if(u&&c&&c.height>0||d&&c&&r(c)){n===null&&(n=new u2(t));const h=u?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function l$(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function u$(t,e,n,i){const r={},s=new WeakMap;function o(c){const h=c.target;h.index!==null&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);for(const m in h.morphAttributes){const x=h.morphAttributes[m];for(let y=0,v=x.length;y<v;y++)e.remove(x[y])}h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function a(c,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,n.memory.geometries++),h}function l(c){const h=c.attributes;for(const m in h)e.update(h[m],t.ARRAY_BUFFER);const f=c.morphAttributes;for(const m in f){const x=f[m];for(let y=0,v=x.length;y<v;y++)e.update(x[y],t.ARRAY_BUFFER)}}function u(c){const h=[],f=c.index,m=c.attributes.position;let x=0;if(f!==null){const _=f.array;x=f.version;for(let w=0,b=_.length;w<b;w+=3){const E=_[w+0],A=_[w+1],T=_[w+2];h.push(E,A,A,T,T,E)}}else if(m!==void 0){const _=m.array;x=m.version;for(let w=0,b=_.length/3-1;w<b;w+=3){const E=w+0,A=w+1,T=w+2;h.push(E,A,A,T,T,E)}}else return;const y=new(dF(h)?pc:GE)(h,1);y.version=x;const v=s.get(c);v&&e.remove(v),s.set(c,y)}function d(c){const h=s.get(c);if(h){const f=c.index;f!==null&&h.version<f.version&&u(c)}else u(c);return s.get(c)}return{get:a,update:l,getWireframeAttribute:d}}function c$(t,e,n,i){const r=i.isWebGL2;let s;function o(h){s=h}let a,l;function u(h){a=h.type,l=h.bytesPerElement}function d(h,f){t.drawElements(s,f,a,h*l),n.update(f,s,1)}function c(h,f,m){if(m===0)return;let x,y;if(r)x=t,y="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[y](s,f,a,h*l,m),n.update(f,s,m)}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=c}function h$(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function d$(t,e){return t[0]-e[0]}function f$(t,e){return Math.abs(e[1])-Math.abs(t[1])}function p$(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ct,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,d,c){const h=u.morphTargetInfluences;if(e.isWebGL2===!0){const f=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,m=f!==void 0?f.length:0;let x=s.get(d);if(x===void 0||x.count!==m){let k=function(){U.dispose(),s.delete(d),d.removeEventListener("dispose",k)};x!==void 0&&x.texture.dispose();const _=d.morphAttributes.position!==void 0,w=d.morphAttributes.normal!==void 0,b=d.morphAttributes.color!==void 0,E=d.morphAttributes.position||[],A=d.morphAttributes.normal||[],T=d.morphAttributes.color||[];let L=0;_===!0&&(L=1),w===!0&&(L=2),b===!0&&(L=3);let P=d.attributes.position.count*L,C=1;P>e.maxTextureSize&&(C=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const D=new Float32Array(P*C*4*m),U=new Sx(D,P,C,m);U.type=rs,U.needsUpdate=!0;const G=L*4;for(let H=0;H<m;H++){const K=E[H],q=A[H],N=T[H],V=P*C*4*H;for(let j=0;j<K.count;j++){const z=j*G;_===!0&&(o.fromBufferAttribute(K,j),D[V+z+0]=o.x,D[V+z+1]=o.y,D[V+z+2]=o.z,D[V+z+3]=0),w===!0&&(o.fromBufferAttribute(q,j),D[V+z+4]=o.x,D[V+z+5]=o.y,D[V+z+6]=o.z,D[V+z+7]=0),b===!0&&(o.fromBufferAttribute(N,j),D[V+z+8]=o.x,D[V+z+9]=o.y,D[V+z+10]=o.z,D[V+z+11]=N.itemSize===4?o.w:1)}}x={count:m,texture:U,size:new ee(P,C)},s.set(d,x),d.addEventListener("dispose",k)}let y=0;for(let _=0;_<h.length;_++)y+=h[_];const v=d.morphTargetsRelative?1:1-y;c.getUniforms().setValue(t,"morphTargetBaseInfluence",v),c.getUniforms().setValue(t,"morphTargetInfluences",h),c.getUniforms().setValue(t,"morphTargetsTexture",x.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",x.size)}else{const f=h===void 0?0:h.length;let m=i[d.id];if(m===void 0||m.length!==f){m=[];for(let w=0;w<f;w++)m[w]=[w,0];i[d.id]=m}for(let w=0;w<f;w++){const b=m[w];b[0]=w,b[1]=h[w]}m.sort(f$);for(let w=0;w<8;w++)w<f&&m[w][1]?(a[w][0]=m[w][0],a[w][1]=m[w][1]):(a[w][0]=Number.MAX_SAFE_INTEGER,a[w][1]=0);a.sort(d$);const x=d.morphAttributes.position,y=d.morphAttributes.normal;let v=0;for(let w=0;w<8;w++){const b=a[w],E=b[0],A=b[1];E!==Number.MAX_SAFE_INTEGER&&A?(x&&d.getAttribute("morphTarget"+w)!==x[E]&&d.setAttribute("morphTarget"+w,x[E]),y&&d.getAttribute("morphNormal"+w)!==y[E]&&d.setAttribute("morphNormal"+w,y[E]),r[w]=A,v+=A):(x&&d.hasAttribute("morphTarget"+w)===!0&&d.deleteAttribute("morphTarget"+w),y&&d.hasAttribute("morphNormal"+w)===!0&&d.deleteAttribute("morphNormal"+w),r[w]=0)}const _=d.morphTargetsRelative?1:1-v;c.getUniforms().setValue(t,"morphTargetBaseInfluence",_),c.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function m$(t,e,n,i){let r=new WeakMap;function s(l){const u=i.render.frame,d=l.geometry,c=e.get(l,d);if(r.get(c)!==u&&(e.update(c),r.set(c,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==u&&(h.update(),r.set(h,u))}return c}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:s,dispose:o}}const wF=new Tn,SF=new Sx,bF=new jE,MF=new hf,WR=[],$R=[],qR=new Float32Array(16),XR=new Float32Array(9),YR=new Float32Array(4);function ff(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=WR[r];if(s===void 0&&(s=new Float32Array(r),WR[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function wi(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Si(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Mx(t,e){let n=$R[e];n===void 0&&(n=new Int32Array(e),$R[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function g$(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function v$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(wi(n,e))return;t.uniform2fv(this.addr,e),Si(n,e)}}function y$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(wi(n,e))return;t.uniform3fv(this.addr,e),Si(n,e)}}function x$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(wi(n,e))return;t.uniform4fv(this.addr,e),Si(n,e)}}function _$(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(wi(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Si(n,e)}else{if(wi(n,i))return;YR.set(i),t.uniformMatrix2fv(this.addr,!1,YR),Si(n,i)}}function w$(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(wi(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Si(n,e)}else{if(wi(n,i))return;XR.set(i),t.uniformMatrix3fv(this.addr,!1,XR),Si(n,i)}}function S$(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(wi(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Si(n,e)}else{if(wi(n,i))return;qR.set(i),t.uniformMatrix4fv(this.addr,!1,qR),Si(n,i)}}function b$(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function M$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(wi(n,e))return;t.uniform2iv(this.addr,e),Si(n,e)}}function A$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(wi(n,e))return;t.uniform3iv(this.addr,e),Si(n,e)}}function E$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(wi(n,e))return;t.uniform4iv(this.addr,e),Si(n,e)}}function T$(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function C$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(wi(n,e))return;t.uniform2uiv(this.addr,e),Si(n,e)}}function P$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(wi(n,e))return;t.uniform3uiv(this.addr,e),Si(n,e)}}function R$(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(wi(n,e))return;t.uniform4uiv(this.addr,e),Si(n,e)}}function L$(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||wF,r)}function D$(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||bF,r)}function I$(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||MF,r)}function O$(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||SF,r)}function N$(t){switch(t){case 5126:return g$;case 35664:return v$;case 35665:return y$;case 35666:return x$;case 35674:return _$;case 35675:return w$;case 35676:return S$;case 5124:case 35670:return b$;case 35667:case 35671:return M$;case 35668:case 35672:return A$;case 35669:case 35673:return E$;case 5125:return T$;case 36294:return C$;case 36295:return P$;case 36296:return R$;case 35678:case 36198:case 36298:case 36306:case 35682:return L$;case 35679:case 36299:case 36307:return D$;case 35680:case 36300:case 36308:case 36293:return I$;case 36289:case 36303:case 36311:case 36292:return O$}}function k$(t,e){t.uniform1fv(this.addr,e)}function U$(t,e){const n=ff(e,this.size,2);t.uniform2fv(this.addr,n)}function z$(t,e){const n=ff(e,this.size,3);t.uniform3fv(this.addr,n)}function F$(t,e){const n=ff(e,this.size,4);t.uniform4fv(this.addr,n)}function B$(t,e){const n=ff(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function V$(t,e){const n=ff(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function j$(t,e){const n=ff(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function G$(t,e){t.uniform1iv(this.addr,e)}function H$(t,e){t.uniform2iv(this.addr,e)}function W$(t,e){t.uniform3iv(this.addr,e)}function $$(t,e){t.uniform4iv(this.addr,e)}function q$(t,e){t.uniform1uiv(this.addr,e)}function X$(t,e){t.uniform2uiv(this.addr,e)}function Y$(t,e){t.uniform3uiv(this.addr,e)}function Z$(t,e){t.uniform4uiv(this.addr,e)}function K$(t,e,n){const i=this.cache,r=e.length,s=Mx(n,r);wi(i,s)||(t.uniform1iv(this.addr,s),Si(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||wF,s[o])}function Q$(t,e,n){const i=this.cache,r=e.length,s=Mx(n,r);wi(i,s)||(t.uniform1iv(this.addr,s),Si(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||bF,s[o])}function J$(t,e,n){const i=this.cache,r=e.length,s=Mx(n,r);wi(i,s)||(t.uniform1iv(this.addr,s),Si(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||MF,s[o])}function eq(t,e,n){const i=this.cache,r=e.length,s=Mx(n,r);wi(i,s)||(t.uniform1iv(this.addr,s),Si(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||SF,s[o])}function tq(t){switch(t){case 5126:return k$;case 35664:return U$;case 35665:return z$;case 35666:return F$;case 35674:return B$;case 35675:return V$;case 35676:return j$;case 5124:case 35670:return G$;case 35667:case 35671:return H$;case 35668:case 35672:return W$;case 35669:case 35673:return $$;case 5125:return q$;case 36294:return X$;case 36295:return Y$;case 36296:return Z$;case 35678:case 36198:case 36298:case 36306:case 35682:return K$;case 35679:case 36299:case 36307:return Q$;case 35680:case 36300:case 36308:case 36293:return J$;case 36289:case 36303:case 36311:case 36292:return eq}}class nq{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.setValue=N$(n.type)}}class iq{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.size=n.size,this.setValue=tq(n.type)}}class rq{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,n[a.id],i)}}}const uS=/(\w+)(\])?(\[|\.)?/g;function ZR(t,e){t.seq.push(e),t.map[e.id]=e}function sq(t,e,n){const i=t.name,r=i.length;for(uS.lastIndex=0;;){const s=uS.exec(i),o=uS.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){ZR(n,u===void 0?new nq(a,t,e):new iq(a,t,e));break}else{let c=n.map[a];c===void 0&&(c=new rq(a),ZR(n,c)),n=c}}}class Iy{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);sq(s,o,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in n&&i.push(o)}return i}}function KR(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const oq=37297;let aq=0;function lq(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function uq(t){const e=ln.getPrimaries(ln.workingColorSpace),n=ln.getPrimaries(t);let i;switch(e===n?i="":e===zm&&n===Um?i="LinearDisplayP3ToLinearSRGB":e===Um&&n===zm&&(i="LinearSRGBToLinearDisplayP3"),t){case yo:case mg:return[i,"LinearTransferOETF"];case ni:case wx:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[i,"LinearTransferOETF"]}}function QR(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+lq(t.getShaderSource(e),o)}else return r}function cq(t,e){const n=uq(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function hq(t,e){let n;switch(e){case Uz:n="Linear";break;case zz:n="Reinhard";break;case Fz:n="OptimizedCineon";break;case DE:n="ACESFilmic";break;case Bz:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function dq(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Dp).join(`
`)}function fq(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function pq(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Dp(t){return t!==""}function JR(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function eL(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const mq=/^[ \t]*#include +<([\w\d./]+)>/gm;function c2(t){return t.replace(mq,vq)}const gq=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function vq(t,e){let n=Tt[e];if(n===void 0){const i=gq.get(e);if(i!==void 0)n=Tt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return c2(n)}const yq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function tL(t){return t.replace(yq,xq)}function xq(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function nL(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function _q(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===gx?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Xp?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===no&&(e="SHADOWMAP_TYPE_VSM"),e}function wq(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ia:case $a:e="ENVMAP_TYPE_CUBE";break;case Oc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Sq(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case $a:e="ENVMAP_MODE_REFRACTION";break}return e}function bq(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case pg:e="ENVMAP_BLENDING_MULTIPLY";break;case Nz:e="ENVMAP_BLENDING_MIX";break;case kz:e="ENVMAP_BLENDING_ADD";break}return e}function Mq(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function Aq(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=_q(n),u=wq(n),d=Sq(n),c=bq(n),h=Mq(n),f=n.isWebGL2?"":dq(n),m=fq(s),x=r.createProgram();let y,v,_=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(Dp).join(`
`),y.length>0&&(y+=`
`),v=[f,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(Dp).join(`
`),v.length>0&&(v+=`
`)):(y=[nL(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Dp).join(`
`),v=[f,nL(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.envMap?"#define "+c:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Qo?"#define TONE_MAPPING":"",n.toneMapping!==Qo?Tt.tonemapping_pars_fragment:"",n.toneMapping!==Qo?hq("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Tt.colorspace_pars_fragment,cq("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Dp).join(`
`)),o=c2(o),o=JR(o,n),o=eL(o,n),a=c2(a),a=JR(a,n),a=eL(a,n),o=tL(o),a=tL(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===a2?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===a2?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const w=_+y+o,b=_+v+a,E=KR(r,r.VERTEX_SHADER,w),A=KR(r,r.FRAGMENT_SHADER,b);r.attachShader(x,E),r.attachShader(x,A),n.index0AttributeName!==void 0?r.bindAttribLocation(x,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function T(D){if(t.debug.checkShaderErrors){const U=r.getProgramInfoLog(x).trim(),G=r.getShaderInfoLog(E).trim(),k=r.getShaderInfoLog(A).trim();let H=!0,K=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(H=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,x,E,A);else{const q=QR(r,E,"vertex"),N=QR(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Program Info Log: `+U+`
`+q+`
`+N)}else U!==""?console.warn("THREE.WebGLProgram: Program Info Log:",U):(G===""||k==="")&&(K=!1);K&&(D.diagnostics={runnable:H,programLog:U,vertexShader:{log:G,prefix:y},fragmentShader:{log:k,prefix:v}})}r.deleteShader(E),r.deleteShader(A),L=new Iy(r,x),P=pq(r,x)}let L;this.getUniforms=function(){return L===void 0&&T(this),L};let P;this.getAttributes=function(){return P===void 0&&T(this),P};let C=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return C===!1&&(C=r.getProgramParameter(x,oq)),C},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=aq++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=E,this.fragmentShader=A,this}let Eq=0;class Tq{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new Cq(e),n.set(e,i)),i}}class Cq{constructor(e){this.id=Eq++,this.code=e,this.usedTimes=0}}function Pq(t,e,n,i,r,s,o){const a=new fc,l=new Tq,u=[],d=r.isWebGL2,c=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(P){return P===0?"uv":`uv${P}`}function y(P,C,D,U,G){const k=U.fog,H=G.geometry,K=P.isMeshStandardMaterial?U.environment:null,q=(P.isMeshStandardMaterial?n:e).get(P.envMap||K),N=q&&q.mapping===Oc?q.image.height:null,V=m[P.type];P.precision!==null&&(f=r.getMaxPrecision(P.precision),f!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",f,"instead."));const j=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,z=j!==void 0?j.length:0;let $=0;H.morphAttributes.position!==void 0&&($=1),H.morphAttributes.normal!==void 0&&($=2),H.morphAttributes.color!==void 0&&($=3);let te,Q,J,ie;if(V){const Cn=Is[V];te=Cn.vertexShader,Q=Cn.fragmentShader}else te=P.vertexShader,Q=P.fragmentShader,l.update(P),J=l.getVertexShaderID(P),ie=l.getFragmentShaderID(P);const se=t.getRenderTarget(),pe=G.isInstancedMesh===!0,le=!!P.map,Ae=!!P.matcap,ae=!!q,W=!!P.aoMap,me=!!P.lightMap,ue=!!P.bumpMap,ce=!!P.normalMap,ge=!!P.displacementMap,De=!!P.emissiveMap,Me=!!P.metalnessMap,Ce=!!P.roughnessMap,ke=P.anisotropy>0,He=P.clearcoat>0,bt=P.iridescence>0,Y=P.sheen>0,B=P.transmission>0,he=ke&&!!P.anisotropyMap,Re=He&&!!P.clearcoatMap,Le=He&&!!P.clearcoatNormalMap,Ie=He&&!!P.clearcoatRoughnessMap,rt=bt&&!!P.iridescenceMap,Oe=bt&&!!P.iridescenceThicknessMap,Ge=Y&&!!P.sheenColorMap,ot=Y&&!!P.sheenRoughnessMap,Wt=!!P.specularMap,Fe=!!P.specularColorMap,Qt=!!P.specularIntensityMap,Mt=B&&!!P.transmissionMap,gt=B&&!!P.thicknessMap,ft=!!P.gradientMap,Xe=!!P.alphaMap,Ft=P.alphaTest>0,ne=!!P.alphaHash,Ye=!!P.extensions,je=!!H.attributes.uv1,Te=!!H.attributes.uv2,$e=!!H.attributes.uv3;let vt=Qo;return P.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(vt=t.toneMapping),{isWebGL2:d,shaderID:V,shaderType:P.type,shaderName:P.name,vertexShader:te,fragmentShader:Q,defines:P.defines,customVertexShaderID:J,customFragmentShaderID:ie,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:f,instancing:pe,instancingColor:pe&&G.instanceColor!==null,supportsVertexTextures:h,outputColorSpace:se===null?t.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:yo,map:le,matcap:Ae,envMap:ae,envMapMode:ae&&q.mapping,envMapCubeUVHeight:N,aoMap:W,lightMap:me,bumpMap:ue,normalMap:ce,displacementMap:h&&ge,emissiveMap:De,normalMapObjectSpace:ce&&P.normalMapType===tF,normalMapTangentSpace:ce&&P.normalMapType===fu,metalnessMap:Me,roughnessMap:Ce,anisotropy:ke,anisotropyMap:he,clearcoat:He,clearcoatMap:Re,clearcoatNormalMap:Le,clearcoatRoughnessMap:Ie,iridescence:bt,iridescenceMap:rt,iridescenceThicknessMap:Oe,sheen:Y,sheenColorMap:Ge,sheenRoughnessMap:ot,specularMap:Wt,specularColorMap:Fe,specularIntensityMap:Qt,transmission:B,transmissionMap:Mt,thicknessMap:gt,gradientMap:ft,opaque:P.transparent===!1&&P.blending===Xl,alphaMap:Xe,alphaTest:Ft,alphaHash:ne,combine:P.combine,mapUv:le&&x(P.map.channel),aoMapUv:W&&x(P.aoMap.channel),lightMapUv:me&&x(P.lightMap.channel),bumpMapUv:ue&&x(P.bumpMap.channel),normalMapUv:ce&&x(P.normalMap.channel),displacementMapUv:ge&&x(P.displacementMap.channel),emissiveMapUv:De&&x(P.emissiveMap.channel),metalnessMapUv:Me&&x(P.metalnessMap.channel),roughnessMapUv:Ce&&x(P.roughnessMap.channel),anisotropyMapUv:he&&x(P.anisotropyMap.channel),clearcoatMapUv:Re&&x(P.clearcoatMap.channel),clearcoatNormalMapUv:Le&&x(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ie&&x(P.clearcoatRoughnessMap.channel),iridescenceMapUv:rt&&x(P.iridescenceMap.channel),iridescenceThicknessMapUv:Oe&&x(P.iridescenceThicknessMap.channel),sheenColorMapUv:Ge&&x(P.sheenColorMap.channel),sheenRoughnessMapUv:ot&&x(P.sheenRoughnessMap.channel),specularMapUv:Wt&&x(P.specularMap.channel),specularColorMapUv:Fe&&x(P.specularColorMap.channel),specularIntensityMapUv:Qt&&x(P.specularIntensityMap.channel),transmissionMapUv:Mt&&x(P.transmissionMap.channel),thicknessMapUv:gt&&x(P.thicknessMap.channel),alphaMapUv:Xe&&x(P.alphaMap.channel),vertexTangents:!!H.attributes.tangent&&(ce||ke),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,vertexUv1s:je,vertexUv2s:Te,vertexUv3s:$e,pointsUvs:G.isPoints===!0&&!!H.attributes.uv&&(le||Xe),fog:!!k,useFog:P.fog===!0,fogExp2:k&&k.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:c,skinning:G.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:z,morphTextureStride:$,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numLightProbes:C.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:P.dithering,shadowMapEnabled:t.shadowMap.enabled&&D.length>0,shadowMapType:t.shadowMap.type,toneMapping:vt,useLegacyLights:t._useLegacyLights,decodeVideoTexture:le&&P.map.isVideoTexture===!0&&ln.getTransfer(P.map.colorSpace)===gn,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===so,flipSided:P.side===Sr,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionDerivatives:Ye&&P.extensions.derivatives===!0,extensionFragDepth:Ye&&P.extensions.fragDepth===!0,extensionDrawBuffers:Ye&&P.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ye&&P.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()}}function v(P){const C=[];if(P.shaderID?C.push(P.shaderID):(C.push(P.customVertexShaderID),C.push(P.customFragmentShaderID)),P.defines!==void 0)for(const D in P.defines)C.push(D),C.push(P.defines[D]);return P.isRawShaderMaterial===!1&&(_(C,P),w(C,P),C.push(t.outputColorSpace)),C.push(P.customProgramCacheKey),C.join()}function _(P,C){P.push(C.precision),P.push(C.outputColorSpace),P.push(C.envMapMode),P.push(C.envMapCubeUVHeight),P.push(C.mapUv),P.push(C.alphaMapUv),P.push(C.lightMapUv),P.push(C.aoMapUv),P.push(C.bumpMapUv),P.push(C.normalMapUv),P.push(C.displacementMapUv),P.push(C.emissiveMapUv),P.push(C.metalnessMapUv),P.push(C.roughnessMapUv),P.push(C.anisotropyMapUv),P.push(C.clearcoatMapUv),P.push(C.clearcoatNormalMapUv),P.push(C.clearcoatRoughnessMapUv),P.push(C.iridescenceMapUv),P.push(C.iridescenceThicknessMapUv),P.push(C.sheenColorMapUv),P.push(C.sheenRoughnessMapUv),P.push(C.specularMapUv),P.push(C.specularColorMapUv),P.push(C.specularIntensityMapUv),P.push(C.transmissionMapUv),P.push(C.thicknessMapUv),P.push(C.combine),P.push(C.fogExp2),P.push(C.sizeAttenuation),P.push(C.morphTargetsCount),P.push(C.morphAttributeCount),P.push(C.numDirLights),P.push(C.numPointLights),P.push(C.numSpotLights),P.push(C.numSpotLightMaps),P.push(C.numHemiLights),P.push(C.numRectAreaLights),P.push(C.numDirLightShadows),P.push(C.numPointLightShadows),P.push(C.numSpotLightShadows),P.push(C.numSpotLightShadowsWithMaps),P.push(C.numLightProbes),P.push(C.shadowMapType),P.push(C.toneMapping),P.push(C.numClippingPlanes),P.push(C.numClipIntersection),P.push(C.depthPacking)}function w(P,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.matcap&&a.enable(4),C.envMap&&a.enable(5),C.normalMapObjectSpace&&a.enable(6),C.normalMapTangentSpace&&a.enable(7),C.clearcoat&&a.enable(8),C.iridescence&&a.enable(9),C.alphaTest&&a.enable(10),C.vertexColors&&a.enable(11),C.vertexAlphas&&a.enable(12),C.vertexUv1s&&a.enable(13),C.vertexUv2s&&a.enable(14),C.vertexUv3s&&a.enable(15),C.vertexTangents&&a.enable(16),C.anisotropy&&a.enable(17),C.alphaHash&&a.enable(18),P.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.useLegacyLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.transmission&&a.enable(15),C.sheen&&a.enable(16),C.opaque&&a.enable(17),C.pointsUvs&&a.enable(18),C.decodeVideoTexture&&a.enable(19),P.push(a.mask)}function b(P){const C=m[P.type];let D;if(C){const U=Is[C];D=Nc.clone(U.uniforms)}else D=P.uniforms;return D}function E(P,C){let D;for(let U=0,G=u.length;U<G;U++){const k=u[U];if(k.cacheKey===C){D=k,++D.usedTimes;break}}return D===void 0&&(D=new Aq(t,C,P,s),u.push(D)),D}function A(P){if(--P.usedTimes===0){const C=u.indexOf(P);u[C]=u[u.length-1],u.pop(),P.destroy()}}function T(P){l.remove(P)}function L(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:b,acquireProgram:E,releaseProgram:A,releaseShaderCache:T,programs:u,dispose:L}}function Rq(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function Lq(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function iL(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function rL(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(c,h,f,m,x,y){let v=t[e];return v===void 0?(v={id:c.id,object:c,geometry:h,material:f,groupOrder:m,renderOrder:c.renderOrder,z:x,group:y},t[e]=v):(v.id=c.id,v.object=c,v.geometry=h,v.material=f,v.groupOrder=m,v.renderOrder=c.renderOrder,v.z=x,v.group=y),e++,v}function a(c,h,f,m,x,y){const v=o(c,h,f,m,x,y);f.transmission>0?i.push(v):f.transparent===!0?r.push(v):n.push(v)}function l(c,h,f,m,x,y){const v=o(c,h,f,m,x,y);f.transmission>0?i.unshift(v):f.transparent===!0?r.unshift(v):n.unshift(v)}function u(c,h){n.length>1&&n.sort(c||Lq),i.length>1&&i.sort(h||iL),r.length>1&&r.sort(h||iL)}function d(){for(let c=e,h=t.length;c<h;c++){const f=t[c];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:d,sort:u}}function Dq(){let t=new WeakMap;function e(i,r){const s=t.get(i);let o;return s===void 0?(o=new rL,t.set(i,[o])):r>=s.length?(o=new rL,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Iq(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new O,color:new We};break;case"SpotLight":n={position:new O,direction:new O,color:new We,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new O,color:new We,distance:0,decay:0};break;case"HemisphereLight":n={direction:new O,skyColor:new We,groundColor:new We};break;case"RectAreaLight":n={color:new We,position:new O,halfWidth:new O,halfHeight:new O};break}return t[e.id]=n,n}}}function Oq(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Nq=0;function kq(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Uq(t,e){const n=new Iq,i=Oq(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new O);const s=new O,o=new Ue,a=new Ue;function l(d,c){let h=0,f=0,m=0;for(let U=0;U<9;U++)r.probe[U].set(0,0,0);let x=0,y=0,v=0,_=0,w=0,b=0,E=0,A=0,T=0,L=0,P=0;d.sort(kq);const C=c===!0?Math.PI:1;for(let U=0,G=d.length;U<G;U++){const k=d[U],H=k.color,K=k.intensity,q=k.distance,N=k.shadow&&k.shadow.map?k.shadow.map.texture:null;if(k.isAmbientLight)h+=H.r*K*C,f+=H.g*K*C,m+=H.b*K*C;else if(k.isLightProbe){for(let V=0;V<9;V++)r.probe[V].addScaledVector(k.sh.coefficients[V],K);P++}else if(k.isDirectionalLight){const V=n.get(k);if(V.color.copy(k.color).multiplyScalar(k.intensity*C),k.castShadow){const j=k.shadow,z=i.get(k);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.directionalShadow[x]=z,r.directionalShadowMap[x]=N,r.directionalShadowMatrix[x]=k.shadow.matrix,b++}r.directional[x]=V,x++}else if(k.isSpotLight){const V=n.get(k);V.position.setFromMatrixPosition(k.matrixWorld),V.color.copy(H).multiplyScalar(K*C),V.distance=q,V.coneCos=Math.cos(k.angle),V.penumbraCos=Math.cos(k.angle*(1-k.penumbra)),V.decay=k.decay,r.spot[v]=V;const j=k.shadow;if(k.map&&(r.spotLightMap[T]=k.map,T++,j.updateMatrices(k),k.castShadow&&L++),r.spotLightMatrix[v]=j.matrix,k.castShadow){const z=i.get(k);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.spotShadow[v]=z,r.spotShadowMap[v]=N,A++}v++}else if(k.isRectAreaLight){const V=n.get(k);V.color.copy(H).multiplyScalar(K),V.halfWidth.set(k.width*.5,0,0),V.halfHeight.set(0,k.height*.5,0),r.rectArea[_]=V,_++}else if(k.isPointLight){const V=n.get(k);if(V.color.copy(k.color).multiplyScalar(k.intensity*C),V.distance=k.distance,V.decay=k.decay,k.castShadow){const j=k.shadow,z=i.get(k);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,z.shadowCameraNear=j.camera.near,z.shadowCameraFar=j.camera.far,r.pointShadow[y]=z,r.pointShadowMap[y]=N,r.pointShadowMatrix[y]=k.shadow.matrix,E++}r.point[y]=V,y++}else if(k.isHemisphereLight){const V=n.get(k);V.skyColor.copy(k.color).multiplyScalar(K*C),V.groundColor.copy(k.groundColor).multiplyScalar(K*C),r.hemi[w]=V,w++}}_>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Ve.LTC_FLOAT_1,r.rectAreaLTC2=Ve.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Ve.LTC_HALF_1,r.rectAreaLTC2=Ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const D=r.hash;(D.directionalLength!==x||D.pointLength!==y||D.spotLength!==v||D.rectAreaLength!==_||D.hemiLength!==w||D.numDirectionalShadows!==b||D.numPointShadows!==E||D.numSpotShadows!==A||D.numSpotMaps!==T||D.numLightProbes!==P)&&(r.directional.length=x,r.spot.length=v,r.rectArea.length=_,r.point.length=y,r.hemi.length=w,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=E,r.spotLightMatrix.length=A+T-L,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=L,r.numLightProbes=P,D.directionalLength=x,D.pointLength=y,D.spotLength=v,D.rectAreaLength=_,D.hemiLength=w,D.numDirectionalShadows=b,D.numPointShadows=E,D.numSpotShadows=A,D.numSpotMaps=T,D.numLightProbes=P,r.version=Nq++)}function u(d,c){let h=0,f=0,m=0,x=0,y=0;const v=c.matrixWorldInverse;for(let _=0,w=d.length;_<w;_++){const b=d[_];if(b.isDirectionalLight){const E=r.directional[h];E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),h++}else if(b.isSpotLight){const E=r.spot[m];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),m++}else if(b.isRectAreaLight){const E=r.rectArea[x];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),E.halfWidth.set(b.width*.5,0,0),E.halfHeight.set(0,b.height*.5,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),x++}else if(b.isPointLight){const E=r.point[f];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){const E=r.hemi[y];E.direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(v),y++}}}return{setup:l,setupView:u,state:r}}function sL(t,e){const n=new Uq(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(c){i.push(c)}function a(c){r.push(c)}function l(c){n.setup(i,c)}function u(c){n.setupView(i,c)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function zq(t,e){let n=new WeakMap;function i(s,o=0){const a=n.get(s);let l;return a===void 0?(l=new sL(t,e),n.set(s,[l])):o>=a.length?(l=new sL(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}class WE extends Wi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Jz,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class $E extends Wi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Fq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Bq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Vq(t,e,n){let i=new bx;const r=new ee,s=new ee,o=new Ct,a=new WE({depthPacking:eF}),l=new $E,u={},d=n.maxTextureSize,c={[Wa]:Sr,[Sr]:Wa,[so]:so},h=new Gs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ee},radius:{value:4}},vertexShader:Fq,fragmentShader:Bq}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new Ke;m.setAttribute("position",new ht(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new yi(m,h),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=gx;let v=this.type;this.render=function(E,A,T){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||E.length===0)return;const L=t.getRenderTarget(),P=t.getActiveCubeFace(),C=t.getActiveMipmapLevel(),D=t.state;D.setBlending(Ua),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);const U=v!==no&&this.type===no,G=v===no&&this.type!==no;for(let k=0,H=E.length;k<H;k++){const K=E[k],q=K.shadow;if(q===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(q.autoUpdate===!1&&q.needsUpdate===!1)continue;r.copy(q.mapSize);const N=q.getFrameExtents();if(r.multiply(N),s.copy(q.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/N.x),r.x=s.x*N.x,q.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/N.y),r.y=s.y*N.y,q.mapSize.y=s.y)),q.map===null||U===!0||G===!0){const j=this.type!==no?{minFilter:ti,magFilter:ti}:{};q.map!==null&&q.map.dispose(),q.map=new js(r.x,r.y,j),q.map.texture.name=K.name+".shadowMap",q.camera.updateProjectionMatrix()}t.setRenderTarget(q.map),t.clear();const V=q.getViewportCount();for(let j=0;j<V;j++){const z=q.getViewport(j);o.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),D.viewport(o),q.updateMatrices(K,j),i=q.getFrustum(),b(A,T,q.camera,K,this.type)}q.isPointLightShadow!==!0&&this.type===no&&_(q,T),q.needsUpdate=!1}v=this.type,y.needsUpdate=!1,t.setRenderTarget(L,P,C)};function _(E,A){const T=e.update(x);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new js(r.x,r.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,t.setRenderTarget(E.mapPass),t.clear(),t.renderBufferDirect(A,null,T,h,x,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,t.setRenderTarget(E.map),t.clear(),t.renderBufferDirect(A,null,T,f,x,null)}function w(E,A,T,L){let P=null;const C=T.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(C!==void 0)P=C;else if(P=T.isPointLight===!0?l:a,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const D=P.uuid,U=A.uuid;let G=u[D];G===void 0&&(G={},u[D]=G);let k=G[U];k===void 0&&(k=P.clone(),G[U]=k),P=k}if(P.visible=A.visible,P.wireframe=A.wireframe,L===no?P.side=A.shadowSide!==null?A.shadowSide:A.side:P.side=A.shadowSide!==null?A.shadowSide:c[A.side],P.alphaMap=A.alphaMap,P.alphaTest=A.alphaTest,P.map=A.map,P.clipShadows=A.clipShadows,P.clippingPlanes=A.clippingPlanes,P.clipIntersection=A.clipIntersection,P.displacementMap=A.displacementMap,P.displacementScale=A.displacementScale,P.displacementBias=A.displacementBias,P.wireframeLinewidth=A.wireframeLinewidth,P.linewidth=A.linewidth,T.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const D=t.properties.get(P);D.light=T}return P}function b(E,A,T,L,P){if(E.visible===!1)return;if(E.layers.test(A.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&P===no)&&(!E.frustumCulled||i.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,E.matrixWorld);const U=e.update(E),G=E.material;if(Array.isArray(G)){const k=U.groups;for(let H=0,K=k.length;H<K;H++){const q=k[H],N=G[q.materialIndex];if(N&&N.visible){const V=w(E,N,L,P);t.renderBufferDirect(T,null,U,V,E,q)}}}else if(G.visible){const k=w(E,G,L,P);t.renderBufferDirect(T,null,U,k,E,null)}}const D=E.children;for(let U=0,G=D.length;U<G;U++)b(D[U],A,T,L,P)}}function jq(t,e,n){const i=n.isWebGL2;function r(){let ne=!1;const Ye=new Ct;let je=null;const Te=new Ct(0,0,0,0);return{setMask:function($e){je!==$e&&!ne&&(t.colorMask($e,$e,$e,$e),je=$e)},setLocked:function($e){ne=$e},setClear:function($e,vt,Xt,Cn,or){or===!0&&($e*=Cn,vt*=Cn,Xt*=Cn),Ye.set($e,vt,Xt,Cn),Te.equals(Ye)===!1&&(t.clearColor($e,vt,Xt,Cn),Te.copy(Ye))},reset:function(){ne=!1,je=null,Te.set(-1,0,0,0)}}}function s(){let ne=!1,Ye=null,je=null,Te=null;return{setTest:function($e){$e?le(t.DEPTH_TEST):Ae(t.DEPTH_TEST)},setMask:function($e){Ye!==$e&&!ne&&(t.depthMask($e),Ye=$e)},setFunc:function($e){if(je!==$e){switch($e){case Cz:t.depthFunc(t.NEVER);break;case Pz:t.depthFunc(t.ALWAYS);break;case Rz:t.depthFunc(t.LESS);break;case Cm:t.depthFunc(t.LEQUAL);break;case Lz:t.depthFunc(t.EQUAL);break;case Dz:t.depthFunc(t.GEQUAL);break;case Iz:t.depthFunc(t.GREATER);break;case Oz:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}je=$e}},setLocked:function($e){ne=$e},setClear:function($e){Te!==$e&&(t.clearDepth($e),Te=$e)},reset:function(){ne=!1,Ye=null,je=null,Te=null}}}function o(){let ne=!1,Ye=null,je=null,Te=null,$e=null,vt=null,Xt=null,Cn=null,or=null;return{setTest:function(dn){ne||(dn?le(t.STENCIL_TEST):Ae(t.STENCIL_TEST))},setMask:function(dn){Ye!==dn&&!ne&&(t.stencilMask(dn),Ye=dn)},setFunc:function(dn,Ni,fs){(je!==dn||Te!==Ni||$e!==fs)&&(t.stencilFunc(dn,Ni,fs),je=dn,Te=Ni,$e=fs)},setOp:function(dn,Ni,fs){(vt!==dn||Xt!==Ni||Cn!==fs)&&(t.stencilOp(dn,Ni,fs),vt=dn,Xt=Ni,Cn=fs)},setLocked:function(dn){ne=dn},setClear:function(dn){or!==dn&&(t.clearStencil(dn),or=dn)},reset:function(){ne=!1,Ye=null,je=null,Te=null,$e=null,vt=null,Xt=null,Cn=null,or=null}}}const a=new r,l=new s,u=new o,d=new WeakMap,c=new WeakMap;let h={},f={},m=new WeakMap,x=[],y=null,v=!1,_=null,w=null,b=null,E=null,A=null,T=null,L=null,P=new We(0,0,0),C=0,D=!1,U=null,G=null,k=null,H=null,K=null;const q=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let N=!1,V=0;const j=t.getParameter(t.VERSION);j.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(j)[1]),N=V>=1):j.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),N=V>=2);let z=null,$={};const te=t.getParameter(t.SCISSOR_BOX),Q=t.getParameter(t.VIEWPORT),J=new Ct().fromArray(te),ie=new Ct().fromArray(Q);function se(ne,Ye,je,Te){const $e=new Uint8Array(4),vt=t.createTexture();t.bindTexture(ne,vt),t.texParameteri(ne,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ne,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Xt=0;Xt<je;Xt++)i&&(ne===t.TEXTURE_3D||ne===t.TEXTURE_2D_ARRAY)?t.texImage3D(Ye,0,t.RGBA,1,1,Te,0,t.RGBA,t.UNSIGNED_BYTE,$e):t.texImage2D(Ye+Xt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,$e);return vt}const pe={};pe[t.TEXTURE_2D]=se(t.TEXTURE_2D,t.TEXTURE_2D,1),pe[t.TEXTURE_CUBE_MAP]=se(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(pe[t.TEXTURE_2D_ARRAY]=se(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),pe[t.TEXTURE_3D]=se(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),le(t.DEPTH_TEST),l.setFunc(Cm),Me(!1),Ce(CM),le(t.CULL_FACE),ge(Ua);function le(ne){h[ne]!==!0&&(t.enable(ne),h[ne]=!0)}function Ae(ne){h[ne]!==!1&&(t.disable(ne),h[ne]=!1)}function ae(ne,Ye){return f[ne]!==Ye?(t.bindFramebuffer(ne,Ye),f[ne]=Ye,i&&(ne===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=Ye),ne===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=Ye)),!0):!1}function W(ne,Ye){let je=x,Te=!1;if(ne)if(je=m.get(Ye),je===void 0&&(je=[],m.set(Ye,je)),ne.isWebGLMultipleRenderTargets){const $e=ne.texture;if(je.length!==$e.length||je[0]!==t.COLOR_ATTACHMENT0){for(let vt=0,Xt=$e.length;vt<Xt;vt++)je[vt]=t.COLOR_ATTACHMENT0+vt;je.length=$e.length,Te=!0}}else je[0]!==t.COLOR_ATTACHMENT0&&(je[0]=t.COLOR_ATTACHMENT0,Te=!0);else je[0]!==t.BACK&&(je[0]=t.BACK,Te=!0);Te&&(n.isWebGL2?t.drawBuffers(je):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(je))}function me(ne){return y!==ne?(t.useProgram(ne),y=ne,!0):!1}const ue={[Al]:t.FUNC_ADD,[fz]:t.FUNC_SUBTRACT,[pz]:t.FUNC_REVERSE_SUBTRACT};if(i)ue[DM]=t.MIN,ue[IM]=t.MAX;else{const ne=e.get("EXT_blend_minmax");ne!==null&&(ue[DM]=ne.MIN_EXT,ue[IM]=ne.MAX_EXT)}const ce={[mz]:t.ZERO,[gz]:t.ONE,[vz]:t.SRC_COLOR,[h1]:t.SRC_ALPHA,[bz]:t.SRC_ALPHA_SATURATE,[wz]:t.DST_COLOR,[xz]:t.DST_ALPHA,[yz]:t.ONE_MINUS_SRC_COLOR,[d1]:t.ONE_MINUS_SRC_ALPHA,[Sz]:t.ONE_MINUS_DST_COLOR,[_z]:t.ONE_MINUS_DST_ALPHA,[Mz]:t.CONSTANT_COLOR,[Az]:t.ONE_MINUS_CONSTANT_COLOR,[Ez]:t.CONSTANT_ALPHA,[Tz]:t.ONE_MINUS_CONSTANT_ALPHA};function ge(ne,Ye,je,Te,$e,vt,Xt,Cn,or,dn){if(ne===Ua){v===!0&&(Ae(t.BLEND),v=!1);return}if(v===!1&&(le(t.BLEND),v=!0),ne!==dz){if(ne!==_||dn!==D){if((w!==Al||A!==Al)&&(t.blendEquation(t.FUNC_ADD),w=Al,A=Al),dn)switch(ne){case Xl:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case PM:t.blendFunc(t.ONE,t.ONE);break;case RM:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case LM:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}else switch(ne){case Xl:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case PM:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case RM:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case LM:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}b=null,E=null,T=null,L=null,P.set(0,0,0),C=0,_=ne,D=dn}return}$e=$e||Ye,vt=vt||je,Xt=Xt||Te,(Ye!==w||$e!==A)&&(t.blendEquationSeparate(ue[Ye],ue[$e]),w=Ye,A=$e),(je!==b||Te!==E||vt!==T||Xt!==L)&&(t.blendFuncSeparate(ce[je],ce[Te],ce[vt],ce[Xt]),b=je,E=Te,T=vt,L=Xt),(Cn.equals(P)===!1||or!==C)&&(t.blendColor(Cn.r,Cn.g,Cn.b,or),P.copy(Cn),C=or),_=ne,D=!1}function De(ne,Ye){ne.side===so?Ae(t.CULL_FACE):le(t.CULL_FACE);let je=ne.side===Sr;Ye&&(je=!je),Me(je),ne.blending===Xl&&ne.transparent===!1?ge(Ua):ge(ne.blending,ne.blendEquation,ne.blendSrc,ne.blendDst,ne.blendEquationAlpha,ne.blendSrcAlpha,ne.blendDstAlpha,ne.blendColor,ne.blendAlpha,ne.premultipliedAlpha),l.setFunc(ne.depthFunc),l.setTest(ne.depthTest),l.setMask(ne.depthWrite),a.setMask(ne.colorWrite);const Te=ne.stencilWrite;u.setTest(Te),Te&&(u.setMask(ne.stencilWriteMask),u.setFunc(ne.stencilFunc,ne.stencilRef,ne.stencilFuncMask),u.setOp(ne.stencilFail,ne.stencilZFail,ne.stencilZPass)),He(ne.polygonOffset,ne.polygonOffsetFactor,ne.polygonOffsetUnits),ne.alphaToCoverage===!0?le(t.SAMPLE_ALPHA_TO_COVERAGE):Ae(t.SAMPLE_ALPHA_TO_COVERAGE)}function Me(ne){U!==ne&&(ne?t.frontFace(t.CW):t.frontFace(t.CCW),U=ne)}function Ce(ne){ne!==uz?(le(t.CULL_FACE),ne!==G&&(ne===CM?t.cullFace(t.BACK):ne===cz?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Ae(t.CULL_FACE),G=ne}function ke(ne){ne!==k&&(N&&t.lineWidth(ne),k=ne)}function He(ne,Ye,je){ne?(le(t.POLYGON_OFFSET_FILL),(H!==Ye||K!==je)&&(t.polygonOffset(Ye,je),H=Ye,K=je)):Ae(t.POLYGON_OFFSET_FILL)}function bt(ne){ne?le(t.SCISSOR_TEST):Ae(t.SCISSOR_TEST)}function Y(ne){ne===void 0&&(ne=t.TEXTURE0+q-1),z!==ne&&(t.activeTexture(ne),z=ne)}function B(ne,Ye,je){je===void 0&&(z===null?je=t.TEXTURE0+q-1:je=z);let Te=$[je];Te===void 0&&(Te={type:void 0,texture:void 0},$[je]=Te),(Te.type!==ne||Te.texture!==Ye)&&(z!==je&&(t.activeTexture(je),z=je),t.bindTexture(ne,Ye||pe[ne]),Te.type=ne,Te.texture=Ye)}function he(){const ne=$[z];ne!==void 0&&ne.type!==void 0&&(t.bindTexture(ne.type,null),ne.type=void 0,ne.texture=void 0)}function Re(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Le(){try{t.compressedTexImage3D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ie(){try{t.texSubImage2D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function rt(){try{t.texSubImage3D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Oe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ge(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function ot(){try{t.texStorage2D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Wt(){try{t.texStorage3D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Fe(){try{t.texImage2D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Qt(){try{t.texImage3D.apply(t,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Mt(ne){J.equals(ne)===!1&&(t.scissor(ne.x,ne.y,ne.z,ne.w),J.copy(ne))}function gt(ne){ie.equals(ne)===!1&&(t.viewport(ne.x,ne.y,ne.z,ne.w),ie.copy(ne))}function ft(ne,Ye){let je=c.get(Ye);je===void 0&&(je=new WeakMap,c.set(Ye,je));let Te=je.get(ne);Te===void 0&&(Te=t.getUniformBlockIndex(Ye,ne.name),je.set(ne,Te))}function Xe(ne,Ye){const Te=c.get(Ye).get(ne);d.get(Ye)!==Te&&(t.uniformBlockBinding(Ye,Te,ne.__bindingPointIndex),d.set(Ye,Te))}function Ft(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),i===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},z=null,$={},f={},m=new WeakMap,x=[],y=null,v=!1,_=null,w=null,b=null,E=null,A=null,T=null,L=null,P=new We(0,0,0),C=0,D=!1,U=null,G=null,k=null,H=null,K=null,J.set(0,0,t.canvas.width,t.canvas.height),ie.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:le,disable:Ae,bindFramebuffer:ae,drawBuffers:W,useProgram:me,setBlending:ge,setMaterial:De,setFlipSided:Me,setCullFace:Ce,setLineWidth:ke,setPolygonOffset:He,setScissorTest:bt,activeTexture:Y,bindTexture:B,unbindTexture:he,compressedTexImage2D:Re,compressedTexImage3D:Le,texImage2D:Fe,texImage3D:Qt,updateUBOMapping:ft,uniformBlockBinding:Xe,texStorage2D:ot,texStorage3D:Wt,texSubImage2D:Ie,texSubImage3D:rt,compressedTexSubImage2D:Oe,compressedTexSubImage3D:Ge,scissor:Mt,viewport:gt,reset:Ft}}function Gq(t,e,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,d=r.maxTextureSize,c=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let x;const y=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(Y,B){return v?new OffscreenCanvas(Y,B):Vm("canvas")}function w(Y,B,he,Re){let Le=1;if((Y.width>Re||Y.height>Re)&&(Le=Re/Math.max(Y.width,Y.height)),Le<1||B===!0)if(typeof HTMLImageElement<"u"&&Y instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Y instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Y instanceof ImageBitmap){const Ie=B?g1:Math.floor,rt=Ie(Le*Y.width),Oe=Ie(Le*Y.height);x===void 0&&(x=_(rt,Oe));const Ge=he?_(rt,Oe):x;return Ge.width=rt,Ge.height=Oe,Ge.getContext("2d").drawImage(Y,0,0,rt,Oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Y.width+"x"+Y.height+") to ("+rt+"x"+Oe+")."),Ge}else return"data"in Y&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Y.width+"x"+Y.height+")."),Y;return Y}function b(Y){return l2(Y.width)&&l2(Y.height)}function E(Y){return a?!1:Y.wrapS!==tr||Y.wrapT!==tr||Y.minFilter!==ti&&Y.minFilter!==In}function A(Y,B){return Y.generateMipmaps&&B&&Y.minFilter!==ti&&Y.minFilter!==In}function T(Y){t.generateMipmap(Y)}function L(Y,B,he,Re,Le=!1){if(a===!1)return B;if(Y!==null){if(t[Y]!==void 0)return t[Y];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Y+"'")}let Ie=B;if(B===t.RED&&(he===t.FLOAT&&(Ie=t.R32F),he===t.HALF_FLOAT&&(Ie=t.R16F),he===t.UNSIGNED_BYTE&&(Ie=t.R8)),B===t.RED_INTEGER&&(he===t.UNSIGNED_BYTE&&(Ie=t.R8UI),he===t.UNSIGNED_SHORT&&(Ie=t.R16UI),he===t.UNSIGNED_INT&&(Ie=t.R32UI),he===t.BYTE&&(Ie=t.R8I),he===t.SHORT&&(Ie=t.R16I),he===t.INT&&(Ie=t.R32I)),B===t.RG&&(he===t.FLOAT&&(Ie=t.RG32F),he===t.HALF_FLOAT&&(Ie=t.RG16F),he===t.UNSIGNED_BYTE&&(Ie=t.RG8)),B===t.RGBA){const rt=Le?km:ln.getTransfer(Re);he===t.FLOAT&&(Ie=t.RGBA32F),he===t.HALF_FLOAT&&(Ie=t.RGBA16F),he===t.UNSIGNED_BYTE&&(Ie=rt===gn?t.SRGB8_ALPHA8:t.RGBA8),he===t.UNSIGNED_SHORT_4_4_4_4&&(Ie=t.RGBA4),he===t.UNSIGNED_SHORT_5_5_5_1&&(Ie=t.RGB5_A1)}return(Ie===t.R16F||Ie===t.R32F||Ie===t.RG16F||Ie===t.RG32F||Ie===t.RGBA16F||Ie===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ie}function P(Y,B,he){return A(Y,he)===!0||Y.isFramebufferTexture&&Y.minFilter!==ti&&Y.minFilter!==In?Math.log2(Math.max(B.width,B.height))+1:Y.mipmaps!==void 0&&Y.mipmaps.length>0?Y.mipmaps.length:Y.isCompressedTexture&&Array.isArray(Y.image)?B.mipmaps.length:1}function C(Y){return Y===ti||Y===f1||Y===Yp?t.NEAREST:t.LINEAR}function D(Y){const B=Y.target;B.removeEventListener("dispose",D),G(B),B.isVideoTexture&&m.delete(B)}function U(Y){const B=Y.target;B.removeEventListener("dispose",U),H(B)}function G(Y){const B=i.get(Y);if(B.__webglInit===void 0)return;const he=Y.source,Re=y.get(he);if(Re){const Le=Re[B.__cacheKey];Le.usedTimes--,Le.usedTimes===0&&k(Y),Object.keys(Re).length===0&&y.delete(he)}i.remove(Y)}function k(Y){const B=i.get(Y);t.deleteTexture(B.__webglTexture);const he=Y.source,Re=y.get(he);delete Re[B.__cacheKey],o.memory.textures--}function H(Y){const B=Y.texture,he=i.get(Y),Re=i.get(B);if(Re.__webglTexture!==void 0&&(t.deleteTexture(Re.__webglTexture),o.memory.textures--),Y.depthTexture&&Y.depthTexture.dispose(),Y.isWebGLCubeRenderTarget)for(let Le=0;Le<6;Le++){if(Array.isArray(he.__webglFramebuffer[Le]))for(let Ie=0;Ie<he.__webglFramebuffer[Le].length;Ie++)t.deleteFramebuffer(he.__webglFramebuffer[Le][Ie]);else t.deleteFramebuffer(he.__webglFramebuffer[Le]);he.__webglDepthbuffer&&t.deleteRenderbuffer(he.__webglDepthbuffer[Le])}else{if(Array.isArray(he.__webglFramebuffer))for(let Le=0;Le<he.__webglFramebuffer.length;Le++)t.deleteFramebuffer(he.__webglFramebuffer[Le]);else t.deleteFramebuffer(he.__webglFramebuffer);if(he.__webglDepthbuffer&&t.deleteRenderbuffer(he.__webglDepthbuffer),he.__webglMultisampledFramebuffer&&t.deleteFramebuffer(he.__webglMultisampledFramebuffer),he.__webglColorRenderbuffer)for(let Le=0;Le<he.__webglColorRenderbuffer.length;Le++)he.__webglColorRenderbuffer[Le]&&t.deleteRenderbuffer(he.__webglColorRenderbuffer[Le]);he.__webglDepthRenderbuffer&&t.deleteRenderbuffer(he.__webglDepthRenderbuffer)}if(Y.isWebGLMultipleRenderTargets)for(let Le=0,Ie=B.length;Le<Ie;Le++){const rt=i.get(B[Le]);rt.__webglTexture&&(t.deleteTexture(rt.__webglTexture),o.memory.textures--),i.remove(B[Le])}i.remove(B),i.remove(Y)}let K=0;function q(){K=0}function N(){const Y=K;return Y>=l&&console.warn("THREE.WebGLTextures: Trying to use "+Y+" texture units while this GPU supports only "+l),K+=1,Y}function V(Y){const B=[];return B.push(Y.wrapS),B.push(Y.wrapT),B.push(Y.wrapR||0),B.push(Y.magFilter),B.push(Y.minFilter),B.push(Y.anisotropy),B.push(Y.internalFormat),B.push(Y.format),B.push(Y.type),B.push(Y.generateMipmaps),B.push(Y.premultiplyAlpha),B.push(Y.flipY),B.push(Y.unpackAlignment),B.push(Y.colorSpace),B.join()}function j(Y,B){const he=i.get(Y);if(Y.isVideoTexture&&He(Y),Y.isRenderTargetTexture===!1&&Y.version>0&&he.__version!==Y.version){const Re=Y.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(he,Y,B);return}}n.bindTexture(t.TEXTURE_2D,he.__webglTexture,t.TEXTURE0+B)}function z(Y,B){const he=i.get(Y);if(Y.version>0&&he.__version!==Y.version){le(he,Y,B);return}n.bindTexture(t.TEXTURE_2D_ARRAY,he.__webglTexture,t.TEXTURE0+B)}function $(Y,B){const he=i.get(Y);if(Y.version>0&&he.__version!==Y.version){le(he,Y,B);return}n.bindTexture(t.TEXTURE_3D,he.__webglTexture,t.TEXTURE0+B)}function te(Y,B){const he=i.get(Y);if(Y.version>0&&he.__version!==Y.version){Ae(he,Y,B);return}n.bindTexture(t.TEXTURE_CUBE_MAP,he.__webglTexture,t.TEXTURE0+B)}const Q={[Lm]:t.REPEAT,[tr]:t.CLAMP_TO_EDGE,[Dm]:t.MIRRORED_REPEAT},J={[ti]:t.NEAREST,[f1]:t.NEAREST_MIPMAP_NEAREST,[Yp]:t.NEAREST_MIPMAP_LINEAR,[In]:t.LINEAR,[IE]:t.LINEAR_MIPMAP_NEAREST,[iu]:t.LINEAR_MIPMAP_LINEAR},ie={[nF]:t.NEVER,[uF]:t.ALWAYS,[iF]:t.LESS,[sF]:t.LEQUAL,[rF]:t.EQUAL,[lF]:t.GEQUAL,[oF]:t.GREATER,[aF]:t.NOTEQUAL};function se(Y,B,he){if(he?(t.texParameteri(Y,t.TEXTURE_WRAP_S,Q[B.wrapS]),t.texParameteri(Y,t.TEXTURE_WRAP_T,Q[B.wrapT]),(Y===t.TEXTURE_3D||Y===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Y,t.TEXTURE_WRAP_R,Q[B.wrapR]),t.texParameteri(Y,t.TEXTURE_MAG_FILTER,J[B.magFilter]),t.texParameteri(Y,t.TEXTURE_MIN_FILTER,J[B.minFilter])):(t.texParameteri(Y,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(Y,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(Y===t.TEXTURE_3D||Y===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Y,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(B.wrapS!==tr||B.wrapT!==tr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Y,t.TEXTURE_MAG_FILTER,C(B.magFilter)),t.texParameteri(Y,t.TEXTURE_MIN_FILTER,C(B.minFilter)),B.minFilter!==ti&&B.minFilter!==In&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),B.compareFunction&&(t.texParameteri(Y,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Y,t.TEXTURE_COMPARE_FUNC,ie[B.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Re=e.get("EXT_texture_filter_anisotropic");if(B.magFilter===ti||B.minFilter!==Yp&&B.minFilter!==iu||B.type===rs&&e.has("OES_texture_float_linear")===!1||a===!1&&B.type===ru&&e.has("OES_texture_half_float_linear")===!1)return;(B.anisotropy>1||i.get(B).__currentAnisotropy)&&(t.texParameterf(Y,Re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,r.getMaxAnisotropy())),i.get(B).__currentAnisotropy=B.anisotropy)}}function pe(Y,B){let he=!1;Y.__webglInit===void 0&&(Y.__webglInit=!0,B.addEventListener("dispose",D));const Re=B.source;let Le=y.get(Re);Le===void 0&&(Le={},y.set(Re,Le));const Ie=V(B);if(Ie!==Y.__cacheKey){Le[Ie]===void 0&&(Le[Ie]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,he=!0),Le[Ie].usedTimes++;const rt=Le[Y.__cacheKey];rt!==void 0&&(Le[Y.__cacheKey].usedTimes--,rt.usedTimes===0&&k(B)),Y.__cacheKey=Ie,Y.__webglTexture=Le[Ie].texture}return he}function le(Y,B,he){let Re=t.TEXTURE_2D;(B.isDataArrayTexture||B.isCompressedArrayTexture)&&(Re=t.TEXTURE_2D_ARRAY),B.isData3DTexture&&(Re=t.TEXTURE_3D);const Le=pe(Y,B),Ie=B.source;n.bindTexture(Re,Y.__webglTexture,t.TEXTURE0+he);const rt=i.get(Ie);if(Ie.version!==rt.__version||Le===!0){n.activeTexture(t.TEXTURE0+he);const Oe=ln.getPrimaries(ln.workingColorSpace),Ge=B.colorSpace===ns?null:ln.getPrimaries(B.colorSpace),ot=B.colorSpace===ns||Oe===Ge?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,B.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,B.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot);const Wt=E(B)&&b(B.image)===!1;let Fe=w(B.image,Wt,!1,d);Fe=bt(B,Fe);const Qt=b(Fe)||a,Mt=s.convert(B.format,B.colorSpace);let gt=s.convert(B.type),ft=L(B.internalFormat,Mt,gt,B.colorSpace,B.isVideoTexture);se(Re,B,Qt);let Xe;const Ft=B.mipmaps,ne=a&&B.isVideoTexture!==!0,Ye=rt.__version===void 0||Le===!0,je=P(B,Fe,Qt);if(B.isDepthTexture)ft=t.DEPTH_COMPONENT,a?B.type===rs?ft=t.DEPTH_COMPONENT32F:B.type===$o?ft=t.DEPTH_COMPONENT24:B.type===Yl?ft=t.DEPTH24_STENCIL8:ft=t.DEPTH_COMPONENT16:B.type===rs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),B.format===Zl&&ft===t.DEPTH_COMPONENT&&B.type!==yx&&B.type!==$o&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),B.type=$o,gt=s.convert(B.type)),B.format===bc&&ft===t.DEPTH_COMPONENT&&(ft=t.DEPTH_STENCIL,B.type!==Yl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),B.type=Yl,gt=s.convert(B.type))),Ye&&(ne?n.texStorage2D(t.TEXTURE_2D,1,ft,Fe.width,Fe.height):n.texImage2D(t.TEXTURE_2D,0,ft,Fe.width,Fe.height,0,Mt,gt,null));else if(B.isDataTexture)if(Ft.length>0&&Qt){ne&&Ye&&n.texStorage2D(t.TEXTURE_2D,je,ft,Ft[0].width,Ft[0].height);for(let Te=0,$e=Ft.length;Te<$e;Te++)Xe=Ft[Te],ne?n.texSubImage2D(t.TEXTURE_2D,Te,0,0,Xe.width,Xe.height,Mt,gt,Xe.data):n.texImage2D(t.TEXTURE_2D,Te,ft,Xe.width,Xe.height,0,Mt,gt,Xe.data);B.generateMipmaps=!1}else ne?(Ye&&n.texStorage2D(t.TEXTURE_2D,je,ft,Fe.width,Fe.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,Fe.width,Fe.height,Mt,gt,Fe.data)):n.texImage2D(t.TEXTURE_2D,0,ft,Fe.width,Fe.height,0,Mt,gt,Fe.data);else if(B.isCompressedTexture)if(B.isCompressedArrayTexture){ne&&Ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,je,ft,Ft[0].width,Ft[0].height,Fe.depth);for(let Te=0,$e=Ft.length;Te<$e;Te++)Xe=Ft[Te],B.format!==vr?Mt!==null?ne?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Te,0,0,0,Xe.width,Xe.height,Fe.depth,Mt,Xe.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Te,ft,Xe.width,Xe.height,Fe.depth,0,Xe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ne?n.texSubImage3D(t.TEXTURE_2D_ARRAY,Te,0,0,0,Xe.width,Xe.height,Fe.depth,Mt,gt,Xe.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Te,ft,Xe.width,Xe.height,Fe.depth,0,Mt,gt,Xe.data)}else{ne&&Ye&&n.texStorage2D(t.TEXTURE_2D,je,ft,Ft[0].width,Ft[0].height);for(let Te=0,$e=Ft.length;Te<$e;Te++)Xe=Ft[Te],B.format!==vr?Mt!==null?ne?n.compressedTexSubImage2D(t.TEXTURE_2D,Te,0,0,Xe.width,Xe.height,Mt,Xe.data):n.compressedTexImage2D(t.TEXTURE_2D,Te,ft,Xe.width,Xe.height,0,Xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ne?n.texSubImage2D(t.TEXTURE_2D,Te,0,0,Xe.width,Xe.height,Mt,gt,Xe.data):n.texImage2D(t.TEXTURE_2D,Te,ft,Xe.width,Xe.height,0,Mt,gt,Xe.data)}else if(B.isDataArrayTexture)ne?(Ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,je,ft,Fe.width,Fe.height,Fe.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Fe.width,Fe.height,Fe.depth,Mt,gt,Fe.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,ft,Fe.width,Fe.height,Fe.depth,0,Mt,gt,Fe.data);else if(B.isData3DTexture)ne?(Ye&&n.texStorage3D(t.TEXTURE_3D,je,ft,Fe.width,Fe.height,Fe.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Fe.width,Fe.height,Fe.depth,Mt,gt,Fe.data)):n.texImage3D(t.TEXTURE_3D,0,ft,Fe.width,Fe.height,Fe.depth,0,Mt,gt,Fe.data);else if(B.isFramebufferTexture){if(Ye)if(ne)n.texStorage2D(t.TEXTURE_2D,je,ft,Fe.width,Fe.height);else{let Te=Fe.width,$e=Fe.height;for(let vt=0;vt<je;vt++)n.texImage2D(t.TEXTURE_2D,vt,ft,Te,$e,0,Mt,gt,null),Te>>=1,$e>>=1}}else if(Ft.length>0&&Qt){ne&&Ye&&n.texStorage2D(t.TEXTURE_2D,je,ft,Ft[0].width,Ft[0].height);for(let Te=0,$e=Ft.length;Te<$e;Te++)Xe=Ft[Te],ne?n.texSubImage2D(t.TEXTURE_2D,Te,0,0,Mt,gt,Xe):n.texImage2D(t.TEXTURE_2D,Te,ft,Mt,gt,Xe);B.generateMipmaps=!1}else ne?(Ye&&n.texStorage2D(t.TEXTURE_2D,je,ft,Fe.width,Fe.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,Mt,gt,Fe)):n.texImage2D(t.TEXTURE_2D,0,ft,Mt,gt,Fe);A(B,Qt)&&T(Re),rt.__version=Ie.version,B.onUpdate&&B.onUpdate(B)}Y.__version=B.version}function Ae(Y,B,he){if(B.image.length!==6)return;const Re=pe(Y,B),Le=B.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Y.__webglTexture,t.TEXTURE0+he);const Ie=i.get(Le);if(Le.version!==Ie.__version||Re===!0){n.activeTexture(t.TEXTURE0+he);const rt=ln.getPrimaries(ln.workingColorSpace),Oe=B.colorSpace===ns?null:ln.getPrimaries(B.colorSpace),Ge=B.colorSpace===ns||rt===Oe?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,B.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,B.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);const ot=B.isCompressedTexture||B.image[0].isCompressedTexture,Wt=B.image[0]&&B.image[0].isDataTexture,Fe=[];for(let Te=0;Te<6;Te++)!ot&&!Wt?Fe[Te]=w(B.image[Te],!1,!0,u):Fe[Te]=Wt?B.image[Te].image:B.image[Te],Fe[Te]=bt(B,Fe[Te]);const Qt=Fe[0],Mt=b(Qt)||a,gt=s.convert(B.format,B.colorSpace),ft=s.convert(B.type),Xe=L(B.internalFormat,gt,ft,B.colorSpace),Ft=a&&B.isVideoTexture!==!0,ne=Ie.__version===void 0||Re===!0;let Ye=P(B,Qt,Mt);se(t.TEXTURE_CUBE_MAP,B,Mt);let je;if(ot){Ft&&ne&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Ye,Xe,Qt.width,Qt.height);for(let Te=0;Te<6;Te++){je=Fe[Te].mipmaps;for(let $e=0;$e<je.length;$e++){const vt=je[$e];B.format!==vr?gt!==null?Ft?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e,0,0,vt.width,vt.height,gt,vt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e,Xe,vt.width,vt.height,0,vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ft?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e,0,0,vt.width,vt.height,gt,ft,vt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e,Xe,vt.width,vt.height,0,gt,ft,vt.data)}}}else{je=B.mipmaps,Ft&&ne&&(je.length>0&&Ye++,n.texStorage2D(t.TEXTURE_CUBE_MAP,Ye,Xe,Fe[0].width,Fe[0].height));for(let Te=0;Te<6;Te++)if(Wt){Ft?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,Fe[Te].width,Fe[Te].height,gt,ft,Fe[Te].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Xe,Fe[Te].width,Fe[Te].height,0,gt,ft,Fe[Te].data);for(let $e=0;$e<je.length;$e++){const Xt=je[$e].image[Te].image;Ft?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e+1,0,0,Xt.width,Xt.height,gt,ft,Xt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e+1,Xe,Xt.width,Xt.height,0,gt,ft,Xt.data)}}else{Ft?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,gt,ft,Fe[Te]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Xe,gt,ft,Fe[Te]);for(let $e=0;$e<je.length;$e++){const vt=je[$e];Ft?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e+1,0,0,gt,ft,vt.image[Te]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Te,$e+1,Xe,gt,ft,vt.image[Te])}}}A(B,Mt)&&T(t.TEXTURE_CUBE_MAP),Ie.__version=Le.version,B.onUpdate&&B.onUpdate(B)}Y.__version=B.version}function ae(Y,B,he,Re,Le,Ie){const rt=s.convert(he.format,he.colorSpace),Oe=s.convert(he.type),Ge=L(he.internalFormat,rt,Oe,he.colorSpace);if(!i.get(B).__hasExternalTextures){const Wt=Math.max(1,B.width>>Ie),Fe=Math.max(1,B.height>>Ie);Le===t.TEXTURE_3D||Le===t.TEXTURE_2D_ARRAY?n.texImage3D(Le,Ie,Ge,Wt,Fe,B.depth,0,rt,Oe,null):n.texImage2D(Le,Ie,Ge,Wt,Fe,0,rt,Oe,null)}n.bindFramebuffer(t.FRAMEBUFFER,Y),ke(B)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Re,Le,i.get(he).__webglTexture,0,Ce(B)):(Le===t.TEXTURE_2D||Le>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Le<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Re,Le,i.get(he).__webglTexture,Ie),n.bindFramebuffer(t.FRAMEBUFFER,null)}function W(Y,B,he){if(t.bindRenderbuffer(t.RENDERBUFFER,Y),B.depthBuffer&&!B.stencilBuffer){let Re=a===!0?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(he||ke(B)){const Le=B.depthTexture;Le&&Le.isDepthTexture&&(Le.type===rs?Re=t.DEPTH_COMPONENT32F:Le.type===$o&&(Re=t.DEPTH_COMPONENT24));const Ie=Ce(B);ke(B)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ie,Re,B.width,B.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,Ie,Re,B.width,B.height)}else t.renderbufferStorage(t.RENDERBUFFER,Re,B.width,B.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,Y)}else if(B.depthBuffer&&B.stencilBuffer){const Re=Ce(B);he&&ke(B)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Re,t.DEPTH24_STENCIL8,B.width,B.height):ke(B)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Re,t.DEPTH24_STENCIL8,B.width,B.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,B.width,B.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,Y)}else{const Re=B.isWebGLMultipleRenderTargets===!0?B.texture:[B.texture];for(let Le=0;Le<Re.length;Le++){const Ie=Re[Le],rt=s.convert(Ie.format,Ie.colorSpace),Oe=s.convert(Ie.type),Ge=L(Ie.internalFormat,rt,Oe,Ie.colorSpace),ot=Ce(B);he&&ke(B)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ot,Ge,B.width,B.height):ke(B)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ot,Ge,B.width,B.height):t.renderbufferStorage(t.RENDERBUFFER,Ge,B.width,B.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function me(Y,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Y),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),j(B.depthTexture,0);const Re=i.get(B.depthTexture).__webglTexture,Le=Ce(B);if(B.depthTexture.format===Zl)ke(B)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Re,0,Le):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Re,0);else if(B.depthTexture.format===bc)ke(B)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Re,0,Le):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Re,0);else throw new Error("Unknown depthTexture format")}function ue(Y){const B=i.get(Y),he=Y.isWebGLCubeRenderTarget===!0;if(Y.depthTexture&&!B.__autoAllocateDepthBuffer){if(he)throw new Error("target.depthTexture not supported in Cube render targets");me(B.__webglFramebuffer,Y)}else if(he){B.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)n.bindFramebuffer(t.FRAMEBUFFER,B.__webglFramebuffer[Re]),B.__webglDepthbuffer[Re]=t.createRenderbuffer(),W(B.__webglDepthbuffer[Re],Y,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,B.__webglFramebuffer),B.__webglDepthbuffer=t.createRenderbuffer(),W(B.__webglDepthbuffer,Y,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function ce(Y,B,he){const Re=i.get(Y);B!==void 0&&ae(Re.__webglFramebuffer,Y,Y.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),he!==void 0&&ue(Y)}function ge(Y){const B=Y.texture,he=i.get(Y),Re=i.get(B);Y.addEventListener("dispose",U),Y.isWebGLMultipleRenderTargets!==!0&&(Re.__webglTexture===void 0&&(Re.__webglTexture=t.createTexture()),Re.__version=B.version,o.memory.textures++);const Le=Y.isWebGLCubeRenderTarget===!0,Ie=Y.isWebGLMultipleRenderTargets===!0,rt=b(Y)||a;if(Le){he.__webglFramebuffer=[];for(let Oe=0;Oe<6;Oe++)if(a&&B.mipmaps&&B.mipmaps.length>0){he.__webglFramebuffer[Oe]=[];for(let Ge=0;Ge<B.mipmaps.length;Ge++)he.__webglFramebuffer[Oe][Ge]=t.createFramebuffer()}else he.__webglFramebuffer[Oe]=t.createFramebuffer()}else{if(a&&B.mipmaps&&B.mipmaps.length>0){he.__webglFramebuffer=[];for(let Oe=0;Oe<B.mipmaps.length;Oe++)he.__webglFramebuffer[Oe]=t.createFramebuffer()}else he.__webglFramebuffer=t.createFramebuffer();if(Ie)if(r.drawBuffers){const Oe=Y.texture;for(let Ge=0,ot=Oe.length;Ge<ot;Ge++){const Wt=i.get(Oe[Ge]);Wt.__webglTexture===void 0&&(Wt.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&Y.samples>0&&ke(Y)===!1){const Oe=Ie?B:[B];he.__webglMultisampledFramebuffer=t.createFramebuffer(),he.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,he.__webglMultisampledFramebuffer);for(let Ge=0;Ge<Oe.length;Ge++){const ot=Oe[Ge];he.__webglColorRenderbuffer[Ge]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,he.__webglColorRenderbuffer[Ge]);const Wt=s.convert(ot.format,ot.colorSpace),Fe=s.convert(ot.type),Qt=L(ot.internalFormat,Wt,Fe,ot.colorSpace,Y.isXRRenderTarget===!0),Mt=Ce(Y);t.renderbufferStorageMultisample(t.RENDERBUFFER,Mt,Qt,Y.width,Y.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ge,t.RENDERBUFFER,he.__webglColorRenderbuffer[Ge])}t.bindRenderbuffer(t.RENDERBUFFER,null),Y.depthBuffer&&(he.__webglDepthRenderbuffer=t.createRenderbuffer(),W(he.__webglDepthRenderbuffer,Y,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Le){n.bindTexture(t.TEXTURE_CUBE_MAP,Re.__webglTexture),se(t.TEXTURE_CUBE_MAP,B,rt);for(let Oe=0;Oe<6;Oe++)if(a&&B.mipmaps&&B.mipmaps.length>0)for(let Ge=0;Ge<B.mipmaps.length;Ge++)ae(he.__webglFramebuffer[Oe][Ge],Y,B,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,Ge);else ae(he.__webglFramebuffer[Oe],Y,B,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0);A(B,rt)&&T(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Ie){const Oe=Y.texture;for(let Ge=0,ot=Oe.length;Ge<ot;Ge++){const Wt=Oe[Ge],Fe=i.get(Wt);n.bindTexture(t.TEXTURE_2D,Fe.__webglTexture),se(t.TEXTURE_2D,Wt,rt),ae(he.__webglFramebuffer,Y,Wt,t.COLOR_ATTACHMENT0+Ge,t.TEXTURE_2D,0),A(Wt,rt)&&T(t.TEXTURE_2D)}n.unbindTexture()}else{let Oe=t.TEXTURE_2D;if((Y.isWebGL3DRenderTarget||Y.isWebGLArrayRenderTarget)&&(a?Oe=Y.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Oe,Re.__webglTexture),se(Oe,B,rt),a&&B.mipmaps&&B.mipmaps.length>0)for(let Ge=0;Ge<B.mipmaps.length;Ge++)ae(he.__webglFramebuffer[Ge],Y,B,t.COLOR_ATTACHMENT0,Oe,Ge);else ae(he.__webglFramebuffer,Y,B,t.COLOR_ATTACHMENT0,Oe,0);A(B,rt)&&T(Oe),n.unbindTexture()}Y.depthBuffer&&ue(Y)}function De(Y){const B=b(Y)||a,he=Y.isWebGLMultipleRenderTargets===!0?Y.texture:[Y.texture];for(let Re=0,Le=he.length;Re<Le;Re++){const Ie=he[Re];if(A(Ie,B)){const rt=Y.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Oe=i.get(Ie).__webglTexture;n.bindTexture(rt,Oe),T(rt),n.unbindTexture()}}}function Me(Y){if(a&&Y.samples>0&&ke(Y)===!1){const B=Y.isWebGLMultipleRenderTargets?Y.texture:[Y.texture],he=Y.width,Re=Y.height;let Le=t.COLOR_BUFFER_BIT;const Ie=[],rt=Y.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Oe=i.get(Y),Ge=Y.isWebGLMultipleRenderTargets===!0;if(Ge)for(let ot=0;ot<B.length;ot++)n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Oe.__webglFramebuffer);for(let ot=0;ot<B.length;ot++){Ie.push(t.COLOR_ATTACHMENT0+ot),Y.depthBuffer&&Ie.push(rt);const Wt=Oe.__ignoreDepthValues!==void 0?Oe.__ignoreDepthValues:!1;if(Wt===!1&&(Y.depthBuffer&&(Le|=t.DEPTH_BUFFER_BIT),Y.stencilBuffer&&(Le|=t.STENCIL_BUFFER_BIT)),Ge&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Oe.__webglColorRenderbuffer[ot]),Wt===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[rt]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[rt])),Ge){const Fe=i.get(B[ot]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Fe,0)}t.blitFramebuffer(0,0,he,Re,0,0,he,Re,Le,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ie)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ge)for(let ot=0;ot<B.length;ot++){n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.RENDERBUFFER,Oe.__webglColorRenderbuffer[ot]);const Wt=i.get(B[ot]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.TEXTURE_2D,Wt,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer)}}function Ce(Y){return Math.min(c,Y.samples)}function ke(Y){const B=i.get(Y);return a&&Y.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&B.__useRenderToTexture!==!1}function He(Y){const B=o.render.frame;m.get(Y)!==B&&(m.set(Y,B),Y.update())}function bt(Y,B){const he=Y.colorSpace,Re=Y.format,Le=Y.type;return Y.isCompressedTexture===!0||Y.isVideoTexture===!0||Y.format===m1||he!==yo&&he!==ns&&(ln.getTransfer(he)===gn?a===!1?e.has("EXT_sRGB")===!0&&Re===vr?(Y.format=m1,Y.minFilter=In,Y.generateMipmaps=!1):B=VE.sRGBToLinear(B):(Re!==vr||Le!==Jo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",he)),B}this.allocateTextureUnit=N,this.resetTextureUnits=q,this.setTexture2D=j,this.setTexture2DArray=z,this.setTexture3D=$,this.setTextureCube=te,this.rebindTextures=ce,this.setupRenderTarget=ge,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=Me,this.setupDepthRenderbuffer=ue,this.setupFrameBufferTexture=ae,this.useMultisampledRTT=ke}function AF(t,e,n){const i=n.isWebGL2;function r(s,o=ns){let a;const l=ln.getTransfer(o);if(s===Jo)return t.UNSIGNED_BYTE;if(s===NE)return t.UNSIGNED_SHORT_4_4_4_4;if(s===kE)return t.UNSIGNED_SHORT_5_5_5_1;if(s===jz)return t.BYTE;if(s===Gz)return t.SHORT;if(s===yx)return t.UNSIGNED_SHORT;if(s===OE)return t.INT;if(s===$o)return t.UNSIGNED_INT;if(s===rs)return t.FLOAT;if(s===ru)return i?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Hz)return t.ALPHA;if(s===vr)return t.RGBA;if(s===Wz)return t.LUMINANCE;if(s===$z)return t.LUMINANCE_ALPHA;if(s===Zl)return t.DEPTH_COMPONENT;if(s===bc)return t.DEPTH_STENCIL;if(s===m1)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===qz)return t.RED;if(s===UE)return t.RED_INTEGER;if(s===p1)return t.RG;if(s===zE)return t.RG_INTEGER;if(s===xx)return t.RGBA_INTEGER;if(s===Ty||s===Cy||s===Py||s===Ry)if(l===gn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Ty)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Cy)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Py)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Ry)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Ty)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Cy)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Py)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Ry)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===NM||s===kM||s===UM||s===zM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===NM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===kM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===UM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===zM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Xz)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===FM||s===BM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===FM)return l===gn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===BM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===VM||s===jM||s===GM||s===HM||s===WM||s===$M||s===qM||s===XM||s===YM||s===ZM||s===KM||s===QM||s===JM||s===e2)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===VM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===jM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===GM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===HM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===WM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===$M)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===qM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===XM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===YM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ZM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===KM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===QM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===JM)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===e2)return l===gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Ly||s===t2||s===n2)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Ly)return l===gn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===t2)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===n2)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===Yz||s===i2||s===r2||s===s2)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Ly)return a.COMPRESSED_RED_RGTC1_EXT;if(s===i2)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===r2)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===s2)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Yl?i?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class EF extends gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ll extends jt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Hq={type:"move"};class cS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ll,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ll,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new O,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new O),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ll,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new O,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new O),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const x of e.hand.values()){const y=n.getJointPose(x,i),v=this._getHandJoint(u,x);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const d=u.joints["index-finger-tip"],c=u.joints["thumb-tip"],h=d.position.distanceTo(c.position),f=.02,m=.005;u.inputState.pinching&&h>f+m?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=f-m&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Hq)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new Ll;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class qE extends Tn{constructor(e,n,i,r,s,o,a,l,u,d){if(d=d!==void 0?d:Zl,d!==Zl&&d!==bc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===Zl&&(i=$o),i===void 0&&d===bc&&(i=Yl),super(null,r,s,o,a,l,d,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:ti,this.minFilter=l!==void 0?l:ti,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class Wq extends sa{constructor(e,n){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,d=null,c=null,h=null,f=null,m=null;const x=n.getContextAttributes();let y=null,v=null;const _=[],w=[],b=new gi;b.layers.enable(1),b.viewport=new Ct;const E=new gi;E.layers.enable(2),E.viewport=new Ct;const A=[b,E],T=new EF;T.layers.enable(1),T.layers.enable(2);let L=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(z){let $=_[z];return $===void 0&&($=new cS,_[z]=$),$.getTargetRaySpace()},this.getControllerGrip=function(z){let $=_[z];return $===void 0&&($=new cS,_[z]=$),$.getGripSpace()},this.getHand=function(z){let $=_[z];return $===void 0&&($=new cS,_[z]=$),$.getHandSpace()};function C(z){const $=w.indexOf(z.inputSource);if($===-1)return;const te=_[$];te!==void 0&&(te.update(z.inputSource,z.frame,u||o),te.dispatchEvent({type:z.type,data:z.inputSource}))}function D(){r.removeEventListener("select",C),r.removeEventListener("selectstart",C),r.removeEventListener("selectend",C),r.removeEventListener("squeeze",C),r.removeEventListener("squeezestart",C),r.removeEventListener("squeezeend",C),r.removeEventListener("end",D),r.removeEventListener("inputsourceschange",U);for(let z=0;z<_.length;z++){const $=w[z];$!==null&&(w[z]=null,_[z].disconnect($))}L=null,P=null,e.setRenderTarget(y),f=null,h=null,c=null,r=null,v=null,j.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(z){s=z,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(z){a=z,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(z){u=z},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return c},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=async function(z){if(r=z,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",C),r.addEventListener("selectstart",C),r.addEventListener("selectend",C),r.addEventListener("squeeze",C),r.addEventListener("squeezestart",C),r.addEventListener("squeezeend",C),r.addEventListener("end",D),r.addEventListener("inputsourceschange",U),x.xrCompatible!==!0&&await n.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const $={antialias:r.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,n,$),r.updateRenderState({baseLayer:f}),v=new js(f.framebufferWidth,f.framebufferHeight,{format:vr,type:Jo,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let $=null,te=null,Q=null;x.depth&&(Q=x.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,$=x.stencil?bc:Zl,te=x.stencil?Yl:$o);const J={colorFormat:n.RGBA8,depthFormat:Q,scaleFactor:s};c=new XRWebGLBinding(r,n),h=c.createProjectionLayer(J),r.updateRenderState({layers:[h]}),v=new js(h.textureWidth,h.textureHeight,{format:vr,type:Jo,depthTexture:new qE(h.textureWidth,h.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,$),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});const ie=e.properties.get(v);ie.__ignoreDepthValues=h.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),j.setContext(r),j.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function U(z){for(let $=0;$<z.removed.length;$++){const te=z.removed[$],Q=w.indexOf(te);Q>=0&&(w[Q]=null,_[Q].disconnect(te))}for(let $=0;$<z.added.length;$++){const te=z.added[$];let Q=w.indexOf(te);if(Q===-1){for(let ie=0;ie<_.length;ie++)if(ie>=w.length){w.push(te),Q=ie;break}else if(w[ie]===null){w[ie]=te,Q=ie;break}if(Q===-1)break}const J=_[Q];J&&J.connect(te)}}const G=new O,k=new O;function H(z,$,te){G.setFromMatrixPosition($.matrixWorld),k.setFromMatrixPosition(te.matrixWorld);const Q=G.distanceTo(k),J=$.projectionMatrix.elements,ie=te.projectionMatrix.elements,se=J[14]/(J[10]-1),pe=J[14]/(J[10]+1),le=(J[9]+1)/J[5],Ae=(J[9]-1)/J[5],ae=(J[8]-1)/J[0],W=(ie[8]+1)/ie[0],me=se*ae,ue=se*W,ce=Q/(-ae+W),ge=ce*-ae;$.matrixWorld.decompose(z.position,z.quaternion,z.scale),z.translateX(ge),z.translateZ(ce),z.matrixWorld.compose(z.position,z.quaternion,z.scale),z.matrixWorldInverse.copy(z.matrixWorld).invert();const De=se+ce,Me=pe+ce,Ce=me-ge,ke=ue+(Q-ge),He=le*pe/Me*De,bt=Ae*pe/Me*De;z.projectionMatrix.makePerspective(Ce,ke,He,bt,De,Me),z.projectionMatrixInverse.copy(z.projectionMatrix).invert()}function K(z,$){$===null?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices($.matrixWorld,z.matrix),z.matrixWorldInverse.copy(z.matrixWorld).invert()}this.updateCamera=function(z){if(r===null)return;T.near=E.near=b.near=z.near,T.far=E.far=b.far=z.far,(L!==T.near||P!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),L=T.near,P=T.far);const $=z.parent,te=T.cameras;K(T,$);for(let Q=0;Q<te.length;Q++)K(te[Q],$);te.length===2?H(T,b,E):T.projectionMatrix.copy(b.projectionMatrix),q(z,T,$)};function q(z,$,te){te===null?z.matrix.copy($.matrixWorld):(z.matrix.copy(te.matrixWorld),z.matrix.invert(),z.matrix.multiply($.matrixWorld)),z.matrix.decompose(z.position,z.quaternion,z.scale),z.updateMatrixWorld(!0),z.projectionMatrix.copy($.projectionMatrix),z.projectionMatrixInverse.copy($.projectionMatrixInverse),z.isPerspectiveCamera&&(z.fov=Hd*2*Math.atan(1/z.projectionMatrix.elements[5]),z.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(h===null&&f===null))return l},this.setFoveation=function(z){l=z,h!==null&&(h.fixedFoveation=z),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=z)};let N=null;function V(z,$){if(d=$.getViewerPose(u||o),m=$,d!==null){const te=d.views;f!==null&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let Q=!1;te.length!==T.cameras.length&&(T.cameras.length=0,Q=!0);for(let J=0;J<te.length;J++){const ie=te[J];let se=null;if(f!==null)se=f.getViewport(ie);else{const le=c.getViewSubImage(h,ie);se=le.viewport,J===0&&(e.setRenderTargetTextures(v,le.colorTexture,h.ignoreDepthValues?void 0:le.depthStencilTexture),e.setRenderTarget(v))}let pe=A[J];pe===void 0&&(pe=new gi,pe.layers.enable(J),pe.viewport=new Ct,A[J]=pe),pe.matrix.fromArray(ie.transform.matrix),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.projectionMatrix.fromArray(ie.projectionMatrix),pe.projectionMatrixInverse.copy(pe.projectionMatrix).invert(),pe.viewport.set(se.x,se.y,se.width,se.height),J===0&&(T.matrix.copy(pe.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),Q===!0&&T.cameras.push(pe)}}for(let te=0;te<_.length;te++){const Q=w[te],J=_[te];Q!==null&&J!==void 0&&J.update(Q,$,u||o)}N&&N(z,$),$.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:$}),m=null}const j=new _F;j.setAnimationLoop(V),this.setAnimationLoop=function(z){N=z},this.dispose=function(){}}}function $q(t,e){function n(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function i(y,v){v.color.getRGB(y.fogColor.value,vF(t)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function r(y,v,_,w,b){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),c(y,v)):v.isMeshPhongMaterial?(s(y,v),d(y,v)):v.isMeshStandardMaterial?(s(y,v),h(y,v),v.isMeshPhysicalMaterial&&f(y,v,b)):v.isMeshMatcapMaterial?(s(y,v),m(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),x(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(o(y,v),v.isLineDashedMaterial&&a(y,v)):v.isPointsMaterial?l(y,v,_,w):v.isSpriteMaterial?u(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,n(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===Sr&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,n(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===Sr&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,n(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,n(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const _=e.get(v).envMap;if(_&&(y.envMap.value=_,y.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap){y.lightMap.value=v.lightMap;const w=t._useLegacyLights===!0?Math.PI:1;y.lightMapIntensity.value=v.lightMapIntensity*w,n(v.lightMap,y.lightMapTransform)}v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,y.aoMapTransform))}function o(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform))}function a(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,_,w){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*_,y.scale.value=w*.5,v.map&&(y.map.value=v.map,n(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function d(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function c(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function h(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,y.roughnessMapTransform)),e.get(v).envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function f(y,v,_){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Sr&&y.clearcoatNormalScale.value.negate())),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=_.texture,y.transmissionSamplerSize.value.set(_.width,_.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,y.specularIntensityMapTransform))}function m(y,v){v.matcap&&(y.matcap.value=v.matcap)}function x(y,v){const _=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(_.matrixWorld),y.nearDistance.value=_.shadow.camera.near,y.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function qq(t,e,n,i){let r={},s={},o=[];const a=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(_,w){const b=w.program;i.uniformBlockBinding(_,b)}function u(_,w){let b=r[_.id];b===void 0&&(m(_),b=d(_),r[_.id]=b,_.addEventListener("dispose",y));const E=w.program;i.updateUBOMapping(_,E);const A=e.render.frame;s[_.id]!==A&&(h(_),s[_.id]=A)}function d(_){const w=c();_.__bindingPointIndex=w;const b=t.createBuffer(),E=_.__size,A=_.usage;return t.bindBuffer(t.UNIFORM_BUFFER,b),t.bufferData(t.UNIFORM_BUFFER,E,A),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,w,b),b}function c(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(_){const w=r[_.id],b=_.uniforms,E=_.__cache;t.bindBuffer(t.UNIFORM_BUFFER,w);for(let A=0,T=b.length;A<T;A++){const L=b[A];if(f(L,A,E)===!0){const P=L.__offset,C=Array.isArray(L.value)?L.value:[L.value];let D=0;for(let U=0;U<C.length;U++){const G=C[U],k=x(G);typeof G=="number"?(L.__data[0]=G,t.bufferSubData(t.UNIFORM_BUFFER,P+D,L.__data)):G.isMatrix3?(L.__data[0]=G.elements[0],L.__data[1]=G.elements[1],L.__data[2]=G.elements[2],L.__data[3]=G.elements[0],L.__data[4]=G.elements[3],L.__data[5]=G.elements[4],L.__data[6]=G.elements[5],L.__data[7]=G.elements[0],L.__data[8]=G.elements[6],L.__data[9]=G.elements[7],L.__data[10]=G.elements[8],L.__data[11]=G.elements[0]):(G.toArray(L.__data,D),D+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,P,L.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(_,w,b){const E=_.value;if(b[w]===void 0){if(typeof E=="number")b[w]=E;else{const A=Array.isArray(E)?E:[E],T=[];for(let L=0;L<A.length;L++)T.push(A[L].clone());b[w]=T}return!0}else if(typeof E=="number"){if(b[w]!==E)return b[w]=E,!0}else{const A=Array.isArray(b[w])?b[w]:[b[w]],T=Array.isArray(E)?E:[E];for(let L=0;L<A.length;L++){const P=A[L];if(P.equals(T[L])===!1)return P.copy(T[L]),!0}}return!1}function m(_){const w=_.uniforms;let b=0;const E=16;let A=0;for(let T=0,L=w.length;T<L;T++){const P=w[T],C={boundary:0,storage:0},D=Array.isArray(P.value)?P.value:[P.value];for(let U=0,G=D.length;U<G;U++){const k=D[U],H=x(k);C.boundary+=H.boundary,C.storage+=H.storage}if(P.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),P.__offset=b,T>0){A=b%E;const U=E-A;A!==0&&U-C.boundary<0&&(b+=E-A,P.__offset=b)}b+=C.storage}return A=b%E,A>0&&(b+=E-A),_.__size=b,_.__cache={},this}function x(_){const w={boundary:0,storage:0};return typeof _=="number"?(w.boundary=4,w.storage=4):_.isVector2?(w.boundary=8,w.storage=8):_.isVector3||_.isColor?(w.boundary=16,w.storage=12):_.isVector4?(w.boundary=16,w.storage=16):_.isMatrix3?(w.boundary=48,w.storage=48):_.isMatrix4?(w.boundary=64,w.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),w}function y(_){const w=_.target;w.removeEventListener("dispose",y);const b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function v(){for(const _ in r)t.deleteBuffer(r[_]);o=[],r={},s={}}return{bind:l,update:u,dispose:v}}class XE{constructor(e={}){const{canvas:n=fF(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:c=!1}=e;this.isWebGLRenderer=!0;let h;i!==null?h=i.getContextAttributes().alpha:h=o;const f=new Uint32Array(4),m=new Int32Array(4);let x=null,y=null;const v=[],_=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ni,this._useLegacyLights=!1,this.toneMapping=Qo,this.toneMappingExposure=1;const w=this;let b=!1,E=0,A=0,T=null,L=-1,P=null;const C=new Ct,D=new Ct;let U=null;const G=new We(0);let k=0,H=n.width,K=n.height,q=1,N=null,V=null;const j=new Ct(0,0,H,K),z=new Ct(0,0,H,K);let $=!1;const te=new bx;let Q=!1,J=!1,ie=null;const se=new Ue,pe=new ee,le=new O,Ae={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ae(){return T===null?q:1}let W=i;function me(X,fe){for(let xe=0;xe<X.length;xe++){const we=X[xe],be=n.getContext(we,fe);if(be!==null)return be}return null}try{const X={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:c};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${mx}`),n.addEventListener("webglcontextlost",Ft,!1),n.addEventListener("webglcontextrestored",ne,!1),n.addEventListener("webglcontextcreationerror",Ye,!1),W===null){const fe=["webgl2","webgl","experimental-webgl"];if(w.isWebGL1Renderer===!0&&fe.shift(),W=me(fe,X),W===null)throw me(fe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&W instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),W.getShaderPrecisionFormat===void 0&&(W.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}let ue,ce,ge,De,Me,Ce,ke,He,bt,Y,B,he,Re,Le,Ie,rt,Oe,Ge,ot,Wt,Fe,Qt,Mt,gt;function ft(){ue=new l$(W),ce=new n$(W,ue,e),ue.init(ce),Qt=new AF(W,ue,ce),ge=new jq(W,ue,ce),De=new h$(W),Me=new Rq,Ce=new Gq(W,ue,ge,Me,ce,Qt,De),ke=new r$(w),He=new a$(w),bt=new w8(W,ce),Mt=new e$(W,ue,bt,ce),Y=new u$(W,bt,De,Mt),B=new m$(W,Y,bt,De),ot=new p$(W,ce,Ce),rt=new i$(Me),he=new Pq(w,ke,He,ue,ce,Mt,rt),Re=new $q(w,Me),Le=new Dq,Ie=new zq(ue,ce),Ge=new J7(w,ke,He,ge,B,h,l),Oe=new Vq(w,B,ce),gt=new qq(W,De,ce,ge),Wt=new t$(W,ue,De,ce),Fe=new c$(W,ue,De,ce),De.programs=he.programs,w.capabilities=ce,w.extensions=ue,w.properties=Me,w.renderLists=Le,w.shadowMap=Oe,w.state=ge,w.info=De}ft();const Xe=new Wq(w,W);this.xr=Xe,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){const X=ue.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=ue.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(X){X!==void 0&&(q=X,this.setSize(H,K,!1))},this.getSize=function(X){return X.set(H,K)},this.setSize=function(X,fe,xe=!0){if(Xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}H=X,K=fe,n.width=Math.floor(X*q),n.height=Math.floor(fe*q),xe===!0&&(n.style.width=X+"px",n.style.height=fe+"px"),this.setViewport(0,0,X,fe)},this.getDrawingBufferSize=function(X){return X.set(H*q,K*q).floor()},this.setDrawingBufferSize=function(X,fe,xe){H=X,K=fe,q=xe,n.width=Math.floor(X*xe),n.height=Math.floor(fe*xe),this.setViewport(0,0,X,fe)},this.getCurrentViewport=function(X){return X.copy(C)},this.getViewport=function(X){return X.copy(j)},this.setViewport=function(X,fe,xe,we){X.isVector4?j.set(X.x,X.y,X.z,X.w):j.set(X,fe,xe,we),ge.viewport(C.copy(j).multiplyScalar(q).floor())},this.getScissor=function(X){return X.copy(z)},this.setScissor=function(X,fe,xe,we){X.isVector4?z.set(X.x,X.y,X.z,X.w):z.set(X,fe,xe,we),ge.scissor(D.copy(z).multiplyScalar(q).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(X){ge.setScissorTest($=X)},this.setOpaqueSort=function(X){N=X},this.setTransparentSort=function(X){V=X},this.getClearColor=function(X){return X.copy(Ge.getClearColor())},this.setClearColor=function(){Ge.setClearColor.apply(Ge,arguments)},this.getClearAlpha=function(){return Ge.getClearAlpha()},this.setClearAlpha=function(){Ge.setClearAlpha.apply(Ge,arguments)},this.clear=function(X=!0,fe=!0,xe=!0){let we=0;if(X){let be=!1;if(T!==null){const tt=T.texture.format;be=tt===xx||tt===zE||tt===UE}if(be){const tt=T.texture.type,lt=tt===Jo||tt===$o||tt===yx||tt===Yl||tt===NE||tt===kE,yt=Ge.getClearColor(),xt=Ge.getClearAlpha(),Pt=yt.r,At=yt.g,Rt=yt.b;lt?(f[0]=Pt,f[1]=At,f[2]=Rt,f[3]=xt,W.clearBufferuiv(W.COLOR,0,f)):(m[0]=Pt,m[1]=At,m[2]=Rt,m[3]=xt,W.clearBufferiv(W.COLOR,0,m))}else we|=W.COLOR_BUFFER_BIT}fe&&(we|=W.DEPTH_BUFFER_BIT),xe&&(we|=W.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),W.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Ft,!1),n.removeEventListener("webglcontextrestored",ne,!1),n.removeEventListener("webglcontextcreationerror",Ye,!1),Le.dispose(),Ie.dispose(),Me.dispose(),ke.dispose(),He.dispose(),B.dispose(),Mt.dispose(),gt.dispose(),he.dispose(),Xe.dispose(),Xe.removeEventListener("sessionstart",or),Xe.removeEventListener("sessionend",dn),ie&&(ie.dispose(),ie=null),Ni.stop()};function Ft(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function ne(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const X=De.autoReset,fe=Oe.enabled,xe=Oe.autoUpdate,we=Oe.needsUpdate,be=Oe.type;ft(),De.autoReset=X,Oe.enabled=fe,Oe.autoUpdate=xe,Oe.needsUpdate=we,Oe.type=be}function Ye(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function je(X){const fe=X.target;fe.removeEventListener("dispose",je),Te(fe)}function Te(X){$e(X),Me.remove(X)}function $e(X){const fe=Me.get(X).programs;fe!==void 0&&(fe.forEach(function(xe){he.releaseProgram(xe)}),X.isShaderMaterial&&he.releaseShaderCache(X))}this.renderBufferDirect=function(X,fe,xe,we,be,tt){fe===null&&(fe=Ae);const lt=be.isMesh&&be.matrixWorld.determinant()<0,yt=u_(X,fe,xe,we,be);ge.setMaterial(we,lt);let xt=xe.index,Pt=1;if(we.wireframe===!0){if(xt=Y.getWireframeAttribute(xe),xt===void 0)return;Pt=2}const At=xe.drawRange,Rt=xe.attributes.position;let Pn=At.start*Pt,ki=(At.start+At.count)*Pt;tt!==null&&(Pn=Math.max(Pn,tt.start*Pt),ki=Math.min(ki,(tt.start+tt.count)*Pt)),xt!==null?(Pn=Math.max(Pn,0),ki=Math.min(ki,xt.count)):Rt!=null&&(Pn=Math.max(Pn,0),ki=Math.min(ki,Rt.count));const xn=ki-Pn;if(xn<0||xn===1/0)return;Mt.setup(be,we,yt,xe,xt);let Mi,wt=Wt;if(xt!==null&&(Mi=bt.get(xt),wt=Fe,wt.setIndex(Mi)),be.isMesh)we.wireframe===!0?(ge.setLineWidth(we.wireframeLinewidth*ae()),wt.setMode(W.LINES)):wt.setMode(W.TRIANGLES);else if(be.isLine){let st=we.linewidth;st===void 0&&(st=1),ge.setLineWidth(st*ae()),be.isLineSegments?wt.setMode(W.LINES):be.isLineLoop?wt.setMode(W.LINE_LOOP):wt.setMode(W.LINE_STRIP)}else be.isPoints?wt.setMode(W.POINTS):be.isSprite&&wt.setMode(W.TRIANGLES);if(be.isInstancedMesh)wt.renderInstances(Pn,xn,be.count);else if(xe.isInstancedBufferGeometry){const st=xe._maxInstanceCount!==void 0?xe._maxInstanceCount:1/0,ps=Math.min(xe.instanceCount,st);wt.renderInstances(Pn,xn,ps)}else wt.render(Pn,xn)};function vt(X,fe,xe){X.transparent===!0&&X.side===so&&X.forceSinglePass===!1?(X.side=Sr,X.needsUpdate=!0,Zc(X,fe,xe),X.side=Wa,X.needsUpdate=!0,Zc(X,fe,xe),X.side=so):Zc(X,fe,xe)}this.compile=function(X,fe,xe=null){xe===null&&(xe=X),y=Ie.get(xe),y.init(),_.push(y),xe.traverseVisible(function(be){be.isLight&&be.layers.test(fe.layers)&&(y.pushLight(be),be.castShadow&&y.pushShadow(be))}),X!==xe&&X.traverseVisible(function(be){be.isLight&&be.layers.test(fe.layers)&&(y.pushLight(be),be.castShadow&&y.pushShadow(be))}),y.setupLights(w._useLegacyLights);const we=new Set;return X.traverse(function(be){const tt=be.material;if(tt)if(Array.isArray(tt))for(let lt=0;lt<tt.length;lt++){const yt=tt[lt];vt(yt,xe,be),we.add(yt)}else vt(tt,xe,be),we.add(tt)}),_.pop(),y=null,we},this.compileAsync=function(X,fe,xe=null){const we=this.compile(X,fe,xe);return new Promise(be=>{function tt(){if(we.forEach(function(lt){Me.get(lt).currentProgram.isReady()&&we.delete(lt)}),we.size===0){be(X);return}setTimeout(tt,10)}ue.get("KHR_parallel_shader_compile")!==null?tt():setTimeout(tt,10)})};let Xt=null;function Cn(X){Xt&&Xt(X)}function or(){Ni.stop()}function dn(){Ni.start()}const Ni=new _F;Ni.setAnimationLoop(Cn),typeof self<"u"&&Ni.setContext(self),this.setAnimationLoop=function(X){Xt=X,Xe.setAnimationLoop(X),X===null?Ni.stop():Ni.start()},Xe.addEventListener("sessionstart",or),Xe.addEventListener("sessionend",dn),this.render=function(X,fe){if(fe!==void 0&&fe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),fe.parent===null&&fe.matrixWorldAutoUpdate===!0&&fe.updateMatrixWorld(),Xe.enabled===!0&&Xe.isPresenting===!0&&(Xe.cameraAutoUpdate===!0&&Xe.updateCamera(fe),fe=Xe.getCamera()),X.isScene===!0&&X.onBeforeRender(w,X,fe,T),y=Ie.get(X,_.length),y.init(),_.push(y),se.multiplyMatrices(fe.projectionMatrix,fe.matrixWorldInverse),te.setFromProjectionMatrix(se),J=this.localClippingEnabled,Q=rt.init(this.clippingPlanes,J),x=Le.get(X,v.length),x.init(),v.push(x),fs(X,fe,0,w.sortObjects),x.finish(),w.sortObjects===!0&&x.sort(N,V),this.info.render.frame++,Q===!0&&rt.beginShadows();const xe=y.state.shadowsArray;if(Oe.render(xe,X,fe),Q===!0&&rt.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ge.render(x,X),y.setupLights(w._useLegacyLights),fe.isArrayCamera){const we=fe.cameras;for(let be=0,tt=we.length;be<tt;be++){const lt=we[be];Af(x,X,lt,lt.viewport)}}else Af(x,X,fe);T!==null&&(Ce.updateMultisampleRenderTarget(T),Ce.updateRenderTargetMipmap(T)),X.isScene===!0&&X.onAfterRender(w,X,fe),Mt.resetDefaultState(),L=-1,P=null,_.pop(),_.length>0?y=_[_.length-1]:y=null,v.pop(),v.length>0?x=v[v.length-1]:x=null};function fs(X,fe,xe,we){if(X.visible===!1)return;if(X.layers.test(fe.layers)){if(X.isGroup)xe=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(fe);else if(X.isLight)y.pushLight(X),X.castShadow&&y.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||te.intersectsSprite(X)){we&&le.setFromMatrixPosition(X.matrixWorld).applyMatrix4(se);const lt=B.update(X),yt=X.material;yt.visible&&x.push(X,lt,yt,xe,le.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(!X.frustumCulled||te.intersectsObject(X))){const lt=B.update(X),yt=X.material;if(we&&(X.boundingSphere!==void 0?(X.boundingSphere===null&&X.computeBoundingSphere(),le.copy(X.boundingSphere.center)):(lt.boundingSphere===null&&lt.computeBoundingSphere(),le.copy(lt.boundingSphere.center)),le.applyMatrix4(X.matrixWorld).applyMatrix4(se)),Array.isArray(yt)){const xt=lt.groups;for(let Pt=0,At=xt.length;Pt<At;Pt++){const Rt=xt[Pt],Pn=yt[Rt.materialIndex];Pn&&Pn.visible&&x.push(X,lt,Pn,xe,le.z,Rt)}}else yt.visible&&x.push(X,lt,yt,xe,le.z,null)}}const tt=X.children;for(let lt=0,yt=tt.length;lt<yt;lt++)fs(tt[lt],fe,xe,we)}function Af(X,fe,xe,we){const be=X.opaque,tt=X.transmissive,lt=X.transparent;y.setupLightsView(xe),Q===!0&&rt.setGlobalState(w.clippingPlanes,xe),tt.length>0&&Ef(be,tt,fe,xe),we&&ge.viewport(C.copy(we)),be.length>0&&Yc(be,fe,xe),tt.length>0&&Yc(tt,fe,xe),lt.length>0&&Yc(lt,fe,xe),ge.buffers.depth.setTest(!0),ge.buffers.depth.setMask(!0),ge.buffers.color.setMask(!0),ge.setPolygonOffset(!1)}function Ef(X,fe,xe,we){if((xe.isScene===!0?xe.overrideMaterial:null)!==null)return;const tt=ce.isWebGL2;ie===null&&(ie=new js(1,1,{generateMipmaps:!0,type:ue.has("EXT_color_buffer_half_float")?ru:Jo,minFilter:iu,samples:tt?4:0})),w.getDrawingBufferSize(pe),tt?ie.setSize(pe.x,pe.y):ie.setSize(g1(pe.x),g1(pe.y));const lt=w.getRenderTarget();w.setRenderTarget(ie),w.getClearColor(G),k=w.getClearAlpha(),k<1&&w.setClearColor(16777215,.5),w.clear();const yt=w.toneMapping;w.toneMapping=Qo,Yc(X,xe,we),Ce.updateMultisampleRenderTarget(ie),Ce.updateRenderTargetMipmap(ie);let xt=!1;for(let Pt=0,At=fe.length;Pt<At;Pt++){const Rt=fe[Pt],Pn=Rt.object,ki=Rt.geometry,xn=Rt.material,Mi=Rt.group;if(xn.side===so&&Pn.layers.test(we.layers)){const wt=xn.side;xn.side=Sr,xn.needsUpdate=!0,el(Pn,xe,we,ki,xn,Mi),xn.side=wt,xn.needsUpdate=!0,xt=!0}}xt===!0&&(Ce.updateMultisampleRenderTarget(ie),Ce.updateRenderTargetMipmap(ie)),w.setRenderTarget(lt),w.setClearColor(G,k),w.toneMapping=yt}function Yc(X,fe,xe){const we=fe.isScene===!0?fe.overrideMaterial:null;for(let be=0,tt=X.length;be<tt;be++){const lt=X[be],yt=lt.object,xt=lt.geometry,Pt=we===null?lt.material:we,At=lt.group;yt.layers.test(xe.layers)&&el(yt,fe,xe,xt,Pt,At)}}function el(X,fe,xe,we,be,tt){X.onBeforeRender(w,fe,xe,we,be,tt),X.modelViewMatrix.multiplyMatrices(xe.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),be.onBeforeRender(w,fe,xe,we,X,tt),be.transparent===!0&&be.side===so&&be.forceSinglePass===!1?(be.side=Sr,be.needsUpdate=!0,w.renderBufferDirect(xe,fe,we,be,X,tt),be.side=Wa,be.needsUpdate=!0,w.renderBufferDirect(xe,fe,we,be,X,tt),be.side=so):w.renderBufferDirect(xe,fe,we,be,X,tt),X.onAfterRender(w,fe,xe,we,be,tt)}function Zc(X,fe,xe){fe.isScene!==!0&&(fe=Ae);const we=Me.get(X),be=y.state.lights,tt=y.state.shadowsArray,lt=be.state.version,yt=he.getParameters(X,be.state,tt,fe,xe),xt=he.getProgramCacheKey(yt);let Pt=we.programs;we.environment=X.isMeshStandardMaterial?fe.environment:null,we.fog=fe.fog,we.envMap=(X.isMeshStandardMaterial?He:ke).get(X.envMap||we.environment),Pt===void 0&&(X.addEventListener("dispose",je),Pt=new Map,we.programs=Pt);let At=Pt.get(xt);if(At!==void 0){if(we.currentProgram===At&&we.lightsStateVersion===lt)return Ug(X,yt),At}else yt.uniforms=he.getUniforms(X),X.onBuild(xe,yt,w),X.onBeforeCompile(yt,w),At=he.acquireProgram(yt,xt),Pt.set(xt,At),we.uniforms=yt.uniforms;const Rt=we.uniforms;return(!X.isShaderMaterial&&!X.isRawShaderMaterial||X.clipping===!0)&&(Rt.clippingPlanes=rt.uniform),Ug(X,yt),we.needsLights=h_(X),we.lightsStateVersion=lt,we.needsLights&&(Rt.ambientLightColor.value=be.state.ambient,Rt.lightProbe.value=be.state.probe,Rt.directionalLights.value=be.state.directional,Rt.directionalLightShadows.value=be.state.directionalShadow,Rt.spotLights.value=be.state.spot,Rt.spotLightShadows.value=be.state.spotShadow,Rt.rectAreaLights.value=be.state.rectArea,Rt.ltc_1.value=be.state.rectAreaLTC1,Rt.ltc_2.value=be.state.rectAreaLTC2,Rt.pointLights.value=be.state.point,Rt.pointLightShadows.value=be.state.pointShadow,Rt.hemisphereLights.value=be.state.hemi,Rt.directionalShadowMap.value=be.state.directionalShadowMap,Rt.directionalShadowMatrix.value=be.state.directionalShadowMatrix,Rt.spotShadowMap.value=be.state.spotShadowMap,Rt.spotLightMatrix.value=be.state.spotLightMatrix,Rt.spotLightMap.value=be.state.spotLightMap,Rt.pointShadowMap.value=be.state.pointShadowMap,Rt.pointShadowMatrix.value=be.state.pointShadowMatrix),we.currentProgram=At,we.uniformsList=null,At}function kg(X){if(X.uniformsList===null){const fe=X.currentProgram.getUniforms();X.uniformsList=Iy.seqWithValue(fe.seq,X.uniforms)}return X.uniformsList}function Ug(X,fe){const xe=Me.get(X);xe.outputColorSpace=fe.outputColorSpace,xe.instancing=fe.instancing,xe.instancingColor=fe.instancingColor,xe.skinning=fe.skinning,xe.morphTargets=fe.morphTargets,xe.morphNormals=fe.morphNormals,xe.morphColors=fe.morphColors,xe.morphTargetsCount=fe.morphTargetsCount,xe.numClippingPlanes=fe.numClippingPlanes,xe.numIntersection=fe.numClipIntersection,xe.vertexAlphas=fe.vertexAlphas,xe.vertexTangents=fe.vertexTangents,xe.toneMapping=fe.toneMapping}function u_(X,fe,xe,we,be){fe.isScene!==!0&&(fe=Ae),Ce.resetTextureUnits();const tt=fe.fog,lt=we.isMeshStandardMaterial?fe.environment:null,yt=T===null?w.outputColorSpace:T.isXRRenderTarget===!0?T.texture.colorSpace:yo,xt=(we.isMeshStandardMaterial?He:ke).get(we.envMap||lt),Pt=we.vertexColors===!0&&!!xe.attributes.color&&xe.attributes.color.itemSize===4,At=!!xe.attributes.tangent&&(!!we.normalMap||we.anisotropy>0),Rt=!!xe.morphAttributes.position,Pn=!!xe.morphAttributes.normal,ki=!!xe.morphAttributes.color;let xn=Qo;we.toneMapped&&(T===null||T.isXRRenderTarget===!0)&&(xn=w.toneMapping);const Mi=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,wt=Mi!==void 0?Mi.length:0,st=Me.get(we),ps=y.state.lights;if(Q===!0&&(J===!0||X!==P)){const Ei=X===P&&we.id===L;rt.setState(we,X,Ei)}let Gt=!1;we.version===st.__version?(st.needsLights&&st.lightsStateVersion!==ps.state.version||st.outputColorSpace!==yt||be.isInstancedMesh&&st.instancing===!1||!be.isInstancedMesh&&st.instancing===!0||be.isSkinnedMesh&&st.skinning===!1||!be.isSkinnedMesh&&st.skinning===!0||be.isInstancedMesh&&st.instancingColor===!0&&be.instanceColor===null||be.isInstancedMesh&&st.instancingColor===!1&&be.instanceColor!==null||st.envMap!==xt||we.fog===!0&&st.fog!==tt||st.numClippingPlanes!==void 0&&(st.numClippingPlanes!==rt.numPlanes||st.numIntersection!==rt.numIntersection)||st.vertexAlphas!==Pt||st.vertexTangents!==At||st.morphTargets!==Rt||st.morphNormals!==Pn||st.morphColors!==ki||st.toneMapping!==xn||ce.isWebGL2===!0&&st.morphTargetsCount!==wt)&&(Gt=!0):(Gt=!0,st.__version=we.version);let zn=st.currentProgram;Gt===!0&&(zn=Zc(we,fe,be));let Mo=!1,ms=!1,Ai=!1;const ri=zn.getUniforms(),Ao=st.uniforms;if(ge.useProgram(zn.program)&&(Mo=!0,ms=!0,Ai=!0),we.id!==L&&(L=we.id,ms=!0),Mo||P!==X){ri.setValue(W,"projectionMatrix",X.projectionMatrix),ri.setValue(W,"viewMatrix",X.matrixWorldInverse);const Ei=ri.map.cameraPosition;Ei!==void 0&&Ei.setValue(W,le.setFromMatrixPosition(X.matrixWorld)),ce.logarithmicDepthBuffer&&ri.setValue(W,"logDepthBufFC",2/(Math.log(X.far+1)/Math.LN2)),(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial)&&ri.setValue(W,"isOrthographic",X.isOrthographicCamera===!0),P!==X&&(P=X,ms=!0,Ai=!0)}if(be.isSkinnedMesh){ri.setOptional(W,be,"bindMatrix"),ri.setOptional(W,be,"bindMatrixInverse");const Ei=be.skeleton;Ei&&(ce.floatVertexTextures?(Ei.boneTexture===null&&Ei.computeBoneTexture(),ri.setValue(W,"boneTexture",Ei.boneTexture,Ce),ri.setValue(W,"boneTextureSize",Ei.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Kc=xe.morphAttributes;if((Kc.position!==void 0||Kc.normal!==void 0||Kc.color!==void 0&&ce.isWebGL2===!0)&&ot.update(be,xe,zn),(ms||st.receiveShadow!==be.receiveShadow)&&(st.receiveShadow=be.receiveShadow,ri.setValue(W,"receiveShadow",be.receiveShadow)),we.isMeshGouraudMaterial&&we.envMap!==null&&(Ao.envMap.value=xt,Ao.flipEnvMap.value=xt.isCubeTexture&&xt.isRenderTargetTexture===!1?-1:1),ms&&(ri.setValue(W,"toneMappingExposure",w.toneMappingExposure),st.needsLights&&c_(Ao,Ai),tt&&we.fog===!0&&Re.refreshFogUniforms(Ao,tt),Re.refreshMaterialUniforms(Ao,we,q,K,ie),Iy.upload(W,kg(st),Ao,Ce)),we.isShaderMaterial&&we.uniformsNeedUpdate===!0&&(Iy.upload(W,kg(st),Ao,Ce),we.uniformsNeedUpdate=!1),we.isSpriteMaterial&&ri.setValue(W,"center",be.center),ri.setValue(W,"modelViewMatrix",be.modelViewMatrix),ri.setValue(W,"normalMatrix",be.normalMatrix),ri.setValue(W,"modelMatrix",be.matrixWorld),we.isShaderMaterial||we.isRawShaderMaterial){const Ei=we.uniformsGroups;for(let Qc=0,qr=Ei.length;Qc<qr;Qc++)if(ce.isWebGL2){const zg=Ei[Qc];gt.update(zg,zn),gt.bind(zg,zn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return zn}function c_(X,fe){X.ambientLightColor.needsUpdate=fe,X.lightProbe.needsUpdate=fe,X.directionalLights.needsUpdate=fe,X.directionalLightShadows.needsUpdate=fe,X.pointLights.needsUpdate=fe,X.pointLightShadows.needsUpdate=fe,X.spotLights.needsUpdate=fe,X.spotLightShadows.needsUpdate=fe,X.rectAreaLights.needsUpdate=fe,X.hemisphereLights.needsUpdate=fe}function h_(X){return X.isMeshLambertMaterial||X.isMeshToonMaterial||X.isMeshPhongMaterial||X.isMeshStandardMaterial||X.isShadowMaterial||X.isShaderMaterial&&X.lights===!0}this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(X,fe,xe){Me.get(X.texture).__webglTexture=fe,Me.get(X.depthTexture).__webglTexture=xe;const we=Me.get(X);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=xe===void 0,we.__autoAllocateDepthBuffer||ue.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(X,fe){const xe=Me.get(X);xe.__webglFramebuffer=fe,xe.__useDefaultFramebuffer=fe===void 0},this.setRenderTarget=function(X,fe=0,xe=0){T=X,E=fe,A=xe;let we=!0,be=null,tt=!1,lt=!1;if(X){const xt=Me.get(X);xt.__useDefaultFramebuffer!==void 0?(ge.bindFramebuffer(W.FRAMEBUFFER,null),we=!1):xt.__webglFramebuffer===void 0?Ce.setupRenderTarget(X):xt.__hasExternalTextures&&Ce.rebindTextures(X,Me.get(X.texture).__webglTexture,Me.get(X.depthTexture).__webglTexture);const Pt=X.texture;(Pt.isData3DTexture||Pt.isDataArrayTexture||Pt.isCompressedArrayTexture)&&(lt=!0);const At=Me.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Array.isArray(At[fe])?be=At[fe][xe]:be=At[fe],tt=!0):ce.isWebGL2&&X.samples>0&&Ce.useMultisampledRTT(X)===!1?be=Me.get(X).__webglMultisampledFramebuffer:Array.isArray(At)?be=At[xe]:be=At,C.copy(X.viewport),D.copy(X.scissor),U=X.scissorTest}else C.copy(j).multiplyScalar(q).floor(),D.copy(z).multiplyScalar(q).floor(),U=$;if(ge.bindFramebuffer(W.FRAMEBUFFER,be)&&ce.drawBuffers&&we&&ge.drawBuffers(X,be),ge.viewport(C),ge.scissor(D),ge.setScissorTest(U),tt){const xt=Me.get(X.texture);W.framebufferTexture2D(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.TEXTURE_CUBE_MAP_POSITIVE_X+fe,xt.__webglTexture,xe)}else if(lt){const xt=Me.get(X.texture),Pt=fe||0;W.framebufferTextureLayer(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,xt.__webglTexture,xe||0,Pt)}L=-1},this.readRenderTargetPixels=function(X,fe,xe,we,be,tt,lt){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let yt=Me.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&lt!==void 0&&(yt=yt[lt]),yt){ge.bindFramebuffer(W.FRAMEBUFFER,yt);try{const xt=X.texture,Pt=xt.format,At=xt.type;if(Pt!==vr&&Qt.convert(Pt)!==W.getParameter(W.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Rt=At===ru&&(ue.has("EXT_color_buffer_half_float")||ce.isWebGL2&&ue.has("EXT_color_buffer_float"));if(At!==Jo&&Qt.convert(At)!==W.getParameter(W.IMPLEMENTATION_COLOR_READ_TYPE)&&!(At===rs&&(ce.isWebGL2||ue.has("OES_texture_float")||ue.has("WEBGL_color_buffer_float")))&&!Rt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}fe>=0&&fe<=X.width-we&&xe>=0&&xe<=X.height-be&&W.readPixels(fe,xe,we,be,Qt.convert(Pt),Qt.convert(At),tt)}finally{const xt=T!==null?Me.get(T).__webglFramebuffer:null;ge.bindFramebuffer(W.FRAMEBUFFER,xt)}}},this.copyFramebufferToTexture=function(X,fe,xe=0){const we=Math.pow(2,-xe),be=Math.floor(fe.image.width*we),tt=Math.floor(fe.image.height*we);Ce.setTexture2D(fe,0),W.copyTexSubImage2D(W.TEXTURE_2D,xe,0,0,X.x,X.y,be,tt),ge.unbindTexture()},this.copyTextureToTexture=function(X,fe,xe,we=0){const be=fe.image.width,tt=fe.image.height,lt=Qt.convert(xe.format),yt=Qt.convert(xe.type);Ce.setTexture2D(xe,0),W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,xe.flipY),W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),W.pixelStorei(W.UNPACK_ALIGNMENT,xe.unpackAlignment),fe.isDataTexture?W.texSubImage2D(W.TEXTURE_2D,we,X.x,X.y,be,tt,lt,yt,fe.image.data):fe.isCompressedTexture?W.compressedTexSubImage2D(W.TEXTURE_2D,we,X.x,X.y,fe.mipmaps[0].width,fe.mipmaps[0].height,lt,fe.mipmaps[0].data):W.texSubImage2D(W.TEXTURE_2D,we,X.x,X.y,lt,yt,fe.image),we===0&&xe.generateMipmaps&&W.generateMipmap(W.TEXTURE_2D),ge.unbindTexture()},this.copyTextureToTexture3D=function(X,fe,xe,we,be=0){if(w.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const tt=X.max.x-X.min.x+1,lt=X.max.y-X.min.y+1,yt=X.max.z-X.min.z+1,xt=Qt.convert(we.format),Pt=Qt.convert(we.type);let At;if(we.isData3DTexture)Ce.setTexture3D(we,0),At=W.TEXTURE_3D;else if(we.isDataArrayTexture)Ce.setTexture2DArray(we,0),At=W.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,we.flipY),W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),W.pixelStorei(W.UNPACK_ALIGNMENT,we.unpackAlignment);const Rt=W.getParameter(W.UNPACK_ROW_LENGTH),Pn=W.getParameter(W.UNPACK_IMAGE_HEIGHT),ki=W.getParameter(W.UNPACK_SKIP_PIXELS),xn=W.getParameter(W.UNPACK_SKIP_ROWS),Mi=W.getParameter(W.UNPACK_SKIP_IMAGES),wt=xe.isCompressedTexture?xe.mipmaps[0]:xe.image;W.pixelStorei(W.UNPACK_ROW_LENGTH,wt.width),W.pixelStorei(W.UNPACK_IMAGE_HEIGHT,wt.height),W.pixelStorei(W.UNPACK_SKIP_PIXELS,X.min.x),W.pixelStorei(W.UNPACK_SKIP_ROWS,X.min.y),W.pixelStorei(W.UNPACK_SKIP_IMAGES,X.min.z),xe.isDataTexture||xe.isData3DTexture?W.texSubImage3D(At,be,fe.x,fe.y,fe.z,tt,lt,yt,xt,Pt,wt.data):xe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),W.compressedTexSubImage3D(At,be,fe.x,fe.y,fe.z,tt,lt,yt,xt,wt.data)):W.texSubImage3D(At,be,fe.x,fe.y,fe.z,tt,lt,yt,xt,Pt,wt),W.pixelStorei(W.UNPACK_ROW_LENGTH,Rt),W.pixelStorei(W.UNPACK_IMAGE_HEIGHT,Pn),W.pixelStorei(W.UNPACK_SKIP_PIXELS,ki),W.pixelStorei(W.UNPACK_SKIP_ROWS,xn),W.pixelStorei(W.UNPACK_SKIP_IMAGES,Mi),be===0&&we.generateMipmaps&&W.generateMipmap(At),ge.unbindTexture()},this.initTexture=function(X){X.isCubeTexture?Ce.setTextureCube(X,0):X.isData3DTexture?Ce.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?Ce.setTexture2DArray(X,0):Ce.setTexture2D(X,0),ge.unbindTexture()},this.resetState=function(){E=0,A=0,T=null,ge.reset(),Mt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return qo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===wx?"display-p3":"srgb",n.unpackColorSpace=ln.workingColorSpace===mg?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ni?ea:Gd}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ea?ni:yo}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class TF extends XE{}TF.prototype.isWebGL1Renderer=!0;class Ax{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new We(e),this.density=n}clone(){return new Ax(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class gg{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new We(e),this.near=n,this.far=i}clone(){return new gg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let $d=class extends jt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}};class Ex{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=Fm,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=os()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ur=new O;class Mc{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)ur.fromBufferAttribute(this,n),ur.applyMatrix4(e),this.setXYZ(n,ur.x,ur.y,ur.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ur.fromBufferAttribute(this,n),ur.applyNormalMatrix(e),this.setXYZ(n,ur.x,ur.y,ur.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ur.fromBufferAttribute(this,n),ur.transformDirection(e),this.setXYZ(n,ur.x,ur.y,ur.z);return this}setX(e,n){return this.normalized&&(n=kt(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=kt(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=kt(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=kt(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=kr(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=kr(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=kr(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=kr(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array),s=kt(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new ht(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Mc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class YE extends Wi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new We(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Th;const rp=new O,Ch=new O,Ph=new O,Rh=new ee,sp=new ee,CF=new Ue,gv=new O,op=new O,vv=new O,oL=new ee,hS=new ee,aL=new ee;class PF extends jt{constructor(e=new YE){if(super(),this.isSprite=!0,this.type="Sprite",Th===void 0){Th=new Ke;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Ex(n,5);Th.setIndex([0,1,2,0,2,3]),Th.setAttribute("position",new Mc(i,3,0,!1)),Th.setAttribute("uv",new Mc(i,2,3,!1))}this.geometry=Th,this.material=e,this.center=new ee(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ch.setFromMatrixScale(this.matrixWorld),CF.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ph.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ch.multiplyScalar(-Ph.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;yv(gv.set(-.5,-.5,0),Ph,o,Ch,r,s),yv(op.set(.5,-.5,0),Ph,o,Ch,r,s),yv(vv.set(.5,.5,0),Ph,o,Ch,r,s),oL.set(0,0),hS.set(1,0),aL.set(1,1);let a=e.ray.intersectTriangle(gv,op,vv,!1,rp);if(a===null&&(yv(op.set(-.5,.5,0),Ph,o,Ch,r,s),hS.set(0,1),a=e.ray.intersectTriangle(gv,vv,op,!1,rp),a===null))return;const l=e.ray.origin.distanceTo(rp);l<e.near||l>e.far||n.push({distance:l,point:rp.clone(),uv:Bi.getInterpolation(rp,gv,op,vv,oL,hS,aL,new ee),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function yv(t,e,n,i,r,s){Rh.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(sp.x=s*Rh.x-r*Rh.y,sp.y=r*Rh.x+s*Rh.y):sp.copy(Rh),t.copy(e),t.x+=sp.x,t.y+=sp.y,t.applyMatrix4(CF)}const xv=new O,lL=new O;class RF extends jt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){xv.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(xv);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){xv.setFromMatrixPosition(e.matrixWorld),lL.setFromMatrixPosition(this.matrixWorld);const i=xv.distanceTo(lL)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const uL=new O,cL=new Ct,hL=new Ct,Xq=new O,dL=new Ue,_v=new O,dS=new Gi,fL=new Ue,fS=new Qa;class LF extends yi{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=OM,this.bindMatrix=new Ue,this.bindMatrixInverse=new Ue,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Hi),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,_v),this.boundingBox.expandByPoint(_v)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Gi),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,_v),this.boundingSphere.expandByPoint(_v)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),dS.copy(this.boundingSphere),dS.applyMatrix4(r),e.ray.intersectsSphere(dS)!==!1&&(fL.copy(r).invert(),fS.copy(e.ray).applyMatrix4(fL),!(this.boundingBox!==null&&fS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,fS)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ct,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===OM?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Vz?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;cL.fromBufferAttribute(r.attributes.skinIndex,e),hL.fromBufferAttribute(r.attributes.skinWeight,e),uL.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=hL.getComponent(s);if(o!==0){const a=cL.getComponent(s);dL.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(Xq.copy(uL).applyMatrix4(dL),o)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class Tx extends jt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Xo extends Tn{constructor(e=null,n=1,i=1,r,s,o,a,l,u=ti,d=ti,c,h){super(null,o,a,l,u,d,r,s,c,h),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const pL=new Ue,Yq=new Ue;class pf{constructor(e=[],n=[]){this.uuid=os(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ue)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Ue;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Yq;pL.multiplyMatrices(a,n[s]),pL.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new pf(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=hF(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new Xo(n,e,e,vr,rs);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=n[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Tx),this.bones.push(o),this.boneInverses.push(new Ue().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Ac extends ht{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Lh=new Ue,mL=new Ue,wv=[],gL=new Hi,Zq=new Ue,ap=new yi,lp=new Gi;class DF extends yi{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Ac(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Zq)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Hi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Lh),gL.copy(e.boundingBox).applyMatrix4(Lh),this.boundingBox.union(gL)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Gi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Lh),lp.copy(e.boundingSphere).applyMatrix4(Lh),this.boundingSphere.union(lp)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const i=this.matrixWorld,r=this.count;if(ap.geometry=this.geometry,ap.material=this.material,ap.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),lp.copy(this.boundingSphere),lp.applyMatrix4(i),e.ray.intersectsSphere(lp)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Lh),mL.multiplyMatrices(i,Lh),ap.matrixWorld=mL,ap.raycast(e,wv);for(let o=0,a=wv.length;o<a;o++){const l=wv[o];l.instanceId=s,l.object=this,n.push(l)}wv.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Ac(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class rr extends Wi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new We(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const vL=new O,yL=new O,xL=new Ue,pS=new Qa,Sv=new Gi;class su extends jt{constructor(e=new Ke,n=new rr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)vL.fromBufferAttribute(n,r-1),yL.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=vL.distanceTo(yL);e.setAttribute("lineDistance",new Ne(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Sv.copy(i.boundingSphere),Sv.applyMatrix4(r),Sv.radius+=s,e.ray.intersectsSphere(Sv)===!1)return;xL.copy(r).invert(),pS.copy(e.ray).applyMatrix4(xL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new O,d=new O,c=new O,h=new O,f=this.isLineSegments?2:1,m=i.index,y=i.attributes.position;if(m!==null){const v=Math.max(0,o.start),_=Math.min(m.count,o.start+o.count);for(let w=v,b=_-1;w<b;w+=f){const E=m.getX(w),A=m.getX(w+1);if(u.fromBufferAttribute(y,E),d.fromBufferAttribute(y,A),pS.distanceSqToSegment(u,d,h,c)>l)continue;h.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(h);L<e.near||L>e.far||n.push({distance:L,point:c.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),_=Math.min(y.count,o.start+o.count);for(let w=v,b=_-1;w<b;w+=f){if(u.fromBufferAttribute(y,w),d.fromBufferAttribute(y,w+1),pS.distanceSqToSegment(u,d,h,c)>l)continue;h.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(h);A<e.near||A>e.far||n.push({distance:A,point:c.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const _L=new O,wL=new O;class _o extends su{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)_L.fromBufferAttribute(n,r),wL.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+_L.distanceTo(wL);e.setAttribute("lineDistance",new Ne(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class IF extends su{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class ZE extends Wi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new We(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const SL=new Ue,h2=new Qa,bv=new Gi,Mv=new O;class OF extends jt{constructor(e=new Ke,n=new ZE){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),bv.copy(i.boundingSphere),bv.applyMatrix4(r),bv.radius+=s,e.ray.intersectsSphere(bv)===!1)return;SL.copy(r).invert(),h2.copy(e.ray).applyMatrix4(SL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,c=i.attributes.position;if(u!==null){const h=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let m=h,x=f;m<x;m++){const y=u.getX(m);Mv.fromBufferAttribute(c,y),bL(Mv,y,l,r,e,n,this)}}else{const h=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let m=h,x=f;m<x;m++)Mv.fromBufferAttribute(c,m),bL(Mv,m,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function bL(t,e,n,i,r,s,o){const a=h2.distanceSqToPoint(t);if(a<n){const l=new O;h2.closestPointToPoint(t,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class NF extends Tn{constructor(e,n,i,r,s,o,a,l,u){super(e,n,i,r,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:In,this.magFilter=s!==void 0?s:In,this.generateMipmaps=!1;const d=this;function c(){d.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Kq extends Tn{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=ti,this.minFilter=ti,this.generateMipmaps=!1,this.needsUpdate=!0}}class Cx extends Tn{constructor(e,n,i,r,s,o,a,l,u,d,c,h){super(null,o,a,l,u,d,r,s,c,h),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Qq extends Cx{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=tr}}class Jq extends Cx{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,ia),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class eX extends Tn{constructor(e,n,i,r,s,o,a,l,u){super(e,n,i,r,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class wo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const s=i.length;let o;n?o=n:o=e*i[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const d=i[r],h=i[r+1]-d,f=(o-d)/h;return(r+f)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new ee:new O);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new O,r=[],s=[],o=[],a=new O,l=new Ue;for(let f=0;f<=e;f++){const m=f/e;r[f]=this.getTangentAt(m,new O)}s[0]=new O,o[0]=new O;let u=Number.MAX_VALUE;const d=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z);d<=u&&(u=d,i.set(1,0,0)),c<=u&&(u=c,i.set(0,1,0)),h<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const m=Math.acos(Hn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,m))}o[f].crossVectors(r[f],s[f])}if(n===!0){let f=Math.acos(Hn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let m=1;m<=e;m++)s[m].applyMatrix4(l.makeRotationAxis(r[m],f*m)),o[m].crossVectors(r[m],s[m])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class vg extends wo{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n){const i=n||new ee,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=l-this.aX,f=u-this.aY;l=h*d-f*c+this.aX,u=h*c+f*d+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class kF extends vg{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function KE(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,d,c){let h=(o-s)/u-(a-s)/(u+d)+(a-o)/d,f=(a-o)/d-(l-o)/(d+c)+(l-a)/c;h*=d,f*=d,r(o,a,h,f)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const Av=new O,mS=new KE,gS=new KE,vS=new KE;class UF extends wo{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new O){const i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,d;this.closed||a>0?u=r[(a-1)%s]:(Av.subVectors(r[0],r[1]).add(r[0]),u=Av);const c=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(Av.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=Av),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let m=Math.pow(u.distanceToSquared(c),f),x=Math.pow(c.distanceToSquared(h),f),y=Math.pow(h.distanceToSquared(d),f);x<1e-4&&(x=1),m<1e-4&&(m=x),y<1e-4&&(y=x),mS.initNonuniformCatmullRom(u.x,c.x,h.x,d.x,m,x,y),gS.initNonuniformCatmullRom(u.y,c.y,h.y,d.y,m,x,y),vS.initNonuniformCatmullRom(u.z,c.z,h.z,d.z,m,x,y)}else this.curveType==="catmullrom"&&(mS.initCatmullRom(u.x,c.x,h.x,d.x,this.tension),gS.initCatmullRom(u.y,c.y,h.y,d.y,this.tension),vS.initCatmullRom(u.z,c.z,h.z,d.z,this.tension));return i.set(mS.calc(l),gS.calc(l),vS.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new O().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ML(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function tX(t,e){const n=1-t;return n*n*e}function nX(t,e){return 2*(1-t)*t*e}function iX(t,e){return t*t*e}function Qp(t,e,n,i){return tX(t,e)+nX(t,n)+iX(t,i)}function rX(t,e){const n=1-t;return n*n*n*e}function sX(t,e){const n=1-t;return 3*n*n*t*e}function oX(t,e){return 3*(1-t)*t*t*e}function aX(t,e){return t*t*t*e}function Jp(t,e,n,i,r){return rX(t,e)+sX(t,n)+oX(t,i)+aX(t,r)}class zs extends wo{constructor(e=new ee,n=new ee,i=new ee,r=new ee){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new ee){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Jp(e,r.x,s.x,o.x,a.x),Jp(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class em extends wo{constructor(e=new O,n=new O,i=new O,r=new O){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new O){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Jp(e,r.x,s.x,o.x,a.x),Jp(e,r.y,s.y,o.y,a.y),Jp(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ho extends wo{constructor(e=new ee,n=new ee){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new ee){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ee){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QE extends wo{constructor(e=new O,n=new O){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new O){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new O){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qa extends wo{constructor(e=new ee,n=new ee,i=new ee){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ee){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Qp(e,r.x,s.x,o.x),Qp(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JE extends wo{constructor(e=new O,n=new O,i=new O){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new O){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Qp(e,r.x,s.x,o.x),Qp(e,r.y,s.y,o.y),Qp(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Px extends wo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new ee){const i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],d=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return i.set(ML(a,l.x,u.x,d.x,c.x),ML(a,l.y,u.y,d.y,c.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new ee().fromArray(r))}return this}}var v1=Object.freeze({__proto__:null,ArcCurve:kF,CatmullRomCurve3:UF,CubicBezierCurve:zs,CubicBezierCurve3:em,EllipseCurve:vg,LineCurve:ho,LineCurve3:QE,QuadraticBezierCurve:qa,QuadraticBezierCurve3:JE,SplineCurve:Px});class eT extends wo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new v1[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const d=l[u];i&&i.equals(d)||(n.push(d),i=d)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new v1[r.type]().fromJSON(r))}return this}}class Ec extends eT{constructor(e){super(),this.type="Path",this.currentPoint=new ee,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new ho(this.currentPoint.clone(),new ee(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new qa(this.currentPoint.clone(),new ee(e,n),new ee(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){const a=new zs(this.currentPoint.clone(),new ee(e,n),new ee(i,r),new ee(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new Px(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+u,n+d,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){const u=new vg(e,n,i,r,s,o,a,l);if(this.curves.length>0){const c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);const d=u.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class mf extends Ke{constructor(e=[new ee(0,-.5),new ee(.5,0),new ee(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Hn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],d=1/n,c=new O,h=new ee,f=new O,m=new O,x=new O;let y=0,v=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:y=e[_+1].x-e[_].x,v=e[_+1].y-e[_].y,f.x=v*1,f.y=-y,f.z=v*0,x.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(x.x,x.y,x.z);break;default:y=e[_+1].x-e[_].x,v=e[_+1].y-e[_].y,f.x=v*1,f.y=-y,f.z=v*0,m.copy(f),f.x+=x.x,f.y+=x.y,f.z+=x.z,f.normalize(),l.push(f.x,f.y,f.z),x.copy(m)}for(let _=0;_<=n;_++){const w=i+_*d*r,b=Math.sin(w),E=Math.cos(w);for(let A=0;A<=e.length-1;A++){c.x=e[A].x*b,c.y=e[A].y,c.z=e[A].x*E,o.push(c.x,c.y,c.z),h.x=_/n,h.y=A/(e.length-1),a.push(h.x,h.y);const T=l[3*A+0]*b,L=l[3*A+1],P=l[3*A+0]*E;u.push(T,L,P)}}for(let _=0;_<n;_++)for(let w=0;w<e.length-1;w++){const b=w+_*e.length,E=b,A=b+e.length,T=b+e.length+1,L=b+1;s.push(E,A,L),s.push(T,L,A)}this.setIndex(s),this.setAttribute("position",new Ne(o,3)),this.setAttribute("uv",new Ne(a,2)),this.setAttribute("normal",new Ne(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mf(e.points,e.segments,e.phiStart,e.phiLength)}}class Rx extends mf{constructor(e=1,n=1,i=4,r=8){const s=new Ec;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:n,capSegments:i,radialSegments:r}}static fromJSON(e){return new Rx(e.radius,e.length,e.capSegments,e.radialSegments)}}class Lx extends Ke{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],o=[],a=[],l=[],u=new O,d=new ee;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let c=0,h=3;c<=n;c++,h+=3){const f=i+c/n*r;u.x=e*Math.cos(f),u.y=e*Math.sin(f),o.push(u.x,u.y,u.z),a.push(0,0,1),d.x=(o[h]/e+1)/2,d.y=(o[h+1]/e+1)/2,l.push(d.x,d.y)}for(let c=1;c<=n;c++)s.push(c,c+1,0);this.setIndex(s),this.setAttribute("position",new Ne(o,3)),this.setAttribute("normal",new Ne(a,3)),this.setAttribute("uv",new Ne(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lx(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class zc extends Ke{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const d=[],c=[],h=[],f=[];let m=0;const x=[],y=i/2;let v=0;_(),o===!1&&(e>0&&w(!0),n>0&&w(!1)),this.setIndex(d),this.setAttribute("position",new Ne(c,3)),this.setAttribute("normal",new Ne(h,3)),this.setAttribute("uv",new Ne(f,2));function _(){const b=new O,E=new O;let A=0;const T=(n-e)/i;for(let L=0;L<=s;L++){const P=[],C=L/s,D=C*(n-e)+e;for(let U=0;U<=r;U++){const G=U/r,k=G*l+a,H=Math.sin(k),K=Math.cos(k);E.x=D*H,E.y=-C*i+y,E.z=D*K,c.push(E.x,E.y,E.z),b.set(H,T,K).normalize(),h.push(b.x,b.y,b.z),f.push(G,1-C),P.push(m++)}x.push(P)}for(let L=0;L<r;L++)for(let P=0;P<s;P++){const C=x[P][L],D=x[P+1][L],U=x[P+1][L+1],G=x[P][L+1];d.push(C,D,G),d.push(D,U,G),A+=6}u.addGroup(v,A,0),v+=A}function w(b){const E=m,A=new ee,T=new O;let L=0;const P=b===!0?e:n,C=b===!0?1:-1;for(let U=1;U<=r;U++)c.push(0,y*C,0),h.push(0,C,0),f.push(.5,.5),m++;const D=m;for(let U=0;U<=r;U++){const k=U/r*l+a,H=Math.cos(k),K=Math.sin(k);T.x=P*K,T.y=y*C,T.z=P*H,c.push(T.x,T.y,T.z),h.push(0,C,0),A.x=H*.5+.5,A.y=K*.5*C+.5,f.push(A.x,A.y),m++}for(let U=0;U<r;U++){const G=E+U,k=D+U;b===!0?d.push(k,k+1,G):d.push(k+1,k,G),L+=3}u.addGroup(v,L,b===!0?1:2),v+=L}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class yg extends zc{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new yg(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class pu extends Ke{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],o=[];a(r),u(i),d(),this.setAttribute("position",new Ne(s,3)),this.setAttribute("normal",new Ne(s.slice(),3)),this.setAttribute("uv",new Ne(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(_){const w=new O,b=new O,E=new O;for(let A=0;A<n.length;A+=3)f(n[A+0],w),f(n[A+1],b),f(n[A+2],E),l(w,b,E,_)}function l(_,w,b,E){const A=E+1,T=[];for(let L=0;L<=A;L++){T[L]=[];const P=_.clone().lerp(b,L/A),C=w.clone().lerp(b,L/A),D=A-L;for(let U=0;U<=D;U++)U===0&&L===A?T[L][U]=P:T[L][U]=P.clone().lerp(C,U/D)}for(let L=0;L<A;L++)for(let P=0;P<2*(A-L)-1;P++){const C=Math.floor(P/2);P%2===0?(h(T[L][C+1]),h(T[L+1][C]),h(T[L][C])):(h(T[L][C+1]),h(T[L+1][C+1]),h(T[L+1][C]))}}function u(_){const w=new O;for(let b=0;b<s.length;b+=3)w.x=s[b+0],w.y=s[b+1],w.z=s[b+2],w.normalize().multiplyScalar(_),s[b+0]=w.x,s[b+1]=w.y,s[b+2]=w.z}function d(){const _=new O;for(let w=0;w<s.length;w+=3){_.x=s[w+0],_.y=s[w+1],_.z=s[w+2];const b=y(_)/2/Math.PI+.5,E=v(_)/Math.PI+.5;o.push(b,1-E)}m(),c()}function c(){for(let _=0;_<o.length;_+=6){const w=o[_+0],b=o[_+2],E=o[_+4],A=Math.max(w,b,E),T=Math.min(w,b,E);A>.9&&T<.1&&(w<.2&&(o[_+0]+=1),b<.2&&(o[_+2]+=1),E<.2&&(o[_+4]+=1))}}function h(_){s.push(_.x,_.y,_.z)}function f(_,w){const b=_*3;w.x=e[b+0],w.y=e[b+1],w.z=e[b+2]}function m(){const _=new O,w=new O,b=new O,E=new O,A=new ee,T=new ee,L=new ee;for(let P=0,C=0;P<s.length;P+=9,C+=6){_.set(s[P+0],s[P+1],s[P+2]),w.set(s[P+3],s[P+4],s[P+5]),b.set(s[P+6],s[P+7],s[P+8]),A.set(o[C+0],o[C+1]),T.set(o[C+2],o[C+3]),L.set(o[C+4],o[C+5]),E.copy(_).add(w).add(b).divideScalar(3);const D=y(E);x(A,C+0,_,D),x(T,C+2,w,D),x(L,C+4,b,D)}}function x(_,w,b,E){E<0&&_.x===1&&(o[w]=_.x-1),b.x===0&&b.z===0&&(o[w]=E/2/Math.PI+.5)}function y(_){return Math.atan2(_.z,-_.x)}function v(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pu(e.vertices,e.indices,e.radius,e.details)}}class xg extends pu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new xg(e.radius,e.detail)}}const Ev=new O,Tv=new O,yS=new O,Cv=new Bi;class zF extends Ke{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(dc*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],d=["a","b","c"],c=new Array(3),h={},f=[];for(let m=0;m<l;m+=3){o?(u[0]=o.getX(m),u[1]=o.getX(m+1),u[2]=o.getX(m+2)):(u[0]=m,u[1]=m+1,u[2]=m+2);const{a:x,b:y,c:v}=Cv;if(x.fromBufferAttribute(a,u[0]),y.fromBufferAttribute(a,u[1]),v.fromBufferAttribute(a,u[2]),Cv.getNormal(yS),c[0]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,c[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,c[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let _=0;_<3;_++){const w=(_+1)%3,b=c[_],E=c[w],A=Cv[d[_]],T=Cv[d[w]],L=`${b}_${E}`,P=`${E}_${b}`;P in h&&h[P]?(yS.dot(h[P].normal)<=s&&(f.push(A.x,A.y,A.z),f.push(T.x,T.y,T.z)),h[P]=null):L in h||(h[L]={index0:u[_],index1:u[w],normal:yS.clone()})}}for(const m in h)if(h[m]){const{index0:x,index1:y}=h[m];Ev.fromBufferAttribute(a,x),Tv.fromBufferAttribute(a,y),f.push(Ev.x,Ev.y,Ev.z),f.push(Tv.x,Tv.y,Tv.z)}this.setAttribute("position",new Ne(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class fo extends Ec{constructor(e){super(e),this.uuid=os(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new Ec().fromJSON(r))}return this}}const lX={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=FF(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,d,c,h,f;if(i&&(s=fX(t,e,s,n)),t.length>80*n){a=u=t[0],l=d=t[1];for(let m=n;m<r;m+=n)c=t[m],h=t[m+1],c<a&&(a=c),h<l&&(l=h),c>u&&(u=c),h>d&&(d=h);f=Math.max(u-a,d-l),f=f!==0?32767/f:0}return jm(s,o,n,a,l,f,0),o}};function FF(t,e,n,i,r){let s,o;if(r===MX(t,e,n,i)>0)for(s=e;s<n;s+=i)o=AL(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=AL(s,t[s],t[s+1],o);return o&&Dx(o,o.next)&&(Hm(o),o=o.next),o}function Tc(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(Dx(n,n.next)||On(n.prev,n,n.next)===0)){if(Hm(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function jm(t,e,n,i,r,s,o){if(!t)return;!o&&s&&yX(t,i,r,s);let a=t,l,u;for(;t.prev!==t.next;){if(l=t.prev,u=t.next,s?cX(t,i,r,s):uX(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),Hm(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=hX(Tc(t),e,n),jm(t,e,n,i,r,s,2)):o===2&&dX(t,e,n,i,r,s):jm(Tc(t),e,n,i,r,s,1);break}}}function uX(t){const e=t.prev,n=t,i=t.next;if(On(e,n,i)>=0)return!1;const r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,u=i.y,d=r<s?r<o?r:o:s<o?s:o,c=a<l?a<u?a:u:l<u?l:u,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>u?a:u:l>u?l:u;let m=i.next;for(;m!==e;){if(m.x>=d&&m.x<=h&&m.y>=c&&m.y<=f&&ud(r,a,s,l,o,u,m.x,m.y)&&On(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function cX(t,e,n,i){const r=t.prev,s=t,o=t.next;if(On(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,d=r.y,c=s.y,h=o.y,f=a<l?a<u?a:u:l<u?l:u,m=d<c?d<h?d:h:c<h?c:h,x=a>l?a>u?a:u:l>u?l:u,y=d>c?d>h?d:h:c>h?c:h,v=d2(f,m,e,n,i),_=d2(x,y,e,n,i);let w=t.prevZ,b=t.nextZ;for(;w&&w.z>=v&&b&&b.z<=_;){if(w.x>=f&&w.x<=x&&w.y>=m&&w.y<=y&&w!==r&&w!==o&&ud(a,d,l,c,u,h,w.x,w.y)&&On(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=f&&b.x<=x&&b.y>=m&&b.y<=y&&b!==r&&b!==o&&ud(a,d,l,c,u,h,b.x,b.y)&&On(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=v;){if(w.x>=f&&w.x<=x&&w.y>=m&&w.y<=y&&w!==r&&w!==o&&ud(a,d,l,c,u,h,w.x,w.y)&&On(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=_;){if(b.x>=f&&b.x<=x&&b.y>=m&&b.y<=y&&b!==r&&b!==o&&ud(a,d,l,c,u,h,b.x,b.y)&&On(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function hX(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!Dx(r,s)&&BF(r,i,i.next,s)&&Gm(r,s)&&Gm(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),Hm(i),Hm(i.next),i=t=s),i=i.next}while(i!==t);return Tc(i)}function dX(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&wX(o,a)){let l=VF(o,a);o=Tc(o,o.next),l=Tc(l,l.next),jm(o,e,n,i,r,s,0),jm(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function fX(t,e,n,i){const r=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,u=FF(t,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(_X(u));for(r.sort(pX),s=0;s<r.length;s++)n=mX(r[s],n);return n}function pX(t,e){return t.x-e.x}function mX(t,e){const n=gX(t,e);if(!n)return e;const i=VF(n,t);return Tc(i,i.next),Tc(n,n.next)}function gX(t,e){let n=e,i=-1/0,r;const s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const h=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=s&&h>i&&(i=h,r=n.x<n.next.x?n:n.next,h===s))return r}n=n.next}while(n!==e);if(!r)return null;const a=r,l=r.x,u=r.y;let d=1/0,c;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&ud(o<u?s:i,o,l,u,o<u?i:s,o,n.x,n.y)&&(c=Math.abs(o-n.y)/(s-n.x),Gm(n,t)&&(c<d||c===d&&(n.x>r.x||n.x===r.x&&vX(r,n)))&&(r=n,d=c)),n=n.next;while(n!==a);return r}function vX(t,e){return On(t.prev,t,e.prev)<0&&On(e.next,t,t.next)<0}function yX(t,e,n,i){let r=t;do r.z===0&&(r.z=d2(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,xX(r)}function xX(t){let e,n,i,r,s,o,a,l,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1);return t}function d2(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function _X(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ud(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function wX(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!SX(t,e)&&(Gm(t,e)&&Gm(e,t)&&bX(t,e)&&(On(t.prev,t,e.prev)||On(t,e.prev,e))||Dx(t,e)&&On(t.prev,t,t.next)>0&&On(e.prev,e,e.next)>0)}function On(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Dx(t,e){return t.x===e.x&&t.y===e.y}function BF(t,e,n,i){const r=Rv(On(t,e,n)),s=Rv(On(t,e,i)),o=Rv(On(n,i,t)),a=Rv(On(n,i,e));return!!(r!==s&&o!==a||r===0&&Pv(t,n,e)||s===0&&Pv(t,i,e)||o===0&&Pv(n,t,i)||a===0&&Pv(n,e,i))}function Pv(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Rv(t){return t>0?1:t<0?-1:0}function SX(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&BF(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Gm(t,e){return On(t.prev,t,t.next)<0?On(t,e,t.next)>=0&&On(t,t.prev,e)>=0:On(t,e,t.prev)<0||On(t,t.next,e)<0}function bX(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function VF(t,e){const n=new f2(t.i,t.x,t.y),i=new f2(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function AL(t,e,n,i){const r=new f2(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Hm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function f2(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function MX(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class po{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return po.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];EL(e),TL(i,e);let o=e.length;n.forEach(EL);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,TL(i,n[l]);const a=lX.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function EL(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function TL(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Ix extends Ke{constructor(e=new fo([new ee(.5,.5),new ee(-.5,.5),new ee(-.5,-.5),new ee(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new Ne(r,3)),this.setAttribute("uv",new Ne(s,2)),this.computeVertexNormals();function o(a){const l=[],u=n.curveSegments!==void 0?n.curveSegments:12,d=n.steps!==void 0?n.steps:1,c=n.depth!==void 0?n.depth:1;let h=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,m=n.bevelSize!==void 0?n.bevelSize:f-.1,x=n.bevelOffset!==void 0?n.bevelOffset:0,y=n.bevelSegments!==void 0?n.bevelSegments:3;const v=n.extrudePath,_=n.UVGenerator!==void 0?n.UVGenerator:AX;let w,b=!1,E,A,T,L;v&&(w=v.getSpacedPoints(d),b=!0,h=!1,E=v.computeFrenetFrames(d,!1),A=new O,T=new O,L=new O),h||(y=0,f=0,m=0,x=0);const P=a.extractPoints(u);let C=P.shape;const D=P.holes;if(!po.isClockWise(C)){C=C.reverse();for(let W=0,me=D.length;W<me;W++){const ue=D[W];po.isClockWise(ue)&&(D[W]=ue.reverse())}}const G=po.triangulateShape(C,D),k=C;for(let W=0,me=D.length;W<me;W++){const ue=D[W];C=C.concat(ue)}function H(W,me,ue){return me||console.error("THREE.ExtrudeGeometry: vec does not exist"),W.clone().addScaledVector(me,ue)}const K=C.length,q=G.length;function N(W,me,ue){let ce,ge,De;const Me=W.x-me.x,Ce=W.y-me.y,ke=ue.x-W.x,He=ue.y-W.y,bt=Me*Me+Ce*Ce,Y=Me*He-Ce*ke;if(Math.abs(Y)>Number.EPSILON){const B=Math.sqrt(bt),he=Math.sqrt(ke*ke+He*He),Re=me.x-Ce/B,Le=me.y+Me/B,Ie=ue.x-He/he,rt=ue.y+ke/he,Oe=((Ie-Re)*He-(rt-Le)*ke)/(Me*He-Ce*ke);ce=Re+Me*Oe-W.x,ge=Le+Ce*Oe-W.y;const Ge=ce*ce+ge*ge;if(Ge<=2)return new ee(ce,ge);De=Math.sqrt(Ge/2)}else{let B=!1;Me>Number.EPSILON?ke>Number.EPSILON&&(B=!0):Me<-Number.EPSILON?ke<-Number.EPSILON&&(B=!0):Math.sign(Ce)===Math.sign(He)&&(B=!0),B?(ce=-Ce,ge=Me,De=Math.sqrt(bt)):(ce=Me,ge=Ce,De=Math.sqrt(bt/2))}return new ee(ce/De,ge/De)}const V=[];for(let W=0,me=k.length,ue=me-1,ce=W+1;W<me;W++,ue++,ce++)ue===me&&(ue=0),ce===me&&(ce=0),V[W]=N(k[W],k[ue],k[ce]);const j=[];let z,$=V.concat();for(let W=0,me=D.length;W<me;W++){const ue=D[W];z=[];for(let ce=0,ge=ue.length,De=ge-1,Me=ce+1;ce<ge;ce++,De++,Me++)De===ge&&(De=0),Me===ge&&(Me=0),z[ce]=N(ue[ce],ue[De],ue[Me]);j.push(z),$=$.concat(z)}for(let W=0;W<y;W++){const me=W/y,ue=f*Math.cos(me*Math.PI/2),ce=m*Math.sin(me*Math.PI/2)+x;for(let ge=0,De=k.length;ge<De;ge++){const Me=H(k[ge],V[ge],ce);se(Me.x,Me.y,-ue)}for(let ge=0,De=D.length;ge<De;ge++){const Me=D[ge];z=j[ge];for(let Ce=0,ke=Me.length;Ce<ke;Ce++){const He=H(Me[Ce],z[Ce],ce);se(He.x,He.y,-ue)}}}const te=m+x;for(let W=0;W<K;W++){const me=h?H(C[W],$[W],te):C[W];b?(T.copy(E.normals[0]).multiplyScalar(me.x),A.copy(E.binormals[0]).multiplyScalar(me.y),L.copy(w[0]).add(T).add(A),se(L.x,L.y,L.z)):se(me.x,me.y,0)}for(let W=1;W<=d;W++)for(let me=0;me<K;me++){const ue=h?H(C[me],$[me],te):C[me];b?(T.copy(E.normals[W]).multiplyScalar(ue.x),A.copy(E.binormals[W]).multiplyScalar(ue.y),L.copy(w[W]).add(T).add(A),se(L.x,L.y,L.z)):se(ue.x,ue.y,c/d*W)}for(let W=y-1;W>=0;W--){const me=W/y,ue=f*Math.cos(me*Math.PI/2),ce=m*Math.sin(me*Math.PI/2)+x;for(let ge=0,De=k.length;ge<De;ge++){const Me=H(k[ge],V[ge],ce);se(Me.x,Me.y,c+ue)}for(let ge=0,De=D.length;ge<De;ge++){const Me=D[ge];z=j[ge];for(let Ce=0,ke=Me.length;Ce<ke;Ce++){const He=H(Me[Ce],z[Ce],ce);b?se(He.x,He.y+w[d-1].y,w[d-1].x+ue):se(He.x,He.y,c+ue)}}}Q(),J();function Q(){const W=r.length/3;if(h){let me=0,ue=K*me;for(let ce=0;ce<q;ce++){const ge=G[ce];pe(ge[2]+ue,ge[1]+ue,ge[0]+ue)}me=d+y*2,ue=K*me;for(let ce=0;ce<q;ce++){const ge=G[ce];pe(ge[0]+ue,ge[1]+ue,ge[2]+ue)}}else{for(let me=0;me<q;me++){const ue=G[me];pe(ue[2],ue[1],ue[0])}for(let me=0;me<q;me++){const ue=G[me];pe(ue[0]+K*d,ue[1]+K*d,ue[2]+K*d)}}i.addGroup(W,r.length/3-W,0)}function J(){const W=r.length/3;let me=0;ie(k,me),me+=k.length;for(let ue=0,ce=D.length;ue<ce;ue++){const ge=D[ue];ie(ge,me),me+=ge.length}i.addGroup(W,r.length/3-W,1)}function ie(W,me){let ue=W.length;for(;--ue>=0;){const ce=ue;let ge=ue-1;ge<0&&(ge=W.length-1);for(let De=0,Me=d+y*2;De<Me;De++){const Ce=K*De,ke=K*(De+1),He=me+ce+Ce,bt=me+ge+Ce,Y=me+ge+ke,B=me+ce+ke;le(He,bt,Y,B)}}}function se(W,me,ue){l.push(W),l.push(me),l.push(ue)}function pe(W,me,ue){Ae(W),Ae(me),Ae(ue);const ce=r.length/3,ge=_.generateTopUV(i,r,ce-3,ce-2,ce-1);ae(ge[0]),ae(ge[1]),ae(ge[2])}function le(W,me,ue,ce){Ae(W),Ae(me),Ae(ce),Ae(me),Ae(ue),Ae(ce);const ge=r.length/3,De=_.generateSideWallUV(i,r,ge-6,ge-3,ge-2,ge-1);ae(De[0]),ae(De[1]),ae(De[3]),ae(De[1]),ae(De[2]),ae(De[3])}function Ae(W){r.push(l[W*3+0]),r.push(l[W*3+1]),r.push(l[W*3+2])}function ae(W){s.push(W.x),s.push(W.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return EX(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new v1[r.type]().fromJSON(r)),new Ix(i,e.options)}}const AX={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],d=e[r*3+1];return[new ee(s,o),new ee(a,l),new ee(u,d)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],u=e[i*3],d=e[i*3+1],c=e[i*3+2],h=e[r*3],f=e[r*3+1],m=e[r*3+2],x=e[s*3],y=e[s*3+1],v=e[s*3+2];return Math.abs(a-d)<Math.abs(o-u)?[new ee(o,1-l),new ee(u,1-c),new ee(h,1-m),new ee(x,1-v)]:[new ee(a,1-l),new ee(d,1-c),new ee(f,1-m),new ee(y,1-v)]}};function EX(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class _g extends pu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new _g(e.radius,e.detail)}}class wg extends pu{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new wg(e.radius,e.detail)}}class Ox extends Ke{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],u=[],d=[];let c=e;const h=(n-e)/r,f=new O,m=new ee;for(let x=0;x<=r;x++){for(let y=0;y<=i;y++){const v=s+y/i*o;f.x=c*Math.cos(v),f.y=c*Math.sin(v),l.push(f.x,f.y,f.z),u.push(0,0,1),m.x=(f.x/n+1)/2,m.y=(f.y/n+1)/2,d.push(m.x,m.y)}c+=h}for(let x=0;x<r;x++){const y=x*(i+1);for(let v=0;v<i;v++){const _=v+y,w=_,b=_+i+1,E=_+i+2,A=_+1;a.push(w,b,A),a.push(b,E,A)}}this.setIndex(a),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ox(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Nx extends Ke{constructor(e=new fo([new ee(0,.5),new ee(-.5,-.5),new ee(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let d=0;d<e.length;d++)u(e[d]),this.addGroup(a,l,d),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new Ne(r,3)),this.setAttribute("normal",new Ne(s,3)),this.setAttribute("uv",new Ne(o,2));function u(d){const c=r.length/3,h=d.extractPoints(n);let f=h.shape;const m=h.holes;po.isClockWise(f)===!1&&(f=f.reverse());for(let y=0,v=m.length;y<v;y++){const _=m[y];po.isClockWise(_)===!0&&(m[y]=_.reverse())}const x=po.triangulateShape(f,m);for(let y=0,v=m.length;y<v;y++){const _=m[y];f=f.concat(_)}for(let y=0,v=f.length;y<v;y++){const _=f[y];r.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let y=0,v=x.length;y<v;y++){const _=x[y],w=_[0]+c,b=_[1]+c,E=_[2]+c;i.push(w,b,E),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return TX(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=n[e.shapes[r]];i.push(o)}return new Nx(i,e.curveSegments)}}function TX(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class gf extends Ke{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const d=[],c=new O,h=new O,f=[],m=[],x=[],y=[];for(let v=0;v<=i;v++){const _=[],w=v/i;let b=0;v===0&&o===0?b=.5/n:v===i&&l===Math.PI&&(b=-.5/n);for(let E=0;E<=n;E++){const A=E/n;c.x=-e*Math.cos(r+A*s)*Math.sin(o+w*a),c.y=e*Math.cos(o+w*a),c.z=e*Math.sin(r+A*s)*Math.sin(o+w*a),m.push(c.x,c.y,c.z),h.copy(c).normalize(),x.push(h.x,h.y,h.z),y.push(A+b,1-w),_.push(u++)}d.push(_)}for(let v=0;v<i;v++)for(let _=0;_<n;_++){const w=d[v][_+1],b=d[v][_],E=d[v+1][_],A=d[v+1][_+1];(v!==0||o>0)&&f.push(w,b,A),(v!==i-1||l<Math.PI)&&f.push(b,E,A)}this.setIndex(f),this.setAttribute("position",new Ne(m,3)),this.setAttribute("normal",new Ne(x,3)),this.setAttribute("uv",new Ne(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gf(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class kx extends pu{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new kx(e.radius,e.detail)}}class Ux extends Ke{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],u=[],d=new O,c=new O,h=new O;for(let f=0;f<=i;f++)for(let m=0;m<=r;m++){const x=m/r*s,y=f/i*Math.PI*2;c.x=(e+n*Math.cos(y))*Math.cos(x),c.y=(e+n*Math.cos(y))*Math.sin(x),c.z=n*Math.sin(y),a.push(c.x,c.y,c.z),d.x=e*Math.cos(x),d.y=e*Math.sin(x),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(m/r),u.push(f/i)}for(let f=1;f<=i;f++)for(let m=1;m<=r;m++){const x=(r+1)*f+m-1,y=(r+1)*(f-1)+m-1,v=(r+1)*(f-1)+m,_=(r+1)*f+m;o.push(x,y,_),o.push(y,v,_)}this.setIndex(o),this.setAttribute("position",new Ne(a,3)),this.setAttribute("normal",new Ne(l,3)),this.setAttribute("uv",new Ne(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ux(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Sg extends Ke{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],u=[],d=[],c=new O,h=new O,f=new O,m=new O,x=new O,y=new O,v=new O;for(let w=0;w<=i;++w){const b=w/i*s*Math.PI*2;_(b,s,o,e,f),_(b+.01,s,o,e,m),y.subVectors(m,f),v.addVectors(m,f),x.crossVectors(y,v),v.crossVectors(x,y),x.normalize(),v.normalize();for(let E=0;E<=r;++E){const A=E/r*Math.PI*2,T=-n*Math.cos(A),L=n*Math.sin(A);c.x=f.x+(T*v.x+L*x.x),c.y=f.y+(T*v.y+L*x.y),c.z=f.z+(T*v.z+L*x.z),l.push(c.x,c.y,c.z),h.subVectors(c,f).normalize(),u.push(h.x,h.y,h.z),d.push(w/i),d.push(E/r)}}for(let w=1;w<=i;w++)for(let b=1;b<=r;b++){const E=(r+1)*(w-1)+(b-1),A=(r+1)*w+(b-1),T=(r+1)*w+b,L=(r+1)*(w-1)+b;a.push(E,A,L),a.push(A,T,L)}this.setIndex(a),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2));function _(w,b,E,A,T){const L=Math.cos(w),P=Math.sin(w),C=E/b*w,D=Math.cos(C);T.x=A*(2+D)*.5*L,T.y=A*(2+D)*P*.5,T.z=A*Math.sin(C)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sg(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class zx extends Ke{constructor(e=new JE(new O(-1,-1,0),new O(-1,1,0),new O(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new O,l=new O,u=new ee;let d=new O;const c=[],h=[],f=[],m=[];x(),this.setIndex(m),this.setAttribute("position",new Ne(c,3)),this.setAttribute("normal",new Ne(h,3)),this.setAttribute("uv",new Ne(f,2));function x(){for(let w=0;w<n;w++)y(w);y(s===!1?n:0),_(),v()}function y(w){d=e.getPointAt(w/n,d);const b=o.normals[w],E=o.binormals[w];for(let A=0;A<=r;A++){const T=A/r*Math.PI*2,L=Math.sin(T),P=-Math.cos(T);l.x=P*b.x+L*E.x,l.y=P*b.y+L*E.y,l.z=P*b.z+L*E.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=d.x+i*l.x,a.y=d.y+i*l.y,a.z=d.z+i*l.z,c.push(a.x,a.y,a.z)}}function v(){for(let w=1;w<=n;w++)for(let b=1;b<=r;b++){const E=(r+1)*(w-1)+(b-1),A=(r+1)*w+(b-1),T=(r+1)*w+b,L=(r+1)*(w-1)+b;m.push(E,A,L),m.push(A,T,L)}}function _(){for(let w=0;w<=n;w++)for(let b=0;b<=r;b++)u.x=w/n,u.y=b/r,f.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new zx(new v1[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class jF extends Ke{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new O,s=new O;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,d=l.length;u<d;++u){const c=l[u],h=c.start,f=c.count;for(let m=h,x=h+f;m<x;m+=3)for(let y=0;y<3;y++){const v=a.getX(m+y),_=a.getX(m+(y+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,_),CL(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const d=3*a+u,c=3*a+(u+1)%3;r.fromBufferAttribute(o,d),s.fromBufferAttribute(o,c),CL(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ne(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function CL(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var PL=Object.freeze({__proto__:null,BoxGeometry:us,CapsuleGeometry:Rx,CircleGeometry:Lx,ConeGeometry:yg,CylinderGeometry:zc,DodecahedronGeometry:xg,EdgesGeometry:zF,ExtrudeGeometry:Ix,IcosahedronGeometry:_g,LatheGeometry:mf,OctahedronGeometry:wg,PlaneGeometry:Uc,PolyhedronGeometry:pu,RingGeometry:Ox,ShapeGeometry:Nx,SphereGeometry:gf,TetrahedronGeometry:kx,TorusGeometry:Ux,TorusKnotGeometry:Sg,TubeGeometry:zx,WireframeGeometry:jF});class GF extends Wi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new We(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class HF extends Gs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class tT extends Wi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new We(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class WF extends tT{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ee(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Hn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new We(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new We(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new We(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class $F extends Wi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new We(16777215),this.specular=new We(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class qF extends Wi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new We(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class XF extends Wi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class YF extends Wi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new We(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ZF extends Wi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new We(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fu,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class KF extends rr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function oc(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function QF(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function JF(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function p2(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function nT(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function CX(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],d=u.getValueSize(),c=[],h=[];for(let f=0;f<u.times.length;++f){const m=u.times[f]*r;if(!(m<n||m>=i)){c.push(u.times[f]);for(let x=0;x<d;++x)h.push(u.values[f*d+x])}}c.length!==0&&(u.times=oc(c,u.times.constructor),u.values=oc(h,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function PX(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=t.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(u===void 0)continue;let d=0;const c=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=c/3);let h=0;const f=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const m=a.times.length-1;let x;if(s<=a.times[0]){const v=d,_=c-d;x=a.values.slice(v,_)}else if(s>=a.times[m]){const v=m*c+d,_=v+c-d;x=a.values.slice(v,_)}else{const v=a.createInterpolant(),_=d,w=c-d;v.evaluate(s),x=v.resultBuffer.slice(_,w)}l==="quaternion"&&new xi().fromArray(x).normalize().conjugate().toArray(x);const y=u.times.length;for(let v=0;v<y;++v){const _=v*f+h;if(l==="quaternion")xi.multiplyQuaternionsFlat(u.values,_,x,0,u.values,_);else{const w=f-h*2;for(let b=0;b<w;++b)u.values[_+b]-=x[b]}}}return t.blendMode=FE,t}const RX={convertArray:oc,isTypedArray:QF,getKeyframeOrder:JF,sortedArray:p2,flattenJSON:nT,subclip:CX,makeClipAdditive:PX};class bg{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class e4 extends bg{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ic,endingEnd:ic}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case rc:s=e,a=2*n-i;break;case Nm:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case rc:o=e,l=2*i-n;break;case Nm:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}const u=(i-n)*.5,d=this.valueSize;this._weightPrev=u/(n-a),this._weightNext=u/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(i-n)/(r-n),x=m*m,y=x*m,v=-h*y+2*h*x-h*m,_=(1+h)*y+(-1.5-2*h)*x+(-.5+h)*m+1,w=(-1-f)*y+(1.5+f)*x+.5*m,b=f*y-f*x;for(let E=0;E!==a;++E)s[E]=v*o[d+E]+_*o[u+E]+w*o[l+E]+b*o[c+E];return s}}class iT extends bg{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=(i-n)/(r-n),c=1-d;for(let h=0;h!==a;++h)s[h]=o[u+h]*c+o[l+h]*d;return s}}class t4 extends bg{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class So{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=oc(n,this.TimeBufferType),this.values=oc(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:oc(e.times,Array),values:oc(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new t4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iT(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new e4(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Im:n=this.InterpolantFactoryMethodDiscrete;break;case Om:n=this.InterpolantFactoryMethodLinear;break;case Dy:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Im;case this.InterpolantFactoryMethodLinear:return Om;case this.InterpolantFactoryMethodSmooth:return Dy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&QF(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Dy,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(r)l=!0;else{const c=a*i,h=c-i,f=c+i;for(let m=0;m!==i;++m){const x=n[c+m];if(x!==n[h+m]||x!==n[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const c=a*i,h=o*i;for(let f=0;f!==i;++f)n[h+f]=n[c+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,u=0;u!==i;++u)n[l+u]=n[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}So.prototype.TimeBufferType=Float32Array;So.prototype.ValueBufferType=Float32Array;So.prototype.DefaultInterpolation=Om;class Fc extends So{}Fc.prototype.ValueTypeName="bool";Fc.prototype.ValueBufferType=Array;Fc.prototype.DefaultInterpolation=Im;Fc.prototype.InterpolantFactoryMethodLinear=void 0;Fc.prototype.InterpolantFactoryMethodSmooth=void 0;class rT extends So{}rT.prototype.ValueTypeName="color";class Wm extends So{}Wm.prototype.ValueTypeName="number";class n4 extends bg{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n);let u=e*a;for(let d=u+a;u!==d;u+=4)xi.slerpFlat(s,0,o,u-a,o,u,l);return s}}class vf extends So{InterpolantFactoryMethodLinear(e){return new n4(this.times,this.values,this.getValueSize(),e)}}vf.prototype.ValueTypeName="quaternion";vf.prototype.DefaultInterpolation=Om;vf.prototype.InterpolantFactoryMethodSmooth=void 0;class Bc extends So{}Bc.prototype.ValueTypeName="string";Bc.prototype.ValueBufferType=Array;Bc.prototype.DefaultInterpolation=Im;Bc.prototype.InterpolantFactoryMethodLinear=void 0;Bc.prototype.InterpolantFactoryMethodSmooth=void 0;class $m extends So{}$m.prototype.ValueTypeName="vector";class qm{constructor(e,n=-1,i,r=_x){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=os(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(DX(i[o]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)n.push(So.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=JF(l);l=p2(l,1,d),u=p2(u,1,d),!r&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new Wm(".morphTargetInfluences["+n[a].name+"]",l,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const c=d[1];let h=r[c];h||(r[c]=h=[]),h.push(u)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(c,h,f,m,x){if(f.length!==0){const y=[],v=[];nT(f,y,v,m),y.length!==0&&x.push(new c(h,y,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let c=0;c<u.length;c++){const h=u[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const f={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let x=0;x<h[m].morphTargets.length;x++)f[h[m].morphTargets[x]]=-1;for(const x in f){const y=[],v=[];for(let _=0;_!==h[m].morphTargets.length;++_){const w=h[m];y.push(w.time),v.push(w.morphTarget===x?1:0)}r.push(new Wm(".morphTargetInfluence["+x+"]",y,v))}l=f.length*o}else{const f=".bones["+n[c].name+"]";i($m,f+".position",h,"pos",r),i(vf,f+".quaternion",h,"rot",r),i($m,f+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function LX(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Wm;case"vector":case"vector2":case"vector3":case"vector4":return $m;case"color":return rT;case"quaternion":return vf;case"bool":case"boolean":return Fc;case"string":return Bc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function DX(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=LX(t.type);if(t.times===void 0){const n=[],i=[];nT(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Cc={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class sT{constructor(e,n,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,c){return u.push(d,c),this},this.removeHandler=function(d){const c=u.indexOf(d);return c!==-1&&u.splice(c,2),this},this.getHandler=function(d){for(let c=0,h=u.length;c<h;c+=2){const f=u[c],m=u[c+1];if(f.global&&(f.lastIndex=0),f.test(d))return m}return null}}}const i4=new sT;class sr{constructor(e){this.manager=e!==void 0?e:i4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}sr.DEFAULT_MATERIAL_NAME="__DEFAULT";const xa={};class IX extends Error{constructor(e,n){super(e),this.response=n}}class Hs extends sr{constructor(e){super(e)}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Cc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(xa[e]!==void 0){xa[e].push({onLoad:n,onProgress:i,onError:r});return}xa[e]=[],xa[e].push({onLoad:n,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=xa[e],c=u.body.getReader(),h=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),f=h?parseInt(h):0,m=f!==0;let x=0;const y=new ReadableStream({start(v){_();function _(){c.read().then(({done:w,value:b})=>{if(w)v.close();else{x+=b.byteLength;const E=new ProgressEvent("progress",{lengthComputable:m,loaded:x,total:f});for(let A=0,T=d.length;A<T;A++){const L=d[A];L.onProgress&&L.onProgress(E)}v.enqueue(b),_()}})}}});return new Response(y)}else throw new IX(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const c=/charset="?([^;"\s]*)"?/i.exec(a),h=c&&c[1]?c[1].toLowerCase():void 0,f=new TextDecoder(h);return u.arrayBuffer().then(m=>f.decode(m))}}}).then(u=>{Cc.add(e,u);const d=xa[e];delete xa[e];for(let c=0,h=d.length;c<h;c++){const f=d[c];f.onLoad&&f.onLoad(u)}}).catch(u=>{const d=xa[e];if(d===void 0)throw this.manager.itemError(e),u;delete xa[e];for(let c=0,h=d.length;c<h;c++){const f=d[c];f.onError&&f.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class OX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Hs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=qm.parse(e[i]);n.push(r)}return n}}class NX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=[],a=new Cx,l=new Hs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function d(c){l.load(e[c],function(h){const f=s.parse(h,!0);o[c]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},u+=1,u===6&&(f.mipmapCount===1&&(a.minFilter=In),a.image=o,a.format=f.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let c=0,h=e.length;c<h;++c)d(c);else l.load(e,function(c){const h=s.parse(c,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let m=0;m<f;m++){o[m]={mipmaps:[]};for(let x=0;x<h.mipmapCount;x++)o[m].mipmaps.push(h.mipmaps[m*h.mipmapCount+x]),o[m].format=h.format,o[m].width=h.width,o[m].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=In),a.format=h.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}}class Xm extends sr{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Cc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a=Vm("img");function l(){d(),Cc.add(e,this),n&&n(this),s.manager.itemEnd(e)}function u(c){d(),r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class kX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=new hf;s.colorSpace=ni;const o=new Xm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(d){s.images[u]=d,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let u=0;u<e.length;++u)l(u);return s}}class UX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Xo,a=new Hs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let u;try{u=s.parse(l)}catch(d){if(r!==void 0)r(d);else{console.error(d);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:tr,o.wrapT=u.wrapT!==void 0?u.wrapT:tr,o.magFilter=u.magFilter!==void 0?u.magFilter:In,o.minFilter=u.minFilter!==void 0?u.minFilter:In,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0?o.colorSpace=u.colorSpace:u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=iu),u.mipmapCount===1&&(o.minFilter=In),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,n&&n(o,u)},i,r),o}}class zX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=new Tn,o=new Xm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class Ja extends jt{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new We(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class oT extends Ja{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(jt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new We(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const xS=new Ue,RL=new O,LL=new O;class aT{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ee(512,512),this.map=null,this.mapPass=null,this.matrix=new Ue,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new bx,this._frameExtents=new ee(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;RL.setFromMatrixPosition(e.matrixWorld),n.position.copy(RL),LL.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(LL),n.updateMatrixWorld(),xS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xS),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(xS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class FX extends aT{constructor(){super(new gi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Hd*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class lT extends Ja{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(jt.DEFAULT_UP),this.updateMatrix(),this.target=new jt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new FX}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const DL=new Ue,up=new O,_S=new O;class BX extends aT{constructor(){super(new gi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ee(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new O(1,0,0),new O(-1,0,0),new O(0,0,1),new O(0,0,-1),new O(0,1,0),new O(0,-1,0)],this._cubeUps=[new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,0,1),new O(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),up.setFromMatrixPosition(e.matrixWorld),i.position.copy(up),_S.copy(i.position),_S.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(_S),i.updateMatrixWorld(),r.makeTranslation(-up.x,-up.y,-up.z),DL.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(DL)}}class uT extends Ja{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new BX}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class VX extends aT{constructor(){super(new df(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class cT extends Ja{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(jt.DEFAULT_UP),this.updateMatrix(),this.target=new jt,this.shadow=new VX}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class r4 extends Ja{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class s4 extends Ja{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class o4{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new O)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class a4 extends Ja{constructor(e=new o4,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class Fx extends sr{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,o=new Hs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=Fx.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new We().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new We().setHex(o.value);break;case"v2":r.uniforms[s].value=new ee().fromArray(o.value);break;case"v3":r.uniforms[s].value=new O().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Ct().fromArray(o.value);break;case"m3":r.uniforms[s].value=new St().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Ue().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new ee().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new ee().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:GF,SpriteMaterial:YE,RawShaderMaterial:HF,ShaderMaterial:Gs,PointsMaterial:ZE,MeshPhysicalMaterial:WF,MeshStandardMaterial:tT,MeshPhongMaterial:$F,MeshToonMaterial:qF,MeshNormalMaterial:XF,MeshLambertMaterial:YF,MeshDepthMaterial:WE,MeshDistanceMaterial:$E,MeshBasicMaterial:oa,MeshMatcapMaterial:ZF,LineDashedMaterial:KF,LineBasicMaterial:rr,Material:Wi};return new n[e]}}class m2{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class hT extends Ke{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Bx extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Hs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(f,m){if(n[m]!==void 0)return n[m];const y=f.interleavedBuffers[m],v=s(f,y.buffer),_=ad(y.type,v),w=new Ex(_,y.stride);return w.uuid=y.uuid,n[m]=w,w}function s(f,m){if(i[m]!==void 0)return i[m];const y=f.arrayBuffers[m],v=new Uint32Array(y).buffer;return i[m]=v,v}const o=e.isInstancedBufferGeometry?new hT:new Ke,a=e.data.index;if(a!==void 0){const f=ad(a.type,a.array);o.setIndex(new ht(f,1))}const l=e.data.attributes;for(const f in l){const m=l[f];let x;if(m.isInterleavedBufferAttribute){const y=r(e.data,m.data);x=new Mc(y,m.itemSize,m.offset,m.normalized)}else{const y=ad(m.type,m.array),v=m.isInstancedBufferAttribute?Ac:ht;x=new v(y,m.itemSize,m.normalized)}m.name!==void 0&&(x.name=m.name),m.usage!==void 0&&x.setUsage(m.usage),m.updateRange!==void 0&&(x.updateRange.offset=m.updateRange.offset,x.updateRange.count=m.updateRange.count),o.setAttribute(f,x)}const u=e.data.morphAttributes;if(u)for(const f in u){const m=u[f],x=[];for(let y=0,v=m.length;y<v;y++){const _=m[y];let w;if(_.isInterleavedBufferAttribute){const b=r(e.data,_.data);w=new Mc(b,_.itemSize,_.offset,_.normalized)}else{const b=ad(_.type,_.array);w=new ht(b,_.itemSize,_.normalized)}_.name!==void 0&&(w.name=_.name),x.push(w)}o.morphAttributes[f]=x}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let f=0,m=c.length;f!==m;++f){const x=c[f];o.addGroup(x.start,x.count,x.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const f=new O;h.center!==void 0&&f.fromArray(h.center),o.boundingSphere=new Gi(f,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class jX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?m2.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Hs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(c){r!==void 0&&r(c),console.error("THREE:ObjectLoader: Can't parse "+e+".",c.message);return}const d=u.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?m2.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Hs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,i),d=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,d),n!==void 0){let c=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){c=!0;break}c===!1&&n(u)}return u}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new fo().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new pf().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new Bx;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in PL?a=PL[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new Fx;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=qm.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return o(d)}else return l.data?{data:ad(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new sT(n);s=new Xm(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,d=e.length;u<d;u++){const c=e[u],h=c.url;if(Array.isArray(h)){const f=[];for(let m=0,x=h.length;m<x;m++){const y=h[m],v=a(y);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new Xo(v.data,v.width,v.height)))}r[c.uuid]=new sc(f)}else{const f=a(c.url);r[c.uuid]=new sc(f)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:ad(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Xm(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const d=[];for(let c=0,h=u.length;c<h;c++){const f=u[c],m=await s(f);m!==null&&(m instanceof HTMLImageElement?d.push(m):d.push(new Xo(m.data,m.width,m.height)))}i[l.uuid]=new sc(d)}else{const d=await s(l.url);i[l.uuid]=new sc(d)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=n[a.image],u=l.data;let d;Array.isArray(u)?(d=new hf,u.length===6&&(d.needsUpdate=!0)):(u&&u.data?d=new Xo:d=new Tn,u&&(d.needsUpdate=!0)),d.source=l,d.uuid=a.uuid,a.name!==void 0&&(d.name=a.name),a.mapping!==void 0&&(d.mapping=i(a.mapping,GX)),a.channel!==void 0&&(d.channel=a.channel),a.offset!==void 0&&d.offset.fromArray(a.offset),a.repeat!==void 0&&d.repeat.fromArray(a.repeat),a.center!==void 0&&d.center.fromArray(a.center),a.rotation!==void 0&&(d.rotation=a.rotation),a.wrap!==void 0&&(d.wrapS=i(a.wrap[0],IL),d.wrapT=i(a.wrap[1],IL)),a.format!==void 0&&(d.format=a.format),a.internalFormat!==void 0&&(d.internalFormat=a.internalFormat),a.type!==void 0&&(d.type=a.type),a.colorSpace!==void 0&&(d.colorSpace=a.colorSpace),a.encoding!==void 0&&(d.encoding=a.encoding),a.minFilter!==void 0&&(d.minFilter=i(a.minFilter,OL)),a.magFilter!==void 0&&(d.magFilter=i(a.magFilter,OL)),a.anisotropy!==void 0&&(d.anisotropy=a.anisotropy),a.flipY!==void 0&&(d.flipY=a.flipY),a.generateMipmaps!==void 0&&(d.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(d.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(d.compareFunction=a.compareFunction),a.userData!==void 0&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,n,i,r,s){let o;function a(h){return n[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),n[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const f=[];for(let m=0,x=h.length;m<x;m++){const y=h[m];i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),f.push(i[y])}return f}return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),i[h]}}function u(h){return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),r[h]}let d,c;switch(e.type){case"Scene":o=new $d,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new We(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new gg(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Ax(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new gi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new df(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new r4(e.color,e.intensity);break;case"DirectionalLight":o=new cT(e.color,e.intensity);break;case"PointLight":o=new uT(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new s4(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new lT(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new oT(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new a4().fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),c=l(e.material),o=new LF(d,c),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),c=l(e.material),o=new yi(d,c);break;case"InstancedMesh":d=a(e.geometry),c=l(e.material);const h=e.count,f=e.instanceMatrix,m=e.instanceColor;o=new DF(d,c,h),o.instanceMatrix=new Ac(new Float32Array(f.array),16),m!==void 0&&(o.instanceColor=new Ac(new Float32Array(m.array),m.itemSize));break;case"LOD":o=new RF;break;case"Line":o=new su(a(e.geometry),l(e.material));break;case"LineLoop":o=new IF(a(e.geometry),l(e.material));break;case"LineSegments":o=new _o(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new OF(a(e.geometry),l(e.material));break;case"Sprite":o=new PF(l(e.material));break;case"Group":o=new Ll;break;case"Bone":o=new Tx;break;default:o=new jt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let f=0;f<h.length;f++)o.add(this.parseObject(h[f],n,i,r,s))}if(e.animations!==void 0){const h=e.animations;for(let f=0;f<h.length;f++){const m=h[f];o.animations.push(s[m])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const m=h[f],x=o.getObjectByProperty("uuid",m.object);x!==void 0&&o.addLevel(x,m.distance,m.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const GX={UVMapping:vx,CubeReflectionMapping:ia,CubeRefractionMapping:$a,EquirectangularReflectionMapping:Pm,EquirectangularRefractionMapping:Rm,CubeUVReflectionMapping:Oc},IL={RepeatWrapping:Lm,ClampToEdgeWrapping:tr,MirroredRepeatWrapping:Dm},OL={NearestFilter:ti,NearestMipmapNearestFilter:f1,NearestMipmapLinearFilter:Yp,LinearFilter:In,LinearMipmapNearestFilter:IE,LinearMipmapLinearFilter:iu};class HX extends sr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Cc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Cc.add(e,l),n&&n(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Lv,dT=class{static getContext(){return Lv===void 0&&(Lv=new(window.AudioContext||window.webkitAudioContext)),Lv}static setContext(e){Lv=e}};class WX extends sr{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Hs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);dT.getContext().decodeAudioData(u,function(c){n(c)},a)}catch(u){a(u)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const NL=new Ue,kL=new Ue,Ru=new Ue;class $X{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new gi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new gi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Ru.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(dc*n.fov*.5)/n.zoom;let a,l;kL.elements[12]=-r,NL.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,Ru.elements[0]=2*n.near/(l-a),Ru.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Ru),a=-o*n.aspect-s,l=o*n.aspect-s,Ru.elements[0]=2*n.near/(l-a),Ru.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Ru)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(kL),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(NL)}}class fT{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=UL(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=UL();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function UL(){return(typeof performance>"u"?Date:performance).now()}const Lu=new O,zL=new xi,qX=new O,Du=new O;class XX extends jt{constructor(){super(),this.type="AudioListener",this.context=dT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fT}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Lu,zL,qX),Du.set(0,0,-1).applyQuaternion(zL),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Lu.x,r),n.positionY.linearRampToValueAtTime(Lu.y,r),n.positionZ.linearRampToValueAtTime(Lu.z,r),n.forwardX.linearRampToValueAtTime(Du.x,r),n.forwardY.linearRampToValueAtTime(Du.y,r),n.forwardZ.linearRampToValueAtTime(Du.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(Lu.x,Lu.y,Lu.z),n.setOrientation(Du.x,Du.y,Du.z,i.x,i.y,i.z)}}let l4=class extends jt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Iu=new O,FL=new xi,YX=new O,Ou=new O;class ZX extends l4{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Iu,FL,YX),Ou.set(0,0,1).applyQuaternion(FL);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Iu.x,i),n.positionY.linearRampToValueAtTime(Iu.y,i),n.positionZ.linearRampToValueAtTime(Iu.z,i),n.orientationX.linearRampToValueAtTime(Ou.x,i),n.orientationY.linearRampToValueAtTime(Ou.y,i),n.orientationZ.linearRampToValueAtTime(Ou.z,i)}else n.setPosition(Iu.x,Iu.y,Iu.z),n.setOrientation(Ou.x,Ou.y,Ou.z)}}class KX{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class u4{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,u=n+n;l!==u;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){xi.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const o=this._workIndex*s;xi.multiplyQuaternionsFlat(e,o,e,n,e,i),xi.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[i+o]*r}}}const pT="\\[\\]\\.:\\/",QX=new RegExp("["+pT+"]","g"),mT="[^"+pT+"]",JX="[^"+pT.replace("\\.","")+"]",eY=/((?:WC+[\/:])*)/.source.replace("WC",mT),tY=/(WCOD+)?/.source.replace("WCOD",JX),nY=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",mT),iY=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",mT),rY=new RegExp("^"+eY+tY+nY+iY+"$"),sY=["material","materials","bones","map"];class oY{constructor(e,n,i){const r=i||Zt.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Zt{constructor(e,n,i){this.path=n,this.parsedPath=i||Zt.parseTrackName(n),this.node=Zt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Zt.Composite(e,n,i):new Zt(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(QX,"")}static parseTrackName(e){const n=rY.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);sY.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Zt.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[r];if(o===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Zt.Composite=oY;Zt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zt.prototype.GetterByBindingType=[Zt.prototype._getValue_direct,Zt.prototype._getValue_array,Zt.prototype._getValue_arrayElement,Zt.prototype._getValue_toArray];Zt.prototype.SetterByBindingTypeAndVersioning=[[Zt.prototype._setValue_direct,Zt.prototype._setValue_direct_setNeedsUpdate,Zt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_array,Zt.prototype._setValue_array_setNeedsUpdate,Zt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_arrayElement,Zt.prototype._setValue_arrayElement_setNeedsUpdate,Zt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_fromArray,Zt.prototype._setValue_fromArray_setNeedsUpdate,Zt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class aY{constructor(){this.isAnimationObjectGroup=!0,this.uuid=os(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let d=0,c=arguments.length;d!==c;++d){const h=arguments[d],f=h.uuid;let m=n[f];if(m===void 0){m=l++,n[f]=m,e.push(h);for(let x=0,y=o;x!==y;++x)s[x].push(new Zt(h,i[x],r[x]))}else if(m<u){a=e[m];const x=--u,y=e[x];n[y.uuid]=m,e[m]=y,n[f]=x,e[x]=h;for(let v=0,_=o;v!==_;++v){const w=s[v],b=w[x];let E=w[m];w[m]=b,E===void 0&&(E=new Zt(h,i[v],r[v])),w[x]=E}}else e[m]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,d=n[u];if(d!==void 0&&d>=s){const c=s++,h=e[c];n[h.uuid]=d,e[d]=h,n[u]=c,e[c]=l;for(let f=0,m=r;f!==m;++f){const x=i[f],y=x[c],v=x[d];x[d]=y,x[c]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],d=u.uuid,c=n[d];if(c!==void 0)if(delete n[d],c<s){const h=--s,f=e[h],m=--o,x=e[m];n[f.uuid]=c,e[c]=f,n[x.uuid]=h,e[h]=x,e.pop();for(let y=0,v=r;y!==v;++y){const _=i[y],w=_[h],b=_[m];_[c]=w,_[h]=b,_.pop()}}else{const h=--o,f=e[h];h>0&&(n[f.uuid]=c),e[c]=f,e.pop();for(let m=0,x=r;m!==x;++m){const y=i[m];y[c]=y[h],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,d=this.nCachedObjects_,c=new Array(u);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(c);for(let h=d,f=l.length;h!==f;++h){const m=l[h];c[h]=new Zt(m,e,n)}return c}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];n[u]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class c4{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:ic,endingEnd:ic};for(let u=0;u!==o;++u){const d=s[u].createInterpolant(null);a[u]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Kz,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+i,u[0]=e/o,u[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case FE:for(let d=0,c=l.length;d!==c;++d)l[d].evaluate(o),u[d].accumulateAdditive(a);break;case _x:default:for(let d=0,c=l.length;d!==c;++d)l[d].evaluate(o),u[d].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===Qz;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===Zz){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=rc,r.endingEnd=rc):(e?r.endingStart=this.zeroSlopeAtStart?rc:ic:r.endingStart=Nm,n?r.endingEnd=this.zeroSlopeAtEnd?rc:ic:r.endingEnd=Nm)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}}const lY=new Float32Array(1);class uY extends sa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,u=this._bindingsByRootAndName;let d=u[l];d===void 0&&(d={},u[l]=d);for(let c=0;c!==s;++c){const h=r[c],f=h.name;let m=d[f];if(m!==void 0)++m.referenceCount,o[c]=m;else{if(m=o[c],m!==void 0){m._cacheIndex===null&&(++m.referenceCount,this._addInactiveBinding(m,l,f));continue}const x=n&&n._propertyBindings[c].binding.parsedPath;m=new u4(Zt.create(i,f,x),h.ValueTypeName,h.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,l,f),o[c]=m}a[c].resultBuffer=m.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],d=e._byClipCacheIndex;u._byClipCacheIndex=d,l[d]=u,l.pop(),e._byClipCacheIndex=null;const c=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],u=e._cacheIndex;l._cacheIndex=u,n[u]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new iT(new Float32Array(2),new Float32Array(2),1,lY),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let o=typeof e=="string"?qm.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(i===void 0&&(o!==null?i=o.blendMode:i=_x),l!==void 0){const c=l.actionByRoot[s];if(c!==void 0&&c.blendMode===i)return c;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const d=new c4(this,o,n,i);return this._bindAction(d,u),this._addInactiveAction(d,a,s),d}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?qm.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==i;++u)n[u]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const d=u._cacheIndex,c=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=d,n[d]=c,n.pop(),this._removeInactiveBindingsForAction(u)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class gT{constructor(e){this.value=e}clone(){return new gT(this.value.clone===void 0?this.value:this.value.clone())}}let cY=0;class hY extends sa{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:cY++}),this.name="",this.usage=Fm,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++)this.uniforms.push(n[i].clone());return this}clone(){return new this.constructor().copy(this)}}class dY extends Ex{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class fY{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class vT{constructor(e,n,i=0,r=1/0){this.ray=new Qa(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new fc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,i=[]){return g2(e,this,i,n),i.sort(BL),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)g2(e[r],this,i,n);return i.sort(BL),i}}function BL(t,e){return t.distance-e.distance}function g2(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)g2(r[s],e,n,!0)}}class pY{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Hn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class mY{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const VL=new ee;class yT{constructor(e=new ee(1/0,1/0),n=new ee(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=VL.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,VL).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const jL=new O,Dv=new O;class h4{constructor(e=new O,n=new O){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){jL.subVectors(e,this.start),Dv.subVectors(this.end,this.start);const i=Dv.dot(Dv);let s=Dv.dot(jL)/i;return n&&(s=Hn(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const GL=new O;class d4 extends jt{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Ke,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,d=a/l*Math.PI*2;r.push(Math.cos(u),Math.sin(u),1,Math.cos(d),Math.sin(d),1)}i.setAttribute("position",new Ne(r,3));const s=new rr({fog:!1,toneMapped:!1});this.cone=new _o(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),GL.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(GL),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ml=new O,Iv=new Ue,wS=new Ue;class gY extends _o{constructor(e){const n=f4(e),i=new Ke,r=[],s=[],o=new We(0,0,1),a=new We(0,1,0);for(let u=0;u<n.length;u++){const d=n[u];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new Ne(r,3)),i.setAttribute("color",new Ne(s,3));const l=new rr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");wS.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(Iv.multiplyMatrices(wS,a.matrixWorld),ml.setFromMatrixPosition(Iv),r.setXYZ(o,ml.x,ml.y,ml.z),Iv.multiplyMatrices(wS,a.parent.matrixWorld),ml.setFromMatrixPosition(Iv),r.setXYZ(o+1,ml.x,ml.y,ml.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function f4(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,f4(t.children[n]));return e}class p4 extends yi{constructor(e,n,i){const r=new gf(n,4,2),s=new oa({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const vY=new O,HL=new We,WL=new We;class yY extends jt{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new wg(n);r.rotateY(Math.PI*.5),this.material=new oa({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new ht(o,3)),this.add(new yi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");HL.copy(this.light.color),WL.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?HL:WL;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(vY.setFromMatrixPosition(this.light.matrixWorld).negate())}}class xY extends _o{constructor(e=10,n=10,i=4473924,r=8947848){i=new We(i),r=new We(r);const s=n/2,o=e/n,a=e/2,l=[],u=[];for(let h=0,f=0,m=-a;h<=n;h++,m+=o){l.push(-a,0,m,a,0,m),l.push(m,0,-a,m,0,a);const x=h===s?i:r;x.toArray(u,f),f+=3,x.toArray(u,f),f+=3,x.toArray(u,f),f+=3,x.toArray(u,f),f+=3}const d=new Ke;d.setAttribute("position",new Ne(l,3)),d.setAttribute("color",new Ne(u,3));const c=new rr({vertexColors:!0,toneMapped:!1});super(d,c),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class _Y extends _o{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new We(s),o=new We(o);const a=[],l=[];if(n>1)for(let c=0;c<n;c++){const h=c/n*(Math.PI*2),f=Math.sin(h)*e,m=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,m);const x=c&1?s:o;l.push(x.r,x.g,x.b),l.push(x.r,x.g,x.b)}for(let c=0;c<i;c++){const h=c&1?s:o,f=e-e/i*c;for(let m=0;m<r;m++){let x=m/r*(Math.PI*2),y=Math.sin(x)*f,v=Math.cos(x)*f;a.push(y,0,v),l.push(h.r,h.g,h.b),x=(m+1)/r*(Math.PI*2),y=Math.sin(x)*f,v=Math.cos(x)*f,a.push(y,0,v),l.push(h.r,h.g,h.b)}}const u=new Ke;u.setAttribute("position",new Ne(a,3)),u.setAttribute("color",new Ne(l,3));const d=new rr({vertexColors:!0,toneMapped:!1});super(u,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const $L=new O,Ov=new O,qL=new O;class m4 extends jt{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Ke;r.setAttribute("position",new Ne([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new rr({fog:!1,toneMapped:!1});this.lightPlane=new su(r,s),this.add(this.lightPlane),r=new Ke,r.setAttribute("position",new Ne([0,0,0,0,0,1],3)),this.targetLine=new su(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),$L.setFromMatrixPosition(this.light.matrixWorld),Ov.setFromMatrixPosition(this.light.target.matrixWorld),qL.subVectors(Ov,$L),this.lightPlane.lookAt(Ov),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ov),this.targetLine.scale.z=qL.length()}}const Nv=new O,Bn=new kc;class Ym extends _o{constructor(e){const n=new Ke,i=new rr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(m,x){l(m),l(x)}function l(m){r.push(0,0,0),s.push(0,0,0),o[m]===void 0&&(o[m]=[]),o[m].push(r.length/3-1)}n.setAttribute("position",new Ne(r,3)),n.setAttribute("color",new Ne(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new We(16755200),d=new We(16711680),c=new We(43775),h=new We(16777215),f=new We(3355443);this.setColors(u,d,c,h,f)}setColors(e,n,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;Bn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Kn("c",n,e,Bn,0,0,-1),Kn("t",n,e,Bn,0,0,1),Kn("n1",n,e,Bn,-i,-r,-1),Kn("n2",n,e,Bn,i,-r,-1),Kn("n3",n,e,Bn,-i,r,-1),Kn("n4",n,e,Bn,i,r,-1),Kn("f1",n,e,Bn,-i,-r,1),Kn("f2",n,e,Bn,i,-r,1),Kn("f3",n,e,Bn,-i,r,1),Kn("f4",n,e,Bn,i,r,1),Kn("u1",n,e,Bn,i*.7,r*1.1,-1),Kn("u2",n,e,Bn,-i*.7,r*1.1,-1),Kn("u3",n,e,Bn,0,r*2,-1),Kn("cf1",n,e,Bn,-i,0,1),Kn("cf2",n,e,Bn,i,0,1),Kn("cf3",n,e,Bn,0,-r,1),Kn("cf4",n,e,Bn,0,r,1),Kn("cn1",n,e,Bn,-i,0,-1),Kn("cn2",n,e,Bn,i,0,-1),Kn("cn3",n,e,Bn,0,-r,-1),Kn("cn4",n,e,Bn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Kn(t,e,n,i,r,s,o){Nv.set(r,s,o).unproject(i);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let u=0,d=a.length;u<d;u++)l.setXYZ(a[u],Nv.x,Nv.y,Nv.z)}}const kv=new Hi;class wY extends _o{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Ke;s.setIndex(new ht(i,1)),s.setAttribute("position",new ht(r,3)),super(s,new rr({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&kv.setFromObject(this.object),kv.isEmpty())return;const n=kv.min,i=kv.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=n.x,s[4]=i.y,s[5]=i.z,s[6]=n.x,s[7]=n.y,s[8]=i.z,s[9]=i.x,s[10]=n.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=n.z,s[15]=n.x,s[16]=i.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=i.x,s[22]=n.y,s[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Zm extends _o{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ke;s.setIndex(new ht(i,1)),s.setAttribute("position",new Ne(r,3)),super(s,new rr({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class SY extends su{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Ke;o.setAttribute("position",new Ne(s,3)),o.computeBoundingSphere(),super(o,new rr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Ke;l.setAttribute("position",new Ne(a,3)),l.computeBoundingSphere(),this.add(new yi(l,new oa({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const XL=new O;let Uv,SS;class bY extends jt{constructor(e=new O(0,0,1),n=new O(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Uv===void 0&&(Uv=new Ke,Uv.setAttribute("position",new Ne([0,0,0,0,1,0],3)),SS=new zc(0,.5,1,5,1),SS.translate(0,-.5,0)),this.position.copy(n),this.line=new su(Uv,new rr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new yi(SS,new oa({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{XL.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(XL,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class g4 extends _o{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ke;r.setAttribute("position",new Ne(n,3)),r.setAttribute("color",new Ne(i,3));const s=new rr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new We,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class MY{constructor(){this.type="ShapePath",this.color=new We,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new Ec,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(v){const _=[];for(let w=0,b=v.length;w<b;w++){const E=v[w],A=new fo;A.curves=E.curves,_.push(A)}return _}function i(v,_){const w=_.length;let b=!1;for(let E=w-1,A=0;A<w;E=A++){let T=_[E],L=_[A],P=L.x-T.x,C=L.y-T.y;if(Math.abs(C)>Number.EPSILON){if(C<0&&(T=_[A],P=-P,L=_[E],C=-C),v.y<T.y||v.y>L.y)continue;if(v.y===T.y){if(v.x===T.x)return!0}else{const D=C*(v.x-T.x)-P*(v.y-T.y);if(D===0)return!0;if(D<0)continue;b=!b}}else{if(v.y!==T.y)continue;if(L.x<=v.x&&v.x<=T.x||T.x<=v.x&&v.x<=L.x)return!0}}return b}const r=po.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new fo,l.curves=a.curves,u.push(l),u;let d=!r(s[0].getPoints());d=e?!d:d;const c=[],h=[];let f=[],m=0,x;h[m]=void 0,f[m]=[];for(let v=0,_=s.length;v<_;v++)a=s[v],x=a.getPoints(),o=r(x),o=e?!o:o,o?(!d&&h[m]&&m++,h[m]={s:new fo,p:x},h[m].s.curves=a.curves,d&&m++,f[m]=[]):f[m].push({h:a,p:x[0]});if(!h[0])return n(s);if(h.length>1){let v=!1,_=0;for(let w=0,b=h.length;w<b;w++)c[w]=[];for(let w=0,b=h.length;w<b;w++){const E=f[w];for(let A=0;A<E.length;A++){const T=E[A];let L=!0;for(let P=0;P<h.length;P++)i(T.p,h[P].p)&&(w!==P&&_++,L?(L=!1,c[P].push(T)):v=!0);L&&c[w].push(T)}}_>0&&v===!1&&(f=c)}let y;for(let v=0,_=h.length;v<_;v++){l=h[v].s,u.push(l),y=f[v];for(let w=0,b=y.length;w<b;w++)l.holes.push(y[w].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:mx}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=mx);const AY=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:DE,AddEquation:Al,AddOperation:kz,AdditiveAnimationBlendMode:FE,AdditiveBlending:PM,AlphaFormat:Hz,AlwaysCompare:uF,AlwaysDepth:Pz,AlwaysStencilFunc:o2,AmbientLight:r4,AnimationAction:c4,AnimationClip:qm,AnimationLoader:OX,AnimationMixer:uY,AnimationObjectGroup:aY,AnimationUtils:RX,ArcCurve:kF,ArrayCamera:EF,ArrowHelper:bY,AttachedBindMode:OM,Audio:l4,AudioAnalyser:KX,AudioContext:dT,AudioListener:XX,AudioLoader:WX,AxesHelper:g4,BackSide:Sr,BasicDepthPacking:Jz,BasicShadowMap:hz,Bone:Tx,BooleanKeyframeTrack:Fc,Box2:yT,Box3:Hi,Box3Helper:Zm,BoxGeometry:us,BoxHelper:wY,BufferAttribute:ht,BufferGeometry:Ke,BufferGeometryLoader:Bx,ByteType:jz,Cache:Cc,Camera:kc,CameraHelper:Ym,CanvasTexture:eX,CapsuleGeometry:Rx,CatmullRomCurve3:UF,CineonToneMapping:Fz,CircleGeometry:Lx,ClampToEdgeWrapping:tr,Clock:fT,Color:We,ColorKeyframeTrack:rT,ColorManagement:ln,CompressedArrayTexture:Qq,CompressedCubeTexture:Jq,CompressedTexture:Cx,CompressedTextureLoader:NX,ConeGeometry:yg,ConstantAlphaFactor:Ez,ConstantColorFactor:Mz,CubeCamera:yF,CubeReflectionMapping:ia,CubeRefractionMapping:$a,CubeTexture:hf,CubeTextureLoader:kX,CubeUVReflectionMapping:Oc,CubicBezierCurve:zs,CubicBezierCurve3:em,CubicInterpolant:e4,CullFaceBack:CM,CullFaceFront:cz,CullFaceFrontBack:eW,CullFaceNone:uz,Curve:wo,CurvePath:eT,CustomBlending:dz,CustomToneMapping:Bz,CylinderGeometry:zc,Cylindrical:mY,Data3DTexture:jE,DataArrayTexture:Sx,DataTexture:Xo,DataTextureLoader:UX,DataUtils:gF,DecrementStencilOp:dW,DecrementWrapStencilOp:pW,DefaultLoadingManager:i4,DepthFormat:Zl,DepthStencilFormat:bc,DepthTexture:qE,DetachedBindMode:Vz,DirectionalLight:cT,DirectionalLightHelper:m4,DiscreteInterpolant:t4,DisplayP3ColorSpace:wx,DodecahedronGeometry:xg,DoubleSide:so,DstAlphaFactor:xz,DstColorFactor:wz,DynamicCopyUsage:CW,DynamicDrawUsage:cF,DynamicReadUsage:AW,EdgesGeometry:zF,EllipseCurve:vg,EqualCompare:rF,EqualDepth:Lz,EqualStencilFunc:yW,EquirectangularReflectionMapping:Pm,EquirectangularRefractionMapping:Rm,Euler:ta,EventDispatcher:sa,ExtrudeGeometry:Ix,FileLoader:Hs,Float16BufferAttribute:d8,Float32BufferAttribute:Ne,Float64BufferAttribute:f8,FloatType:rs,Fog:gg,FogExp2:Ax,FramebufferTexture:Kq,FrontSide:Wa,Frustum:bx,GLBufferAttribute:fY,GLSL1:RW,GLSL3:a2,GreaterCompare:oF,GreaterDepth:Iz,GreaterEqualCompare:lF,GreaterEqualDepth:Dz,GreaterEqualStencilFunc:SW,GreaterStencilFunc:_W,GridHelper:xY,Group:Ll,HalfFloatType:ru,HemisphereLight:oT,HemisphereLightHelper:yY,IcosahedronGeometry:_g,ImageBitmapLoader:HX,ImageLoader:Xm,ImageUtils:VE,IncrementStencilOp:hW,IncrementWrapStencilOp:fW,InstancedBufferAttribute:Ac,InstancedBufferGeometry:hT,InstancedInterleavedBuffer:dY,InstancedMesh:DF,Int16BufferAttribute:c8,Int32BufferAttribute:h8,Int8BufferAttribute:a8,IntType:OE,InterleavedBuffer:Ex,InterleavedBufferAttribute:Mc,Interpolant:bg,InterpolateDiscrete:Im,InterpolateLinear:Om,InterpolateSmooth:Dy,InvertStencilOp:mW,KeepStencilOp:ju,KeyframeTrack:So,LOD:RF,LatheGeometry:mf,Layers:fc,LessCompare:iF,LessDepth:Rz,LessEqualCompare:sF,LessEqualDepth:Cm,LessEqualStencilFunc:xW,LessStencilFunc:vW,Light:Ja,LightProbe:a4,Line:su,Line3:h4,LineBasicMaterial:rr,LineCurve:ho,LineCurve3:QE,LineDashedMaterial:KF,LineLoop:IF,LineSegments:_o,LinearDisplayP3ColorSpace:mg,LinearEncoding:Gd,LinearFilter:In,LinearInterpolant:iT,LinearMipMapLinearFilter:sW,LinearMipMapNearestFilter:rW,LinearMipmapLinearFilter:iu,LinearMipmapNearestFilter:IE,LinearSRGBColorSpace:yo,LinearToneMapping:Uz,LinearTransfer:km,Loader:sr,LoaderUtils:m2,LoadingManager:sT,LoopOnce:Zz,LoopPingPong:Qz,LoopRepeat:Kz,LuminanceAlphaFormat:$z,LuminanceFormat:Wz,MOUSE:QH,Material:Wi,MaterialLoader:Fx,MathUtils:Ut,Matrix3:St,Matrix4:Ue,MaxEquation:IM,Mesh:yi,MeshBasicMaterial:oa,MeshDepthMaterial:WE,MeshDistanceMaterial:$E,MeshLambertMaterial:YF,MeshMatcapMaterial:ZF,MeshNormalMaterial:XF,MeshPhongMaterial:$F,MeshPhysicalMaterial:WF,MeshStandardMaterial:tT,MeshToonMaterial:qF,MinEquation:DM,MirroredRepeatWrapping:Dm,MixOperation:Nz,MultiplyBlending:LM,MultiplyOperation:pg,NearestFilter:ti,NearestMipMapLinearFilter:iW,NearestMipMapNearestFilter:nW,NearestMipmapLinearFilter:Yp,NearestMipmapNearestFilter:f1,NeverCompare:nF,NeverDepth:Cz,NeverStencilFunc:gW,NoBlending:Ua,NoColorSpace:ns,NoToneMapping:Qo,NormalAnimationBlendMode:_x,NormalBlending:Xl,NotEqualCompare:aF,NotEqualDepth:Oz,NotEqualStencilFunc:wW,NumberKeyframeTrack:Wm,Object3D:jt,ObjectLoader:jX,ObjectSpaceNormalMap:tF,OctahedronGeometry:wg,OneFactor:gz,OneMinusConstantAlphaFactor:Tz,OneMinusConstantColorFactor:Az,OneMinusDstAlphaFactor:_z,OneMinusDstColorFactor:Sz,OneMinusSrcAlphaFactor:d1,OneMinusSrcColorFactor:yz,OrthographicCamera:df,P3Primaries:zm,PCFShadowMap:gx,PCFSoftShadowMap:Xp,PMREMGenerator:u2,Path:Ec,PerspectiveCamera:gi,Plane:Pa,PlaneGeometry:Uc,PlaneHelper:SY,PointLight:uT,PointLightHelper:p4,Points:OF,PointsMaterial:ZE,PolarGridHelper:_Y,PolyhedronGeometry:pu,PositionalAudio:ZX,PropertyBinding:Zt,PropertyMixer:u4,QuadraticBezierCurve:qa,QuadraticBezierCurve3:JE,Quaternion:xi,QuaternionKeyframeTrack:vf,QuaternionLinearInterpolant:n4,RED_GREEN_RGTC2_Format:r2,RED_RGTC1_Format:Yz,REVISION:mx,RGBADepthPacking:eF,RGBAFormat:vr,RGBAIntegerFormat:xx,RGBA_ASTC_10x10_Format:QM,RGBA_ASTC_10x5_Format:YM,RGBA_ASTC_10x6_Format:ZM,RGBA_ASTC_10x8_Format:KM,RGBA_ASTC_12x10_Format:JM,RGBA_ASTC_12x12_Format:e2,RGBA_ASTC_4x4_Format:VM,RGBA_ASTC_5x4_Format:jM,RGBA_ASTC_5x5_Format:GM,RGBA_ASTC_6x5_Format:HM,RGBA_ASTC_6x6_Format:WM,RGBA_ASTC_8x5_Format:$M,RGBA_ASTC_8x6_Format:qM,RGBA_ASTC_8x8_Format:XM,RGBA_BPTC_Format:Ly,RGBA_ETC2_EAC_Format:BM,RGBA_PVRTC_2BPPV1_Format:zM,RGBA_PVRTC_4BPPV1_Format:UM,RGBA_S3TC_DXT1_Format:Cy,RGBA_S3TC_DXT3_Format:Py,RGBA_S3TC_DXT5_Format:Ry,RGB_BPTC_SIGNED_Format:t2,RGB_BPTC_UNSIGNED_Format:n2,RGB_ETC1_Format:Xz,RGB_ETC2_Format:FM,RGB_PVRTC_2BPPV1_Format:kM,RGB_PVRTC_4BPPV1_Format:NM,RGB_S3TC_DXT1_Format:Ty,RGFormat:p1,RGIntegerFormat:zE,RawShaderMaterial:HF,Ray:Qa,Raycaster:vT,Rec709Primaries:Um,RectAreaLight:s4,RedFormat:qz,RedIntegerFormat:UE,ReinhardToneMapping:zz,RenderTarget:pF,RepeatWrapping:Lm,ReplaceStencilOp:cW,ReverseSubtractEquation:pz,RingGeometry:Ox,SIGNED_RED_GREEN_RGTC2_Format:s2,SIGNED_RED_RGTC1_Format:i2,SRGBColorSpace:ni,SRGBTransfer:gn,Scene:$d,ShaderChunk:Tt,ShaderLib:Is,ShaderMaterial:Gs,ShadowMaterial:GF,Shape:fo,ShapeGeometry:Nx,ShapePath:MY,ShapeUtils:po,ShortType:Gz,Skeleton:pf,SkeletonHelper:gY,SkinnedMesh:LF,Source:sc,Sphere:Gi,SphereGeometry:gf,Spherical:pY,SphericalHarmonics3:o4,SplineCurve:Px,SpotLight:lT,SpotLightHelper:d4,Sprite:PF,SpriteMaterial:YE,SrcAlphaFactor:h1,SrcAlphaSaturateFactor:bz,SrcColorFactor:vz,StaticCopyUsage:TW,StaticDrawUsage:Fm,StaticReadUsage:MW,StereoCamera:$X,StreamCopyUsage:PW,StreamDrawUsage:bW,StreamReadUsage:EW,StringKeyframeTrack:Bc,SubtractEquation:fz,SubtractiveBlending:RM,TOUCH:JH,TangentSpaceNormalMap:fu,TetrahedronGeometry:kx,Texture:Tn,TextureLoader:zX,TorusGeometry:Ux,TorusKnotGeometry:Sg,Triangle:Bi,TriangleFanDrawMode:lW,TriangleStripDrawMode:aW,TrianglesDrawMode:oW,TubeGeometry:zx,TwoPassDoubleSide:tW,UVMapping:vx,Uint16BufferAttribute:GE,Uint32BufferAttribute:pc,Uint8BufferAttribute:l8,Uint8ClampedBufferAttribute:u8,Uniform:gT,UniformsGroup:hY,UniformsLib:Ve,UniformsUtils:Nc,UnsignedByteType:Jo,UnsignedInt248Type:Yl,UnsignedIntType:$o,UnsignedShort4444Type:NE,UnsignedShort5551Type:kE,UnsignedShortType:yx,VSMShadowMap:no,Vector2:ee,Vector3:O,Vector4:Ct,VectorKeyframeTrack:$m,VideoTexture:NF,WebGL1Renderer:TF,WebGL3DRenderTarget:YW,WebGLArrayRenderTarget:XW,WebGLCoordinateSystem:qo,WebGLCubeRenderTarget:xF,WebGLMultipleRenderTargets:ZW,WebGLRenderTarget:js,WebGLRenderer:XE,WebGLUtils:AF,WebGPUCoordinateSystem:Bm,WireframeGeometry:jF,WrapAroundEnding:Nm,ZeroCurvatureEnding:ic,ZeroFactor:mz,ZeroSlopeEnding:rc,ZeroStencilOp:uW,_SRGBAFormat:m1,createCanvasElement:fF,sRGBEncoding:ea},Symbol.toStringTag,{value:"Module"}));var v4={exports:{}},Vc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Vc.ConcurrentRoot=1;Vc.ContinuousEventPriority=4;Vc.DefaultEventPriority=16;Vc.DiscreteEventPriority=1;Vc.IdleEventPriority=536870912;Vc.LegacyRoot=0;v4.exports=Vc;var cd=v4.exports;function EY(t){let e;const n=new Set,i=(u,d)=>{const c=typeof u=="function"?u(e):u;if(c!==e){const h=e;e=d?c:Object.assign({},e,c),n.forEach(f=>f(e,h))}},r=()=>e,s=(u,d=r,c=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=d(e);function f(){const m=d(e);if(!c(h,m)){const x=h;u(h=m,x)}}return n.add(f),()=>n.delete(f)},l={setState:i,getState:r,subscribe:(u,d,c)=>d||c?s(u,d,c):(n.add(u),()=>n.delete(u)),destroy:()=>n.clear()};return e=t(i,r,l),l}const TY=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),YL=TY?Se.useEffect:Se.useLayoutEffect;function CY(t){const e=typeof t=="function"?EY(t):t,n=(i=e.getState,r=Object.is)=>{const[,s]=Se.useReducer(y=>y+1,0),o=e.getState(),a=Se.useRef(o),l=Se.useRef(i),u=Se.useRef(r),d=Se.useRef(!1),c=Se.useRef();c.current===void 0&&(c.current=i(o));let h,f=!1;(a.current!==o||l.current!==i||u.current!==r||d.current)&&(h=i(o),f=!r(c.current,h)),YL(()=>{f&&(c.current=h),a.current=o,l.current=i,u.current=r,d.current=!1});const m=Se.useRef(o);YL(()=>{const y=()=>{try{const _=e.getState(),w=l.current(_);u.current(c.current,w)||(a.current=_,c.current=w,s())}catch{d.current=!0,s()}},v=e.subscribe(y);return e.getState()!==m.current&&y(),v},[]);const x=f?h:c.current;return Se.useDebugValue(x),x};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}var y4={exports:{}},bS={exports:{}},MS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZL;function PY(){return ZL||(ZL=1,function(t){function e(N,V){var j=N.length;N.push(V);e:for(;0<j;){var z=j-1>>>1,$=N[z];if(0<r($,V))N[z]=V,N[j]=$,j=z;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var V=N[0],j=N.pop();if(j!==V){N[0]=j;e:for(var z=0,$=N.length,te=$>>>1;z<te;){var Q=2*(z+1)-1,J=N[Q],ie=Q+1,se=N[ie];if(0>r(J,j))ie<$&&0>r(se,J)?(N[z]=se,N[ie]=j,z=ie):(N[z]=J,N[Q]=j,z=Q);else if(ie<$&&0>r(se,j))N[z]=se,N[ie]=j,z=ie;else break e}}return V}function r(N,V){var j=N.sortIndex-V.sortIndex;return j!==0?j:N.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,f=!1,m=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var V=n(u);V!==null;){if(V.callback===null)i(u);else if(V.startTime<=N)i(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(N){if(x=!1,w(N),!m)if(n(l)!==null)m=!0,K(E);else{var V=n(u);V!==null&&q(b,V.startTime-N)}}function E(N,V){m=!1,x&&(x=!1,v(L),L=-1),f=!0;var j=h;try{for(w(V),c=n(l);c!==null&&(!(c.expirationTime>V)||N&&!D());){var z=c.callback;if(typeof z=="function"){c.callback=null,h=c.priorityLevel;var $=z(c.expirationTime<=V);V=t.unstable_now(),typeof $=="function"?c.callback=$:c===n(l)&&i(l),w(V)}else i(l);c=n(l)}if(c!==null)var te=!0;else{var Q=n(u);Q!==null&&q(b,Q.startTime-V),te=!1}return te}finally{c=null,h=j,f=!1}}var A=!1,T=null,L=-1,P=5,C=-1;function D(){return!(t.unstable_now()-C<P)}function U(){if(T!==null){var N=t.unstable_now();C=N;var V=!0;try{V=T(!0,N)}finally{V?G():(A=!1,T=null)}}else A=!1}var G;if(typeof _=="function")G=function(){_(U)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,H=k.port2;k.port1.onmessage=U,G=function(){H.postMessage(null)}}else G=function(){y(U,0)};function K(N){T=N,A||(A=!0,G())}function q(N,V){L=y(function(){N(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,K(E))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var j=h;h=V;try{return N()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,V){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=h;h=N;try{return V()}finally{h=j}},t.unstable_scheduleCallback=function(N,V,j){var z=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?z+j:z):j=z,N){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=j+$,N={id:d++,callback:V,priorityLevel:N,startTime:j,expirationTime:$,sortIndex:-1},j>z?(N.sortIndex=j,e(u,N),n(l)===null&&N===n(u)&&(x?(v(L),L=-1):x=!0,q(b,j-z))):(N.sortIndex=$,e(l,N),m||f||(m=!0,K(E))),N},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(N){var V=h;return function(){var j=h;h=V;try{return N.apply(this,arguments)}finally{h=j}}}}(MS)),MS}var KL;function RY(){return KL||(KL=1,bS.exports=PY()),bS.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LY=function(e){var n={},i=Se,r=RY(),s=Object.assign;function o(p){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+p,S=1;S<arguments.length;S++)g+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),m=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),E=Symbol.iterator;function A(p){return p===null||typeof p!="object"?null:(p=E&&p[E]||p["@@iterator"],typeof p=="function"?p:null)}function T(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case d:return"Fragment";case u:return"Portal";case h:return"Profiler";case c:return"StrictMode";case y:return"Suspense";case v:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case m:return(p.displayName||"Context")+".Consumer";case f:return(p._context.displayName||"Context")+".Provider";case x:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case _:return g=p.displayName||null,g!==null?g:T(p.type)||"Memo";case w:g=p._payload,p=p._init;try{return T(p(g))}catch{}}return null}function L(p){var g=p.type;switch(p.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=g.render,p=p.displayName||p.name||"",g.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(g);case 8:return g===c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function P(p){var g=p,S=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,g.flags&4098&&(S=g.return),p=g.return;while(p)}return g.tag===3?S:null}function C(p){if(P(p)!==p)throw Error(o(188))}function D(p){var g=p.alternate;if(!g){if(g=P(p),g===null)throw Error(o(188));return g!==p?null:p}for(var S=p,M=g;;){var R=S.return;if(R===null)break;var I=R.alternate;if(I===null){if(M=R.return,M!==null){S=M;continue}break}if(R.child===I.child){for(I=R.child;I;){if(I===S)return C(R),p;if(I===M)return C(R),g;I=I.sibling}throw Error(o(188))}if(S.return!==M.return)S=R,M=I;else{for(var Z=!1,re=R.child;re;){if(re===S){Z=!0,S=R,M=I;break}if(re===M){Z=!0,M=R,S=I;break}re=re.sibling}if(!Z){for(re=I.child;re;){if(re===S){Z=!0,S=I,M=R;break}if(re===M){Z=!0,M=I,S=R;break}re=re.sibling}if(!Z)throw Error(o(189))}}if(S.alternate!==M)throw Error(o(190))}if(S.tag!==3)throw Error(o(188));return S.stateNode.current===S?p:g}function U(p){return p=D(p),p!==null?G(p):null}function G(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var g=G(p);if(g!==null)return g;p=p.sibling}return null}function k(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){if(p.tag!==4){var g=k(p);if(g!==null)return g}p=p.sibling}return null}var H=Array.isArray,K=e.getPublicInstance,q=e.getRootHostContext,N=e.getChildHostContext,V=e.prepareForCommit,j=e.resetAfterCommit,z=e.createInstance,$=e.appendInitialChild,te=e.finalizeInitialChildren,Q=e.prepareUpdate,J=e.shouldSetTextContent,ie=e.createTextInstance,se=e.scheduleTimeout,pe=e.cancelTimeout,le=e.noTimeout,Ae=e.isPrimaryRenderer,ae=e.supportsMutation,W=e.supportsPersistence,me=e.supportsHydration,ue=e.getInstanceFromNode,ce=e.preparePortalMount,ge=e.getCurrentEventPriority,De=e.detachDeletedInstance,Me=e.supportsMicrotasks,Ce=e.scheduleMicrotask,ke=e.supportsTestSelectors,He=e.findFiberRoot,bt=e.getBoundingRect,Y=e.getTextContent,B=e.isHiddenSubtree,he=e.matchAccessibilityRole,Re=e.setFocusIfFocusable,Le=e.setupIntersectionObserver,Ie=e.appendChild,rt=e.appendChildToContainer,Oe=e.commitTextUpdate,Ge=e.commitMount,ot=e.commitUpdate,Wt=e.insertBefore,Fe=e.insertInContainerBefore,Qt=e.removeChild,Mt=e.removeChildFromContainer,gt=e.resetTextContent,ft=e.hideInstance,Xe=e.hideTextInstance,Ft=e.unhideInstance,ne=e.unhideTextInstance,Ye=e.clearContainer,je=e.cloneInstance,Te=e.createContainerChildSet,$e=e.appendChildToContainerChildSet,vt=e.finalizeContainerChildren,Xt=e.replaceContainerChildren,Cn=e.cloneHiddenInstance,or=e.cloneHiddenTextInstance,dn=e.canHydrateInstance,Ni=e.canHydrateTextInstance,fs=e.canHydrateSuspenseInstance,Af=e.isSuspenseInstancePending,Ef=e.isSuspenseInstanceFallback,Yc=e.registerSuspenseInstanceRetry,el=e.getNextHydratableSibling,Zc=e.getFirstHydratableChild,kg=e.getFirstHydratableChildWithinContainer,Ug=e.getFirstHydratableChildWithinSuspenseInstance,u_=e.hydrateInstance,c_=e.hydrateTextInstance,h_=e.hydrateSuspenseInstance,X=e.getNextHydratableInstanceAfterSuspenseInstance,fe=e.commitHydratedContainer,xe=e.commitHydratedSuspenseInstance,we=e.clearSuspenseBoundary,be=e.clearSuspenseBoundaryFromContainer,tt=e.shouldDeleteUnhydratedTailInstances,lt=e.didNotMatchHydratedContainerTextInstance,yt=e.didNotMatchHydratedTextInstance,xt;function Pt(p){if(xt===void 0)try{throw Error()}catch(S){var g=S.stack.trim().match(/\n( *(at )?)/);xt=g&&g[1]||""}return`
`+xt+p}var At=!1;function Rt(p,g){if(!p||At)return"";At=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Be){var M=Be}Reflect.construct(p,[],g)}else{try{g.call()}catch(Be){M=Be}p.call(g.prototype)}else{try{throw Error()}catch(Be){M=Be}p()}}catch(Be){if(Be&&M&&typeof Be.stack=="string"){for(var R=Be.stack.split(`
`),I=M.stack.split(`
`),Z=R.length-1,re=I.length-1;1<=Z&&0<=re&&R[Z]!==I[re];)re--;for(;1<=Z&&0<=re;Z--,re--)if(R[Z]!==I[re]){if(Z!==1||re!==1)do if(Z--,re--,0>re||R[Z]!==I[re]){var Ee=`
`+R[Z].replace(" at new "," at ");return p.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",p.displayName)),Ee}while(1<=Z&&0<=re);break}}}finally{At=!1,Error.prepareStackTrace=S}return(p=p?p.displayName||p.name:"")?Pt(p):""}var Pn=Object.prototype.hasOwnProperty,ki=[],xn=-1;function Mi(p){return{current:p}}function wt(p){0>xn||(p.current=ki[xn],ki[xn]=null,xn--)}function st(p,g){xn++,ki[xn]=p.current,p.current=g}var ps={},Gt=Mi(ps),zn=Mi(!1),Mo=ps;function ms(p,g){var S=p.type.contextTypes;if(!S)return ps;var M=p.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===g)return M.__reactInternalMemoizedMaskedChildContext;var R={},I;for(I in S)R[I]=g[I];return M&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=g,p.__reactInternalMemoizedMaskedChildContext=R),R}function Ai(p){return p=p.childContextTypes,p!=null}function ri(){wt(zn),wt(Gt)}function Ao(p,g,S){if(Gt.current!==ps)throw Error(o(168));st(Gt,g),st(zn,S)}function Kc(p,g,S){var M=p.stateNode;if(g=g.childContextTypes,typeof M.getChildContext!="function")return S;M=M.getChildContext();for(var R in M)if(!(R in g))throw Error(o(108,L(p)||"Unknown",R));return s({},S,M)}function Ei(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||ps,Mo=Gt.current,st(Gt,p),st(zn,zn.current),!0}function Qc(p,g,S){var M=p.stateNode;if(!M)throw Error(o(169));S?(p=Kc(p,g,Mo),M.__reactInternalMemoizedMergedChildContext=p,wt(zn),wt(Gt),st(Gt,p)):wt(zn),st(zn,S)}var qr=Math.clz32?Math.clz32:z6,zg=Math.log,U6=Math.LN2;function z6(p){return p>>>=0,p===0?32:31-(zg(p)/U6|0)|0}var Fg=64,Bg=4194304;function Tf(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function Vg(p,g){var S=p.pendingLanes;if(S===0)return 0;var M=0,R=p.suspendedLanes,I=p.pingedLanes,Z=S&268435455;if(Z!==0){var re=Z&~R;re!==0?M=Tf(re):(I&=Z,I!==0&&(M=Tf(I)))}else Z=S&~R,Z!==0?M=Tf(Z):I!==0&&(M=Tf(I));if(M===0)return 0;if(g!==0&&g!==M&&!(g&R)&&(R=M&-M,I=g&-g,R>=I||R===16&&(I&4194240)!==0))return g;if(M&4&&(M|=S&16),g=p.entangledLanes,g!==0)for(p=p.entanglements,g&=M;0<g;)S=31-qr(g),R=1<<S,M|=p[S],g&=~R;return M}function F6(p,g){switch(p){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B6(p,g){for(var S=p.suspendedLanes,M=p.pingedLanes,R=p.expirationTimes,I=p.pendingLanes;0<I;){var Z=31-qr(I),re=1<<Z,Ee=R[Z];Ee===-1?(!(re&S)||re&M)&&(R[Z]=F6(re,g)):Ee<=g&&(p.expiredLanes|=re),I&=~re}}function d_(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function f_(p){for(var g=[],S=0;31>S;S++)g.push(p);return g}function Cf(p,g,S){p.pendingLanes|=g,g!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,g=31-qr(g),p[g]=S}function V6(p,g){var S=p.pendingLanes&~g;p.pendingLanes=g,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=g,p.mutableReadLanes&=g,p.entangledLanes&=g,g=p.entanglements;var M=p.eventTimes;for(p=p.expirationTimes;0<S;){var R=31-qr(S),I=1<<R;g[R]=0,M[R]=-1,p[R]=-1,S&=~I}}function p_(p,g){var S=p.entangledLanes|=g;for(p=p.entanglements;S;){var M=31-qr(S),R=1<<M;R&g|p[M]&g&&(p[M]|=g),S&=~R}}var Jt=0;function kC(p){return p&=-p,1<p?4<p?p&268435455?16:536870912:4:1}var m_=r.unstable_scheduleCallback,UC=r.unstable_cancelCallback,j6=r.unstable_shouldYield,G6=r.unstable_requestPaint,Ti=r.unstable_now,g_=r.unstable_ImmediatePriority,H6=r.unstable_UserBlockingPriority,v_=r.unstable_NormalPriority,W6=r.unstable_IdlePriority,jg=null,Eo=null;function $6(p){if(Eo&&typeof Eo.onCommitFiberRoot=="function")try{Eo.onCommitFiberRoot(jg,p,void 0,(p.current.flags&128)===128)}catch{}}function q6(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var To=typeof Object.is=="function"?Object.is:q6,la=null,Gg=!1,y_=!1;function zC(p){la===null?la=[p]:la.push(p)}function X6(p){Gg=!0,zC(p)}function Co(){if(!y_&&la!==null){y_=!0;var p=0,g=Jt;try{var S=la;for(Jt=1;p<S.length;p++){var M=S[p];do M=M(!0);while(M!==null)}la=null,Gg=!1}catch(R){throw la!==null&&(la=la.slice(p+1)),m_(g_,Co),R}finally{Jt=g,y_=!1}}return null}var Y6=a.ReactCurrentBatchConfig;function Hg(p,g){if(To(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var S=Object.keys(p),M=Object.keys(g);if(S.length!==M.length)return!1;for(M=0;M<S.length;M++){var R=S[M];if(!Pn.call(g,R)||!To(p[R],g[R]))return!1}return!0}function Z6(p){switch(p.tag){case 5:return Pt(p.type);case 16:return Pt("Lazy");case 13:return Pt("Suspense");case 19:return Pt("SuspenseList");case 0:case 2:case 15:return p=Rt(p.type,!1),p;case 11:return p=Rt(p.type.render,!1),p;case 1:return p=Rt(p.type,!0),p;default:return""}}function qs(p,g){if(p&&p.defaultProps){g=s({},g),p=p.defaultProps;for(var S in p)g[S]===void 0&&(g[S]=p[S]);return g}return g}var Wg=Mi(null),$g=null,Jc=null,x_=null;function __(){x_=Jc=$g=null}function FC(p,g,S){Ae?(st(Wg,g._currentValue),g._currentValue=S):(st(Wg,g._currentValue2),g._currentValue2=S)}function w_(p){var g=Wg.current;wt(Wg),Ae?p._currentValue=g:p._currentValue2=g}function S_(p,g,S){for(;p!==null;){var M=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,M!==null&&(M.childLanes|=g)):M!==null&&(M.childLanes&g)!==g&&(M.childLanes|=g),p===S)break;p=p.return}}function eh(p,g){$g=p,x_=Jc=null,p=p.dependencies,p!==null&&p.firstContext!==null&&(p.lanes&g&&(Zr=!0),p.firstContext=null)}function gs(p){var g=Ae?p._currentValue:p._currentValue2;if(x_!==p)if(p={context:p,memoizedValue:g,next:null},Jc===null){if($g===null)throw Error(o(308));Jc=p,$g.dependencies={lanes:0,firstContext:p}}else Jc=Jc.next=p;return g}var Po=null,tl=!1;function b_(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BC(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function ua(p,g){return{eventTime:p,lane:g,tag:0,payload:null,callback:null,next:null}}function nl(p,g){var S=p.updateQueue;S!==null&&(S=S.shared,si!==null&&p.mode&1&&!(Bt&2)?(p=S.interleaved,p===null?(g.next=g,Po===null?Po=[S]:Po.push(S)):(g.next=p.next,p.next=g),S.interleaved=g):(p=S.pending,p===null?g.next=g:(g.next=p.next,p.next=g),S.pending=g))}function qg(p,g,S){if(g=g.updateQueue,g!==null&&(g=g.shared,(S&4194240)!==0)){var M=g.lanes;M&=p.pendingLanes,S|=M,g.lanes=S,p_(p,S)}}function VC(p,g){var S=p.updateQueue,M=p.alternate;if(M!==null&&(M=M.updateQueue,S===M)){var R=null,I=null;if(S=S.firstBaseUpdate,S!==null){do{var Z={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};I===null?R=I=Z:I=I.next=Z,S=S.next}while(S!==null);I===null?R=I=g:I=I.next=g}else R=I=g;S={baseState:M.baseState,firstBaseUpdate:R,lastBaseUpdate:I,shared:M.shared,effects:M.effects},p.updateQueue=S;return}p=S.lastBaseUpdate,p===null?S.firstBaseUpdate=g:p.next=g,S.lastBaseUpdate=g}function Xg(p,g,S,M){var R=p.updateQueue;tl=!1;var I=R.firstBaseUpdate,Z=R.lastBaseUpdate,re=R.shared.pending;if(re!==null){R.shared.pending=null;var Ee=re,Be=Ee.next;Ee.next=null,Z===null?I=Be:Z.next=Be,Z=Ee;var it=p.alternate;it!==null&&(it=it.updateQueue,re=it.lastBaseUpdate,re!==Z&&(re===null?it.firstBaseUpdate=Be:re.next=Be,it.lastBaseUpdate=Ee))}if(I!==null){var Dt=R.baseState;Z=0,it=Be=Ee=null,re=I;do{var pt=re.lane,pn=re.eventTime;if((M&pt)===pt){it!==null&&(it=it.next={eventTime:pn,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var ut=p,Yi=re;switch(pt=g,pn=S,Yi.tag){case 1:if(ut=Yi.payload,typeof ut=="function"){Dt=ut.call(pn,Dt,pt);break e}Dt=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=Yi.payload,pt=typeof ut=="function"?ut.call(pn,Dt,pt):ut,pt==null)break e;Dt=s({},Dt,pt);break e;case 2:tl=!0}}re.callback!==null&&re.lane!==0&&(p.flags|=64,pt=R.effects,pt===null?R.effects=[re]:pt.push(re))}else pn={eventTime:pn,lane:pt,tag:re.tag,payload:re.payload,callback:re.callback,next:null},it===null?(Be=it=pn,Ee=Dt):it=it.next=pn,Z|=pt;if(re=re.next,re===null){if(re=R.shared.pending,re===null)break;pt=re,re=pt.next,pt.next=null,R.lastBaseUpdate=pt,R.shared.pending=null}}while(1);if(it===null&&(Ee=Dt),R.baseState=Ee,R.firstBaseUpdate=Be,R.lastBaseUpdate=it,g=R.shared.interleaved,g!==null){R=g;do Z|=R.lane,R=R.next;while(R!==g)}else I===null&&(R.shared.lanes=0);uh|=Z,p.lanes=Z,p.memoizedState=Dt}}function jC(p,g,S){if(p=g.effects,g.effects=null,p!==null)for(g=0;g<p.length;g++){var M=p[g],R=M.callback;if(R!==null){if(M.callback=null,M=S,typeof R!="function")throw Error(o(191,R));R.call(M)}}}var GC=new i.Component().refs;function M_(p,g,S,M){g=p.memoizedState,S=S(M,g),S=S==null?g:s({},g,S),p.memoizedState=S,p.lanes===0&&(p.updateQueue.baseState=S)}var Yg={isMounted:function(p){return(p=p._reactInternals)?P(p)===p:!1},enqueueSetState:function(p,g,S){p=p._reactInternals;var M=lr(),R=sl(p),I=ua(M,R);I.payload=g,S!=null&&(I.callback=S),nl(p,I),g=ws(p,R,M),g!==null&&qg(g,p,R)},enqueueReplaceState:function(p,g,S){p=p._reactInternals;var M=lr(),R=sl(p),I=ua(M,R);I.tag=1,I.payload=g,S!=null&&(I.callback=S),nl(p,I),g=ws(p,R,M),g!==null&&qg(g,p,R)},enqueueForceUpdate:function(p,g){p=p._reactInternals;var S=lr(),M=sl(p),R=ua(S,M);R.tag=2,g!=null&&(R.callback=g),nl(p,R),g=ws(p,M,S),g!==null&&qg(g,p,M)}};function HC(p,g,S,M,R,I,Z){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(M,I,Z):g.prototype&&g.prototype.isPureReactComponent?!Hg(S,M)||!Hg(R,I):!0}function WC(p,g,S){var M=!1,R=ps,I=g.contextType;return typeof I=="object"&&I!==null?I=gs(I):(R=Ai(g)?Mo:Gt.current,M=g.contextTypes,I=(M=M!=null)?ms(p,R):ps),g=new g(S,I),p.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Yg,p.stateNode=g,g._reactInternals=p,M&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=R,p.__reactInternalMemoizedMaskedChildContext=I),g}function $C(p,g,S,M){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(S,M),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(S,M),g.state!==p&&Yg.enqueueReplaceState(g,g.state,null)}function A_(p,g,S,M){var R=p.stateNode;R.props=S,R.state=p.memoizedState,R.refs=GC,b_(p);var I=g.contextType;typeof I=="object"&&I!==null?R.context=gs(I):(I=Ai(g)?Mo:Gt.current,R.context=ms(p,I)),R.state=p.memoizedState,I=g.getDerivedStateFromProps,typeof I=="function"&&(M_(p,g,I,S),R.state=p.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(g=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),g!==R.state&&Yg.enqueueReplaceState(R,R.state,null),Xg(p,S,R,M),R.state=p.memoizedState),typeof R.componentDidMount=="function"&&(p.flags|=4194308)}var th=[],nh=0,Zg=null,Kg=0,vs=[],ys=0,vu=null,ca=1,ha="";function yu(p,g){th[nh++]=Kg,th[nh++]=Zg,Zg=p,Kg=g}function qC(p,g,S){vs[ys++]=ca,vs[ys++]=ha,vs[ys++]=vu,vu=p;var M=ca;p=ha;var R=32-qr(M)-1;M&=~(1<<R),S+=1;var I=32-qr(g)+R;if(30<I){var Z=R-R%5;I=(M&(1<<Z)-1).toString(32),M>>=Z,R-=Z,ca=1<<32-qr(g)+R|S<<R|M,ha=I+p}else ca=1<<I|S<<R|M,ha=p}function E_(p){p.return!==null&&(yu(p,1),qC(p,1,0))}function T_(p){for(;p===Zg;)Zg=th[--nh],th[nh]=null,Kg=th[--nh],th[nh]=null;for(;p===vu;)vu=vs[--ys],vs[ys]=null,ha=vs[--ys],vs[ys]=null,ca=vs[--ys],vs[ys]=null}var Xr=null,Yr=null,An=!1,Pf=!1,Xs=null;function XC(p,g){var S=Ss(5,null,null,0);S.elementType="DELETED",S.stateNode=g,S.return=p,g=p.deletions,g===null?(p.deletions=[S],p.flags|=16):g.push(S)}function YC(p,g){switch(p.tag){case 5:return g=dn(g,p.type,p.pendingProps),g!==null?(p.stateNode=g,Xr=p,Yr=Zc(g),!0):!1;case 6:return g=Ni(g,p.pendingProps),g!==null?(p.stateNode=g,Xr=p,Yr=null,!0):!1;case 13:if(g=fs(g),g!==null){var S=vu!==null?{id:ca,overflow:ha}:null;return p.memoizedState={dehydrated:g,treeContext:S,retryLane:1073741824},S=Ss(18,null,null,0),S.stateNode=g,S.return=p,p.child=S,Xr=p,Yr=null,!0}return!1;default:return!1}}function C_(p){return(p.mode&1)!==0&&(p.flags&128)===0}function P_(p){if(An){var g=Yr;if(g){var S=g;if(!YC(p,g)){if(C_(p))throw Error(o(418));g=el(S);var M=Xr;g&&YC(p,g)?XC(M,S):(p.flags=p.flags&-4097|2,An=!1,Xr=p)}}else{if(C_(p))throw Error(o(418));p.flags=p.flags&-4097|2,An=!1,Xr=p}}}function ZC(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;Xr=p}function Rf(p){if(!me||p!==Xr)return!1;if(!An)return ZC(p),An=!0,!1;if(p.tag!==3&&(p.tag!==5||tt(p.type)&&!J(p.type,p.memoizedProps))){var g=Yr;if(g){if(C_(p)){for(p=Yr;p;)p=el(p);throw Error(o(418))}for(;g;)XC(p,g),g=el(g)}}if(ZC(p),p.tag===13){if(!me)throw Error(o(316));if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(o(317));Yr=X(p)}else Yr=Xr?el(p.stateNode):null;return!0}function ih(){me&&(Yr=Xr=null,Pf=An=!1)}function R_(p){Xs===null?Xs=[p]:Xs.push(p)}function Lf(p,g,S){if(p=S.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(o(309));var M=S.stateNode}if(!M)throw Error(o(147,p));var R=M,I=""+p;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===I?g.ref:(g=function(Z){var re=R.refs;re===GC&&(re=R.refs={}),Z===null?delete re[I]:re[I]=Z},g._stringRef=I,g)}if(typeof p!="string")throw Error(o(284));if(!S._owner)throw Error(o(290,p))}return p}function Qg(p,g){throw p=Object.prototype.toString.call(g),Error(o(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p))}function KC(p){var g=p._init;return g(p._payload)}function QC(p){function g(ve,oe){if(p){var _e=ve.deletions;_e===null?(ve.deletions=[oe],ve.flags|=16):_e.push(oe)}}function S(ve,oe){if(!p)return null;for(;oe!==null;)g(ve,oe),oe=oe.sibling;return null}function M(ve,oe){for(ve=new Map;oe!==null;)oe.key!==null?ve.set(oe.key,oe):ve.set(oe.index,oe),oe=oe.sibling;return ve}function R(ve,oe){return ve=al(ve,oe),ve.index=0,ve.sibling=null,ve}function I(ve,oe,_e){return ve.index=_e,p?(_e=ve.alternate,_e!==null?(_e=_e.index,_e<oe?(ve.flags|=2,oe):_e):(ve.flags|=2,oe)):(ve.flags|=1048576,oe)}function Z(ve){return p&&ve.alternate===null&&(ve.flags|=2),ve}function re(ve,oe,_e,Qe){return oe===null||oe.tag!==6?(oe=fw(_e,ve.mode,Qe),oe.return=ve,oe):(oe=R(oe,_e),oe.return=ve,oe)}function Ee(ve,oe,_e,Qe){var at=_e.type;return at===d?it(ve,oe,_e.props.children,Qe,_e.key):oe!==null&&(oe.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===w&&KC(at)===oe.type)?(Qe=R(oe,_e.props),Qe.ref=Lf(ve,oe,_e),Qe.return=ve,Qe):(Qe=P0(_e.type,_e.key,_e.props,null,ve.mode,Qe),Qe.ref=Lf(ve,oe,_e),Qe.return=ve,Qe)}function Be(ve,oe,_e,Qe){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==_e.containerInfo||oe.stateNode.implementation!==_e.implementation?(oe=pw(_e,ve.mode,Qe),oe.return=ve,oe):(oe=R(oe,_e.children||[]),oe.return=ve,oe)}function it(ve,oe,_e,Qe,at){return oe===null||oe.tag!==7?(oe=Au(_e,ve.mode,Qe,at),oe.return=ve,oe):(oe=R(oe,_e),oe.return=ve,oe)}function Dt(ve,oe,_e){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=fw(""+oe,ve.mode,_e),oe.return=ve,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case l:return _e=P0(oe.type,oe.key,oe.props,null,ve.mode,_e),_e.ref=Lf(ve,null,oe),_e.return=ve,_e;case u:return oe=pw(oe,ve.mode,_e),oe.return=ve,oe;case w:var Qe=oe._init;return Dt(ve,Qe(oe._payload),_e)}if(H(oe)||A(oe))return oe=Au(oe,ve.mode,_e,null),oe.return=ve,oe;Qg(ve,oe)}return null}function pt(ve,oe,_e,Qe){var at=oe!==null?oe.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return at!==null?null:re(ve,oe,""+_e,Qe);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case l:return _e.key===at?Ee(ve,oe,_e,Qe):null;case u:return _e.key===at?Be(ve,oe,_e,Qe):null;case w:return at=_e._init,pt(ve,oe,at(_e._payload),Qe)}if(H(_e)||A(_e))return at!==null?null:it(ve,oe,_e,Qe,null);Qg(ve,_e)}return null}function pn(ve,oe,_e,Qe,at){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return ve=ve.get(_e)||null,re(oe,ve,""+Qe,at);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case l:return ve=ve.get(Qe.key===null?_e:Qe.key)||null,Ee(oe,ve,Qe,at);case u:return ve=ve.get(Qe.key===null?_e:Qe.key)||null,Be(oe,ve,Qe,at);case w:var zt=Qe._init;return pn(ve,oe,_e,zt(Qe._payload),at)}if(H(Qe)||A(Qe))return ve=ve.get(_e)||null,it(oe,ve,Qe,at,null);Qg(oe,Qe)}return null}function ut(ve,oe,_e,Qe){for(var at=null,zt=null,It=oe,en=oe=0,Pi=null;It!==null&&en<_e.length;en++){It.index>en?(Pi=It,It=null):Pi=It.sibling;var tn=pt(ve,It,_e[en],Qe);if(tn===null){It===null&&(It=Pi);break}p&&It&&tn.alternate===null&&g(ve,It),oe=I(tn,oe,en),zt===null?at=tn:zt.sibling=tn,zt=tn,It=Pi}if(en===_e.length)return S(ve,It),An&&yu(ve,en),at;if(It===null){for(;en<_e.length;en++)It=Dt(ve,_e[en],Qe),It!==null&&(oe=I(It,oe,en),zt===null?at=It:zt.sibling=It,zt=It);return An&&yu(ve,en),at}for(It=M(ve,It);en<_e.length;en++)Pi=pn(It,ve,en,_e[en],Qe),Pi!==null&&(p&&Pi.alternate!==null&&It.delete(Pi.key===null?en:Pi.key),oe=I(Pi,oe,en),zt===null?at=Pi:zt.sibling=Pi,zt=Pi);return p&&It.forEach(function(ll){return g(ve,ll)}),An&&yu(ve,en),at}function Yi(ve,oe,_e,Qe){var at=A(_e);if(typeof at!="function")throw Error(o(150));if(_e=at.call(_e),_e==null)throw Error(o(151));for(var zt=at=null,It=oe,en=oe=0,Pi=null,tn=_e.next();It!==null&&!tn.done;en++,tn=_e.next()){It.index>en?(Pi=It,It=null):Pi=It.sibling;var ll=pt(ve,It,tn.value,Qe);if(ll===null){It===null&&(It=Pi);break}p&&It&&ll.alternate===null&&g(ve,It),oe=I(ll,oe,en),zt===null?at=ll:zt.sibling=ll,zt=ll,It=Pi}if(tn.done)return S(ve,It),An&&yu(ve,en),at;if(It===null){for(;!tn.done;en++,tn=_e.next())tn=Dt(ve,tn.value,Qe),tn!==null&&(oe=I(tn,oe,en),zt===null?at=tn:zt.sibling=tn,zt=tn);return An&&yu(ve,en),at}for(It=M(ve,It);!tn.done;en++,tn=_e.next())tn=pn(It,ve,en,tn.value,Qe),tn!==null&&(p&&tn.alternate!==null&&It.delete(tn.key===null?en:tn.key),oe=I(tn,oe,en),zt===null?at=tn:zt.sibling=tn,zt=tn);return p&&It.forEach(function(Ej){return g(ve,Ej)}),An&&yu(ve,en),at}function bs(ve,oe,_e,Qe){if(typeof _e=="object"&&_e!==null&&_e.type===d&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case l:e:{for(var at=_e.key,zt=oe;zt!==null;){if(zt.key===at){if(at=_e.type,at===d){if(zt.tag===7){S(ve,zt.sibling),oe=R(zt,_e.props.children),oe.return=ve,ve=oe;break e}}else if(zt.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===w&&KC(at)===zt.type){S(ve,zt.sibling),oe=R(zt,_e.props),oe.ref=Lf(ve,zt,_e),oe.return=ve,ve=oe;break e}S(ve,zt);break}else g(ve,zt);zt=zt.sibling}_e.type===d?(oe=Au(_e.props.children,ve.mode,Qe,_e.key),oe.return=ve,ve=oe):(Qe=P0(_e.type,_e.key,_e.props,null,ve.mode,Qe),Qe.ref=Lf(ve,oe,_e),Qe.return=ve,ve=Qe)}return Z(ve);case u:e:{for(zt=_e.key;oe!==null;){if(oe.key===zt)if(oe.tag===4&&oe.stateNode.containerInfo===_e.containerInfo&&oe.stateNode.implementation===_e.implementation){S(ve,oe.sibling),oe=R(oe,_e.children||[]),oe.return=ve,ve=oe;break e}else{S(ve,oe);break}else g(ve,oe);oe=oe.sibling}oe=pw(_e,ve.mode,Qe),oe.return=ve,ve=oe}return Z(ve);case w:return zt=_e._init,bs(ve,oe,zt(_e._payload),Qe)}if(H(_e))return ut(ve,oe,_e,Qe);if(A(_e))return Yi(ve,oe,_e,Qe);Qg(ve,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,oe!==null&&oe.tag===6?(S(ve,oe.sibling),oe=R(oe,_e),oe.return=ve,ve=oe):(S(ve,oe),oe=fw(_e,ve.mode,Qe),oe.return=ve,ve=oe),Z(ve)):S(ve,oe)}return bs}var rh=QC(!0),JC=QC(!1),Df={},xs=Mi(Df),If=Mi(Df),sh=Mi(Df);function Ro(p){if(p===Df)throw Error(o(174));return p}function L_(p,g){st(sh,g),st(If,p),st(xs,Df),p=q(g),wt(xs),st(xs,p)}function oh(){wt(xs),wt(If),wt(sh)}function e3(p){var g=Ro(sh.current),S=Ro(xs.current);g=N(S,p.type,g),S!==g&&(st(If,p),st(xs,g))}function D_(p){If.current===p&&(wt(xs),wt(If))}var Rn=Mi(0);function Jg(p){for(var g=p;g!==null;){if(g.tag===13){var S=g.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||Af(S)||Ef(S)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var I_=[];function O_(){for(var p=0;p<I_.length;p++){var g=I_[p];Ae?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}I_.length=0}var e0=a.ReactCurrentDispatcher,_s=a.ReactCurrentBatchConfig,ah=0,Fn=null,$i=null,Ci=null,t0=!1,Of=!1,Nf=0,K6=0;function qi(){throw Error(o(321))}function N_(p,g){if(g===null)return!1;for(var S=0;S<g.length&&S<p.length;S++)if(!To(p[S],g[S]))return!1;return!0}function k_(p,g,S,M,R,I){if(ah=I,Fn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,e0.current=p===null||p.memoizedState===null?tj:nj,p=S(M,R),Of){I=0;do{if(Of=!1,Nf=0,25<=I)throw Error(o(301));I+=1,Ci=$i=null,g.updateQueue=null,e0.current=ij,p=S(M,R)}while(Of)}if(e0.current=o0,g=$i!==null&&$i.next!==null,ah=0,Ci=$i=Fn=null,t0=!1,g)throw Error(o(300));return p}function U_(){var p=Nf!==0;return Nf=0,p}function da(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ci===null?Fn.memoizedState=Ci=p:Ci=Ci.next=p,Ci}function Lo(){if($i===null){var p=Fn.alternate;p=p!==null?p.memoizedState:null}else p=$i.next;var g=Ci===null?Fn.memoizedState:Ci.next;if(g!==null)Ci=g,$i=p;else{if(p===null)throw Error(o(310));$i=p,p={memoizedState:$i.memoizedState,baseState:$i.baseState,baseQueue:$i.baseQueue,queue:$i.queue,next:null},Ci===null?Fn.memoizedState=Ci=p:Ci=Ci.next=p}return Ci}function xu(p,g){return typeof g=="function"?g(p):g}function n0(p){var g=Lo(),S=g.queue;if(S===null)throw Error(o(311));S.lastRenderedReducer=p;var M=$i,R=M.baseQueue,I=S.pending;if(I!==null){if(R!==null){var Z=R.next;R.next=I.next,I.next=Z}M.baseQueue=R=I,S.pending=null}if(R!==null){I=R.next,M=M.baseState;var re=Z=null,Ee=null,Be=I;do{var it=Be.lane;if((ah&it)===it)Ee!==null&&(Ee=Ee.next={lane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),M=Be.hasEagerState?Be.eagerState:p(M,Be.action);else{var Dt={lane:it,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null};Ee===null?(re=Ee=Dt,Z=M):Ee=Ee.next=Dt,Fn.lanes|=it,uh|=it}Be=Be.next}while(Be!==null&&Be!==I);Ee===null?Z=M:Ee.next=re,To(M,g.memoizedState)||(Zr=!0),g.memoizedState=M,g.baseState=Z,g.baseQueue=Ee,S.lastRenderedState=M}if(p=S.interleaved,p!==null){R=p;do I=R.lane,Fn.lanes|=I,uh|=I,R=R.next;while(R!==p)}else R===null&&(S.lanes=0);return[g.memoizedState,S.dispatch]}function i0(p){var g=Lo(),S=g.queue;if(S===null)throw Error(o(311));S.lastRenderedReducer=p;var M=S.dispatch,R=S.pending,I=g.memoizedState;if(R!==null){S.pending=null;var Z=R=R.next;do I=p(I,Z.action),Z=Z.next;while(Z!==R);To(I,g.memoizedState)||(Zr=!0),g.memoizedState=I,g.baseQueue===null&&(g.baseState=I),S.lastRenderedState=I}return[I,M]}function t3(){}function n3(p,g){var S=Fn,M=Lo(),R=g(),I=!To(M.memoizedState,R);if(I&&(M.memoizedState=R,Zr=!0),M=M.queue,Uf(s3.bind(null,S,M,p),[p]),M.getSnapshot!==g||I||Ci!==null&&Ci.memoizedState.tag&1){if(S.flags|=2048,kf(9,r3.bind(null,S,M,R,g),void 0,null),si===null)throw Error(o(349));ah&30||i3(S,g,R)}return R}function i3(p,g,S){p.flags|=16384,p={getSnapshot:g,value:S},g=Fn.updateQueue,g===null?(g={lastEffect:null,stores:null},Fn.updateQueue=g,g.stores=[p]):(S=g.stores,S===null?g.stores=[p]:S.push(p))}function r3(p,g,S,M){g.value=S,g.getSnapshot=M,o3(g)&&ws(p,1,-1)}function s3(p,g,S){return S(function(){o3(g)&&ws(p,1,-1)})}function o3(p){var g=p.getSnapshot;p=p.value;try{var S=g();return!To(p,S)}catch{return!0}}function z_(p){var g=da();return typeof p=="function"&&(p=p()),g.memoizedState=g.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xu,lastRenderedState:p},g.queue=p,p=p.dispatch=ej.bind(null,Fn,p),[g.memoizedState,p]}function kf(p,g,S,M){return p={tag:p,create:g,destroy:S,deps:M,next:null},g=Fn.updateQueue,g===null?(g={lastEffect:null,stores:null},Fn.updateQueue=g,g.lastEffect=p.next=p):(S=g.lastEffect,S===null?g.lastEffect=p.next=p:(M=S.next,S.next=p,p.next=M,g.lastEffect=p)),p}function a3(){return Lo().memoizedState}function r0(p,g,S,M){var R=da();Fn.flags|=p,R.memoizedState=kf(1|g,S,void 0,M===void 0?null:M)}function s0(p,g,S,M){var R=Lo();M=M===void 0?null:M;var I=void 0;if($i!==null){var Z=$i.memoizedState;if(I=Z.destroy,M!==null&&N_(M,Z.deps)){R.memoizedState=kf(g,S,I,M);return}}Fn.flags|=p,R.memoizedState=kf(1|g,S,I,M)}function F_(p,g){return r0(8390656,8,p,g)}function Uf(p,g){return s0(2048,8,p,g)}function l3(p,g){return s0(4,2,p,g)}function u3(p,g){return s0(4,4,p,g)}function c3(p,g){if(typeof g=="function")return p=p(),g(p),function(){g(null)};if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function h3(p,g,S){return S=S!=null?S.concat([p]):null,s0(4,4,c3.bind(null,g,p),S)}function B_(){}function d3(p,g){var S=Lo();g=g===void 0?null:g;var M=S.memoizedState;return M!==null&&g!==null&&N_(g,M[1])?M[0]:(S.memoizedState=[p,g],p)}function f3(p,g){var S=Lo();g=g===void 0?null:g;var M=S.memoizedState;return M!==null&&g!==null&&N_(g,M[1])?M[0]:(p=p(),S.memoizedState=[p,g],p)}function Q6(p,g){var S=Jt;Jt=S!==0&&4>S?S:4,p(!0);var M=_s.transition;_s.transition={};try{p(!1),g()}finally{Jt=S,_s.transition=M}}function p3(){return Lo().memoizedState}function J6(p,g,S){var M=sl(p);S={lane:M,action:S,hasEagerState:!1,eagerState:null,next:null},m3(p)?g3(g,S):(v3(p,g,S),S=lr(),p=ws(p,M,S),p!==null&&y3(p,g,M))}function ej(p,g,S){var M=sl(p),R={lane:M,action:S,hasEagerState:!1,eagerState:null,next:null};if(m3(p))g3(g,R);else{v3(p,g,R);var I=p.alternate;if(p.lanes===0&&(I===null||I.lanes===0)&&(I=g.lastRenderedReducer,I!==null))try{var Z=g.lastRenderedState,re=I(Z,S);if(R.hasEagerState=!0,R.eagerState=re,To(re,Z))return}catch{}finally{}S=lr(),p=ws(p,M,S),p!==null&&y3(p,g,M)}}function m3(p){var g=p.alternate;return p===Fn||g!==null&&g===Fn}function g3(p,g){Of=t0=!0;var S=p.pending;S===null?g.next=g:(g.next=S.next,S.next=g),p.pending=g}function v3(p,g,S){si!==null&&p.mode&1&&!(Bt&2)?(p=g.interleaved,p===null?(S.next=S,Po===null?Po=[g]:Po.push(g)):(S.next=p.next,p.next=S),g.interleaved=S):(p=g.pending,p===null?S.next=S:(S.next=p.next,p.next=S),g.pending=S)}function y3(p,g,S){if(S&4194240){var M=g.lanes;M&=p.pendingLanes,S|=M,g.lanes=S,p_(p,S)}}var o0={readContext:gs,useCallback:qi,useContext:qi,useEffect:qi,useImperativeHandle:qi,useInsertionEffect:qi,useLayoutEffect:qi,useMemo:qi,useReducer:qi,useRef:qi,useState:qi,useDebugValue:qi,useDeferredValue:qi,useTransition:qi,useMutableSource:qi,useSyncExternalStore:qi,useId:qi,unstable_isNewReconciler:!1},tj={readContext:gs,useCallback:function(p,g){return da().memoizedState=[p,g===void 0?null:g],p},useContext:gs,useEffect:F_,useImperativeHandle:function(p,g,S){return S=S!=null?S.concat([p]):null,r0(4194308,4,c3.bind(null,g,p),S)},useLayoutEffect:function(p,g){return r0(4194308,4,p,g)},useInsertionEffect:function(p,g){return r0(4,2,p,g)},useMemo:function(p,g){var S=da();return g=g===void 0?null:g,p=p(),S.memoizedState=[p,g],p},useReducer:function(p,g,S){var M=da();return g=S!==void 0?S(g):g,M.memoizedState=M.baseState=g,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:g},M.queue=p,p=p.dispatch=J6.bind(null,Fn,p),[M.memoizedState,p]},useRef:function(p){var g=da();return p={current:p},g.memoizedState=p},useState:z_,useDebugValue:B_,useDeferredValue:function(p){var g=z_(p),S=g[0],M=g[1];return F_(function(){var R=_s.transition;_s.transition={};try{M(p)}finally{_s.transition=R}},[p]),S},useTransition:function(){var p=z_(!1),g=p[0];return p=Q6.bind(null,p[1]),da().memoizedState=p,[g,p]},useMutableSource:function(){},useSyncExternalStore:function(p,g,S){var M=Fn,R=da();if(An){if(S===void 0)throw Error(o(407));S=S()}else{if(S=g(),si===null)throw Error(o(349));ah&30||i3(M,g,S)}R.memoizedState=S;var I={value:S,getSnapshot:g};return R.queue=I,F_(s3.bind(null,M,I,p),[p]),M.flags|=2048,kf(9,r3.bind(null,M,I,S,g),void 0,null),S},useId:function(){var p=da(),g=si.identifierPrefix;if(An){var S=ha,M=ca;S=(M&~(1<<32-qr(M)-1)).toString(32)+S,g=":"+g+"R"+S,S=Nf++,0<S&&(g+="H"+S.toString(32)),g+=":"}else S=K6++,g=":"+g+"r"+S.toString(32)+":";return p.memoizedState=g},unstable_isNewReconciler:!1},nj={readContext:gs,useCallback:d3,useContext:gs,useEffect:Uf,useImperativeHandle:h3,useInsertionEffect:l3,useLayoutEffect:u3,useMemo:f3,useReducer:n0,useRef:a3,useState:function(){return n0(xu)},useDebugValue:B_,useDeferredValue:function(p){var g=n0(xu),S=g[0],M=g[1];return Uf(function(){var R=_s.transition;_s.transition={};try{M(p)}finally{_s.transition=R}},[p]),S},useTransition:function(){var p=n0(xu)[0],g=Lo().memoizedState;return[p,g]},useMutableSource:t3,useSyncExternalStore:n3,useId:p3,unstable_isNewReconciler:!1},ij={readContext:gs,useCallback:d3,useContext:gs,useEffect:Uf,useImperativeHandle:h3,useInsertionEffect:l3,useLayoutEffect:u3,useMemo:f3,useReducer:i0,useRef:a3,useState:function(){return i0(xu)},useDebugValue:B_,useDeferredValue:function(p){var g=i0(xu),S=g[0],M=g[1];return Uf(function(){var R=_s.transition;_s.transition={};try{M(p)}finally{_s.transition=R}},[p]),S},useTransition:function(){var p=i0(xu)[0],g=Lo().memoizedState;return[p,g]},useMutableSource:t3,useSyncExternalStore:n3,useId:p3,unstable_isNewReconciler:!1};function V_(p,g){try{var S="",M=g;do S+=Z6(M),M=M.return;while(M);var R=S}catch(I){R=`
Error generating stack: `+I.message+`
`+I.stack}return{value:p,source:g,stack:R}}function j_(p,g){try{console.error(g.value)}catch(S){setTimeout(function(){throw S})}}var rj=typeof WeakMap=="function"?WeakMap:Map;function x3(p,g,S){S=ua(-1,S),S.tag=3,S.payload={element:null};var M=g.value;return S.callback=function(){S0||(S0=!0,ow=M),j_(p,g)},S}function _3(p,g,S){S=ua(-1,S),S.tag=3;var M=p.type.getDerivedStateFromError;if(typeof M=="function"){var R=g.value;S.payload=function(){return M(R)},S.callback=function(){j_(p,g)}}var I=p.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(S.callback=function(){j_(p,g),typeof M!="function"&&(il===null?il=new Set([this]):il.add(this));var Z=g.stack;this.componentDidCatch(g.value,{componentStack:Z!==null?Z:""})}),S}function w3(p,g,S){var M=p.pingCache;if(M===null){M=p.pingCache=new rj;var R=new Set;M.set(g,R)}else R=M.get(g),R===void 0&&(R=new Set,M.set(g,R));R.has(S)||(R.add(S),p=yj.bind(null,p,g,S),g.then(p,p))}function S3(p){do{var g;if((g=p.tag===13)&&(g=p.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return p;p=p.return}while(p!==null);return null}function b3(p,g,S,M,R){return p.mode&1?(p.flags|=65536,p.lanes=R,p):(p===g?p.flags|=65536:(p.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(g=ua(-1,1),g.tag=2,nl(S,g))),S.lanes|=1),p)}function Do(p){p.flags|=4}function M3(p,g){if(p!==null&&p.child===g.child)return!0;if(g.flags&16)return!1;for(p=g.child;p!==null;){if(p.flags&12854||p.subtreeFlags&12854)return!1;p=p.sibling}return!0}var zf,Ff,a0,l0;if(ae)zf=function(p,g){for(var S=g.child;S!==null;){if(S.tag===5||S.tag===6)$(p,S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===g)break;for(;S.sibling===null;){if(S.return===null||S.return===g)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},Ff=function(){},a0=function(p,g,S,M,R){if(p=p.memoizedProps,p!==M){var I=g.stateNode,Z=Ro(xs.current);S=Q(I,S,p,M,R,Z),(g.updateQueue=S)&&Do(g)}},l0=function(p,g,S,M){S!==M&&Do(g)};else if(W){zf=function(p,g,S,M){for(var R=g.child;R!==null;){if(R.tag===5){var I=R.stateNode;S&&M&&(I=Cn(I,R.type,R.memoizedProps,R)),$(p,I)}else if(R.tag===6)I=R.stateNode,S&&M&&(I=or(I,R.memoizedProps,R)),$(p,I);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)I=R.child,I!==null&&(I.return=R),zf(p,R,!0,!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===g)break;for(;R.sibling===null;){if(R.return===null||R.return===g)return;R=R.return}R.sibling.return=R.return,R=R.sibling}};var A3=function(p,g,S,M){for(var R=g.child;R!==null;){if(R.tag===5){var I=R.stateNode;S&&M&&(I=Cn(I,R.type,R.memoizedProps,R)),$e(p,I)}else if(R.tag===6)I=R.stateNode,S&&M&&(I=or(I,R.memoizedProps,R)),$e(p,I);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)I=R.child,I!==null&&(I.return=R),A3(p,R,!0,!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===g)break;for(;R.sibling===null;){if(R.return===null||R.return===g)return;R=R.return}R.sibling.return=R.return,R=R.sibling}};Ff=function(p,g){var S=g.stateNode;if(!M3(p,g)){p=S.containerInfo;var M=Te(p);A3(M,g,!1,!1),S.pendingChildren=M,Do(g),vt(p,M)}},a0=function(p,g,S,M,R){var I=p.stateNode,Z=p.memoizedProps;if((p=M3(p,g))&&Z===M)g.stateNode=I;else{var re=g.stateNode,Ee=Ro(xs.current),Be=null;Z!==M&&(Be=Q(re,S,Z,M,R,Ee)),p&&Be===null?g.stateNode=I:(I=je(I,Be,S,Z,M,g,p,re),te(I,S,M,R,Ee)&&Do(g),g.stateNode=I,p?Do(g):zf(I,g,!1,!1))}},l0=function(p,g,S,M){S!==M?(p=Ro(sh.current),S=Ro(xs.current),g.stateNode=ie(M,p,S,g),Do(g)):g.stateNode=p.stateNode}}else Ff=function(){},a0=function(){},l0=function(){};function Bf(p,g){if(!An)switch(p.tailMode){case"hidden":g=p.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?p.tail=null:S.sibling=null;break;case"collapsed":S=p.tail;for(var M=null;S!==null;)S.alternate!==null&&(M=S),S=S.sibling;M===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:M.sibling=null}}function Xi(p){var g=p.alternate!==null&&p.alternate.child===p.child,S=0,M=0;if(g)for(var R=p.child;R!==null;)S|=R.lanes|R.childLanes,M|=R.subtreeFlags&14680064,M|=R.flags&14680064,R.return=p,R=R.sibling;else for(R=p.child;R!==null;)S|=R.lanes|R.childLanes,M|=R.subtreeFlags,M|=R.flags,R.return=p,R=R.sibling;return p.subtreeFlags|=M,p.childLanes=S,g}function sj(p,g,S){var M=g.pendingProps;switch(T_(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xi(g),null;case 1:return Ai(g.type)&&ri(),Xi(g),null;case 3:return M=g.stateNode,oh(),wt(zn),wt(Gt),O_(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(p===null||p.child===null)&&(Rf(g)?Do(g):p===null||p.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,Xs!==null&&(uw(Xs),Xs=null))),Ff(p,g),Xi(g),null;case 5:D_(g),S=Ro(sh.current);var R=g.type;if(p!==null&&g.stateNode!=null)a0(p,g,R,M,S),p.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!M){if(g.stateNode===null)throw Error(o(166));return Xi(g),null}if(p=Ro(xs.current),Rf(g)){if(!me)throw Error(o(175));p=u_(g.stateNode,g.type,g.memoizedProps,S,p,g,!Pf),g.updateQueue=p,p!==null&&Do(g)}else{var I=z(R,M,S,p,g);zf(I,g,!1,!1),g.stateNode=I,te(I,R,M,S,p)&&Do(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Xi(g),null;case 6:if(p&&g.stateNode!=null)l0(p,g,p.memoizedProps,M);else{if(typeof M!="string"&&g.stateNode===null)throw Error(o(166));if(p=Ro(sh.current),S=Ro(xs.current),Rf(g)){if(!me)throw Error(o(176));if(p=g.stateNode,M=g.memoizedProps,(S=c_(p,M,g,!Pf))&&(R=Xr,R!==null))switch(I=(R.mode&1)!==0,R.tag){case 3:lt(R.stateNode.containerInfo,p,M,I);break;case 5:yt(R.type,R.memoizedProps,R.stateNode,p,M,I)}S&&Do(g)}else g.stateNode=ie(M,p,S,g)}return Xi(g),null;case 13:if(wt(Rn),M=g.memoizedState,An&&Yr!==null&&g.mode&1&&!(g.flags&128)){for(p=Yr;p;)p=el(p);return ih(),g.flags|=98560,g}if(M!==null&&M.dehydrated!==null){if(M=Rf(g),p===null){if(!M)throw Error(o(318));if(!me)throw Error(o(344));if(p=g.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(o(317));h_(p,g)}else ih(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;return Xi(g),null}return Xs!==null&&(uw(Xs),Xs=null),g.flags&128?(g.lanes=S,g):(M=M!==null,S=!1,p===null?Rf(g):S=p.memoizedState!==null,M&&!S&&(g.child.flags|=8192,g.mode&1&&(p===null||Rn.current&1?fi===0&&(fi=3):hw())),g.updateQueue!==null&&(g.flags|=4),Xi(g),null);case 4:return oh(),Ff(p,g),p===null&&ce(g.stateNode.containerInfo),Xi(g),null;case 10:return w_(g.type._context),Xi(g),null;case 17:return Ai(g.type)&&ri(),Xi(g),null;case 19:if(wt(Rn),R=g.memoizedState,R===null)return Xi(g),null;if(M=(g.flags&128)!==0,I=R.rendering,I===null)if(M)Bf(R,!1);else{if(fi!==0||p!==null&&p.flags&128)for(p=g.child;p!==null;){if(I=Jg(p),I!==null){for(g.flags|=128,Bf(R,!1),p=I.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),g.subtreeFlags=0,p=S,M=g.child;M!==null;)S=M,R=p,S.flags&=14680066,I=S.alternate,I===null?(S.childLanes=0,S.lanes=R,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=I.childLanes,S.lanes=I.lanes,S.child=I.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=I.memoizedProps,S.memoizedState=I.memoizedState,S.updateQueue=I.updateQueue,S.type=I.type,R=I.dependencies,S.dependencies=R===null?null:{lanes:R.lanes,firstContext:R.firstContext}),M=M.sibling;return st(Rn,Rn.current&1|2),g.child}p=p.sibling}R.tail!==null&&Ti()>sw&&(g.flags|=128,M=!0,Bf(R,!1),g.lanes=4194304)}else{if(!M)if(p=Jg(I),p!==null){if(g.flags|=128,M=!0,p=p.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),Bf(R,!0),R.tail===null&&R.tailMode==="hidden"&&!I.alternate&&!An)return Xi(g),null}else 2*Ti()-R.renderingStartTime>sw&&S!==1073741824&&(g.flags|=128,M=!0,Bf(R,!1),g.lanes=4194304);R.isBackwards?(I.sibling=g.child,g.child=I):(p=R.last,p!==null?p.sibling=I:g.child=I,R.last=I)}return R.tail!==null?(g=R.tail,R.rendering=g,R.tail=g.sibling,R.renderingStartTime=Ti(),g.sibling=null,p=Rn.current,st(Rn,M?p&1|2:p&1),g):(Xi(g),null);case 22:case 23:return cw(),M=g.memoizedState!==null,p!==null&&p.memoizedState!==null!==M&&(g.flags|=8192),M&&g.mode&1?Kr&1073741824&&(Xi(g),ae&&g.subtreeFlags&6&&(g.flags|=8192)):Xi(g),null;case 24:return null;case 25:return null}throw Error(o(156,g.tag))}var oj=a.ReactCurrentOwner,Zr=!1;function ar(p,g,S,M){g.child=p===null?JC(g,null,S,M):rh(g,p.child,S,M)}function E3(p,g,S,M,R){S=S.render;var I=g.ref;return eh(g,R),M=k_(p,g,S,M,I,R),S=U_(),p!==null&&!Zr?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~R,fa(p,g,R)):(An&&S&&E_(g),g.flags|=1,ar(p,g,M,R),g.child)}function T3(p,g,S,M,R){if(p===null){var I=S.type;return typeof I=="function"&&!dw(I)&&I.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(g.tag=15,g.type=I,C3(p,g,I,M,R)):(p=P0(S.type,null,M,g,g.mode,R),p.ref=g.ref,p.return=g,g.child=p)}if(I=p.child,!(p.lanes&R)){var Z=I.memoizedProps;if(S=S.compare,S=S!==null?S:Hg,S(Z,M)&&p.ref===g.ref)return fa(p,g,R)}return g.flags|=1,p=al(I,M),p.ref=g.ref,p.return=g,g.child=p}function C3(p,g,S,M,R){if(p!==null&&Hg(p.memoizedProps,M)&&p.ref===g.ref)if(Zr=!1,(p.lanes&R)!==0)p.flags&131072&&(Zr=!0);else return g.lanes=p.lanes,fa(p,g,R);return G_(p,g,S,M,R)}function P3(p,g,S){var M=g.pendingProps,R=M.children,I=p!==null?p.memoizedState:null;if(M.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null},st(lh,Kr),Kr|=S;else if(S&1073741824)g.memoizedState={baseLanes:0,cachePool:null},M=I!==null?I.baseLanes:S,st(lh,Kr),Kr|=M;else return p=I!==null?I.baseLanes|S:S,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:p,cachePool:null},g.updateQueue=null,st(lh,Kr),Kr|=p,null;else I!==null?(M=I.baseLanes|S,g.memoizedState=null):M=S,st(lh,Kr),Kr|=M;return ar(p,g,R,S),g.child}function R3(p,g){var S=g.ref;(p===null&&S!==null||p!==null&&p.ref!==S)&&(g.flags|=512,g.flags|=2097152)}function G_(p,g,S,M,R){var I=Ai(S)?Mo:Gt.current;return I=ms(g,I),eh(g,R),S=k_(p,g,S,M,I,R),M=U_(),p!==null&&!Zr?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~R,fa(p,g,R)):(An&&M&&E_(g),g.flags|=1,ar(p,g,S,R),g.child)}function L3(p,g,S,M,R){if(Ai(S)){var I=!0;Ei(g)}else I=!1;if(eh(g,R),g.stateNode===null)p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),WC(g,S,M),A_(g,S,M,R),M=!0;else if(p===null){var Z=g.stateNode,re=g.memoizedProps;Z.props=re;var Ee=Z.context,Be=S.contextType;typeof Be=="object"&&Be!==null?Be=gs(Be):(Be=Ai(S)?Mo:Gt.current,Be=ms(g,Be));var it=S.getDerivedStateFromProps,Dt=typeof it=="function"||typeof Z.getSnapshotBeforeUpdate=="function";Dt||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(re!==M||Ee!==Be)&&$C(g,Z,M,Be),tl=!1;var pt=g.memoizedState;Z.state=pt,Xg(g,M,Z,R),Ee=g.memoizedState,re!==M||pt!==Ee||zn.current||tl?(typeof it=="function"&&(M_(g,S,it,M),Ee=g.memoizedState),(re=tl||HC(g,S,re,M,pt,Ee,Be))?(Dt||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(g.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=M,g.memoizedState=Ee),Z.props=M,Z.state=Ee,Z.context=Be,M=re):(typeof Z.componentDidMount=="function"&&(g.flags|=4194308),M=!1)}else{Z=g.stateNode,BC(p,g),re=g.memoizedProps,Be=g.type===g.elementType?re:qs(g.type,re),Z.props=Be,Dt=g.pendingProps,pt=Z.context,Ee=S.contextType,typeof Ee=="object"&&Ee!==null?Ee=gs(Ee):(Ee=Ai(S)?Mo:Gt.current,Ee=ms(g,Ee));var pn=S.getDerivedStateFromProps;(it=typeof pn=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(re!==Dt||pt!==Ee)&&$C(g,Z,M,Ee),tl=!1,pt=g.memoizedState,Z.state=pt,Xg(g,M,Z,R);var ut=g.memoizedState;re!==Dt||pt!==ut||zn.current||tl?(typeof pn=="function"&&(M_(g,S,pn,M),ut=g.memoizedState),(Be=tl||HC(g,S,Be,M,pt,ut,Ee)||!1)?(it||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(M,ut,Ee),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(M,ut,Ee)),typeof Z.componentDidUpdate=="function"&&(g.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof Z.componentDidUpdate!="function"||re===p.memoizedProps&&pt===p.memoizedState||(g.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&pt===p.memoizedState||(g.flags|=1024),g.memoizedProps=M,g.memoizedState=ut),Z.props=M,Z.state=ut,Z.context=Ee,M=Be):(typeof Z.componentDidUpdate!="function"||re===p.memoizedProps&&pt===p.memoizedState||(g.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&pt===p.memoizedState||(g.flags|=1024),M=!1)}return H_(p,g,S,M,I,R)}function H_(p,g,S,M,R,I){R3(p,g);var Z=(g.flags&128)!==0;if(!M&&!Z)return R&&Qc(g,S,!1),fa(p,g,I);M=g.stateNode,oj.current=g;var re=Z&&typeof S.getDerivedStateFromError!="function"?null:M.render();return g.flags|=1,p!==null&&Z?(g.child=rh(g,p.child,null,I),g.child=rh(g,null,re,I)):ar(p,g,re,I),g.memoizedState=M.state,R&&Qc(g,S,!0),g.child}function D3(p){var g=p.stateNode;g.pendingContext?Ao(p,g.pendingContext,g.pendingContext!==g.context):g.context&&Ao(p,g.context,!1),L_(p,g.containerInfo)}function I3(p,g,S,M,R){return ih(),R_(R),g.flags|=256,ar(p,g,S,M),g.child}var u0={dehydrated:null,treeContext:null,retryLane:0};function c0(p){return{baseLanes:p,cachePool:null}}function O3(p,g,S){var M=g.pendingProps,R=Rn.current,I=!1,Z=(g.flags&128)!==0,re;if((re=Z)||(re=p!==null&&p.memoizedState===null?!1:(R&2)!==0),re?(I=!0,g.flags&=-129):(p===null||p.memoizedState!==null)&&(R|=1),st(Rn,R&1),p===null)return P_(g),p=g.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?(g.mode&1?Ef(p)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(R=M.children,p=M.fallback,I?(M=g.mode,I=g.child,R={mode:"hidden",children:R},!(M&1)&&I!==null?(I.childLanes=0,I.pendingProps=R):I=R0(R,M,0,null),p=Au(p,M,S,null),I.return=g,p.return=g,I.sibling=p,g.child=I,g.child.memoizedState=c0(S),g.memoizedState=u0,p):W_(g,R));if(R=p.memoizedState,R!==null){if(re=R.dehydrated,re!==null){if(Z)return g.flags&256?(g.flags&=-257,h0(p,g,S,Error(o(422)))):g.memoizedState!==null?(g.child=p.child,g.flags|=128,null):(I=M.fallback,R=g.mode,M=R0({mode:"visible",children:M.children},R,0,null),I=Au(I,R,S,null),I.flags|=2,M.return=g,I.return=g,M.sibling=I,g.child=M,g.mode&1&&rh(g,p.child,null,S),g.child.memoizedState=c0(S),g.memoizedState=u0,I);if(!(g.mode&1))g=h0(p,g,S,null);else if(Ef(re))g=h0(p,g,S,Error(o(419)));else if(M=(S&p.childLanes)!==0,Zr||M){if(M=si,M!==null){switch(S&-S){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}M=I&(M.suspendedLanes|S)?0:I,M!==0&&M!==R.retryLane&&(R.retryLane=M,ws(p,M,-1))}hw(),g=h0(p,g,S,Error(o(421)))}else Af(re)?(g.flags|=128,g.child=p.child,g=xj.bind(null,p),Yc(re,g),g=null):(S=R.treeContext,me&&(Yr=Ug(re),Xr=g,An=!0,Xs=null,Pf=!1,S!==null&&(vs[ys++]=ca,vs[ys++]=ha,vs[ys++]=vu,ca=S.id,ha=S.overflow,vu=g)),g=W_(g,g.pendingProps.children),g.flags|=4096);return g}return I?(M=k3(p,g,M.children,M.fallback,S),I=g.child,R=p.child.memoizedState,I.memoizedState=R===null?c0(S):{baseLanes:R.baseLanes|S,cachePool:null},I.childLanes=p.childLanes&~S,g.memoizedState=u0,M):(S=N3(p,g,M.children,S),g.memoizedState=null,S)}return I?(M=k3(p,g,M.children,M.fallback,S),I=g.child,R=p.child.memoizedState,I.memoizedState=R===null?c0(S):{baseLanes:R.baseLanes|S,cachePool:null},I.childLanes=p.childLanes&~S,g.memoizedState=u0,M):(S=N3(p,g,M.children,S),g.memoizedState=null,S)}function W_(p,g){return g=R0({mode:"visible",children:g},p.mode,0,null),g.return=p,p.child=g}function N3(p,g,S,M){var R=p.child;return p=R.sibling,S=al(R,{mode:"visible",children:S}),!(g.mode&1)&&(S.lanes=M),S.return=g,S.sibling=null,p!==null&&(M=g.deletions,M===null?(g.deletions=[p],g.flags|=16):M.push(p)),g.child=S}function k3(p,g,S,M,R){var I=g.mode;p=p.child;var Z=p.sibling,re={mode:"hidden",children:S};return!(I&1)&&g.child!==p?(S=g.child,S.childLanes=0,S.pendingProps=re,g.deletions=null):(S=al(p,re),S.subtreeFlags=p.subtreeFlags&14680064),Z!==null?M=al(Z,M):(M=Au(M,I,R,null),M.flags|=2),M.return=g,S.return=g,S.sibling=M,g.child=S,M}function h0(p,g,S,M){return M!==null&&R_(M),rh(g,p.child,null,S),p=W_(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function U3(p,g,S){p.lanes|=g;var M=p.alternate;M!==null&&(M.lanes|=g),S_(p.return,g,S)}function $_(p,g,S,M,R){var I=p.memoizedState;I===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:M,tail:S,tailMode:R}:(I.isBackwards=g,I.rendering=null,I.renderingStartTime=0,I.last=M,I.tail=S,I.tailMode=R)}function z3(p,g,S){var M=g.pendingProps,R=M.revealOrder,I=M.tail;if(ar(p,g,M.children,S),M=Rn.current,M&2)M=M&1|2,g.flags|=128;else{if(p!==null&&p.flags&128)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&U3(p,S,g);else if(p.tag===19)U3(p,S,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}M&=1}if(st(Rn,M),!(g.mode&1))g.memoizedState=null;else switch(R){case"forwards":for(S=g.child,R=null;S!==null;)p=S.alternate,p!==null&&Jg(p)===null&&(R=S),S=S.sibling;S=R,S===null?(R=g.child,g.child=null):(R=S.sibling,S.sibling=null),$_(g,!1,R,S,I);break;case"backwards":for(S=null,R=g.child,g.child=null;R!==null;){if(p=R.alternate,p!==null&&Jg(p)===null){g.child=R;break}p=R.sibling,R.sibling=S,S=R,R=p}$_(g,!0,S,null,I);break;case"together":$_(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function fa(p,g,S){if(p!==null&&(g.dependencies=p.dependencies),uh|=g.lanes,!(S&g.childLanes))return null;if(p!==null&&g.child!==p.child)throw Error(o(153));if(g.child!==null){for(p=g.child,S=al(p,p.pendingProps),g.child=S,S.return=g;p.sibling!==null;)p=p.sibling,S=S.sibling=al(p,p.pendingProps),S.return=g;S.sibling=null}return g.child}function aj(p,g,S){switch(g.tag){case 3:D3(g),ih();break;case 5:e3(g);break;case 1:Ai(g.type)&&Ei(g);break;case 4:L_(g,g.stateNode.containerInfo);break;case 10:FC(g,g.type._context,g.memoizedProps.value);break;case 13:var M=g.memoizedState;if(M!==null)return M.dehydrated!==null?(st(Rn,Rn.current&1),g.flags|=128,null):S&g.child.childLanes?O3(p,g,S):(st(Rn,Rn.current&1),p=fa(p,g,S),p!==null?p.sibling:null);st(Rn,Rn.current&1);break;case 19:if(M=(S&g.childLanes)!==0,p.flags&128){if(M)return z3(p,g,S);g.flags|=128}var R=g.memoizedState;if(R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),st(Rn,Rn.current),M)break;return null;case 22:case 23:return g.lanes=0,P3(p,g,S)}return fa(p,g,S)}function lj(p,g){switch(T_(g),g.tag){case 1:return Ai(g.type)&&ri(),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return oh(),wt(zn),wt(Gt),O_(),p=g.flags,p&65536&&!(p&128)?(g.flags=p&-65537|128,g):null;case 5:return D_(g),null;case 13:if(wt(Rn),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(o(340));ih()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return wt(Rn),null;case 4:return oh(),null;case 10:return w_(g.type._context),null;case 22:case 23:return cw(),null;case 24:return null;default:return null}}var d0=!1,_u=!1,uj=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function f0(p,g){var S=p.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(M){Rr(p,g,M)}else S.current=null}function q_(p,g,S){try{S()}catch(M){Rr(p,g,M)}}var F3=!1;function cj(p,g){for(V(p.containerInfo),Ze=g;Ze!==null;)if(p=Ze,g=p.child,(p.subtreeFlags&1028)!==0&&g!==null)g.return=p,Ze=g;else for(;Ze!==null;){p=Ze;try{var S=p.alternate;if(p.flags&1024)switch(p.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var M=S.memoizedProps,R=S.memoizedState,I=p.stateNode,Z=I.getSnapshotBeforeUpdate(p.elementType===p.type?M:qs(p.type,M),R);I.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:ae&&Ye(p.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(re){Rr(p,p.return,re)}if(g=p.sibling,g!==null){g.return=p.return,Ze=g;break}Ze=p.return}return S=F3,F3=!1,S}function wu(p,g,S){var M=g.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var R=M=M.next;do{if((R.tag&p)===p){var I=R.destroy;R.destroy=void 0,I!==void 0&&q_(g,S,I)}R=R.next}while(R!==M)}}function Vf(p,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var S=g=g.next;do{if((S.tag&p)===p){var M=S.create;S.destroy=M()}S=S.next}while(S!==g)}}function X_(p){var g=p.ref;if(g!==null){var S=p.stateNode;switch(p.tag){case 5:p=K(S);break;default:p=S}typeof g=="function"?g(p):g.current=p}}function B3(p,g,S){if(Eo&&typeof Eo.onCommitFiberUnmount=="function")try{Eo.onCommitFiberUnmount(jg,g)}catch{}switch(g.tag){case 0:case 11:case 14:case 15:if(p=g.updateQueue,p!==null&&(p=p.lastEffect,p!==null)){var M=p=p.next;do{var R=M,I=R.destroy;R=R.tag,I!==void 0&&(R&2||R&4)&&q_(g,S,I),M=M.next}while(M!==p)}break;case 1:if(f0(g,S),p=g.stateNode,typeof p.componentWillUnmount=="function")try{p.props=g.memoizedProps,p.state=g.memoizedState,p.componentWillUnmount()}catch(Z){Rr(g,S,Z)}break;case 5:f0(g,S);break;case 4:ae?$3(p,g,S):W&&W&&(g=g.stateNode.containerInfo,S=Te(g),Xt(g,S))}}function V3(p,g,S){for(var M=g;;)if(B3(p,M,S),M.child===null||ae&&M.tag===4){if(M===g)break;for(;M.sibling===null;){if(M.return===null||M.return===g)return;M=M.return}M.sibling.return=M.return,M=M.sibling}else M.child.return=M,M=M.child}function j3(p){var g=p.alternate;g!==null&&(p.alternate=null,j3(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&De(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function G3(p){return p.tag===5||p.tag===3||p.tag===4}function H3(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||G3(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function W3(p){if(ae){e:{for(var g=p.return;g!==null;){if(G3(g))break e;g=g.return}throw Error(o(160))}var S=g;switch(S.tag){case 5:g=S.stateNode,S.flags&32&&(gt(g),S.flags&=-33),S=H3(p),Z_(p,S,g);break;case 3:case 4:g=S.stateNode.containerInfo,S=H3(p),Y_(p,S,g);break;default:throw Error(o(161))}}}function Y_(p,g,S){var M=p.tag;if(M===5||M===6)p=p.stateNode,g?Fe(S,p,g):rt(S,p);else if(M!==4&&(p=p.child,p!==null))for(Y_(p,g,S),p=p.sibling;p!==null;)Y_(p,g,S),p=p.sibling}function Z_(p,g,S){var M=p.tag;if(M===5||M===6)p=p.stateNode,g?Wt(S,p,g):Ie(S,p);else if(M!==4&&(p=p.child,p!==null))for(Z_(p,g,S),p=p.sibling;p!==null;)Z_(p,g,S),p=p.sibling}function $3(p,g,S){for(var M=g,R=!1,I,Z;;){if(!R){R=M.return;e:for(;;){if(R===null)throw Error(o(160));switch(I=R.stateNode,R.tag){case 5:Z=!1;break e;case 3:I=I.containerInfo,Z=!0;break e;case 4:I=I.containerInfo,Z=!0;break e}R=R.return}R=!0}if(M.tag===5||M.tag===6)V3(p,M,S),Z?Mt(I,M.stateNode):Qt(I,M.stateNode);else if(M.tag===18)Z?be(I,M.stateNode):we(I,M.stateNode);else if(M.tag===4){if(M.child!==null){I=M.stateNode.containerInfo,Z=!0,M.child.return=M,M=M.child;continue}}else if(B3(p,M,S),M.child!==null){M.child.return=M,M=M.child;continue}if(M===g)break;for(;M.sibling===null;){if(M.return===null||M.return===g)return;M=M.return,M.tag===4&&(R=!1)}M.sibling.return=M.return,M=M.sibling}}function K_(p,g){if(ae){switch(g.tag){case 0:case 11:case 14:case 15:wu(3,g,g.return),Vf(3,g),wu(5,g,g.return);return;case 1:return;case 5:var S=g.stateNode;if(S!=null){var M=g.memoizedProps;p=p!==null?p.memoizedProps:M;var R=g.type,I=g.updateQueue;g.updateQueue=null,I!==null&&ot(S,I,R,p,M,g)}return;case 6:if(g.stateNode===null)throw Error(o(162));S=g.memoizedProps,Oe(g.stateNode,p!==null?p.memoizedProps:S,S);return;case 3:me&&p!==null&&p.memoizedState.isDehydrated&&fe(g.stateNode.containerInfo);return;case 12:return;case 13:p0(g);return;case 19:p0(g);return;case 17:return}throw Error(o(163))}switch(g.tag){case 0:case 11:case 14:case 15:wu(3,g,g.return),Vf(3,g),wu(5,g,g.return);return;case 12:return;case 13:p0(g);return;case 19:p0(g);return;case 3:me&&p!==null&&p.memoizedState.isDehydrated&&fe(g.stateNode.containerInfo);break;case 22:case 23:return}e:if(W){switch(g.tag){case 1:case 5:case 6:break e;case 3:case 4:g=g.stateNode,Xt(g.containerInfo,g.pendingChildren);break e}throw Error(o(163))}}function p0(p){var g=p.updateQueue;if(g!==null){p.updateQueue=null;var S=p.stateNode;S===null&&(S=p.stateNode=new uj),g.forEach(function(M){var R=_j.bind(null,p,M);S.has(M)||(S.add(M),M.then(R,R))})}}function hj(p,g){for(Ze=g;Ze!==null;){g=Ze;var S=g.deletions;if(S!==null)for(var M=0;M<S.length;M++){var R=S[M];try{var I=p;ae?$3(I,R,g):V3(I,R,g);var Z=R.alternate;Z!==null&&(Z.return=null),R.return=null}catch(at){Rr(R,g,at)}}if(S=g.child,g.subtreeFlags&12854&&S!==null)S.return=g,Ze=S;else for(;Ze!==null;){g=Ze;try{var re=g.flags;if(re&32&&ae&&gt(g.stateNode),re&512){var Ee=g.alternate;if(Ee!==null){var Be=Ee.ref;Be!==null&&(typeof Be=="function"?Be(null):Be.current=null)}}if(re&8192)switch(g.tag){case 13:if(g.memoizedState!==null){var it=g.alternate;(it===null||it.memoizedState===null)&&(rw=Ti())}break;case 22:var Dt=g.memoizedState!==null,pt=g.alternate,pn=pt!==null&&pt.memoizedState!==null;if(S=g,ae){e:if(M=S,R=Dt,I=null,ae)for(var ut=M;;){if(ut.tag===5){if(I===null){I=ut;var Yi=ut.stateNode;R?ft(Yi):Ft(ut.stateNode,ut.memoizedProps)}}else if(ut.tag===6){if(I===null){var bs=ut.stateNode;R?Xe(bs):ne(bs,ut.memoizedProps)}}else if((ut.tag!==22&&ut.tag!==23||ut.memoizedState===null||ut===M)&&ut.child!==null){ut.child.return=ut,ut=ut.child;continue}if(ut===M)break;for(;ut.sibling===null;){if(ut.return===null||ut.return===M)break e;I===ut&&(I=null),ut=ut.return}I===ut&&(I=null),ut.sibling.return=ut.return,ut=ut.sibling}}if(Dt&&!pn&&S.mode&1){Ze=S;for(var ve=S.child;ve!==null;){for(S=Ze=ve;Ze!==null;){M=Ze;var oe=M.child;switch(M.tag){case 0:case 11:case 14:case 15:wu(4,M,M.return);break;case 1:f0(M,M.return);var _e=M.stateNode;if(typeof _e.componentWillUnmount=="function"){var Qe=M.return;try{_e.props=M.memoizedProps,_e.state=M.memoizedState,_e.componentWillUnmount()}catch(at){Rr(M,Qe,at)}}break;case 5:f0(M,M.return);break;case 22:if(M.memoizedState!==null){Y3(S);continue}}oe!==null?(oe.return=M,Ze=oe):Y3(S)}ve=ve.sibling}}}switch(re&4102){case 2:W3(g),g.flags&=-3;break;case 6:W3(g),g.flags&=-3,K_(g.alternate,g);break;case 4096:g.flags&=-4097;break;case 4100:g.flags&=-4097,K_(g.alternate,g);break;case 4:K_(g.alternate,g)}}catch(at){Rr(g,g.return,at)}if(S=g.sibling,S!==null){S.return=g.return,Ze=S;break}Ze=g.return}}}function dj(p,g,S){Ze=p,q3(p)}function q3(p,g,S){for(var M=(p.mode&1)!==0;Ze!==null;){var R=Ze,I=R.child;if(R.tag===22&&M){var Z=R.memoizedState!==null||d0;if(!Z){var re=R.alternate,Ee=re!==null&&re.memoizedState!==null||_u;re=d0;var Be=_u;if(d0=Z,(_u=Ee)&&!Be)for(Ze=R;Ze!==null;)Z=Ze,Ee=Z.child,Z.tag===22&&Z.memoizedState!==null?Z3(R):Ee!==null?(Ee.return=Z,Ze=Ee):Z3(R);for(;I!==null;)Ze=I,q3(I),I=I.sibling;Ze=R,d0=re,_u=Be}X3(p)}else R.subtreeFlags&8772&&I!==null?(I.return=R,Ze=I):X3(p)}}function X3(p){for(;Ze!==null;){var g=Ze;if(g.flags&8772){var S=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:_u||Vf(5,g);break;case 1:var M=g.stateNode;if(g.flags&4&&!_u)if(S===null)M.componentDidMount();else{var R=g.elementType===g.type?S.memoizedProps:qs(g.type,S.memoizedProps);M.componentDidUpdate(R,S.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var I=g.updateQueue;I!==null&&jC(g,I,M);break;case 3:var Z=g.updateQueue;if(Z!==null){if(S=null,g.child!==null)switch(g.child.tag){case 5:S=K(g.child.stateNode);break;case 1:S=g.child.stateNode}jC(g,Z,S)}break;case 5:var re=g.stateNode;S===null&&g.flags&4&&Ge(re,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(me&&g.memoizedState===null){var Ee=g.alternate;if(Ee!==null){var Be=Ee.memoizedState;if(Be!==null){var it=Be.dehydrated;it!==null&&xe(it)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}_u||g.flags&512&&X_(g)}catch(Dt){Rr(g,g.return,Dt)}}if(g===p){Ze=null;break}if(S=g.sibling,S!==null){S.return=g.return,Ze=S;break}Ze=g.return}}function Y3(p){for(;Ze!==null;){var g=Ze;if(g===p){Ze=null;break}var S=g.sibling;if(S!==null){S.return=g.return,Ze=S;break}Ze=g.return}}function Z3(p){for(;Ze!==null;){var g=Ze;try{switch(g.tag){case 0:case 11:case 15:var S=g.return;try{Vf(4,g)}catch(Ee){Rr(g,S,Ee)}break;case 1:var M=g.stateNode;if(typeof M.componentDidMount=="function"){var R=g.return;try{M.componentDidMount()}catch(Ee){Rr(g,R,Ee)}}var I=g.return;try{X_(g)}catch(Ee){Rr(g,I,Ee)}break;case 5:var Z=g.return;try{X_(g)}catch(Ee){Rr(g,Z,Ee)}}}catch(Ee){Rr(g,g.return,Ee)}if(g===p){Ze=null;break}var re=g.sibling;if(re!==null){re.return=g.return,Ze=re;break}Ze=g.return}}var m0=0,g0=1,v0=2,y0=3,x0=4;if(typeof Symbol=="function"&&Symbol.for){var jf=Symbol.for;m0=jf("selector.component"),g0=jf("selector.has_pseudo_class"),v0=jf("selector.role"),y0=jf("selector.test_id"),x0=jf("selector.text")}function Q_(p){var g=ue(p);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(o(364));return g}if(p=He(p),p===null)throw Error(o(362));return p.stateNode.current}function J_(p,g){switch(g.$$typeof){case m0:if(p.type===g.value)return!0;break;case g0:e:{g=g.value,p=[p,0];for(var S=0;S<p.length;){var M=p[S++],R=p[S++],I=g[R];if(M.tag!==5||!B(M)){for(;I!=null&&J_(M,I);)R++,I=g[R];if(R===g.length){g=!0;break e}else for(M=M.child;M!==null;)p.push(M,R),M=M.sibling}}g=!1}return g;case v0:if(p.tag===5&&he(p.stateNode,g.value))return!0;break;case x0:if((p.tag===5||p.tag===6)&&(p=Y(p),p!==null&&0<=p.indexOf(g.value)))return!0;break;case y0:if(p.tag===5&&(p=p.memoizedProps["data-testname"],typeof p=="string"&&p.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function ew(p){switch(p.$$typeof){case m0:return"<"+(T(p.value)||"Unknown")+">";case g0:return":has("+(ew(p)||"")+")";case v0:return'[role="'+p.value+'"]';case x0:return'"'+p.value+'"';case y0:return'[data-testname="'+p.value+'"]';default:throw Error(o(365))}}function K3(p,g){var S=[];p=[p,0];for(var M=0;M<p.length;){var R=p[M++],I=p[M++],Z=g[I];if(R.tag!==5||!B(R)){for(;Z!=null&&J_(R,Z);)I++,Z=g[I];if(I===g.length)S.push(R);else for(R=R.child;R!==null;)p.push(R,I),R=R.sibling}}return S}function tw(p,g){if(!ke)throw Error(o(363));p=Q_(p),p=K3(p,g),g=[],p=Array.from(p);for(var S=0;S<p.length;){var M=p[S++];if(M.tag===5)B(M)||g.push(M.stateNode);else for(M=M.child;M!==null;)p.push(M),M=M.sibling}return g}var fj=Math.ceil,_0=a.ReactCurrentDispatcher,nw=a.ReactCurrentOwner,Zn=a.ReactCurrentBatchConfig,Bt=0,si=null,oi=null,Ui=0,Kr=0,lh=Mi(0),fi=0,Gf=null,uh=0,w0=0,iw=0,Hf=null,Cr=null,rw=0,sw=1/0;function ch(){sw=Ti()+500}var S0=!1,ow=null,il=null,b0=!1,rl=null,M0=0,Wf=0,aw=null,A0=-1,E0=0;function lr(){return Bt&6?Ti():A0!==-1?A0:A0=Ti()}function sl(p){return p.mode&1?Bt&2&&Ui!==0?Ui&-Ui:Y6.transition!==null?(E0===0&&(p=Fg,Fg<<=1,!(Fg&4194240)&&(Fg=64),E0=p),E0):(p=Jt,p!==0?p:ge()):1}function ws(p,g,S){if(50<Wf)throw Wf=0,aw=null,Error(o(185));var M=T0(p,g);return M===null?null:(Cf(M,g,S),(!(Bt&2)||M!==si)&&(M===si&&(!(Bt&2)&&(w0|=g),fi===4&&ol(M,Ui)),Pr(M,S),g===1&&Bt===0&&!(p.mode&1)&&(ch(),Gg&&Co())),M)}function T0(p,g){p.lanes|=g;var S=p.alternate;for(S!==null&&(S.lanes|=g),S=p,p=p.return;p!==null;)p.childLanes|=g,S=p.alternate,S!==null&&(S.childLanes|=g),S=p,p=p.return;return S.tag===3?S.stateNode:null}function Pr(p,g){var S=p.callbackNode;B6(p,g);var M=Vg(p,p===si?Ui:0);if(M===0)S!==null&&UC(S),p.callbackNode=null,p.callbackPriority=0;else if(g=M&-M,p.callbackPriority!==g){if(S!=null&&UC(S),g===1)p.tag===0?X6(J3.bind(null,p)):zC(J3.bind(null,p)),Me?Ce(function(){Bt===0&&Co()}):m_(g_,Co),S=null;else{switch(kC(M)){case 1:S=g_;break;case 4:S=H6;break;case 16:S=v_;break;case 536870912:S=W6;break;default:S=v_}S=lP(S,Q3.bind(null,p))}p.callbackPriority=g,p.callbackNode=S}}function Q3(p,g){if(A0=-1,E0=0,Bt&6)throw Error(o(327));var S=p.callbackNode;if(Mu()&&p.callbackNode!==S)return null;var M=Vg(p,p===si?Ui:0);if(M===0)return null;if(M&30||M&p.expiredLanes||g)g=C0(p,M);else{g=M;var R=Bt;Bt|=2;var I=nP();(si!==p||Ui!==g)&&(ch(),Su(p,g));do try{gj();break}catch(re){tP(p,re)}while(1);__(),_0.current=I,Bt=R,oi!==null?g=0:(si=null,Ui=0,g=fi)}if(g!==0){if(g===2&&(R=d_(p),R!==0&&(M=R,g=lw(p,R))),g===1)throw S=Gf,Su(p,0),ol(p,M),Pr(p,Ti()),S;if(g===6)ol(p,M);else{if(R=p.current.alternate,!(M&30)&&!pj(R)&&(g=C0(p,M),g===2&&(I=d_(p),I!==0&&(M=I,g=lw(p,I))),g===1))throw S=Gf,Su(p,0),ol(p,M),Pr(p,Ti()),S;switch(p.finishedWork=R,p.finishedLanes=M,g){case 0:case 1:throw Error(o(345));case 2:bu(p,Cr);break;case 3:if(ol(p,M),(M&130023424)===M&&(g=rw+500-Ti(),10<g)){if(Vg(p,0)!==0)break;if(R=p.suspendedLanes,(R&M)!==M){lr(),p.pingedLanes|=p.suspendedLanes&R;break}p.timeoutHandle=se(bu.bind(null,p,Cr),g);break}bu(p,Cr);break;case 4:if(ol(p,M),(M&4194240)===M)break;for(g=p.eventTimes,R=-1;0<M;){var Z=31-qr(M);I=1<<Z,Z=g[Z],Z>R&&(R=Z),M&=~I}if(M=R,M=Ti()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*fj(M/1960))-M,10<M){p.timeoutHandle=se(bu.bind(null,p,Cr),M);break}bu(p,Cr);break;case 5:bu(p,Cr);break;default:throw Error(o(329))}}}return Pr(p,Ti()),p.callbackNode===S?Q3.bind(null,p):null}function lw(p,g){var S=Hf;return p.current.memoizedState.isDehydrated&&(Su(p,g).flags|=256),p=C0(p,g),p!==2&&(g=Cr,Cr=S,g!==null&&uw(g)),p}function uw(p){Cr===null?Cr=p:Cr.push.apply(Cr,p)}function pj(p){for(var g=p;;){if(g.flags&16384){var S=g.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var M=0;M<S.length;M++){var R=S[M],I=R.getSnapshot;R=R.value;try{if(!To(I(),R))return!1}catch{return!1}}}if(S=g.child,g.subtreeFlags&16384&&S!==null)S.return=g,g=S;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function ol(p,g){for(g&=~iw,g&=~w0,p.suspendedLanes|=g,p.pingedLanes&=~g,p=p.expirationTimes;0<g;){var S=31-qr(g),M=1<<S;p[S]=-1,g&=~M}}function J3(p){if(Bt&6)throw Error(o(327));Mu();var g=Vg(p,0);if(!(g&1))return Pr(p,Ti()),null;var S=C0(p,g);if(p.tag!==0&&S===2){var M=d_(p);M!==0&&(g=M,S=lw(p,M))}if(S===1)throw S=Gf,Su(p,0),ol(p,g),Pr(p,Ti()),S;if(S===6)throw Error(o(345));return p.finishedWork=p.current.alternate,p.finishedLanes=g,bu(p,Cr),Pr(p,Ti()),null}function eP(p){rl!==null&&rl.tag===0&&!(Bt&6)&&Mu();var g=Bt;Bt|=1;var S=Zn.transition,M=Jt;try{if(Zn.transition=null,Jt=1,p)return p()}finally{Jt=M,Zn.transition=S,Bt=g,!(Bt&6)&&Co()}}function cw(){Kr=lh.current,wt(lh)}function Su(p,g){p.finishedWork=null,p.finishedLanes=0;var S=p.timeoutHandle;if(S!==le&&(p.timeoutHandle=le,pe(S)),oi!==null)for(S=oi.return;S!==null;){var M=S;switch(T_(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&ri();break;case 3:oh(),wt(zn),wt(Gt),O_();break;case 5:D_(M);break;case 4:oh();break;case 13:wt(Rn);break;case 19:wt(Rn);break;case 10:w_(M.type._context);break;case 22:case 23:cw()}S=S.return}if(si=p,oi=p=al(p.current,null),Ui=Kr=g,fi=0,Gf=null,iw=w0=uh=0,Cr=Hf=null,Po!==null){for(g=0;g<Po.length;g++)if(S=Po[g],M=S.interleaved,M!==null){S.interleaved=null;var R=M.next,I=S.pending;if(I!==null){var Z=I.next;I.next=R,M.next=Z}S.pending=M}Po=null}return p}function tP(p,g){do{var S=oi;try{if(__(),e0.current=o0,t0){for(var M=Fn.memoizedState;M!==null;){var R=M.queue;R!==null&&(R.pending=null),M=M.next}t0=!1}if(ah=0,Ci=$i=Fn=null,Of=!1,Nf=0,nw.current=null,S===null||S.return===null){fi=1,Gf=g,oi=null;break}e:{var I=p,Z=S.return,re=S,Ee=g;if(g=Ui,re.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var Be=Ee,it=re,Dt=it.tag;if(!(it.mode&1)&&(Dt===0||Dt===11||Dt===15)){var pt=it.alternate;pt?(it.updateQueue=pt.updateQueue,it.memoizedState=pt.memoizedState,it.lanes=pt.lanes):(it.updateQueue=null,it.memoizedState=null)}var pn=S3(Z);if(pn!==null){pn.flags&=-257,b3(pn,Z,re,I,g),pn.mode&1&&w3(I,Be,g),g=pn,Ee=Be;var ut=g.updateQueue;if(ut===null){var Yi=new Set;Yi.add(Ee),g.updateQueue=Yi}else ut.add(Ee);break e}else{if(!(g&1)){w3(I,Be,g),hw();break e}Ee=Error(o(426))}}else if(An&&re.mode&1){var bs=S3(Z);if(bs!==null){!(bs.flags&65536)&&(bs.flags|=256),b3(bs,Z,re,I,g),R_(Ee);break e}}I=Ee,fi!==4&&(fi=2),Hf===null?Hf=[I]:Hf.push(I),Ee=V_(Ee,re),re=Z;do{switch(re.tag){case 3:re.flags|=65536,g&=-g,re.lanes|=g;var ve=x3(re,Ee,g);VC(re,ve);break e;case 1:I=Ee;var oe=re.type,_e=re.stateNode;if(!(re.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(il===null||!il.has(_e)))){re.flags|=65536,g&=-g,re.lanes|=g;var Qe=_3(re,I,g);VC(re,Qe);break e}}re=re.return}while(re!==null)}rP(S)}catch(at){g=at,oi===S&&S!==null&&(oi=S=S.return);continue}break}while(1)}function nP(){var p=_0.current;return _0.current=o0,p===null?o0:p}function hw(){(fi===0||fi===3||fi===2)&&(fi=4),si===null||!(uh&268435455)&&!(w0&268435455)||ol(si,Ui)}function C0(p,g){var S=Bt;Bt|=2;var M=nP();si===p&&Ui===g||Su(p,g);do try{mj();break}catch(R){tP(p,R)}while(1);if(__(),Bt=S,_0.current=M,oi!==null)throw Error(o(261));return si=null,Ui=0,fi}function mj(){for(;oi!==null;)iP(oi)}function gj(){for(;oi!==null&&!j6();)iP(oi)}function iP(p){var g=aP(p.alternate,p,Kr);p.memoizedProps=p.pendingProps,g===null?rP(p):oi=g,nw.current=null}function rP(p){var g=p;do{var S=g.alternate;if(p=g.return,g.flags&32768){if(S=lj(S,g),S!==null){S.flags&=32767,oi=S;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{fi=6,oi=null;return}}else if(S=sj(S,g,Kr),S!==null){oi=S;return}if(g=g.sibling,g!==null){oi=g;return}oi=g=p}while(g!==null);fi===0&&(fi=5)}function bu(p,g){var S=Jt,M=Zn.transition;try{Zn.transition=null,Jt=1,vj(p,g,S)}finally{Zn.transition=M,Jt=S}return null}function vj(p,g,S){do Mu();while(rl!==null);if(Bt&6)throw Error(o(327));var M=p.finishedWork,R=p.finishedLanes;if(M===null)return null;if(p.finishedWork=null,p.finishedLanes=0,M===p.current)throw Error(o(177));p.callbackNode=null,p.callbackPriority=0;var I=M.lanes|M.childLanes;if(V6(p,I),p===si&&(oi=si=null,Ui=0),!(M.subtreeFlags&2064)&&!(M.flags&2064)||b0||(b0=!0,lP(v_,function(){return Mu(),null})),I=(M.flags&15990)!==0,M.subtreeFlags&15990||I){I=Zn.transition,Zn.transition=null;var Z=Jt;Jt=1;var re=Bt;Bt|=4,nw.current=null,cj(p,M),hj(p,M),j(p.containerInfo),p.current=M,dj(M),G6(),Bt=re,Jt=Z,Zn.transition=I}else p.current=M;if(b0&&(b0=!1,rl=p,M0=R),I=p.pendingLanes,I===0&&(il=null),$6(M.stateNode),Pr(p,Ti()),g!==null)for(S=p.onRecoverableError,M=0;M<g.length;M++)S(g[M]);if(S0)throw S0=!1,p=ow,ow=null,p;return M0&1&&p.tag!==0&&Mu(),I=p.pendingLanes,I&1?p===aw?Wf++:(Wf=0,aw=p):Wf=0,Co(),null}function Mu(){if(rl!==null){var p=kC(M0),g=Zn.transition,S=Jt;try{if(Zn.transition=null,Jt=16>p?16:p,rl===null)var M=!1;else{if(p=rl,rl=null,M0=0,Bt&6)throw Error(o(331));var R=Bt;for(Bt|=4,Ze=p.current;Ze!==null;){var I=Ze,Z=I.child;if(Ze.flags&16){var re=I.deletions;if(re!==null){for(var Ee=0;Ee<re.length;Ee++){var Be=re[Ee];for(Ze=Be;Ze!==null;){var it=Ze;switch(it.tag){case 0:case 11:case 15:wu(8,it,I)}var Dt=it.child;if(Dt!==null)Dt.return=it,Ze=Dt;else for(;Ze!==null;){it=Ze;var pt=it.sibling,pn=it.return;if(j3(it),it===Be){Ze=null;break}if(pt!==null){pt.return=pn,Ze=pt;break}Ze=pn}}}var ut=I.alternate;if(ut!==null){var Yi=ut.child;if(Yi!==null){ut.child=null;do{var bs=Yi.sibling;Yi.sibling=null,Yi=bs}while(Yi!==null)}}Ze=I}}if(I.subtreeFlags&2064&&Z!==null)Z.return=I,Ze=Z;else e:for(;Ze!==null;){if(I=Ze,I.flags&2048)switch(I.tag){case 0:case 11:case 15:wu(9,I,I.return)}var ve=I.sibling;if(ve!==null){ve.return=I.return,Ze=ve;break e}Ze=I.return}}var oe=p.current;for(Ze=oe;Ze!==null;){Z=Ze;var _e=Z.child;if(Z.subtreeFlags&2064&&_e!==null)_e.return=Z,Ze=_e;else e:for(Z=oe;Ze!==null;){if(re=Ze,re.flags&2048)try{switch(re.tag){case 0:case 11:case 15:Vf(9,re)}}catch(at){Rr(re,re.return,at)}if(re===Z){Ze=null;break e}var Qe=re.sibling;if(Qe!==null){Qe.return=re.return,Ze=Qe;break e}Ze=re.return}}if(Bt=R,Co(),Eo&&typeof Eo.onPostCommitFiberRoot=="function")try{Eo.onPostCommitFiberRoot(jg,p)}catch{}M=!0}return M}finally{Jt=S,Zn.transition=g}}return!1}function sP(p,g,S){g=V_(S,g),g=x3(p,g,1),nl(p,g),g=lr(),p=T0(p,1),p!==null&&(Cf(p,1,g),Pr(p,g))}function Rr(p,g,S){if(p.tag===3)sP(p,p,S);else for(;g!==null;){if(g.tag===3){sP(g,p,S);break}else if(g.tag===1){var M=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(il===null||!il.has(M))){p=V_(S,p),p=_3(g,p,1),nl(g,p),p=lr(),g=T0(g,1),g!==null&&(Cf(g,1,p),Pr(g,p));break}}g=g.return}}function yj(p,g,S){var M=p.pingCache;M!==null&&M.delete(g),g=lr(),p.pingedLanes|=p.suspendedLanes&S,si===p&&(Ui&S)===S&&(fi===4||fi===3&&(Ui&130023424)===Ui&&500>Ti()-rw?Su(p,0):iw|=S),Pr(p,g)}function oP(p,g){g===0&&(p.mode&1?(g=Bg,Bg<<=1,!(Bg&130023424)&&(Bg=4194304)):g=1);var S=lr();p=T0(p,g),p!==null&&(Cf(p,g,S),Pr(p,S))}function xj(p){var g=p.memoizedState,S=0;g!==null&&(S=g.retryLane),oP(p,S)}function _j(p,g){var S=0;switch(p.tag){case 13:var M=p.stateNode,R=p.memoizedState;R!==null&&(S=R.retryLane);break;case 19:M=p.stateNode;break;default:throw Error(o(314))}M!==null&&M.delete(g),oP(p,S)}var aP;aP=function(p,g,S){if(p!==null)if(p.memoizedProps!==g.pendingProps||zn.current)Zr=!0;else{if(!(p.lanes&S)&&!(g.flags&128))return Zr=!1,aj(p,g,S);Zr=!!(p.flags&131072)}else Zr=!1,An&&g.flags&1048576&&qC(g,Kg,g.index);switch(g.lanes=0,g.tag){case 2:var M=g.type;p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),p=g.pendingProps;var R=ms(g,Gt.current);eh(g,S),R=k_(null,g,M,p,R,S);var I=U_();return g.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Ai(M)?(I=!0,Ei(g)):I=!1,g.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,b_(g),R.updater=Yg,g.stateNode=R,R._reactInternals=g,A_(g,M,p,S),g=H_(null,g,M,!0,I,S)):(g.tag=0,An&&I&&E_(g),ar(null,g,R,S),g=g.child),g;case 16:M=g.elementType;e:{switch(p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),p=g.pendingProps,R=M._init,M=R(M._payload),g.type=M,R=g.tag=Sj(M),p=qs(M,p),R){case 0:g=G_(null,g,M,p,S);break e;case 1:g=L3(null,g,M,p,S);break e;case 11:g=E3(null,g,M,p,S);break e;case 14:g=T3(null,g,M,qs(M.type,p),S);break e}throw Error(o(306,M,""))}return g;case 0:return M=g.type,R=g.pendingProps,R=g.elementType===M?R:qs(M,R),G_(p,g,M,R,S);case 1:return M=g.type,R=g.pendingProps,R=g.elementType===M?R:qs(M,R),L3(p,g,M,R,S);case 3:e:{if(D3(g),p===null)throw Error(o(387));M=g.pendingProps,I=g.memoizedState,R=I.element,BC(p,g),Xg(g,M,null,S);var Z=g.memoizedState;if(M=Z.element,me&&I.isDehydrated)if(I={element:M,isDehydrated:!1,cache:Z.cache,transitions:Z.transitions},g.updateQueue.baseState=I,g.memoizedState=I,g.flags&256){R=Error(o(423)),g=I3(p,g,M,S,R);break e}else if(M!==R){R=Error(o(424)),g=I3(p,g,M,S,R);break e}else for(me&&(Yr=kg(g.stateNode.containerInfo),Xr=g,An=!0,Xs=null,Pf=!1),S=JC(g,null,M,S),g.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(ih(),M===R){g=fa(p,g,S);break e}ar(p,g,M,S)}g=g.child}return g;case 5:return e3(g),p===null&&P_(g),M=g.type,R=g.pendingProps,I=p!==null?p.memoizedProps:null,Z=R.children,J(M,R)?Z=null:I!==null&&J(M,I)&&(g.flags|=32),R3(p,g),ar(p,g,Z,S),g.child;case 6:return p===null&&P_(g),null;case 13:return O3(p,g,S);case 4:return L_(g,g.stateNode.containerInfo),M=g.pendingProps,p===null?g.child=rh(g,null,M,S):ar(p,g,M,S),g.child;case 11:return M=g.type,R=g.pendingProps,R=g.elementType===M?R:qs(M,R),E3(p,g,M,R,S);case 7:return ar(p,g,g.pendingProps,S),g.child;case 8:return ar(p,g,g.pendingProps.children,S),g.child;case 12:return ar(p,g,g.pendingProps.children,S),g.child;case 10:e:{if(M=g.type._context,R=g.pendingProps,I=g.memoizedProps,Z=R.value,FC(g,M,Z),I!==null)if(To(I.value,Z)){if(I.children===R.children&&!zn.current){g=fa(p,g,S);break e}}else for(I=g.child,I!==null&&(I.return=g);I!==null;){var re=I.dependencies;if(re!==null){Z=I.child;for(var Ee=re.firstContext;Ee!==null;){if(Ee.context===M){if(I.tag===1){Ee=ua(-1,S&-S),Ee.tag=2;var Be=I.updateQueue;if(Be!==null){Be=Be.shared;var it=Be.pending;it===null?Ee.next=Ee:(Ee.next=it.next,it.next=Ee),Be.pending=Ee}}I.lanes|=S,Ee=I.alternate,Ee!==null&&(Ee.lanes|=S),S_(I.return,S,g),re.lanes|=S;break}Ee=Ee.next}}else if(I.tag===10)Z=I.type===g.type?null:I.child;else if(I.tag===18){if(Z=I.return,Z===null)throw Error(o(341));Z.lanes|=S,re=Z.alternate,re!==null&&(re.lanes|=S),S_(Z,S,g),Z=I.sibling}else Z=I.child;if(Z!==null)Z.return=I;else for(Z=I;Z!==null;){if(Z===g){Z=null;break}if(I=Z.sibling,I!==null){I.return=Z.return,Z=I;break}Z=Z.return}I=Z}ar(p,g,R.children,S),g=g.child}return g;case 9:return R=g.type,M=g.pendingProps.children,eh(g,S),R=gs(R),M=M(R),g.flags|=1,ar(p,g,M,S),g.child;case 14:return M=g.type,R=qs(M,g.pendingProps),R=qs(M.type,R),T3(p,g,M,R,S);case 15:return C3(p,g,g.type,g.pendingProps,S);case 17:return M=g.type,R=g.pendingProps,R=g.elementType===M?R:qs(M,R),p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),g.tag=1,Ai(M)?(p=!0,Ei(g)):p=!1,eh(g,S),WC(g,M,R),A_(g,M,R,S),H_(null,g,M,!0,p,S);case 19:return z3(p,g,S);case 22:return P3(p,g,S)}throw Error(o(156,g.tag))};function lP(p,g){return m_(p,g)}function wj(p,g,S,M){this.tag=p,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ss(p,g,S,M){return new wj(p,g,S,M)}function dw(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Sj(p){if(typeof p=="function")return dw(p)?1:0;if(p!=null){if(p=p.$$typeof,p===x)return 11;if(p===_)return 14}return 2}function al(p,g){var S=p.alternate;return S===null?(S=Ss(p.tag,g,p.key,p.mode),S.elementType=p.elementType,S.type=p.type,S.stateNode=p.stateNode,S.alternate=p,p.alternate=S):(S.pendingProps=g,S.type=p.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=p.flags&14680064,S.childLanes=p.childLanes,S.lanes=p.lanes,S.child=p.child,S.memoizedProps=p.memoizedProps,S.memoizedState=p.memoizedState,S.updateQueue=p.updateQueue,g=p.dependencies,S.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},S.sibling=p.sibling,S.index=p.index,S.ref=p.ref,S}function P0(p,g,S,M,R,I){var Z=2;if(M=p,typeof p=="function")dw(p)&&(Z=1);else if(typeof p=="string")Z=5;else e:switch(p){case d:return Au(S.children,R,I,g);case c:Z=8,R|=8;break;case h:return p=Ss(12,S,g,R|2),p.elementType=h,p.lanes=I,p;case y:return p=Ss(13,S,g,R),p.elementType=y,p.lanes=I,p;case v:return p=Ss(19,S,g,R),p.elementType=v,p.lanes=I,p;case b:return R0(S,R,I,g);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case f:Z=10;break e;case m:Z=9;break e;case x:Z=11;break e;case _:Z=14;break e;case w:Z=16,M=null;break e}throw Error(o(130,p==null?p:typeof p,""))}return g=Ss(Z,S,g,R),g.elementType=p,g.type=M,g.lanes=I,g}function Au(p,g,S,M){return p=Ss(7,p,M,g),p.lanes=S,p}function R0(p,g,S,M){return p=Ss(22,p,M,g),p.elementType=b,p.lanes=S,p.stateNode={},p}function fw(p,g,S){return p=Ss(6,p,null,g),p.lanes=S,p}function pw(p,g,S){return g=Ss(4,p.children!==null?p.children:[],p.key,g),g.lanes=S,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}function bj(p,g,S,M,R){this.tag=g,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=f_(0),this.expirationTimes=f_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=f_(0),this.identifierPrefix=M,this.onRecoverableError=R,me&&(this.mutableSourceEagerHydrationData=null)}function uP(p,g,S,M,R,I,Z,re,Ee){return p=new bj(p,g,S,re,Ee),g===1?(g=1,I===!0&&(g|=8)):g=0,I=Ss(3,null,null,g),p.current=I,I.stateNode=p,I.memoizedState={element:M,isDehydrated:S,cache:null,transitions:null},b_(I),p}function cP(p){if(!p)return ps;p=p._reactInternals;e:{if(P(p)!==p||p.tag!==1)throw Error(o(170));var g=p;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Ai(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(o(171))}if(p.tag===1){var S=p.type;if(Ai(S))return Kc(p,S,g)}return g}function hP(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(o(188)):(p=Object.keys(p).join(","),Error(o(268,p)));return p=U(g),p===null?null:p.stateNode}function dP(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var S=p.retryLane;p.retryLane=S!==0&&S<g?S:g}}function mw(p,g){dP(p,g),(p=p.alternate)&&dP(p,g)}function Mj(p){return p=U(p),p===null?null:p.stateNode}function Aj(){return null}return n.attemptContinuousHydration=function(p){if(p.tag===13){var g=lr();ws(p,134217728,g),mw(p,134217728)}},n.attemptHydrationAtCurrentPriority=function(p){if(p.tag===13){var g=lr(),S=sl(p);ws(p,S,g),mw(p,S)}},n.attemptSynchronousHydration=function(p){switch(p.tag){case 3:var g=p.stateNode;if(g.current.memoizedState.isDehydrated){var S=Tf(g.pendingLanes);S!==0&&(p_(g,S|1),Pr(g,Ti()),!(Bt&6)&&(ch(),Co()))}break;case 13:var M=lr();eP(function(){return ws(p,1,M)}),mw(p,1)}},n.batchedUpdates=function(p,g){var S=Bt;Bt|=1;try{return p(g)}finally{Bt=S,Bt===0&&(ch(),Gg&&Co())}},n.createComponentSelector=function(p){return{$$typeof:m0,value:p}},n.createContainer=function(p,g,S,M,R,I,Z){return uP(p,g,!1,null,S,M,R,I,Z)},n.createHasPseudoClassSelector=function(p){return{$$typeof:g0,value:p}},n.createHydrationContainer=function(p,g,S,M,R,I,Z,re,Ee){return p=uP(S,M,!0,p,R,I,Z,re,Ee),p.context=cP(null),S=p.current,M=lr(),R=sl(S),I=ua(M,R),I.callback=g??null,nl(S,I),p.current.lanes=R,Cf(p,R,M),Pr(p,M),p},n.createPortal=function(p,g,S){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:M==null?null:""+M,children:p,containerInfo:g,implementation:S}},n.createRoleSelector=function(p){return{$$typeof:v0,value:p}},n.createTestNameSelector=function(p){return{$$typeof:y0,value:p}},n.createTextSelector=function(p){return{$$typeof:x0,value:p}},n.deferredUpdates=function(p){var g=Jt,S=Zn.transition;try{return Zn.transition=null,Jt=16,p()}finally{Jt=g,Zn.transition=S}},n.discreteUpdates=function(p,g,S,M,R){var I=Jt,Z=Zn.transition;try{return Zn.transition=null,Jt=1,p(g,S,M,R)}finally{Jt=I,Zn.transition=Z,Bt===0&&ch()}},n.findAllNodes=tw,n.findBoundingRects=function(p,g){if(!ke)throw Error(o(363));g=tw(p,g),p=[];for(var S=0;S<g.length;S++)p.push(bt(g[S]));for(g=p.length-1;0<g;g--){S=p[g];for(var M=S.x,R=M+S.width,I=S.y,Z=I+S.height,re=g-1;0<=re;re--)if(g!==re){var Ee=p[re],Be=Ee.x,it=Be+Ee.width,Dt=Ee.y,pt=Dt+Ee.height;if(M>=Be&&I>=Dt&&R<=it&&Z<=pt){p.splice(g,1);break}else if(M!==Be||S.width!==Ee.width||pt<I||Dt>Z){if(!(I!==Dt||S.height!==Ee.height||it<M||Be>R)){Be>M&&(Ee.width+=Be-M,Ee.x=M),it<R&&(Ee.width=R-Be),p.splice(g,1);break}}else{Dt>I&&(Ee.height+=Dt-I,Ee.y=I),pt<Z&&(Ee.height=Z-Dt),p.splice(g,1);break}}}return p},n.findHostInstance=hP,n.findHostInstanceWithNoPortals=function(p){return p=D(p),p=p!==null?k(p):null,p===null?null:p.stateNode},n.findHostInstanceWithWarning=function(p){return hP(p)},n.flushControlled=function(p){var g=Bt;Bt|=1;var S=Zn.transition,M=Jt;try{Zn.transition=null,Jt=1,p()}finally{Jt=M,Zn.transition=S,Bt=g,Bt===0&&(ch(),Co())}},n.flushPassiveEffects=Mu,n.flushSync=eP,n.focusWithin=function(p,g){if(!ke)throw Error(o(363));for(p=Q_(p),g=K3(p,g),g=Array.from(g),p=0;p<g.length;){var S=g[p++];if(!B(S)){if(S.tag===5&&Re(S.stateNode))return!0;for(S=S.child;S!==null;)g.push(S),S=S.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Jt},n.getFindAllNodesFailureDescription=function(p,g){if(!ke)throw Error(o(363));var S=0,M=[];p=[Q_(p),0];for(var R=0;R<p.length;){var I=p[R++],Z=p[R++],re=g[Z];if((I.tag!==5||!B(I))&&(J_(I,re)&&(M.push(ew(re)),Z++,Z>S&&(S=Z)),Z<g.length))for(I=I.child;I!==null;)p.push(I,Z),I=I.sibling}if(S<g.length){for(p=[];S<g.length;S++)p.push(ew(g[S]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+p.join(" > ")}return null},n.getPublicRootInstance=function(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return K(p.child.stateNode);default:return p.child.stateNode}},n.injectIntoDevTools=function(p){if(p={bundleType:p.bundleType,version:p.version,rendererPackageName:p.rendererPackageName,rendererConfig:p.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Mj,findFiberByHostInstance:p.findFiberByHostInstance||Aj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")p=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)p=!0;else{try{jg=g.inject(p),Eo=g}catch{}p=!!g.checkDCE}}return p},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(p,g,S,M){if(!ke)throw Error(o(363));p=tw(p,g);var R=Le(p,S,M).disconnect;return{disconnect:function(){R()}}},n.registerMutableSourceForHydration=function(p,g){var S=g._getVersion;S=S(g._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[g,S]:p.mutableSourceEagerHydrationData.push(g,S)},n.runWithPriority=function(p,g){var S=Jt;try{return Jt=p,g()}finally{Jt=S}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(p,g,S,M){var R=g.current,I=lr(),Z=sl(R);return S=cP(S),g.context===null?g.context=S:g.pendingContext=S,g=ua(I,Z),g.payload={element:p},M=M===void 0?null:M,M!==null&&(g.callback=M),nl(R,g),p=ws(R,Z,I),p!==null&&qg(p,R,Z),Z},n};y4.exports=LY;var DY=y4.exports;const IY=UA(DY);var x4={exports:{}},_4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,V){var j=N.length;N.push(V);e:for(;0<j;){var z=j-1>>>1,$=N[z];if(0<r($,V))N[z]=V,N[j]=$,j=z;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var V=N[0],j=N.pop();if(j!==V){N[0]=j;e:for(var z=0,$=N.length,te=$>>>1;z<te;){var Q=2*(z+1)-1,J=N[Q],ie=Q+1,se=N[ie];if(0>r(J,j))ie<$&&0>r(se,J)?(N[z]=se,N[ie]=j,z=ie):(N[z]=J,N[Q]=j,z=Q);else if(ie<$&&0>r(se,j))N[z]=se,N[ie]=j,z=ie;else break e}}return V}function r(N,V){var j=N.sortIndex-V.sortIndex;return j!==0?j:N.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,f=!1,m=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var V=n(u);V!==null;){if(V.callback===null)i(u);else if(V.startTime<=N)i(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(N){if(x=!1,w(N),!m)if(n(l)!==null)m=!0,K(E);else{var V=n(u);V!==null&&q(b,V.startTime-N)}}function E(N,V){m=!1,x&&(x=!1,v(L),L=-1),f=!0;var j=h;try{for(w(V),c=n(l);c!==null&&(!(c.expirationTime>V)||N&&!D());){var z=c.callback;if(typeof z=="function"){c.callback=null,h=c.priorityLevel;var $=z(c.expirationTime<=V);V=t.unstable_now(),typeof $=="function"?c.callback=$:c===n(l)&&i(l),w(V)}else i(l);c=n(l)}if(c!==null)var te=!0;else{var Q=n(u);Q!==null&&q(b,Q.startTime-V),te=!1}return te}finally{c=null,h=j,f=!1}}var A=!1,T=null,L=-1,P=5,C=-1;function D(){return!(t.unstable_now()-C<P)}function U(){if(T!==null){var N=t.unstable_now();C=N;var V=!0;try{V=T(!0,N)}finally{V?G():(A=!1,T=null)}}else A=!1}var G;if(typeof _=="function")G=function(){_(U)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,H=k.port2;k.port1.onmessage=U,G=function(){H.postMessage(null)}}else G=function(){y(U,0)};function K(N){T=N,A||(A=!0,G())}function q(N,V){L=y(function(){N(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,K(E))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var j=h;h=V;try{return N()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,V){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=h;h=N;try{return V()}finally{h=j}},t.unstable_scheduleCallback=function(N,V,j){var z=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?z+j:z):j=z,N){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=j+$,N={id:d++,callback:V,priorityLevel:N,startTime:j,expirationTime:$,sortIndex:-1},j>z?(N.sortIndex=j,e(u,N),n(l)===null&&N===n(u)&&(x?(v(L),L=-1):x=!0,q(b,j-z))):(N.sortIndex=$,e(l,N),m||f||(m=!0,K(E))),N},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(N){var V=h;return function(){var j=h;h=V;try{return N.apply(this,arguments)}finally{h=j}}}})(_4);x4.exports=_4;var QL=x4.exports;const OY=t=>typeof t=="object"&&typeof t.then=="function",ac=[];function w4(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function S4(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of ac)if(w4(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=ac.indexOf(r);s!==-1&&ac.splice(s,1)},promise:(OY(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(ac.push(r),!n)throw r.promise}const NY=(t,e,n)=>S4(t,e,!1,n),kY=(t,e,n)=>void S4(t,e,!0,n),UY=t=>{if(t===void 0||t.length===0)ac.splice(0,ac.length);else{const e=ac.find(n=>w4(t,n.keys,n.equal));e&&e.remove()}},xT={},zY=t=>void Object.assign(xT,t);function FY(t,e){function n(d,{args:c=[],attach:h,...f},m){let x=`${d[0].toUpperCase()}${d.slice(1)}`,y;if(d==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=f.object;y=jh(v,{type:d,root:m,attach:h,primitive:!0})}else{const v=xT[x];if(!v)throw new Error(`R3F: ${x} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(c))throw new Error("R3F: The args prop must be an array!");y=jh(new v(...c),{type:d,root:m,attach:h,memoizedProps:{args:c}})}return y.__r3f.attach===void 0&&(y instanceof Ke?y.__r3f.attach="geometry":y instanceof Wi&&(y.__r3f.attach="material")),x!=="inject"&&TS(y,f),y}function i(d,c){let h=!1;if(c){var f,m;(f=c.__r3f)!=null&&f.attach?ES(d,c,c.__r3f.attach):c.isObject3D&&d.isObject3D&&(d.add(c),h=!0),h||(m=d.__r3f)==null||m.objects.push(c),c.__r3f||jh(c,{}),c.__r3f.parent=d,y2(c),Gh(c)}}function r(d,c,h){let f=!1;if(c){var m,x;if((m=c.__r3f)!=null&&m.attach)ES(d,c,c.__r3f.attach);else if(c.isObject3D&&d.isObject3D){c.parent=d,c.dispatchEvent({type:"added"});const y=d.children.filter(_=>_!==c),v=y.indexOf(h);d.children=[...y.slice(0,v),c,...y.slice(v)],f=!0}f||(x=d.__r3f)==null||x.objects.push(c),c.__r3f||jh(c,{}),c.__r3f.parent=d,y2(c),Gh(c)}}function s(d,c,h=!1){d&&[...d].forEach(f=>o(c,f,h))}function o(d,c,h){if(c){var f,m,x;if(c.__r3f&&(c.__r3f.parent=null),(f=d.__r3f)!=null&&f.objects&&(d.__r3f.objects=d.__r3f.objects.filter(b=>b!==c)),(m=c.__r3f)!=null&&m.attach)iD(d,c,c.__r3f.attach);else if(c.isObject3D&&d.isObject3D){var y;d.remove(c),(y=c.__r3f)!=null&&y.root&&qY(c.__r3f.root,c)}const _=(x=c.__r3f)==null?void 0:x.primitive,w=h===void 0?c.dispose!==null&&!_:h;if(!_){var v;s((v=c.__r3f)==null?void 0:v.objects,c,w),s(c.children,c,w)}delete c.__r3f,w&&c.dispose&&c.type!=="Scene"&&QL.unstable_scheduleCallback(QL.unstable_IdlePriority,()=>{try{c.dispose()}catch{}}),Gh(d)}}function a(d,c,h,f){var m;const x=(m=d.__r3f)==null?void 0:m.parent;if(!x)return;const y=n(c,h,d.__r3f.root);if(d.children){for(const v of d.children)v.__r3f&&i(y,v);d.children=d.children.filter(v=>!v.__r3f)}d.__r3f.objects.forEach(v=>i(y,v)),d.__r3f.objects=[],d.__r3f.autoRemovedBeforeAppend||o(x,d),y.parent&&(y.__r3f.autoRemovedBeforeAppend=!0),i(x,y),y.raycast&&y.__r3f.eventCount&&y.__r3f.root.getState().internal.interaction.push(y),[f,f.alternate].forEach(v=>{v!==null&&(v.stateNode=y,v.ref&&(typeof v.ref=="function"?v.ref(y):v.ref.current=y))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:IY({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,c)=>{if(!c)return;const h=d.getState().scene;h.__r3f&&(h.__r3f.root=d,i(h,c))},removeChildFromContainer:(d,c)=>{c&&o(d.getState().scene,c)},insertInContainerBefore:(d,c,h)=>{if(!c||!h)return;const f=d.getState().scene;f.__r3f&&r(f,c,h)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var c;return!!((c=d==null?void 0:d.__r3f)!=null?c:{}).handlers},prepareUpdate(d,c,h,f){var m;if(((m=d==null?void 0:d.__r3f)!=null?m:{}).primitive&&f.object&&f.object!==d)return[!0];{const{args:y=[],children:v,..._}=f,{args:w=[],children:b,...E}=h;if(!Array.isArray(y))throw new Error("R3F: the args prop must be an array!");if(y.some((T,L)=>T!==w[L]))return[!0];const A=R4(d,_,E,!0);return A.changes.length?[!1,A]:null}},commitUpdate(d,[c,h],f,m,x,y){c?a(d,f,x,y):TS(d,h)},commitMount(d,c,h,f){var m;const x=(m=d.__r3f)!=null?m:{};d.raycast&&x.handlers&&x.eventCount&&d.__r3f.root.getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>jh(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var c;const{attach:h,parent:f}=(c=d.__r3f)!=null?c:{};h&&f&&iD(f,d,h),d.isObject3D&&(d.visible=!1),Gh(d)},unhideInstance(d,c){var h;const{attach:f,parent:m}=(h=d.__r3f)!=null?h:{};f&&m&&ES(m,d,f),(d.isObject3D&&c.visible==null||c.visible)&&(d.visible=!0),Gh(d)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():cd.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Sn.fun(performance.now)?performance.now:Sn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Sn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Sn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:TS}}var JL,eD;const AS=t=>"colorSpace"in t||"outputColorSpace"in t,b4=()=>{var t;return(t=xT.ColorManagement)!=null?t:null},M4=t=>t&&t.isOrthographicCamera,BY=t=>t&&t.hasOwnProperty("current"),Mg=typeof window<"u"&&((JL=window.document)!=null&&JL.createElement||((eD=window.navigator)==null?void 0:eD.product)==="ReactNative")?Se.useLayoutEffect:Se.useEffect;function A4(t){const e=Se.useRef(t);return Mg(()=>void(e.current=t),[t]),e}function VY({set:t}){return Mg(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class E4 extends Se.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}E4.getDerivedStateFromError=()=>({error:!0});const T4="__default",tD=new Map,jY=t=>t&&!!t.memoized&&!!t.changes;function C4(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const cp=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},Sn={obj:t=>t===Object(t)&&!Sn.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Sn.str(t)||Sn.num(t))return t===e;const s=Sn.obj(t);if(s&&i==="reference")return t===e;const o=Sn.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!Sn.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(Sn.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function P4(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function GY(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function jh(t,e){const n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function v2(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}const nD=/-\d+$/;function ES(t,e,n){if(Sn.str(n)){if(nD.test(n)){const s=n.replace(nD,""),{target:o,key:a}=v2(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=v2(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function iD(t,e,n){var i,r;if(Sn.str(n)){const{target:s,key:o}=v2(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function R4(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},u=!1){var d;const c=(d=t==null?void 0:t.__r3f)!=null?d:{},h=Object.entries(r),f=[];if(u){const x=Object.keys(l);for(let y=0;y<x.length;y++)r.hasOwnProperty(x[y])||h.unshift([x[y],T4+"remove"])}h.forEach(([x,y])=>{var v;if((v=t.__r3f)!=null&&v.primitive&&x==="object"||Sn.equ(y,l[x]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(x))return f.push([x,y,!0,[]]);let _=[];x.includes("-")&&(_=x.split("-")),f.push([x,y,!1,_]);for(const w in r){const b=r[w];w.startsWith(`${x}-`)&&f.push([w,b,!1,w.split("-")])}});const m={...r};return c.memoizedProps&&c.memoizedProps.args&&(m.args=c.memoizedProps.args),c.memoizedProps&&c.memoizedProps.attach&&(m.attach=c.memoizedProps.attach),{memoized:m,changes:f}}const HY=typeof process<"u"&&!1;function TS(t,e){var n,i,r;const s=(n=t.__r3f)!=null?n:{},o=s.root,a=(i=o==null||o.getState==null?void 0:o.getState())!=null?i:{},{memoized:l,changes:u}=jY(e)?e:R4(t,e),d=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let h=0;h<u.length;h++){let[f,m,x,y]=u[h];if(AS(t)){const b="srgb",E="srgb-linear";f==="encoding"?(f="colorSpace",m=m===3001?b:E):f==="outputEncoding"&&(f="outputColorSpace",m=m===3001?b:E)}let v=t,_=v[f];if(y.length&&(_=y.reduce((w,b)=>w[b],t),!(_&&_.set))){const[w,...b]=y.reverse();v=b.reverse().reduce((E,A)=>E[A],t),f=w}if(m===T4+"remove")if(v.constructor){let w=tD.get(v.constructor);w||(w=new v.constructor,tD.set(v.constructor,w)),m=w[f]}else m=0;if(x)m?s.handlers[f]=m:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(_&&_.set&&(_.copy||_ instanceof fc)){if(Array.isArray(m))_.fromArray?_.fromArray(m):_.set(...m);else if(_.copy&&m&&m.constructor&&(HY?_.constructor.name===m.constructor.name:_.constructor===m.constructor))_.copy(m);else if(m!==void 0){const w=_ instanceof We;!w&&_.setScalar?_.setScalar(m):_ instanceof fc&&m instanceof fc?_.mask=m.mask:_.set(m),!b4()&&!a.linear&&w&&_.convertSRGBToLinear()}}else if(v[f]=m,v[f]instanceof Tn&&v[f].format===vr&&v[f].type===Jo){const w=v[f];AS(w)&&AS(a.gl)?w.colorSpace=a.gl.outputColorSpace:w.encoding=a.gl.outputEncoding}Gh(t)}if(s.parent&&a.internal&&t.raycast&&d!==s.eventCount){const h=a.internal.interaction.indexOf(t);h>-1&&a.internal.interaction.splice(h,1),s.eventCount&&a.internal.interaction.push(t)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(r=t.__r3f)!=null&&r.parent&&y2(t),t}function Gh(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function y2(t){t.onUpdate==null||t.onUpdate(t)}function WY(t,e){t.manual||(M4(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function zv(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function $Y(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return cd.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return cd.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return cd.ContinuousEventPriority;default:return cd.DefaultEventPriority}}function L4(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function qY(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{L4(n.capturedMap,e,i,r)})}function XY(t){function e(l){const{internal:u}=t.getState(),d=l.offsetX-u.initialClick[0],c=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(d*d+c*c))}function n(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(d=>{var c;return(c=u.__r3f)==null?void 0:c.handlers["onPointer"+d]}))}function i(l,u){const d=t.getState(),c=new Set,h=[],f=u?u(d.internal.interaction):d.internal.interaction;for(let v=0;v<f.length;v++){const _=cp(f[v]);_&&(_.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(l,d);function m(v){const _=cp(v);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var w;_.events.compute==null||_.events.compute(l,_,(w=_.previousRoot)==null?void 0:w.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(v,!0):[]}let x=f.flatMap(m).sort((v,_)=>{const w=cp(v.object),b=cp(_.object);return!w||!b?v.distance-_.distance:b.events.priority-w.events.priority||v.distance-_.distance}).filter(v=>{const _=zv(v);return c.has(_)?!1:(c.add(_),!0)});d.events.filter&&(x=d.events.filter(x,d));for(const v of x){let _=v.object;for(;_;){var y;(y=_.__r3f)!=null&&y.eventCount&&h.push({...v,eventObject:_}),_=_.parent}}if("pointerId"in l&&d.internal.capturedMap.has(l.pointerId))for(let v of d.internal.capturedMap.get(l.pointerId).values())c.has(zv(v.intersection))||h.push(v.intersection);return h}function r(l,u,d,c){const h=t.getState();if(l.length){const f={stopped:!1};for(const m of l){const x=cp(m.object)||h,{raycaster:y,pointer:v,camera:_,internal:w}=x,b=new O(v.x,v.y,0).unproject(_),E=C=>{var D,U;return(D=(U=w.capturedMap.get(C))==null?void 0:U.has(m.eventObject))!=null?D:!1},A=C=>{const D={intersection:m,target:u.target};w.capturedMap.has(C)?w.capturedMap.get(C).set(m.eventObject,D):w.capturedMap.set(C,new Map([[m.eventObject,D]])),u.target.setPointerCapture(C)},T=C=>{const D=w.capturedMap.get(C);D&&L4(w.capturedMap,m.eventObject,D,C)};let L={};for(let C in u){let D=u[C];typeof D!="function"&&(L[C]=D)}let P={...m,...L,pointer:v,intersections:l,stopped:f.stopped,delta:d,unprojectedPoint:b,ray:y.ray,camera:_,stopPropagation(){const C="pointerId"in u&&w.capturedMap.get(u.pointerId);if((!C||C.has(m.eventObject))&&(P.stopped=f.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(D=>D.eventObject===m.eventObject))){const D=l.slice(0,l.indexOf(m));s([...D,m])}},target:{hasPointerCapture:E,setPointerCapture:A,releasePointerCapture:T},currentTarget:{hasPointerCapture:E,setPointerCapture:A,releasePointerCapture:T},nativeEvent:u};if(c(P),f.stopped===!0)break}}return l}function s(l){const{internal:u}=t.getState();for(const d of u.hovered.values())if(!l.length||!l.find(c=>c.object===d.object&&c.index===d.index&&c.instanceId===d.instanceId)){const h=d.eventObject.__r3f,f=h==null?void 0:h.handlers;if(u.hovered.delete(zv(d)),h!=null&&h.eventCount){const m={...d,intersections:l};f.onPointerOut==null||f.onPointerOut(m),f.onPointerLeave==null||f.onPointerLeave(m)}}}function o(l,u){for(let d=0;d<u.length;d++){const c=u[d].__r3f;c==null||c.handlers.onPointerMissed==null||c.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:d}=t.getState();"pointerId"in u&&d.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(u.pointerId)&&(d.capturedMap.delete(u.pointerId),s([]))})}}return function(d){const{onPointerMissed:c,internal:h}=t.getState();h.lastEvent.current=d;const f=l==="onPointerMove",m=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=i(d,f?n:void 0),v=m?e(d):0;l==="onPointerDown"&&(h.initialClick=[d.offsetX,d.offsetY],h.initialHits=y.map(w=>w.eventObject)),m&&!y.length&&v<=2&&(o(d,h.interaction),c&&c(d)),f&&s(y);function _(w){const b=w.eventObject,E=b.__r3f,A=E==null?void 0:E.handlers;if(E!=null&&E.eventCount)if(f){if(A.onPointerOver||A.onPointerEnter||A.onPointerOut||A.onPointerLeave){const T=zv(w),L=h.hovered.get(T);L?L.stopped&&w.stopPropagation():(h.hovered.set(T,w),A.onPointerOver==null||A.onPointerOver(w),A.onPointerEnter==null||A.onPointerEnter(w))}A.onPointerMove==null||A.onPointerMove(w)}else{const T=A[l];T?(!m||h.initialHits.includes(b))&&(o(d,h.interaction.filter(L=>!h.initialHits.includes(L))),T(w)):m&&h.initialHits.includes(b)&&o(d,h.interaction.filter(L=>!h.initialHits.includes(L)))}}r(y,d,v,_)}}return{handlePointer:a}}const D4=t=>!!(t!=null&&t.render),I4=Se.createContext(null),YY=(t,e)=>{const n=CY((a,l)=>{const u=new O,d=new O,c=new O;function h(v=l().camera,_=d,w=l().size){const{width:b,height:E,top:A,left:T}=w,L=b/E;_ instanceof O?c.copy(_):c.set(..._);const P=v.getWorldPosition(u).distanceTo(c);if(M4(v))return{width:b/v.zoom,height:E/v.zoom,top:A,left:T,factor:1,distance:P,aspect:L};{const C=v.fov*Math.PI/180,D=2*Math.tan(C/2)*P,U=D*(b/E);return{width:U,height:D,top:A,left:T,factor:b/U,distance:P,aspect:L}}}let f;const m=v=>a(_=>({performance:{..._.performance,current:v}})),x=new ee;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>t(l(),v),advance:(v,_)=>e(v,_,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new fT,pointer:x,mouse:x,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();f&&clearTimeout(f),v.performance.current!==v.performance.min&&m(v.performance.min),f=setTimeout(()=>m(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:v=>a(_=>({..._,events:{..._.events,...v}})),setSize:(v,_,w,b,E)=>{const A=l().camera,T={width:v,height:_,top:b||0,left:E||0,updateStyle:w};a(L=>({size:T,viewport:{...L.viewport,...h(A,d,T)}}))},setDpr:v=>a(_=>{const w=C4(v);return{viewport:{..._.viewport,dpr:w,initialDpr:_.viewport.initialDpr||w}}}),setFrameloop:(v="always")=>{const _=l().clock;_.stop(),_.elapsedTime=0,v!=="never"&&(_.start(),_.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:Se.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,_,w)=>{const b=l().internal;return b.priority=b.priority+(_>0?1:0),b.subscribers.push({ref:v,priority:_,store:w}),b.subscribers=b.subscribers.sort((E,A)=>E.priority-A.priority),()=>{const E=l().internal;E!=null&&E.subscribers&&(E.priority=E.priority-(_>0?1:0),E.subscribers=E.subscribers.filter(A=>A.ref!==v))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:d,set:c}=n.getState();if(l.width!==r.width||l.height!==r.height||u.dpr!==s){var h;r=l,s=u.dpr,WY(a,l),d.setPixelRatio(u.dpr);const f=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(l.width,l.height,f)}a!==o&&(o=a,c(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};let Fv,ZY=new Set,KY=new Set,QY=new Set;function CS(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function hp(t,e){switch(t){case"before":return CS(ZY,e);case"after":return CS(KY,e);case"tail":return CS(QY,e)}}let PS,RS;function LS(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),PS=e.internal.subscribers,Fv=0;Fv<PS.length;Fv++)RS=PS[Fv],RS.ref.current(RS.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function JY(t){let e=!1,n,i,r;function s(l){i=requestAnimationFrame(s),e=!0,n=0,hp("before",l);for(const d of t.values()){var u;r=d.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((u=r.gl.xr)!=null&&u.isPresenting)&&(n+=LS(l,r))}if(hp("after",l),n===0)return hp("tail",l),e=!1,cancelAnimationFrame(i)}function o(l,u=1){var d;if(!l)return t.forEach(c=>o(c.store.getState()),u);(d=l.gl.xr)!=null&&d.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+u),e||(e=!0,requestAnimationFrame(s)))}function a(l,u=!0,d,c){if(u&&hp("before",l),d)LS(l,d,c);else for(const h of t.values())LS(l,h.store.getState());u&&hp("after",l)}return{loop:s,invalidate:o,advance:a}}function O4(){const t=Se.useContext(I4);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function bd(t=n=>n,e){return O4()(t,e)}function y1(t,e=0){const n=O4(),i=n.getState().internal.subscribe,r=A4(t);return Mg(()=>i(r,e,n),[e,i,n]),null}function eZ(t){return Se.useMemo(()=>P4(t),[t])}const rD=new WeakMap;function N4(t,e){return function(n,...i){let r=rD.get(n);return r||(r=new n,rD.set(n,r)),t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,P4(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`)))))).finally(()=>r.dispose==null?void 0:r.dispose())}}function _T(t,e,n,i){const r=Array.isArray(e)?e:[e],s=NY(N4(n,i),[t,...r],{equal:Sn.equ});return Array.isArray(e)?s:s[0]}_T.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return kY(N4(n),[t,...i])};_T.clear=function(t,e){const n=Array.isArray(e)?e:[e];return UY([t,...n])};const qd=new Map,{invalidate:sD,advance:oD}=JY(qd),{reconciler:x1,applyProps:Dh}=FY(qd,$Y),Ih={objects:"shallow",strict:!1},tZ=(t,e)=>{const n=typeof t=="function"?t(e):t;return D4(n)?n:new XE({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function nZ(t,e){const n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=n}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:r,top:s,left:o}=t.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function iZ(t){const e=qd.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||YY(sD,oD),o=n||x1.createContainer(s,cd.ConcurrentRoot,null,!1,null,"",r,null);e||qd.set(t,{fiber:o,store:s});let a,l=!1,u;return{configure(d={}){let{gl:c,size:h,scene:f,events:m,onCreated:x,shadows:y=!1,linear:v=!1,flat:_=!1,legacy:w=!1,orthographic:b=!1,frameloop:E="always",dpr:A=[1,2],performance:T,raycaster:L,camera:P,onPointerMissed:C}=d,D=s.getState(),U=D.gl;D.gl||D.set({gl:U=tZ(c,t)});let G=D.raycaster;G||D.set({raycaster:G=new vT});const{params:k,...H}=L||{};if(Sn.equ(H,G,Ih)||Dh(G,{...H}),Sn.equ(k,G.params,Ih)||Dh(G,{params:{...G.params,...k}}),!D.camera||D.camera===u&&!Sn.equ(u,P,Ih)){u=P;const $=P instanceof kc,te=$?P:b?new df(0,0,0,0,.1,1e3):new gi(75,0,.1,1e3);$||(te.position.z=5,P&&Dh(te,P),!D.camera&&!(P!=null&&P.rotation)&&te.lookAt(0,0,0)),D.set({camera:te}),G.camera=te}if(!D.scene){let $;f instanceof $d?$=f:($=new $d,f&&Dh($,f)),D.set({scene:jh($)})}if(!D.xr){var K;const $=(J,ie)=>{const se=s.getState();se.frameloop!=="never"&&oD(J,!0,se,ie)},te=()=>{const J=s.getState();J.gl.xr.enabled=J.gl.xr.isPresenting,J.gl.xr.setAnimationLoop(J.gl.xr.isPresenting?$:null),J.gl.xr.isPresenting||sD(J)},Q={connect(){const J=s.getState().gl;J.xr.addEventListener("sessionstart",te),J.xr.addEventListener("sessionend",te)},disconnect(){const J=s.getState().gl;J.xr.removeEventListener("sessionstart",te),J.xr.removeEventListener("sessionend",te)}};typeof((K=U.xr)==null?void 0:K.addEventListener)=="function"&&Q.connect(),D.set({xr:Q})}if(U.shadowMap){const $=U.shadowMap.enabled,te=U.shadowMap.type;if(U.shadowMap.enabled=!!y,Sn.boo(y))U.shadowMap.type=Xp;else if(Sn.str(y)){var q;const Q={basic:hz,percentage:gx,soft:Xp,variance:no};U.shadowMap.type=(q=Q[y])!=null?q:Xp}else Sn.obj(y)&&Object.assign(U.shadowMap,y);($!==U.shadowMap.enabled||te!==U.shadowMap.type)&&(U.shadowMap.needsUpdate=!0)}const N=b4();N&&("enabled"in N?N.enabled=!w:"legacyMode"in N&&(N.legacyMode=w)),Dh(U,{outputEncoding:v?3e3:3001,toneMapping:_?Qo:DE}),D.legacy!==w&&D.set(()=>({legacy:w})),D.linear!==v&&D.set(()=>({linear:v})),D.flat!==_&&D.set(()=>({flat:_})),c&&!Sn.fun(c)&&!D4(c)&&!Sn.equ(c,U,Ih)&&Dh(U,c),m&&!D.events.handlers&&D.set({events:m(s)});const z=nZ(t,h);return Sn.equ(z,D.size,Ih)||D.setSize(z.width,z.height,z.updateStyle,z.top,z.left),A&&D.viewport.dpr!==C4(A)&&D.setDpr(A),D.frameloop!==E&&D.setFrameloop(E),D.onPointerMissed||D.set({onPointerMissed:C}),T&&!Sn.equ(T,D.performance,Ih)&&D.set($=>({performance:{...$.performance,...T}})),a=x,l=!0,this},render(d){return l||this.configure(),x1.updateContainer(Se.createElement(rZ,{store:s,children:d,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){k4(t)}}}function rZ({store:t,children:e,onCreated:n,rootElement:i}){return Mg(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Se.createElement(I4.Provider,{value:t},e)}function k4(t,e){const n=qd.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),x1.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),GY(r),qd.delete(t),e&&e(t)}catch{}},500)})}}x1.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:Se.version});function Km(){return Km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Km.apply(this,arguments)}function x2(t,e,n){var i,r,s,o,a;e==null&&(e=100);function l(){var d=Date.now()-o;d<e&&d>=0?i=setTimeout(l,e-d):(i=null,n||(a=t.apply(s,r),s=r=null))}var u=function(){s=this,r=arguments,o=Date.now();var d=n&&!i;return i||(i=setTimeout(l,e)),d&&(a=t.apply(s,r),s=r=null),a};return u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(a=t.apply(s,r),s=r=null,clearTimeout(i),i=null)},u}x2.debounce=x2;var sZ=x2;const aD=UA(sZ);function oZ(t){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=Se.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=Se.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),u=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,c=Se.useRef(!1);Se.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[h,f,m]=Se.useMemo(()=>{const _=()=>{if(!l.current.element)return;const{left:w,top:b,width:E,height:A,bottom:T,right:L,x:P,y:C}=l.current.element.getBoundingClientRect(),D={left:w,top:b,width:E,height:A,bottom:T,right:L,x:P,y:C};l.current.element instanceof HTMLElement&&r&&(D.height=l.current.element.offsetHeight,D.width=l.current.element.offsetWidth),Object.freeze(D),c.current&&!cZ(l.current.lastBounds,D)&&a(l.current.lastBounds=D)};return[_,d?aD(_,d):_,u?aD(_,u):_]},[a,r,u,d]);function x(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",m,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function y(){l.current.element&&(l.current.resizeObserver=new s(m),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(_=>_.addEventListener("scroll",m,{capture:!0,passive:!0})))}const v=_=>{!_||_===l.current.element||(x(),l.current.element=_,l.current.scrollContainers=U4(_),y())};return lZ(m,!!n),aZ(f),Se.useEffect(()=>{x(),y()},[n,m,f]),Se.useEffect(()=>x,[]),[v,o,h]}function aZ(t){Se.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function lZ(t,e){Se.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function U4(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...U4(t.parentElement)]}const uZ=["x","y","top","bottom","left","right","width","height"],cZ=(t,e)=>uZ.every(n=>t[n]===e[n]);var hZ=Object.defineProperty,dZ=Object.defineProperties,fZ=Object.getOwnPropertyDescriptors,lD=Object.getOwnPropertySymbols,pZ=Object.prototype.hasOwnProperty,mZ=Object.prototype.propertyIsEnumerable,uD=(t,e,n)=>e in t?hZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cD=(t,e)=>{for(var n in e||(e={}))pZ.call(e,n)&&uD(t,n,e[n]);if(lD)for(var n of lD(e))mZ.call(e,n)&&uD(t,n,e[n]);return t},gZ=(t,e)=>dZ(t,fZ(e));function z4(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=z4(i,e,n);if(r)return r;i=e?null:i.sibling}}function F4(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const wT=F4(Se.createContext(null));class B4 extends Se.Component{render(){return Se.createElement(wT.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:hD,ReactCurrentDispatcher:dD}=Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function vZ(){const t=Se.useContext(wT);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Se.useId();return Se.useMemo(()=>{for(const i of[hD==null?void 0:hD.current,t,t==null?void 0:t.alternate]){if(!i)continue;const r=z4(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function yZ(){var t,e;const n=vZ(),[i]=Se.useState(()=>new Map);i.clear();let r=n;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==wT&&!i.has(s)&&i.set(s,(e=dD==null?void 0:dD.current)==null?void 0:e.readContext(F4(s))),r=r.return}return i}function xZ(){const t=yZ();return Se.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>Se.createElement(e,null,Se.createElement(n.Provider,gZ(cD({},i),{value:t.get(n)}))),e=>Se.createElement(B4,cD({},e))),[t])}const DS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function _Z(t){const{handlePointer:e}=XY(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(DS).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,u]=DS[o];n.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=DS[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}const wZ=Se.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=_Z,eventSource:a,eventPrefix:l,shadows:u,linear:d,flat:c,legacy:h,orthographic:f,frameloop:m,dpr:x,performance:y,raycaster:v,camera:_,scene:w,onPointerMissed:b,onCreated:E,...A},T){Se.useMemo(()=>zY(AY),[]);const L=xZ(),[P,C]=oZ({scroll:!0,debounce:{scroll:50,resize:0},...i}),D=Se.useRef(null),U=Se.useRef(null);Se.useImperativeHandle(T,()=>D.current);const G=A4(b),[k,H]=Se.useState(!1),[K,q]=Se.useState(!1);if(k)throw k;if(K)throw K;const N=Se.useRef(null);Mg(()=>{const j=D.current;C.width>0&&C.height>0&&j&&(N.current||(N.current=iZ(j)),N.current.configure({gl:s,events:o,shadows:u,linear:d,flat:c,legacy:h,orthographic:f,frameloop:m,dpr:x,performance:y,raycaster:v,camera:_,scene:w,size:C,onPointerMissed:(...z)=>G.current==null?void 0:G.current(...z),onCreated:z=>{z.events.connect==null||z.events.connect(a?BY(a)?a.current:a:U.current),l&&z.setEvents({compute:($,te)=>{const Q=$[l+"X"],J=$[l+"Y"];te.pointer.set(Q/te.size.width*2-1,-(J/te.size.height)*2+1),te.raycaster.setFromCamera(te.pointer,te.camera)}}),E==null||E(z)}}),N.current.render(Se.createElement(L,null,Se.createElement(E4,{set:q},Se.createElement(Se.Suspense,{fallback:Se.createElement(VY,{set:H})},e)))))}),Se.useEffect(()=>{const j=D.current;if(j)return()=>k4(j)},[]);const V=a?"none":"auto";return Se.createElement("div",Km({ref:U,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...r}},A),Se.createElement("div",{ref:P,style:{width:"100%",height:"100%"}},Se.createElement("canvas",{ref:D,style:{display:"block"}},n)))}),SZ=Se.forwardRef(function(e,n){return Se.createElement(B4,null,Se.createElement(wZ,Km({},e,{ref:n})))}),_1=Se.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Vx=Se.createContext({}),ST=Se.createContext(null),jx=typeof document<"u",bZ=jx?Se.useLayoutEffect:Se.useEffect,V4=Se.createContext({strict:!1});function MZ(t,e,n,i){const{visualElement:r}=Se.useContext(Vx),s=Se.useContext(V4),o=Se.useContext(ST),a=Se.useContext(_1).reducedMotion,l=Se.useRef();i=i||s.renderer,!l.current&&i&&(l.current=i(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const u=l.current;Se.useInsertionEffect(()=>{u&&u.update(n,o)});const d=Se.useRef(!!window.HandoffAppearAnimations);return bZ(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),Se.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,d.current=!1)}),u}function hd(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function AZ(t,e,n){return Se.useCallback(i=>{i&&t.mount&&t.mount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):hd(n)&&(n.current=i))},[e])}function Qm(t){return typeof t=="string"||Array.isArray(t)}function Gx(t){return typeof t=="object"&&typeof t.start=="function"}const bT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],MT=["initial",...bT];function Hx(t){return Gx(t.animate)||MT.some(e=>Qm(t[e]))}function j4(t){return!!(Hx(t)||t.variants)}function EZ(t,e){if(Hx(t)){const{initial:n,animate:i}=t;return{initial:n===!1||Qm(n)?n:void 0,animate:Qm(i)?i:void 0}}return t.inherit!==!1?e:{}}function TZ(t){const{initial:e,animate:n}=EZ(t,Se.useContext(Vx));return Se.useMemo(()=>({initial:e,animate:n}),[fD(e),fD(n)])}function fD(t){return Array.isArray(t)?t.join(" "):t}const pD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Jm={};for(const t in pD)Jm[t]={isEnabled:e=>pD[t].some(n=>!!e[n])};function CZ(t){for(const e in t)Jm[e]={...Jm[e],...t[e]}}const G4=Se.createContext({}),H4=Se.createContext({}),PZ=Symbol.for("motionComponentSymbol");function W4({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:i,Component:r}){t&&CZ(t);function s(a,l){let u;const d={...Se.useContext(_1),...a,layoutId:RZ(a)},{isStatic:c}=d,h=TZ(a),f=i(a,c);if(!c&&jx){h.visualElement=MZ(r,f,d,e);const m=Se.useContext(H4),x=Se.useContext(V4).strict;h.visualElement&&(u=h.visualElement.loadFeatures(d,x,t,m))}return Se.createElement(Vx.Provider,{value:h},u&&h.visualElement?Se.createElement(u,{visualElement:h.visualElement,...d}):null,n(r,a,AZ(f,h.visualElement,l),f,c,h.visualElement))}const o=Se.forwardRef(s);return o[PZ]=r,o}function RZ({layoutId:t}){const e=Se.useContext(G4).id;return e&&t!==void 0?e+"-"+t:t}function LZ(t){function e(i,r={}){return W4(t(i,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(i,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const DZ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function AT(t){return typeof t!="string"||t.includes("-")?!1:!!(DZ.indexOf(t)>-1||/[A-Z]/.test(t))}const w1={};function IZ(t){Object.assign(w1,t)}const Ag=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],jc=new Set(Ag);function $4(t,{layout:e,layoutId:n}){return jc.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!w1[t]||t==="opacity")}const hi=t=>!!(t&&t.getVelocity),OZ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},NZ=Ag.length;function kZ(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},i,r){let s="";for(let o=0;o<NZ;o++){const a=Ag[o];if(t[a]!==void 0){const l=OZ[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(t,i?"":s):n&&i&&(s="none"),s}const q4=t=>e=>typeof e=="string"&&e.startsWith(t),X4=q4("--"),_2=q4("var(--"),UZ=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,zZ=(t,e)=>e&&typeof t=="number"?e.transform(t):t,ou=(t,e,n)=>Math.min(Math.max(n,t),e),Gc={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},tm={...Gc,transform:t=>ou(0,1,t)},Bv={...Gc,default:1},nm=t=>Math.round(t*1e5)/1e5,Wx=/(-)?([\d]*\.?[\d])+/g,Y4=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,FZ=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Eg(t){return typeof t=="string"}const Tg=t=>({test:e=>Eg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),xl=Tg("deg"),na=Tg("%"),_t=Tg("px"),BZ=Tg("vh"),VZ=Tg("vw"),mD={...na,parse:t=>na.parse(t)/100,transform:t=>na.transform(t*100)},gD={...Gc,transform:Math.round},Z4={borderWidth:_t,borderTopWidth:_t,borderRightWidth:_t,borderBottomWidth:_t,borderLeftWidth:_t,borderRadius:_t,radius:_t,borderTopLeftRadius:_t,borderTopRightRadius:_t,borderBottomRightRadius:_t,borderBottomLeftRadius:_t,width:_t,maxWidth:_t,height:_t,maxHeight:_t,size:_t,top:_t,right:_t,bottom:_t,left:_t,padding:_t,paddingTop:_t,paddingRight:_t,paddingBottom:_t,paddingLeft:_t,margin:_t,marginTop:_t,marginRight:_t,marginBottom:_t,marginLeft:_t,rotate:xl,rotateX:xl,rotateY:xl,rotateZ:xl,scale:Bv,scaleX:Bv,scaleY:Bv,scaleZ:Bv,skew:xl,skewX:xl,skewY:xl,distance:_t,translateX:_t,translateY:_t,translateZ:_t,x:_t,y:_t,z:_t,perspective:_t,transformPerspective:_t,opacity:tm,originX:mD,originY:mD,originZ:_t,zIndex:gD,fillOpacity:tm,strokeOpacity:tm,numOctaves:gD};function ET(t,e,n,i){const{style:r,vars:s,transform:o,transformOrigin:a}=t;let l=!1,u=!1,d=!0;for(const c in e){const h=e[c];if(X4(c)){s[c]=h;continue}const f=Z4[c],m=zZ(h,f);if(jc.has(c)){if(l=!0,o[c]=m,!d)continue;h!==(f.default||0)&&(d=!1)}else c.startsWith("origin")?(u=!0,a[c]=m):r[c]=m}if(e.transform||(l||i?r.transform=kZ(t.transform,n,d,i):r.transform&&(r.transform="none")),u){const{originX:c="50%",originY:h="50%",originZ:f=0}=a;r.transformOrigin=`${c} ${h} ${f}`}}const TT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function K4(t,e,n){for(const i in e)!hi(e[i])&&!$4(i,n)&&(t[i]=e[i])}function jZ({transformTemplate:t},e,n){return Se.useMemo(()=>{const i=TT();return ET(i,e,{enableHardwareAcceleration:!n},t),Object.assign({},i.vars,i.style)},[e])}function GZ(t,e,n){const i=t.style||{},r={};return K4(r,i,t),Object.assign(r,jZ(t,e,n)),t.transformValues?t.transformValues(r):r}function HZ(t,e,n){const i={},r=GZ(t,e,n);return t.drag&&t.dragListener!==!1&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(i.tabIndex=0),i.style=r,i}const WZ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function S1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||WZ.has(t)}let Q4=t=>!S1(t);function J4(t){t&&(Q4=e=>e.startsWith("on")?!S1(e):t(e))}try{J4(require("@emotion/is-prop-valid").default)}catch{}function eB(t,e,n){const i={};for(const r in t)r==="values"&&typeof t.values=="object"||(Q4(r)||n===!0&&S1(r)||!e&&!S1(r)||t.draggable&&r.startsWith("onDrag"))&&(i[r]=t[r]);return i}function vD(t,e,n){return typeof t=="string"?t:_t.transform(e+n*t)}function $Z(t,e,n){const i=vD(e,t.x,t.width),r=vD(n,t.y,t.height);return`${i} ${r}`}const qZ={offset:"stroke-dashoffset",array:"stroke-dasharray"},XZ={offset:"strokeDashoffset",array:"strokeDasharray"};function YZ(t,e,n=1,i=0,r=!0){t.pathLength=1;const s=r?qZ:XZ;t[s.offset]=_t.transform(-i);const o=_t.transform(e),a=_t.transform(n);t[s.array]=`${o} ${a}`}function CT(t,{attrX:e,attrY:n,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...u},d,c,h){if(ET(t,u,d,h),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:m,dimensions:x}=t;f.transform&&(x&&(m.transform=f.transform),delete f.transform),x&&(r!==void 0||s!==void 0||m.transform)&&(m.transformOrigin=$Z(x,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),i!==void 0&&(f.scale=i),o!==void 0&&YZ(f,o,a,l,!1)}const tB=()=>({...TT(),attrs:{}}),PT=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ZZ(t,e,n,i){const r=Se.useMemo(()=>{const s=tB();return CT(s,e,{enableHardwareAcceleration:!1},PT(i),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};K4(s,t.style,t),r.style={...s,...r.style}}return r}function KZ(t=!1){return(n,i,r,{latestValues:s},o)=>{const l=(AT(n)?ZZ:HZ)(i,s,o,n),d={...eB(i,typeof n=="string",t),...l,ref:r},{children:c}=i,h=Se.useMemo(()=>hi(c)?c.get():c,[c]);return Se.createElement(n,{...d,children:h})}}const RT=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function nB(t,{style:e,vars:n},i,r){Object.assign(t.style,e,r&&r.getProjectionStyles(i));for(const s in n)t.style.setProperty(s,n[s])}const iB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function rB(t,e,n,i){nB(t,e,void 0,i);for(const r in e.attrs)t.setAttribute(iB.has(r)?r:RT(r),e.attrs[r])}function LT(t,e){const{style:n}=t,i={};for(const r in n)(hi(n[r])||e.style&&hi(e.style[r])||$4(r,t))&&(i[r]=n[r]);return i}function sB(t,e){const n=LT(t,e);for(const i in t)if(hi(t[i])||hi(e[i])){const r=Ag.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[r]=t[i]}return n}function DT(t,e,n,i={},r={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),e}function oB(t){const e=Se.useRef(null);return e.current===null&&(e.current=t()),e.current}const b1=t=>Array.isArray(t),QZ=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),JZ=t=>b1(t)?t[t.length-1]||0:t;function im(t){const e=hi(t)?t.get():t;return QZ(e)?e.toValue():e}function eK({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},i,r,s){const o={latestValues:tK(i,r,s,t),renderState:e()};return n&&(o.mount=a=>n(i,a,o)),o}const IT=t=>(e,n)=>{const i=Se.useContext(Vx),r=Se.useContext(ST),s=()=>eK(t,e,i,r);return n?s():oB(s)};function tK(t,e,n,i){const r={},s=i(t,{});for(const h in s)r[h]=im(s[h]);let{initial:o,animate:a}=t;const l=Hx(t),u=j4(t);e&&u&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const c=d?a:o;return c&&typeof c!="boolean"&&!Gx(c)&&(Array.isArray(c)?c:[c]).forEach(f=>{const m=DT(t,f);if(!m)return;const{transitionEnd:x,transition:y,...v}=m;for(const _ in v){let w=v[_];if(Array.isArray(w)){const b=d?w.length-1:0;w=w[b]}w!==null&&(r[_]=w)}for(const _ in x)r[_]=x[_]}),r}const $n=t=>t;class yD{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function nK(t){let e=new yD,n=new yD,i=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,u=!1,d=!1)=>{const c=d&&r,h=c?e:n;return u&&o.add(l),h.add(l)&&c&&r&&(i=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[e,n]=[n,e],n.clear(),i=e.order.length,i)for(let u=0;u<i;u++){const d=e.order[u];d(l),o.has(d)&&(a.schedule(d),t())}r=!1,s&&(s=!1,a.process(l))}};return a}const Vv=["prepare","read","update","preRender","render","postRender"],iK=40;function rK(t,e){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=Vv.reduce((c,h)=>(c[h]=nK(()=>n=!0),c),{}),o=c=>s[c].process(r),a=()=>{const c=performance.now();n=!1,r.delta=i?1e3/60:Math.max(Math.min(c-r.timestamp,iK),1),r.timestamp=c,r.isProcessing=!0,Vv.forEach(o),r.isProcessing=!1,n&&e&&(i=!1,t(a))},l=()=>{n=!0,i=!0,r.isProcessing||t(a)};return{schedule:Vv.reduce((c,h)=>{const f=s[h];return c[h]=(m,x=!1,y=!1)=>(n||l(),f.schedule(m,x,y)),c},{}),cancel:c=>Vv.forEach(h=>s[h].cancel(c)),state:r,steps:s}}const{schedule:Mn,cancel:Xa,state:Di,steps:IS}=rK(typeof requestAnimationFrame<"u"?requestAnimationFrame:$n,!0),sK={useVisualState:IT({scrapeMotionValuesFromProps:sB,createRenderState:tB,onMount:(t,e,{renderState:n,latestValues:i})=>{Mn.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),Mn.render(()=>{CT(n,i,{enableHardwareAcceleration:!1},PT(e.tagName),t.transformTemplate),rB(e,n)})}})},oK={useVisualState:IT({scrapeMotionValuesFromProps:LT,createRenderState:TT})};function aK(t,{forwardMotionProps:e=!1},n,i){return{...AT(t)?sK:oK,preloadedFeatures:n,useRender:KZ(e),createVisualElement:i,Component:t}}function Na(t,e,n,i={passive:!0}){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n)}const aB=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function $x(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const lB=t=>e=>aB(e)&&t(e,$x(e));function mo(t,e,n,i){return Na(t,e,lB(n),i)}const lK=(t,e)=>n=>e(t(n)),za=(...t)=>t.reduce(lK);function uB(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const xD=uB("dragHorizontal"),_D=uB("dragVertical");function cB(t){let e=!1;if(t==="y")e=_D();else if(t==="x")e=xD();else{const n=xD(),i=_D();n&&i?e=()=>{n(),i()}:(n&&n(),i&&i())}return e}function OT(){const t=cB(!0);return t?(t(),!1):!0}class mu{constructor(e){this.isMounted=!1,this.node=e}update(){}}function wD(t,e){const n="pointer"+(e?"enter":"leave"),i="onHover"+(e?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||OT())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[i]&&Mn.update(()=>a[i](s,o))};return mo(t.current,n,r,{passive:!t.getProps()[i]})}class uK extends mu{mount(){this.unmount=za(wD(this.node,!0),wD(this.node,!1))}unmount(){}}class cK extends mu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=za(Na(this.node.current,"focus",()=>this.onFocus()),Na(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const hB=(t,e)=>e?t===e?!0:hB(t,e.parentElement):!1;function OS(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,$x(n))}class hK extends mu{constructor(){super(...arguments),this.removeStartListeners=$n,this.removeEndListeners=$n,this.removeAccessibleListeners=$n,this.startPointerPress=(e,n)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=mo(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d}=this.node.getProps();Mn.update(()=>{hB(this.node.current,a.target)?u&&u(a,l):d&&d(a,l)})},{passive:!(i.onTap||i.onPointerUp)}),o=mo(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=za(s,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||OS("up",(l,u)=>{const{onTap:d}=this.node.getProps();d&&Mn.update(()=>d(l,u))})};this.removeEndListeners(),this.removeEndListeners=Na(this.node.current,"keyup",o),OS("down",(a,l)=>{this.startPress(a,l)})},n=Na(this.node.current,"keydown",e),i=()=>{this.isPressing&&OS("cancel",(s,o)=>this.cancelPress(s,o))},r=Na(this.node.current,"blur",i);this.removeAccessibleListeners=za(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:i,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&Mn.update(()=>i(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!OT()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&Mn.update(()=>i(e,n))}mount(){const e=this.node.getProps(),n=mo(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),i=Na(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=za(n,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const w2=new WeakMap,NS=new WeakMap,dK=t=>{const e=w2.get(t.target);e&&e(t)},fK=t=>{t.forEach(dK)};function pK({root:t,...e}){const n=t||document;NS.has(n)||NS.set(n,{});const i=NS.get(n),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(fK,{root:t,...e})),i[r]}function mK(t,e,n){const i=pK(e);return w2.set(t,n),i.observe(t),()=>{w2.delete(t),i.unobserve(t)}}const gK={some:0,all:1};class vK extends mu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:gK[r]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:c}=this.node.getProps(),h=u?d:c;h&&h(l)};return mK(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(yK(e,n))&&this.startObserver()}unmount(){}}function yK({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const xK={inView:{Feature:vK},tap:{Feature:hK},focus:{Feature:cK},hover:{Feature:uK}};function dB(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}function _K(t){const e={};return t.values.forEach((n,i)=>e[i]=n.get()),e}function wK(t){const e={};return t.values.forEach((n,i)=>e[i]=n.getVelocity()),e}function qx(t,e,n){const i=t.getProps();return DT(i,e,n!==void 0?n:i.custom,_K(t),wK(t))}const SK="framerAppearId",bK="data-"+RT(SK);let MK=$n,NT=$n;const Kl=t=>t*1e3,Fa=t=>t/1e3,AK={current:!1},fB=t=>Array.isArray(t)&&typeof t[0]=="number";function pB(t){return!!(!t||typeof t=="string"&&mB[t]||fB(t)||Array.isArray(t)&&t.every(pB))}const Ip=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,mB={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ip([0,.65,.55,1]),circOut:Ip([.55,0,1,.45]),backIn:Ip([.31,.01,.66,-.59]),backOut:Ip([.33,1.53,.69,.99])};function gB(t){if(t)return fB(t)?Ip(t):Array.isArray(t)?t.map(gB):mB[t]}function EK(t,e,n,{delay:i=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const u={[e]:n};l&&(u.offset=l);const d=gB(a);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}function TK(t,{repeat:e,repeatType:n="loop"}){const i=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[i]}const vB=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,CK=1e-7,PK=12;function RK(t,e,n,i,r){let s,o,a=0;do o=e+(n-e)/2,s=vB(o,i,r)-t,s>0?n=o:e=o;while(Math.abs(s)>CK&&++a<PK);return o}function Cg(t,e,n,i){if(t===e&&n===i)return $n;const r=s=>RK(s,0,1,t,n);return s=>s===0||s===1?s:vB(r(s),e,i)}const LK=Cg(.42,0,1,1),DK=Cg(0,0,.58,1),yB=Cg(.42,0,.58,1),IK=t=>Array.isArray(t)&&typeof t[0]!="number",xB=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,_B=t=>e=>1-t(1-e),wB=t=>1-Math.sin(Math.acos(t)),kT=_B(wB),OK=xB(kT),SB=Cg(.33,1.53,.69,.99),UT=_B(SB),NK=xB(UT),kK=t=>(t*=2)<1?.5*UT(t):.5*(2-Math.pow(2,-10*(t-1))),UK={linear:$n,easeIn:LK,easeInOut:yB,easeOut:DK,circIn:wB,circInOut:OK,circOut:kT,backIn:UT,backInOut:NK,backOut:SB,anticipate:kK},SD=t=>{if(Array.isArray(t)){NT(t.length===4);const[e,n,i,r]=t;return Cg(e,n,i,r)}else if(typeof t=="string")return UK[t];return t},zT=(t,e)=>n=>!!(Eg(n)&&FZ.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),bB=(t,e,n)=>i=>{if(!Eg(i))return i;const[r,s,o,a]=i.match(Wx);return{[t]:parseFloat(r),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},zK=t=>ou(0,255,t),kS={...Gc,transform:t=>Math.round(zK(t))},lc={test:zT("rgb","red"),parse:bB("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+kS.transform(t)+", "+kS.transform(e)+", "+kS.transform(n)+", "+nm(tm.transform(i))+")"};function FK(t){let e="",n="",i="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const S2={test:zT("#"),parse:FK,transform:lc.transform},dd={test:zT("hsl","hue"),parse:bB("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+na.transform(nm(e))+", "+na.transform(nm(n))+", "+nm(tm.transform(i))+")"},dr={test:t=>lc.test(t)||S2.test(t)||dd.test(t),parse:t=>lc.test(t)?lc.parse(t):dd.test(t)?dd.parse(t):S2.parse(t),transform:t=>Eg(t)?t:t.hasOwnProperty("red")?lc.transform(t):dd.transform(t)},Nn=(t,e,n)=>-n*t+n*e+t;function US(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function BK({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,e/=100,n/=100;let r=0,s=0,o=0;if(!e)r=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=US(l,a,t+1/3),s=US(l,a,t),o=US(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}const zS=(t,e,n)=>{const i=t*t;return Math.sqrt(Math.max(0,n*(e*e-i)+i))},VK=[S2,lc,dd],jK=t=>VK.find(e=>e.test(t));function bD(t){const e=jK(t);let n=e.parse(t);return e===dd&&(n=BK(n)),n}const MB=(t,e)=>{const n=bD(t),i=bD(e),r={...n};return s=>(r.red=zS(n.red,i.red,s),r.green=zS(n.green,i.green,s),r.blue=zS(n.blue,i.blue,s),r.alpha=Nn(n.alpha,i.alpha,s),lc.transform(r))};function GK(t){var e,n;return isNaN(t)&&Eg(t)&&(((e=t.match(Wx))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Y4))===null||n===void 0?void 0:n.length)||0)>0}const AB={regex:UZ,countKey:"Vars",token:"${v}",parse:$n},EB={regex:Y4,countKey:"Colors",token:"${c}",parse:dr.parse},TB={regex:Wx,countKey:"Numbers",token:"${n}",parse:Gc.parse};function FS(t,{regex:e,countKey:n,token:i,parse:r}){const s=t.tokenised.match(e);s&&(t["num"+n]=s.length,t.tokenised=t.tokenised.replace(e,i),t.values.push(...s.map(r)))}function M1(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&FS(n,AB),FS(n,EB),FS(n,TB),n}function CB(t){return M1(t).values}function PB(t){const{values:e,numColors:n,numVars:i,tokenised:r}=M1(t),s=e.length;return o=>{let a=r;for(let l=0;l<s;l++)l<i?a=a.replace(AB.token,o[l]):l<i+n?a=a.replace(EB.token,dr.transform(o[l])):a=a.replace(TB.token,nm(o[l]));return a}}const HK=t=>typeof t=="number"?0:t;function WK(t){const e=CB(t);return PB(t)(e.map(HK))}const au={test:GK,parse:CB,createTransformer:PB,getAnimatableNone:WK},RB=(t,e)=>n=>`${n>0?e:t}`;function LB(t,e){return typeof t=="number"?n=>Nn(t,e,n):dr.test(t)?MB(t,e):t.startsWith("var(")?RB(t,e):IB(t,e)}const DB=(t,e)=>{const n=[...t],i=n.length,r=t.map((s,o)=>LB(s,e[o]));return s=>{for(let o=0;o<i;o++)n[o]=r[o](s);return n}},$K=(t,e)=>{const n={...t,...e},i={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(i[r]=LB(t[r],e[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}},IB=(t,e)=>{const n=au.createTransformer(e),i=M1(t),r=M1(e);return i.numVars===r.numVars&&i.numColors===r.numColors&&i.numNumbers>=r.numNumbers?za(DB(i.values,r.values),n):RB(t,e)},eg=(t,e,n)=>{const i=e-t;return i===0?1:(n-t)/i},MD=(t,e)=>n=>Nn(t,e,n);function qK(t){return typeof t=="number"?MD:typeof t=="string"?dr.test(t)?MB:IB:Array.isArray(t)?DB:typeof t=="object"?$K:MD}function XK(t,e,n){const i=[],r=n||qK(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||$n:e;a=za(l,a)}i.push(a)}return i}function OB(t,e,{clamp:n=!0,ease:i,mixer:r}={}){const s=t.length;if(NT(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=XK(e,i,r),a=o.length,l=u=>{let d=0;if(a>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const c=eg(t[d],t[d+1],u);return o[d](c)};return n?u=>l(ou(t[0],t[s-1],u)):l}function YK(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=eg(0,e,i);t.push(Nn(n,1,r))}}function ZK(t){const e=[0];return YK(e,t.length-1),e}function KK(t,e){return t.map(n=>n*e)}function QK(t,e){return t.map(()=>e||yB).splice(0,t.length-1)}function A1({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const r=IK(i)?i.map(SD):SD(i),s={done:!1,value:e[0]},o=KK(n&&n.length===e.length?n:ZK(e),t),a=OB(o,e,{ease:Array.isArray(r)?r:QK(e,r)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function NB(t,e){return e?t*(1e3/e):0}const JK=5;function kB(t,e,n){const i=Math.max(e-JK,0);return NB(n-t(i),e-i)}const BS=.001,eQ=.01,AD=10,tQ=.05,nQ=1;function iQ({duration:t=800,bounce:e=.25,velocity:n=0,mass:i=1}){let r,s;MK(t<=Kl(AD));let o=1-e;o=ou(tQ,nQ,o),t=ou(eQ,AD,Fa(t)),o<1?(r=u=>{const d=u*o,c=d*t,h=d-n,f=b2(u,o),m=Math.exp(-c);return BS-h/f*m},s=u=>{const c=u*o*t,h=c*n+n,f=Math.pow(o,2)*Math.pow(u,2)*t,m=Math.exp(-c),x=b2(Math.pow(u,2),o);return(-r(u)+BS>0?-1:1)*((h-f)*m)/x}):(r=u=>{const d=Math.exp(-u*t),c=(u-n)*t+1;return-BS+d*c},s=u=>{const d=Math.exp(-u*t),c=(n-u)*(t*t);return d*c});const a=5/t,l=sQ(r,s,a);if(t=Kl(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(l,2)*i;return{stiffness:u,damping:o*2*Math.sqrt(i*u),duration:t}}}const rQ=12;function sQ(t,e,n){let i=n;for(let r=1;r<rQ;r++)i=i-t(i)/e(i);return i}function b2(t,e){return t*Math.sqrt(1-e*e)}const oQ=["duration","bounce"],aQ=["stiffness","damping","mass"];function ED(t,e){return e.some(n=>t[n]!==void 0)}function lQ(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!ED(t,aQ)&&ED(t,oQ)){const n=iQ(t);e={...e,...n,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}function UB({keyframes:t,restDelta:e,restSpeed:n,...i}){const r=t[0],s=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:u,velocity:d,duration:c,isResolvedFromDuration:h}=lQ(i),f=d?-Fa(d):0,m=l/(2*Math.sqrt(a*u)),x=s-r,y=Fa(Math.sqrt(a/u)),v=Math.abs(x)<5;n||(n=v?.01:2),e||(e=v?.005:.5);let _;if(m<1){const w=b2(y,m);_=b=>{const E=Math.exp(-m*y*b);return s-E*((f+m*y*x)/w*Math.sin(w*b)+x*Math.cos(w*b))}}else if(m===1)_=w=>s-Math.exp(-y*w)*(x+(f+y*x)*w);else{const w=y*Math.sqrt(m*m-1);_=b=>{const E=Math.exp(-m*y*b),A=Math.min(w*b,300);return s-E*((f+m*y*x)*Math.sinh(A)+w*x*Math.cosh(A))/w}}return{calculatedDuration:h&&c||null,next:w=>{const b=_(w);if(h)o.done=w>=c;else{let E=f;w!==0&&(m<1?E=kB(_,w,b):E=0);const A=Math.abs(E)<=n,T=Math.abs(s-b)<=e;o.done=A&&T}return o.value=o.done?s:b,o}}}function TD({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:u=.5,restSpeed:d}){const c=t[0],h={done:!1,value:c},f=L=>a!==void 0&&L<a||l!==void 0&&L>l,m=L=>a===void 0?l:l===void 0||Math.abs(a-L)<Math.abs(l-L)?a:l;let x=n*e;const y=c+x,v=o===void 0?y:o(y);v!==y&&(x=v-c);const _=L=>-x*Math.exp(-L/i),w=L=>v+_(L),b=L=>{const P=_(L),C=w(L);h.done=Math.abs(P)<=u,h.value=h.done?v:C};let E,A;const T=L=>{f(h.value)&&(E=L,A=UB({keyframes:[h.value,m(h.value)],velocity:kB(w,L,h.value),damping:r,stiffness:s,restDelta:u,restSpeed:d}))};return T(0),{calculatedDuration:null,next:L=>{let P=!1;return!A&&E===void 0&&(P=!0,b(L),T(L)),E!==void 0&&L>E?A.next(L-E):(!P&&b(L),h)}}}const uQ=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Mn.update(e,!0),stop:()=>Xa(e),now:()=>Di.isProcessing?Di.timestamp:performance.now()}},CD=2e4;function PD(t){let e=0;const n=50;let i=t.next(e);for(;!i.done&&e<CD;)e+=n,i=t.next(e);return e>=CD?1/0:e}const cQ={decay:TD,inertia:TD,tween:A1,keyframes:A1,spring:UB};function E1({autoplay:t=!0,delay:e=0,driver:n=uQ,keyframes:i,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:u,onComplete:d,onUpdate:c,...h}){let f=1,m=!1,x,y;const v=()=>{y=new Promise(z=>{x=z})};v();let _;const w=cQ[r]||A1;let b;w!==A1&&typeof i[0]!="number"&&(b=OB([0,100],i,{clamp:!1}),i=[0,100]);const E=w({...h,keyframes:i});let A;a==="mirror"&&(A=w({...h,keyframes:[...i].reverse(),velocity:-(h.velocity||0)}));let T="idle",L=null,P=null,C=null;E.calculatedDuration===null&&s&&(E.calculatedDuration=PD(E));const{calculatedDuration:D}=E;let U=1/0,G=1/0;D!==null&&(U=D+o,G=U*(s+1)-o);let k=0;const H=z=>{if(P===null)return;f>0&&(P=Math.min(P,z)),f<0&&(P=Math.min(z-G/f,P)),L!==null?k=L:k=Math.round(z-P)*f;const $=k-e*(f>=0?1:-1),te=f>=0?$<0:$>G;k=Math.max($,0),T==="finished"&&L===null&&(k=G);let Q=k,J=E;if(s){const le=k/U;let Ae=Math.floor(le),ae=le%1;!ae&&le>=1&&(ae=1),ae===1&&Ae--,Ae=Math.min(Ae,s+1);const W=!!(Ae%2);W&&(a==="reverse"?(ae=1-ae,o&&(ae-=o/U)):a==="mirror"&&(J=A));let me=ou(0,1,ae);k>G&&(me=a==="reverse"&&W?1:0),Q=me*U}const ie=te?{done:!1,value:i[0]}:J.next(Q);b&&(ie.value=b(ie.value));let{done:se}=ie;!te&&D!==null&&(se=f>=0?k>=G:k<=0);const pe=L===null&&(T==="finished"||T==="running"&&se);return c&&c(ie.value),pe&&N(),ie},K=()=>{_&&_.stop(),_=void 0},q=()=>{T="idle",K(),x(),v(),P=C=null},N=()=>{T="finished",d&&d(),K(),x()},V=()=>{if(m)return;_||(_=n(H));const z=_.now();l&&l(),L!==null?P=z-L:(!P||T==="finished")&&(P=z),T==="finished"&&v(),C=P,L=null,T="running",_.start()};t&&V();const j={then(z,$){return y.then(z,$)},get time(){return Fa(k)},set time(z){z=Kl(z),k=z,L!==null||!_||f===0?L=z:P=_.now()-z/f},get duration(){const z=E.calculatedDuration===null?PD(E):E.calculatedDuration;return Fa(z)},get speed(){return f},set speed(z){z===f||!_||(f=z,j.time=Fa(k))},get state(){return T},play:V,pause:()=>{T="paused",L=k},stop:()=>{m=!0,T!=="idle"&&(T="idle",u&&u(),q())},cancel:()=>{C!==null&&H(C),q()},complete:()=>{T="finished"},sample:z=>(P=0,H(z))};return j}function hQ(t){let e;return()=>(e===void 0&&(e=t()),e)}const dQ=hQ(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),fQ=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),jv=10,pQ=2e4,mQ=(t,e)=>e.type==="spring"||t==="backgroundColor"||!pB(e.ease);function gQ(t,e,{onUpdate:n,onComplete:i,...r}){if(!(dQ()&&fQ.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,l;const u=()=>{l=new Promise(_=>{a=_})};u();let{keyframes:d,duration:c=300,ease:h,times:f}=r;if(mQ(e,r)){const _=E1({...r,repeat:0,delay:0});let w={done:!1,value:d[0]};const b=[];let E=0;for(;!w.done&&E<pQ;)w=_.sample(E),b.push(w.value),E+=jv;f=void 0,d=b,c=E-jv,h="linear"}const m=EK(t.owner.current,e,d,{...r,duration:c,ease:h,times:f});r.syncStart&&(m.startTime=Di.isProcessing?Di.timestamp:document.timeline?document.timeline.currentTime:performance.now());const x=()=>m.cancel(),y=()=>{Mn.update(x),a(),u()};return m.onfinish=()=>{t.set(TK(d,r)),i&&i(),y()},{then(_,w){return l.then(_,w)},attachTimeline(_){return m.timeline=_,m.onfinish=null,$n},get time(){return Fa(m.currentTime||0)},set time(_){m.currentTime=Kl(_)},get speed(){return m.playbackRate},set speed(_){m.playbackRate=_},get duration(){return Fa(c)},play:()=>{o||(m.play(),Xa(x))},pause:()=>m.pause(),stop:()=>{if(o=!0,m.playState==="idle")return;const{currentTime:_}=m;if(_){const w=E1({...r,autoplay:!1});t.setWithVelocity(w.sample(_-jv).value,w.sample(_).value,jv)}y()},complete:()=>m.finish(),cancel:y}}function vQ({keyframes:t,delay:e,onUpdate:n,onComplete:i}){const r=()=>(n&&n(t[t.length-1]),i&&i(),{time:0,speed:1,duration:0,play:$n,pause:$n,stop:$n,then:s=>(s(),Promise.resolve()),cancel:$n,complete:$n});return e?E1({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const yQ={type:"spring",stiffness:500,damping:25,restSpeed:10},xQ=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),_Q={type:"keyframes",duration:.8},wQ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},SQ=(t,{keyframes:e})=>e.length>2?_Q:jc.has(t)?t.startsWith("scale")?xQ(e[1]):yQ:wQ,M2=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(au.test(e)||e==="0")&&!e.startsWith("url(")),bQ=new Set(["brightness","contrast","saturate","opacity"]);function MQ(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=n.match(Wx)||[];if(!i)return t;const r=n.replace(i,"");let s=bQ.has(e)?1:0;return i!==n&&(s*=100),e+"("+s+r+")"}const AQ=/([a-z-]*)\(.*?\)/g,A2={...au,getAnimatableNone:t=>{const e=t.match(AQ);return e?e.map(MQ).join(" "):t}},EQ={...Z4,color:dr,backgroundColor:dr,outlineColor:dr,fill:dr,stroke:dr,borderColor:dr,borderTopColor:dr,borderRightColor:dr,borderBottomColor:dr,borderLeftColor:dr,filter:A2,WebkitFilter:A2},FT=t=>EQ[t];function zB(t,e){let n=FT(t);return n!==A2&&(n=au),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const FB=t=>/^0[^.\s]+$/.test(t);function TQ(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||FB(t)}function CQ(t,e,n,i){const r=M2(e,n);let s;Array.isArray(n)?s=[...n]:s=[null,n];const o=i.from!==void 0?i.from:t.get();let a;const l=[];for(let u=0;u<s.length;u++)s[u]===null&&(s[u]=u===0?o:s[u-1]),TQ(s[u])&&l.push(u),typeof s[u]=="string"&&s[u]!=="none"&&s[u]!=="0"&&(a=s[u]);if(r&&l.length&&a)for(let u=0;u<l.length;u++){const d=l[u];s[d]=zB(e,a)}return s}function PQ({when:t,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:u,...d}){return!!Object.keys(d).length}function BB(t,e){return t[e]||t.default||t}const BT=(t,e,n,i={})=>r=>{const s=BB(i,t)||{},o=s.delay||i.delay||0;let{elapsed:a=0}=i;a=a-Kl(o);const l=CQ(e,t,n,s),u=l[0],d=l[l.length-1],c=M2(t,u),h=M2(t,d);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:m=>{e.set(m),s.onUpdate&&s.onUpdate(m)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(PQ(s)||(f={...f,...SQ(t,f)}),f.duration&&(f.duration=Kl(f.duration)),f.repeatDelay&&(f.repeatDelay=Kl(f.repeatDelay)),!c||!h||AK.current||s.type===!1)return vQ(f);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const m=gQ(e,t,f);if(m)return m}return E1(f)};function T1(t){return!!(hi(t)&&t.add)}const VB=t=>/^\-?\d*\.?\d+$/.test(t);function VT(t,e){t.indexOf(e)===-1&&t.push(e)}function jT(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class GT{constructor(){this.subscriptions=[]}add(e){return VT(this.subscriptions,e),()=>jT(this.subscriptions,e)}notify(e,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const RQ=t=>!isNaN(parseFloat(t));class LQ{constructor(e,n={}){this.version="10.16.4",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,r=!0)=>{this.prev=this.current,this.current=i;const{delta:s,timestamp:o}=Di;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,Mn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Mn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=RQ(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new GT);const i=this.events[e].add(n);return e==="change"?()=>{i(),Mn.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,i){this.set(n),this.prev=e,this.timeDelta=i}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?NB(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Xd(t,e){return new LQ(t,e)}const jB=t=>e=>e.test(t),DQ={test:t=>t==="auto",parse:t=>t},GB=[Gc,_t,na,xl,VZ,BZ,DQ],dp=t=>GB.find(jB(t)),IQ=[...GB,dr,au],OQ=t=>IQ.find(jB(t));function NQ(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Xd(n))}function kQ(t,e){const n=qx(t,e);let{transitionEnd:i={},transition:r={},...s}=n?t.makeTargetAnimatable(n,!1):{};s={...s,...i};for(const o in s){const a=JZ(s[o]);NQ(t,o,a)}}function HB(t,e,n){var i,r;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],u=e[l];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(r=(i=n[l])!==null&&i!==void 0?i:t.readValue(l))!==null&&r!==void 0?r:e[l]),d!=null&&(typeof d=="string"&&(VB(d)||FB(d))?d=parseFloat(d):!OQ(d)&&au.test(u)&&(d=zB(l,u)),t.addValue(l,Xd(d,{owner:t})),n[l]===void 0&&(n[l]=d),d!==null&&t.setBaseTarget(l,d))}}function UQ(t,e){return e?(e[t]||e.default||e).from:void 0}function zQ(t,e,n){const i={};for(const r in t){const s=UQ(r,e);if(s!==void 0)i[r]=s;else{const o=n.getValue(r);o&&(i[r]=o.get())}}return i}function FQ({protectedKeys:t,needsAnimating:e},n){const i=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function WB(t,e,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");i&&(s=i);const u=[],d=r&&t.animationState&&t.animationState.getState()[r];for(const c in a){const h=t.getValue(c),f=a[c];if(!h||f===void 0||d&&FQ(d,c))continue;const m={delay:n,elapsed:0,...s};if(window.HandoffAppearAnimations&&!h.hasAnimated){const y=t.getProps()[bK];y&&(m.elapsed=window.HandoffAppearAnimations(y,c,h,Mn),m.syncStart=!0)}h.start(BT(c,h,f,t.shouldReduceMotion&&jc.has(c)?{type:!1}:m));const x=h.animation;T1(l)&&(l.add(c),x.then(()=>l.remove(c))),u.push(x)}return o&&Promise.all(u).then(()=>{o&&kQ(t,o)}),u}function E2(t,e,n={}){const i=qx(t,e,n.custom);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(WB(t,i,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:c}=r;return BQ(t,e,u+l,d,c,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,u]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>u())}else return Promise.all([s(),o(n.delay)])}function BQ(t,e,n=0,i=0,r=1,s){const o=[],a=(t.variantChildren.size-1)*i,l=r===1?(u=0)=>u*i:(u=0)=>a-u*i;return Array.from(t.variantChildren).sort(VQ).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(E2(u,e,{...s,delay:n+l(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function VQ(t,e){return t.sortNodePosition(e)}function jQ(t,e,n={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>E2(t,s,n));i=Promise.all(r)}else if(typeof e=="string")i=E2(t,e,n);else{const r=typeof e=="function"?qx(t,e,n.custom):e;i=Promise.all(WB(t,r,n))}return i.then(()=>t.notify("AnimationComplete",e))}const GQ=[...bT].reverse(),HQ=bT.length;function WQ(t){return e=>Promise.all(e.map(({animation:n,options:i})=>jQ(t,n,i)))}function $Q(t){let e=WQ(t);const n=XQ();let i=!0;const r=(l,u)=>{const d=qx(t,u);if(d){const{transition:c,transitionEnd:h,...f}=d;l={...l,...f,...h}}return l};function s(l){e=l(t)}function o(l,u){const d=t.getProps(),c=t.getVariantContext(!0)||{},h=[],f=new Set;let m={},x=1/0;for(let v=0;v<HQ;v++){const _=GQ[v],w=n[_],b=d[_]!==void 0?d[_]:c[_],E=Qm(b),A=_===u?w.isActive:null;A===!1&&(x=v);let T=b===c[_]&&b!==d[_]&&E;if(T&&i&&t.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...m},!w.isActive&&A===null||!b&&!w.prevProp||Gx(b)||typeof b=="boolean")continue;const L=qQ(w.prevProp,b);let P=L||_===u&&w.isActive&&!T&&E||v>x&&E;const C=Array.isArray(b)?b:[b];let D=C.reduce(r,{});A===!1&&(D={});const{prevResolvedValues:U={}}=w,G={...U,...D},k=H=>{P=!0,f.delete(H),w.needsAnimating[H]=!0};for(const H in G){const K=D[H],q=U[H];m.hasOwnProperty(H)||(K!==q?b1(K)&&b1(q)?!dB(K,q)||L?k(H):w.protectedKeys[H]=!0:K!==void 0?k(H):f.add(H):K!==void 0&&f.has(H)?k(H):w.protectedKeys[H]=!0)}w.prevProp=b,w.prevResolvedValues=D,w.isActive&&(m={...m,...D}),i&&t.blockInitialAnimation&&(P=!1),P&&!T&&h.push(...C.map(H=>({animation:H,options:{type:_,...l}})))}if(f.size){const v={};f.forEach(_=>{const w=t.getBaseTarget(_);w!==void 0&&(v[_]=w)}),h.push({animation:v})}let y=!!h.length;return i&&d.initial===!1&&!t.manuallyAnimateOnMount&&(y=!1),i=!1,y?e(h):Promise.resolve()}function a(l,u,d){var c;if(n[l].isActive===u)return Promise.resolve();(c=t.variantChildren)===null||c===void 0||c.forEach(f=>{var m;return(m=f.animationState)===null||m===void 0?void 0:m.setActive(l,u)}),n[l].isActive=u;const h=o(d,l);for(const f in n)n[f].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n}}function qQ(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!dB(e,t):!1}function Nu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function XQ(){return{animate:Nu(!0),whileInView:Nu(),whileHover:Nu(),whileTap:Nu(),whileDrag:Nu(),whileFocus:Nu(),exit:Nu()}}class YQ extends mu{constructor(e){super(e),e.animationState||(e.animationState=$Q(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Gx(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let ZQ=0;class KQ extends mu{constructor(){super(...arguments),this.id=ZQ++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:i}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e,{custom:i??this.node.getProps().custom});n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const $B={animation:{Feature:YQ},exit:{Feature:KQ}},RD=(t,e)=>Math.abs(t-e);function QQ(t,e){const n=RD(t.x,e.x),i=RD(t.y,e.y);return Math.sqrt(n**2+i**2)}class qB{constructor(e,n,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const u=jS(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,c=QQ(u.offset,{x:0,y:0})>=3;if(!d&&!c)return;const{point:h}=u,{timestamp:f}=Di;this.history.push({...h,timestamp:f});const{onStart:m,onMove:x}=this.handlers;d||(m&&m(this.lastMoveEvent,u),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,u)},this.handlePointerMove=(u,d)=>{this.lastMoveEvent=u,this.lastMoveEventInfo=VS(d,this.transformPagePoint),Mn.update(this.updatePoint,!0)},this.handlePointerUp=(u,d)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:c,onSessionEnd:h}=this.handlers,f=jS(u.type==="pointercancel"?this.lastMoveEventInfo:VS(d,this.transformPagePoint),this.history);this.startEvent&&c&&c(u,f),h&&h(u,f)},!aB(e))return;this.handlers=n,this.transformPagePoint=i;const r=$x(e),s=VS(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=Di;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=n;l&&l(e,jS(s,this.history)),this.removeListeners=za(mo(window,"pointermove",this.handlePointerMove),mo(window,"pointerup",this.handlePointerUp),mo(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Xa(this.updatePoint)}}function VS(t,e){return e?{point:e(t.point)}:t}function LD(t,e){return{x:t.x-e.x,y:t.y-e.y}}function jS({point:t},e){return{point:t,delta:LD(t,XB(e)),offset:LD(t,JQ(e)),velocity:eJ(e,.1)}}function JQ(t){return t[0]}function XB(t){return t[t.length-1]}function eJ(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=XB(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>Kl(e)));)n--;if(!i)return{x:0,y:0};const s=Fa(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function cs(t){return t.max-t.min}function T2(t,e=0,n=.01){return Math.abs(t-e)<=n}function DD(t,e,n,i=.5){t.origin=i,t.originPoint=Nn(e.min,e.max,t.origin),t.scale=cs(n)/cs(e),(T2(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Nn(n.min,n.max,t.origin)-t.originPoint,(T2(t.translate)||isNaN(t.translate))&&(t.translate=0)}function rm(t,e,n,i){DD(t.x,e.x,n.x,i?i.originX:void 0),DD(t.y,e.y,n.y,i?i.originY:void 0)}function ID(t,e,n){t.min=n.min+e.min,t.max=t.min+cs(e)}function tJ(t,e,n){ID(t.x,e.x,n.x),ID(t.y,e.y,n.y)}function OD(t,e,n){t.min=e.min-n.min,t.max=t.min+cs(e)}function sm(t,e,n){OD(t.x,e.x,n.x),OD(t.y,e.y,n.y)}function nJ(t,{min:e,max:n},i){return e!==void 0&&t<e?t=i?Nn(e,t,i.min):Math.max(t,e):n!==void 0&&t>n&&(t=i?Nn(n,t,i.max):Math.min(t,n)),t}function ND(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function iJ(t,{top:e,left:n,bottom:i,right:r}){return{x:ND(t.x,n,r),y:ND(t.y,e,i)}}function kD(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function rJ(t,e){return{x:kD(t.x,e.x),y:kD(t.y,e.y)}}function sJ(t,e){let n=.5;const i=cs(t),r=cs(e);return r>i?n=eg(e.min,e.max-i,t.min):i>r&&(n=eg(t.min,t.max-r,e.min)),ou(0,1,n)}function oJ(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const C2=.35;function aJ(t=C2){return t===!1?t=0:t===!0&&(t=C2),{x:UD(t,"left","right"),y:UD(t,"top","bottom")}}function UD(t,e,n){return{min:zD(t,e),max:zD(t,n)}}function zD(t,e){return typeof t=="number"?t:t[e]||0}const FD=()=>({translate:0,scale:1,origin:0,originPoint:0}),fd=()=>({x:FD(),y:FD()}),BD=()=>({min:0,max:0}),ei=()=>({x:BD(),y:BD()});function Go(t){return[t("x"),t("y")]}function YB({top:t,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:t,max:i}}}function lJ({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function uJ(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function GS(t){return t===void 0||t===1}function P2({scale:t,scaleX:e,scaleY:n}){return!GS(t)||!GS(e)||!GS(n)}function Hu(t){return P2(t)||ZB(t)||t.z||t.rotate||t.rotateX||t.rotateY}function ZB(t){return VD(t.x)||VD(t.y)}function VD(t){return t&&t!=="0%"}function C1(t,e,n){const i=t-n,r=e*i;return n+r}function jD(t,e,n,i,r){return r!==void 0&&(t=C1(t,r,i)),C1(t,n,i)+e}function R2(t,e=0,n=1,i,r){t.min=jD(t.min,e,n,i,r),t.max=jD(t.max,e,n,i,r)}function KB(t,{x:e,y:n}){R2(t.x,e.translate,e.scale,e.originPoint),R2(t.y,n.translate,n.scale,n.originPoint)}function cJ(t,e,n,i=!1){const r=n.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&pd(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,KB(t,o)),i&&Hu(s.latestValues)&&pd(t,s.latestValues))}e.x=GD(e.x),e.y=GD(e.y)}function GD(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Sl(t,e){t.min=t.min+e,t.max=t.max+e}function HD(t,e,[n,i,r]){const s=e[r]!==void 0?e[r]:.5,o=Nn(t.min,t.max,s);R2(t,e[n],e[i],o,e.scale)}const hJ=["x","scaleX","originX"],dJ=["y","scaleY","originY"];function pd(t,e){HD(t.x,e,hJ),HD(t.y,e,dJ)}function QB(t,e){return YB(uJ(t.getBoundingClientRect(),e))}function fJ(t,e,n){const i=QB(t,n),{scroll:r}=e;return r&&(Sl(i.x,r.offset.x),Sl(i.y,r.offset.y)),i}const pJ=new WeakMap;class mJ{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ei(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=l=>{this.stopAnimation(),n&&this.snapToCursor($x(l,"page").point)},s=(l,u)=>{const{drag:d,dragPropagation:c,onDragStart:h}=this.getProps();if(d&&!c&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=cB(d),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Go(m=>{let x=this.getAxisMotionValue(m).get()||0;if(na.test(x)){const{projection:y}=this.visualElement;if(y&&y.layout){const v=y.layout.layoutBox[m];v&&(x=cs(v)*(parseFloat(x)/100))}}this.originPoint[m]=x}),h&&Mn.update(()=>h(l,u),!1,!0);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,u)=>{const{dragPropagation:d,dragDirectionLock:c,onDirectionLock:h,onDrag:f}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:m}=u;if(c&&this.currentDirection===null){this.currentDirection=gJ(m),this.currentDirection!==null&&h&&h(this.currentDirection);return}this.updateAxis("x",u.point,m),this.updateAxis("y",u.point,m),this.visualElement.render(),f&&f(l,u)},a=(l,u)=>this.stop(l,u);this.panSession=new qB(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Mn.update(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:r}=this.getProps();if(!i||!Gv(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=nJ(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),{layout:i}=this.visualElement.projection||{},r=this.constraints;e&&hd(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=iJ(i.layoutBox,e):this.constraints=!1,this.elastic=aJ(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Go(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=oJ(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!hd(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=fJ(i,r.root,this.visualElement.getTransformPagePoint());let o=rJ(r.layout.layoutBox,s);if(n){const a=n(lJ(o));this.hasMutatedConstraints=!!a,a&&(o=YB(a))}return o}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=Go(d=>{if(!Gv(d,n,this.currentDirection))return;let c=l&&l[d]||{};o&&(c={min:0,max:0});const h=r?200:1e6,f=r?40:1e7,m={type:"inertia",velocity:i?e[d]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...c};return this.startAxisValueAnimation(d,m)});return Promise.all(u).then(a)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return i.start(BT(e,i,0,n))}stopAnimation(){Go(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Go(n=>{const{drag:i}=this.getProps();if(!Gv(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];s.set(e[n]-Nn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!hd(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Go(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=sJ({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Go(o=>{if(!Gv(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];a.set(Nn(l,u,r[o]))})}addListeners(){if(!this.visualElement.current)return;pJ.set(this.visualElement,this);const e=this.visualElement.current,n=mo(e,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();hd(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),i();const o=Na(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Go(d=>{const c=this.getAxisMotionValue(d);c&&(this.originPoint[d]+=l[d].translate,c.set(c.get()+l[d].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=C2,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Gv(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function gJ(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class vJ extends mu{constructor(e){super(e),this.removeGroupControls=$n,this.removeListeners=$n,this.controls=new mJ(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||$n}unmount(){this.removeGroupControls(),this.removeListeners()}}const WD=t=>(e,n)=>{t&&Mn.update(()=>t(e,n))};class yJ extends mu{constructor(){super(...arguments),this.removePointerDownListener=$n}onPointerDown(e){this.session=new qB(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:WD(e),onStart:WD(n),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Mn.update(()=>r(s,o))}}}mount(){this.removePointerDownListener=mo(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function xJ(){const t=Se.useContext(ST);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:i}=t,r=Se.useId();return Se.useEffect(()=>i(r),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}const Oy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $D(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const fp={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(_t.test(t))t=parseFloat(t);else return t;const n=$D(t,e.target.x),i=$D(t,e.target.y);return`${n}% ${i}%`}},_J={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,r=au.parse(t);if(r.length>5)return i;const s=au.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const u=Nn(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=u),typeof r[3+o]=="number"&&(r[3+o]/=u),s(r)}};class wJ extends ik.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;IZ(SJ),s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Oy.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Mn.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function JB(t){const[e,n]=xJ(),i=Se.useContext(G4);return ik.createElement(wJ,{...t,layoutGroup:i,switchLayoutGroup:Se.useContext(H4),isPresent:e,safeToRemove:n})}const SJ={borderRadius:{...fp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:fp,borderTopRightRadius:fp,borderBottomLeftRadius:fp,borderBottomRightRadius:fp,boxShadow:_J},e5=["TopLeft","TopRight","BottomLeft","BottomRight"],bJ=e5.length,qD=t=>typeof t=="string"?parseFloat(t):t,XD=t=>typeof t=="number"||_t.test(t);function MJ(t,e,n,i,r,s){r?(t.opacity=Nn(0,n.opacity!==void 0?n.opacity:1,AJ(i)),t.opacityExit=Nn(e.opacity!==void 0?e.opacity:1,0,EJ(i))):s&&(t.opacity=Nn(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,i));for(let o=0;o<bJ;o++){const a=`border${e5[o]}Radius`;let l=YD(e,a),u=YD(n,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||XD(l)===XD(u)?(t[a]=Math.max(Nn(qD(l),qD(u),i),0),(na.test(u)||na.test(l))&&(t[a]+="%")):t[a]=u}(e.rotate||n.rotate)&&(t.rotate=Nn(e.rotate||0,n.rotate||0,i))}function YD(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const AJ=t5(0,.5,kT),EJ=t5(.5,.95,$n);function t5(t,e,n){return i=>i<t?0:i>e?1:n(eg(t,e,i))}function ZD(t,e){t.min=e.min,t.max=e.max}function As(t,e){ZD(t.x,e.x),ZD(t.y,e.y)}function KD(t,e,n,i,r){return t-=e,t=C1(t,1/n,i),r!==void 0&&(t=C1(t,1/r,i)),t}function TJ(t,e=0,n=1,i=.5,r,s=t,o=t){if(na.test(e)&&(e=parseFloat(e),e=Nn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Nn(s.min,s.max,i);t===s&&(a-=e),t.min=KD(t.min,e,n,a,r),t.max=KD(t.max,e,n,a,r)}function QD(t,e,[n,i,r],s,o){TJ(t,e[n],e[i],e[r],e.scale,s,o)}const CJ=["x","scaleX","originX"],PJ=["y","scaleY","originY"];function JD(t,e,n,i){QD(t.x,e,CJ,n?n.x:void 0,i?i.x:void 0),QD(t.y,e,PJ,n?n.y:void 0,i?i.y:void 0)}function eI(t){return t.translate===0&&t.scale===1}function n5(t){return eI(t.x)&&eI(t.y)}function RJ(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function i5(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function tI(t){return cs(t.x)/cs(t.y)}class LJ{constructor(){this.members=[]}add(e){VT(this.members,e),e.scheduleRender()}remove(e){if(jT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function nI(t,e,n){let i="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(i=`translate3d(${r}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:u,rotateY:d}=n;l&&(i+=`rotate(${l}deg) `),u&&(i+=`rotateX(${u}deg) `),d&&(i+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(i+=`scale(${o}, ${a})`),i||"none"}const DJ=(t,e)=>t.depth-e.depth;class IJ{constructor(){this.children=[],this.isDirty=!1}add(e){VT(this.children,e),this.isDirty=!0}remove(e){jT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(DJ),this.isDirty=!1,this.children.forEach(e)}}function OJ(t,e){const n=performance.now(),i=({timestamp:r})=>{const s=r-n;s>=e&&(Xa(i),t(s-e))};return Mn.read(i,!0),()=>Xa(i)}function NJ(t){window.MotionDebug&&window.MotionDebug.record(t)}function kJ(t){return t instanceof SVGElement&&t.tagName!=="svg"}function UJ(t,e,n){const i=hi(t)?t:Xd(t);return i.start(BT("",i,e,n)),i.animation}const iI=["","X","Y","Z"],rI=1e3;let zJ=0;const Wu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function r5({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=zJ++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Wu.totalNodes=Wu.resolvedTargetDeltas=Wu.recalculatedProjection=0,this.nodes.forEach(VJ),this.nodes.forEach($J),this.nodes.forEach(qJ),this.nodes.forEach(jJ),NJ(Wu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new IJ)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new GT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=kJ(o),this.instance=o;const{layoutId:l,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||l)&&(this.isLayoutDirty=!0),t){let c;const h=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,c&&c(),c=OJ(h,250),Oy.hasAnimatedSinceResize&&(Oy.hasAnimatedSinceResize=!1,this.nodes.forEach(oI))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||u)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||QJ,{onLayoutAnimationStart:y,onLayoutAnimationComplete:v}=d.getProps(),_=!this.targetLayout||!i5(this.targetLayout,m)||f,w=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(c,w);const b={...BB(x,"layout"),onPlay:y,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else h||oI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Xa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(XJ),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const c=this.path[d];c.shouldResetTransform=!0,c.updateScroll("snapshot"),c.options.layoutRoot&&c.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sI);return}this.isUpdating||this.nodes.forEach(HJ),this.isUpdating=!1,this.nodes.forEach(WJ),this.nodes.forEach(FJ),this.nodes.forEach(BJ),this.clearAllSnapshots();const a=performance.now();Di.delta=ou(0,1e3/60,a-Di.timestamp),Di.timestamp=a,Di.isProcessing=!0,IS.update.process(Di),IS.preRender.process(Di),IS.render.process(Di),Di.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(GJ),this.sharedNodes.forEach(YJ)}scheduleUpdateProjection(){Mn.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){Mn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ei(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:i(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!n5(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(a||Hu(this.latestValues)||d)&&(r(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),JJ(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return ei();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Sl(a.x,l.offset.x),Sl(a.y,l.offset.y)),a}removeElementScroll(o){const a=ei();As(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:d,options:c}=u;if(u!==this.root&&d&&c.layoutScroll){if(d.isRoot){As(a,o);const{scroll:h}=this.root;h&&(Sl(a.x,-h.offset.x),Sl(a.y,-h.offset.y))}Sl(a.x,d.offset.x),Sl(a.y,d.offset.y)}}return a}applyTransform(o,a=!1){const l=ei();As(l,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&pd(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Hu(d.latestValues)&&pd(l,d.latestValues)}return Hu(this.latestValues)&&pd(l,this.latestValues),l}removeTransform(o){const a=ei();As(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Hu(u.latestValues))continue;P2(u.latestValues)&&u.updateSnapshot();const d=ei(),c=u.measurePageBox();As(d,c),JD(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Hu(this.latestValues)&&JD(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Di.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:c,layoutId:h}=this.options;if(!(!this.layout||!(c||h))){if(this.resolvedRelativeTargetAt=Di.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ei(),this.relativeTargetOrigin=ei(),sm(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),As(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ei(),this.targetWithTransforms=ei()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),tJ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):As(this.target,this.layout.layoutBox),KB(this.target,this.targetDelta)):As(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ei(),this.relativeTargetOrigin=ei(),sm(this.relativeTargetOrigin,this.target,f.target),As(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Wu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||P2(this.parent.latestValues)||ZB(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Di.timestamp&&(u=!1),u)return;const{layout:d,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||c))return;As(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;cJ(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:m}=a;if(!m){this.projectionTransform&&(this.projectionDelta=fd(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=fd(),this.projectionDeltaWithTransform=fd());const x=this.projectionTransform;rm(this.projectionDelta,this.layoutCorrected,m,this.latestValues),this.projectionTransform=nI(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==h||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m)),Wu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},c=fd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=ei(),f=l?l.source:void 0,m=this.layout?this.layout.source:void 0,x=f!==m,y=this.getStack(),v=!y||y.members.length<=1,_=!!(x&&!v&&this.options.crossfade===!0&&!this.path.some(KJ));this.animationProgress=0;let w;this.mixTargetDelta=b=>{const E=b/1e3;aI(c.x,o.x,E),aI(c.y,o.y,E),this.setTargetDelta(c),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sm(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZJ(this.relativeTarget,this.relativeTargetOrigin,h,E),w&&RJ(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=ei()),As(w,this.relativeTarget)),x&&(this.animationValues=d,MJ(d,u,this.latestValues,E,_,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Xa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Mn.update(()=>{Oy.hasAnimatedSinceResize=!0,this.currentAnimation=UJ(0,rI,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:d}=o;if(!(!a||!l||!u)){if(this!==o&&this.layout&&u&&s5(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ei();const c=cs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+c;const h=cs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}As(a,l),pd(a,d),rm(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new LJ),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const u={};for(let d=0;d<iI.length;d++){const c="rotate"+iI[d];l[c]&&(u[c]=l[c],o.setStaticValue(c,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const u={};if(!this.instance||this.isSVG)return u;if(this.isVisible)u.visibility="";else return{visibility:"hidden"};const d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=im(o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=im(o.pointerEvents)||""),this.hasProjected&&!Hu(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const h=c.animationValues||c.latestValues;this.applyTransformsToTarget(),u.transform=nI(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:f,y:m}=this.projectionDelta;u.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,c.animationValues?u.opacity=c===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=c===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const x in w1){if(h[x]===void 0)continue;const{correct:y,applyTo:v}=w1[x],_=u.transform==="none"?h[x]:y(h[x],c);if(v){const w=v.length;for(let b=0;b<w;b++)u[v[b]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=c===this?im(o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(sI),this.root.sharedNodes.clear()}}}function FJ(t){t.updateLayout()}function BJ(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Go(c=>{const h=o?n.measuredBox[c]:n.layoutBox[c],f=cs(h);h.min=i[c].min,h.max=h.min+f}):s5(s,n.layoutBox,i)&&Go(c=>{const h=o?n.measuredBox[c]:n.layoutBox[c],f=cs(i[c]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[c].max=t.relativeTarget[c].min+f)});const a=fd();rm(a,i,n.layoutBox);const l=fd();o?rm(l,t.applyTransform(r,!0),n.measuredBox):rm(l,i,n.layoutBox);const u=!n5(a);let d=!1;if(!t.resumeFrom){const c=t.getClosestProjectingParent();if(c&&!c.resumeFrom){const{snapshot:h,layout:f}=c;if(h&&f){const m=ei();sm(m,n.layoutBox,h.layoutBox);const x=ei();sm(x,i,f.layoutBox),i5(m,x)||(d=!0),c.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=m,t.relativeParent=c)}}}t.notifyListeners("didUpdate",{layout:i,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:i}=t.options;i&&i()}t.options.transition=void 0}function VJ(t){Wu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function jJ(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function GJ(t){t.clearSnapshot()}function sI(t){t.clearMeasurements()}function HJ(t){t.isLayoutDirty=!1}function WJ(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function oI(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function $J(t){t.resolveTargetDelta()}function qJ(t){t.calcProjection()}function XJ(t){t.resetRotation()}function YJ(t){t.removeLeadSnapshot()}function aI(t,e,n){t.translate=Nn(e.translate,0,n),t.scale=Nn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function lI(t,e,n,i){t.min=Nn(e.min,n.min,i),t.max=Nn(e.max,n.max,i)}function ZJ(t,e,n,i){lI(t.x,e.x,n.x,i),lI(t.y,e.y,n.y,i)}function KJ(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const QJ={duration:.45,ease:[.4,0,.1,1]},uI=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),cI=uI("applewebkit/")&&!uI("chrome/")?Math.round:$n;function hI(t){t.min=cI(t.min),t.max=cI(t.max)}function JJ(t){hI(t.x),hI(t.y)}function s5(t,e,n){return t==="position"||t==="preserve-aspect"&&!T2(tI(e),tI(n),.2)}const eee=r5({attachResizeListener:(t,e)=>Na(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),HS={current:void 0},o5=r5({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!HS.current){const t=new eee({});t.mount(window),t.setOptions({layoutScroll:!0}),HS.current=t}return HS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),tee={pan:{Feature:yJ},drag:{Feature:vJ,ProjectionNode:o5,MeasureLayout:JB}},nee=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function iee(t){const e=nee.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]}function L2(t,e,n=1){const[i,r]=iee(t);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return VB(o)?parseFloat(o):o}else return _2(r)?L2(r,e,n+1):r}function ree(t,{...e},n){const i=t.current;if(!(i instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(r=>{const s=r.get();if(!_2(s))return;const o=L2(s,i);o&&r.set(o)});for(const r in e){const s=e[r];if(!_2(s))continue;const o=L2(s,i);o&&(e[r]=o,n||(n={}),n[r]===void 0&&(n[r]=s))}return{target:e,transitionEnd:n}}const see=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),a5=t=>see.has(t),oee=t=>Object.keys(t).some(a5),dI=t=>t===Gc||t===_t,fI=(t,e)=>parseFloat(t.split(", ")[e]),pI=(t,e)=>(n,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/);if(r)return fI(r[1],e);{const s=i.match(/^matrix\((.+)\)$/);return s?fI(s[1],t):0}},aee=new Set(["x","y","z"]),lee=Ag.filter(t=>!aee.has(t));function uee(t){const e=[];return lee.forEach(n=>{const i=t.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Yd={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:pI(4,13),y:pI(5,14)};Yd.translateX=Yd.x;Yd.translateY=Yd.y;const cee=(t,e,n)=>{const i=e.measureViewportBox(),r=e.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{a[u]=Yd[u](i,s)}),e.render();const l=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(a[u]),t[u]=Yd[u](l,s)}),t},hee=(t,e,n={},i={})=>{e={...e},i={...i};const r=Object.keys(e).filter(a5);let s=[],o=!1;const a=[];if(r.forEach(l=>{const u=t.getValue(l);if(!t.hasValue(l))return;let d=n[l],c=dp(d);const h=e[l];let f;if(b1(h)){const m=h.length,x=h[0]===null?1:0;d=h[x],c=dp(d);for(let y=x;y<m&&h[y]!==null;y++)f?NT(dp(h[y])===f):f=dp(h[y])}else f=dp(h);if(c!==f)if(dI(c)&&dI(f)){const m=u.get();typeof m=="string"&&u.set(parseFloat(m)),typeof h=="string"?e[l]=parseFloat(h):Array.isArray(h)&&f===_t&&(e[l]=h.map(parseFloat))}else c!=null&&c.transform&&(f!=null&&f.transform)&&(d===0||h===0)?d===0?u.set(f.transform(d)):e[l]=c.transform(h):(o||(s=uee(t),o=!0),a.push(l),i[l]=i[l]!==void 0?i[l]:e[l],u.jump(h))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,u=cee(e,t,a);return s.length&&s.forEach(([d,c])=>{t.getValue(d).set(c)}),t.render(),jx&&l!==null&&window.scrollTo({top:l}),{target:u,transitionEnd:i}}else return{target:e,transitionEnd:i}};function dee(t,e,n,i){return oee(e)?hee(t,e,n,i):{target:e,transitionEnd:i}}const fee=(t,e,n,i)=>{const r=ree(t,e,i);return e=r.target,i=r.transitionEnd,dee(t,e,n,i)},D2={current:null},l5={current:!1};function pee(){if(l5.current=!0,!!jx)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>D2.current=t.matches;t.addListener(e),e()}else D2.current=!1}function mee(t,e,n){const{willChange:i}=e;for(const r in e){const s=e[r],o=n[r];if(hi(s))t.addValue(r,s),T1(i)&&i.add(r);else if(hi(o))t.addValue(r,Xd(s,{owner:t})),T1(i)&&i.remove(r);else if(o!==s)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,Xd(a!==void 0?a:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const mI=new WeakMap,u5=Object.keys(Jm),gee=u5.length,gI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],vee=MT.length;class c5{constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Mn.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=Hx(n),this.isVariantNode=j4(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const c in d){const h=d[c];a[c]!==void 0&&hi(h)&&(h.set(a[c],!1),T1(u)&&u.add(c))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,mI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),l5.current||pee(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:D2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){mI.delete(this.current),this.projection&&this.projection.unmount(),Xa(this.notifyUpdate),Xa(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const i=jc.has(e),r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Mn.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},i,r,s){let o,a;for(let l=0;l<gee;l++){const u=u5[l],{isEnabled:d,Feature:c,ProjectionNode:h,MeasureLayout:f}=Jm[u];h&&(o=h),d(n)&&(!this.features[u]&&c&&(this.features[u]=new c(this)),f&&(a=f))}if(!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:u,drag:d,dragConstraints:c,layoutScroll:h,layoutRoot:f}=n;this.projection.setOptions({layoutId:l,layout:u,alwaysMeasureLayout:!!d||c&&hd(c),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:s,layoutScroll:h,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ei()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<gI.length;i++){const r=gI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=e["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=mee(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const n={};for(let i=0;i<vee;i++){const r=MT[i],s=this.props[r];(Qm(s)||s===!1)&&(n[r]=s)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=Xd(n,{owner:this}),this.addValue(e,i)),i}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:i}=this.props,r=typeof i=="string"||typeof i=="object"?(n=DT(this.props,i))===null||n===void 0?void 0:n[e]:void 0;if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!hi(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new GT),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class h5 extends c5{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...i},{transformValues:r},s){let o=zQ(i,e||{},this);if(r&&(n&&(n=r(n)),i&&(i=r(i)),o&&(o=r(o))),s){HB(this,i,o);const a=fee(this,i,o,n);n=a.transitionEnd,i=a.target}return{transition:e,transitionEnd:n,...i}}}function yee(t){return window.getComputedStyle(t)}class xee extends h5{readValueFromInstance(e,n){if(jc.has(n)){const i=FT(n);return i&&i.default||0}else{const i=yee(e),r=(X4(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return QB(e,n)}build(e,n,i,r){ET(e,n,i,r.transformTemplate)}scrapeMotionValuesFromProps(e,n){return LT(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hi(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,i,r){nB(e,n,i,r)}}class _ee extends h5{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(jc.has(n)){const i=FT(n);return i&&i.default||0}return n=iB.has(n)?n:RT(n),e.getAttribute(n)}measureInstanceViewportBox(){return ei()}scrapeMotionValuesFromProps(e,n){return sB(e,n)}build(e,n,i,r){CT(e,n,i,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,i,r){rB(e,n,i,r)}mount(e){this.isSVGTag=PT(e.tagName),super.mount(e)}}const wee=(t,e)=>AT(t)?new _ee(e,{enableHardwareAcceleration:!1}):new xee(e,{enableHardwareAcceleration:!0}),See={layout:{ProjectionNode:o5,MeasureLayout:JB}},bee={...$B,...xK,...tee,...See},Or=LZ((t,e)=>aK(t,e,bee,wee));function Mee({children:t,isValidProp:e,...n}){e&&J4(e),n={...Se.useContext(_1),...n},n.isStatic=oB(()=>n.isStatic);const i=Se.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return Se.createElement(_1.Provider,{value:i},t)}const Aee=()=>F.jsx("nav",{className:"navbar",children:F.jsxs("span",{className:"logo",children:[F.jsx("span",{className:"letter-i",children:"i"}),F.jsx("span",{className:"letter-c",children:"c"}),F.jsx("span",{className:"letter-f",children:"f"})]})}),Eee="_root_1mlms_1",Tee="_container_1mlms_49",Cee="_flex_1mlms_89",Pee="_column_1mlms_93",Ree="_contactSection_1mlms_121",Lee="_contactSection_emailForm_1mlms_130",Dee="_contactSection_title_1mlms_138",Iee="_contactSection_emailInput_1mlms_143",Oee="_contactSection_messageInput_1mlms_153",Nee="_contactSection_submitButton_1mlms_165",kee="_contactSection_logosContainer_1mlms_172",ku={root:Eee,container:Tee,"text-secondary":"_text-secondary_1mlms_77","font-weight-200":"_font-weight-200_1mlms_81","font-weight-500":"_font-weight-500_1mlms_85",flex:Cee,column:Pee,"space-between":"_space-between_1mlms_97","align-item-start":"_align-item-start_1mlms_101","align-items-center":"_align-items-center_1mlms_105","justify-center":"_justify-center_1mlms_109","gap-5":"_gap-5_1mlms_113","gap-10":"_gap-10_1mlms_117",contactSection:Ree,contactSection_emailForm:Lee,contactSection_title:Dee,contactSection_emailInput:Iee,contactSection_messageInput:Oee,contactSection_submitButton:Nee,contactSection_logosContainer:kee},Uee=()=>F.jsx("section",{id:"contact",className:ku.contactSection,children:F.jsxs(Or.form,{className:ku.contactSection_emailForm,id:"emailForm",action:"mailto:igor2008_11@hotmail.com",method:"post",encType:"text/plain",initial:{opacity:0},whileInView:{opacity:1,transition:{duration:1,delay:.2}},children:[F.jsx(Or.h1,{className:ku.contactSection_title,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.6}},children:"Contact"}),F.jsx(Or.input,{className:ku.contactSection_emailInput,type:"email",name:"email",placeholder:"youremail@gmail.com",required:!0,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.9}}}),F.jsx(Or.textarea,{className:ku.contactSection_messageInput,name:"message",placeholder:"Hey it's nice to meet you....",rows:5,cols:33,maxLength:300,minLength:50,required:!0,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:1.1}}}),F.jsx(Or.button,{type:"submit",className:ku.contactSection_submitButton,initial:{backgroundColor:"#FAF8FD",color:"#000",opacity:0,y:50},whileHover:{backgroundColor:"#d3712f",color:"#FAF8FD",transition:{duration:.01}},whileInView:{opacity:1,y:0,transition:{duration:1,delay:1.4}},children:"Send"}),F.jsxs(Or.div,{className:ku.contactSection_logosContainer,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:1.4}},children:[F.jsx("a",{href:"https://www.facebook.com/IgorPRI1/",target:"_blank",rel:"noreferrer",children:F.jsx("img",{src:"assets/images/facebook-logo.svg",alt:""})}),F.jsx("a",{href:"https://www.linkedin.com/in/igorcf/",target:"_blank",rel:"noreferrer",children:F.jsx("img",{src:"assets/images/linkedin-logo.svg",alt:""})}),F.jsx("a",{href:"https://github.com/Kasuk1?tab=repositories",target:"_blank",rel:"noreferrer",children:F.jsx("img",{src:"assets/images/github-logo.svg",alt:""})}),F.jsx("a",{href:"https://www.instagram.com/yesimigori/",target:"_blank",rel:"noreferrer",children:F.jsx("img",{src:"assets/images/instagram-logo.svg",alt:""})}),F.jsx("a",{href:"https://www.youtube.com/@gnosiophobia",target:"_blank",rel:"noreferrer",children:F.jsx("img",{src:"assets/images/youtube-logo.svg",alt:""})})]})]})}),zee="_root_1go73_1",Fee="_container_1go73_49",Bee="_flex_1go73_89",Vee="_column_1go73_93",jee="_main_hero_1go73_121",Gee="_main_hero_headers_1go73_131",Hee="_main_hero_headers_title_1go73_139",Wee="_main_hero_headers_description_1go73_148",$ee="_main_hero_headers_button_1go73_160",pp={root:zee,container:Fee,"text-secondary":"_text-secondary_1go73_77","font-weight-200":"_font-weight-200_1go73_81","font-weight-500":"_font-weight-500_1go73_85",flex:Bee,column:Vee,"space-between":"_space-between_1go73_97","align-item-start":"_align-item-start_1go73_101","align-items-center":"_align-items-center_1go73_105","justify-center":"_justify-center_1go73_109","gap-5":"_gap-5_1go73_113","gap-10":"_gap-10_1go73_117",main_hero:jee,main_hero_headers:Gee,main_hero_headers_title:Hee,main_hero_headers_description:Wee,main_hero_headers_button:$ee},qee=()=>F.jsx("section",{className:pp.main_hero,children:F.jsxs("header",{className:pp.main_hero_headers,children:[F.jsxs(Or.p,{className:pp.main_hero_headers_title,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.4}},children:["Hola! I'm ",F.jsx("br",{}),F.jsx("span",{children:"Igor Chinchay"})]}),F.jsxs(Or.p,{className:`${pp.main_hero_headers_description}`,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.6}},children:["A ",F.jsx("span",{children:"Software Engineer"})," that loves frontend, 3D, music, videogames and wealthness."]}),F.jsx(Or.a,{href:"#contact",className:pp.main_hero_headers_button,initial:{backgroundColor:"#FAF8FD",color:"#000",opacity:0,y:50},whileHover:{backgroundColor:"#d3712f",color:"#FAF8FD",transition:{duration:.01}},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.7}},children:"Contact me"})]})}),Xee=[{skillLevel:"advanced",skillName:"Javascript/Typescript"},{skillLevel:"advanced",skillName:"HTML/CSS"},{skillLevel:"advanced",skillName:"React/Redux"},{skillLevel:"intermediate",skillName:"CSS Preprocessors"},{skillLevel:"intermediate",skillName:"Node/Express"},{skillLevel:"intermediate",skillName:"MongoDB"},{skillLevel:"intermediate",skillName:"Figma"},{skillLevel:"basic",skillName:"Docker"},{skillLevel:"basic",skillName:"AWS"}],Yee=[{date:"Mar 2022 - Mar 2023",companyName:"Sharpminds",role:"React Developer"},{date:"Dec 2021 - Mar 2022",companyName:"Pragma",role:"Software Engineer"},{date:"Sep 2021 - Nov 2021",companyName:"NTT Data",role:"Centers Junior (CJ)"},{date:"Apr 2021 - May 2021",companyName:"IQ Comunicacin Integral",role:"Front-End Web Developer"}],Zee="_root_15g9b_1",Kee="_container_15g9b_49",Qee="_flex_15g9b_89",Jee="_column_15g9b_93",ete="_skillSection_15g9b_121",tte="_skillSection_chunk_15g9b_131",nte="_skillSection_title_15g9b_137",mp={root:Zee,container:Kee,"text-secondary":"_text-secondary_15g9b_77","font-weight-200":"_font-weight-200_15g9b_81","font-weight-500":"_font-weight-500_15g9b_85",flex:Qee,column:Jee,"space-between":"_space-between_15g9b_97","align-item-start":"_align-item-start_15g9b_101","align-items-center":"_align-items-center_15g9b_105","justify-center":"_justify-center_15g9b_109","gap-5":"_gap-5_15g9b_113","gap-10":"_gap-10_15g9b_117",skillSection:ete,skillSection_chunk:tte,skillSection_title:nte},ite=()=>F.jsxs("section",{className:mp.skillSection,children:[F.jsxs(Or.div,{className:mp.skillSection_chunk,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.4}},children:[F.jsx("h1",{className:mp.skillSection_title,children:"Skills"}),Xee.map(({skillLevel:t,skillName:e})=>F.jsx(qN,{skillLevel:t,skillName:e},e))]}),F.jsxs(Or.div,{className:mp.skillSection_chunk,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.8}},children:[F.jsx("h1",{className:mp.skillSection_title,children:"Experience"}),Yee.map(({date:t,role:e,companyName:n})=>F.jsx(qN,{date:t,role:e,companyName:n},n))]})]}),rte=[{id:1,name:"NoiseApp",description:"Web app(Frontend) - Spotify API.",technologies:{Design:["Figma"],Frontend:["HTML5","CSS3","JavaScript","Sass","Redux","RTK","React-Router-V6","Spotify API","Fontawesome"]},references:[{id:1,name:"Official Web",url:"https://noise-app.netlify.app/"},{id:2,name:"GitHub - Frontend",url:"https://github.com/Kasuk1/personal-noiseapp"},{id:3,name:"Figma - Wireframe",url:"https://www.figma.com/file/LUmoAiitPxxeCoy1ZmYgmO/Web---Noise?node-id=2%3A28"},{id:4,name:"Figma - Prototype",url:"https://www.figma.com/file/LUmoAiitPxxeCoy1ZmYgmO/Web---Noise?node-id=2%3A29"}],images:[{id:1,src:"",alt:"Noise Image 1"},{id:2,src:"",alt:"Noise Image 2"},{id:3,src:"",alt:"Noise Image 3"},{id:4,src:"",alt:"Noise Image 4"}],status:"Active"},{id:2,name:"My Dear Character",description:"Web application(game) - Sockets - MERN.",technologies:{Design:["Figma"],Frontend:["HTML5","CSS3","TypeScript","Sass","React","RTK","Socket.IO Client","React-Router-V6","PokeAPI","Styled-Components"],Backend:["Node","Express","Socket.IO Server","JWT","Bcrypt","Cors","cross-fetch","dotenv","express-validator","MongoDB","Mongoose"]},references:[{id:1,name:"Official Web",url:"https://mdcharacter.netlify.app/"},{id:2,name:"GitHub - Frontend",url:"https://github.com/Kasuk1/personal-mydearcharacter"},{id:3,name:"GitHub - Backend",url:"https://github.com/Kasuk1/personal-mydearcharacter-backend"}],images:[{id:1,src:"",alt:"Hero Section - My Dear Character"},{id:2,src:"",alt:"Characters Section - My Dear Character"},{id:3,src:"",alt:"Footer - My Dear Character"}],status:"Active"},{id:3,name:"My Little Friend",description:"Web application, MERN stack for veterinaries.",technologies:{Design:["Figma","Photoshop"],Frontend:["HTML5","CSS3","Sass","React","RTK","React-Router-V6","Ant-Design",""],Backend:["Node","Express","Bcrypt","Cors","dotenv","Express-Validator","Cloudinary","Epayco-sdk-node","Multer","Passport","MongoDB","Mongoose"]},references:[{id:1,name:"Official Web",url:"https://mylittlefriend-top19.netlify.app/"},{id:2,name:"GitHub - Frontend",url:"https://github.com/Kasuk1/MyLittleFriend"},{id:3,name:"GitHub - Backend",url:"https://github.com/rivaldo-ortega/MyLittleFriend-backend"}],images:[{id:1,src:"",alt:"Hero Section - My Little Friend"},{id:2,src:"",alt:"My Pets Section - My Little Friend"},{id:3,src:"",alt:"Services - My Little Friend"}],status:"Active"}],ste="_root_72zjq_1",ote="_container_72zjq_49",ate="_flex_72zjq_89",lte="_column_72zjq_93",ute="_projectSection_72zjq_121",cte="_projectSection_title_72zjq_130",hte="_projectSection_descriptionContainer_72zjq_137",dte="_projectSection_description_72zjq_137",Hv={root:ste,container:ote,"text-secondary":"_text-secondary_72zjq_77","font-weight-200":"_font-weight-200_72zjq_81","font-weight-500":"_font-weight-500_72zjq_85",flex:ate,column:lte,"space-between":"_space-between_72zjq_97","align-item-start":"_align-item-start_72zjq_101","align-items-center":"_align-items-center_72zjq_105","justify-center":"_justify-center_72zjq_109","gap-5":"_gap-5_72zjq_113","gap-10":"_gap-10_72zjq_117",projectSection:ute,projectSection_title:cte,projectSection_descriptionContainer:hte,projectSection_description:dte},fte=()=>F.jsx("section",{className:Hv.projectSection,children:F.jsxs("div",{className:Hv.projectSection_descriptionContainer,children:[F.jsx(Or.h1,{className:Hv.projectSection_title,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.3}},children:"Projects"}),F.jsx(Or.p,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.5}},children:"Here are some projects that it's too probably that will receive updates! "}),F.jsx(Or.div,{className:Hv.projectSection_description,initial:{opacity:0,y:50},whileInView:{opacity:1,y:0,transition:{duration:1,delay:.7}},children:rte.map(({images:t,name:e,description:n,id:i,references:r})=>F.jsxs("div",{children:[F.jsx("a",{href:r[0].url,target:"_blank",rel:"noreferrer",children:e}),F.jsx("p",{children:n})]},i))})]})});function pte(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}function mte(t,e,n){const i=bd(h=>h.size),r=bd(h=>h.viewport),s=typeof t=="number"?t:i.width*r.dpr,o=typeof e=="number"?e:i.height*r.dpr,a=(typeof t=="number"?n:t)||{},{samples:l=0,depth:u,...d}=a,c=Se.useMemo(()=>{const h=new js(s,o,{minFilter:In,magFilter:In,type:ru,...d});return u&&(h.depthTexture=new qE(s,o,rs)),h.samples=l,h},[]);return Se.useLayoutEffect(()=>{c.setSize(s,o),l&&(c.samples=l)},[l,c,s,o]),Se.useEffect(()=>()=>c.dispose(),[]),c}const gte=t=>typeof t=="function",vte=Se.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:i,children:r,...s},o)=>{const a=bd(({set:y})=>y),l=bd(({camera:y})=>y),u=bd(({size:y})=>y),d=Se.useRef(null),c=Se.useRef(null),h=mte(e);Se.useLayoutEffect(()=>{s.manual||(d.current.aspect=u.width/u.height)},[u,s]),Se.useLayoutEffect(()=>{d.current.updateProjectionMatrix()});let f=0,m=null;const x=gte(r);return y1(y=>{x&&(n===1/0||f<n)&&(c.current.visible=!1,y.gl.setRenderTarget(h),m=y.scene.background,t&&(y.scene.background=t),y.gl.render(y.scene,d.current),y.scene.background=m,y.gl.setRenderTarget(null),c.current.visible=!0,f++)}),Se.useLayoutEffect(()=>{if(i){const y=l;return a(()=>({camera:d.current})),()=>a(()=>({camera:y}))}},[d,i,a]),Se.createElement(Se.Fragment,null,Se.createElement("perspectiveCamera",Km({ref:pte([d,o])},s),!x&&r),Se.createElement("group",{ref:c},x&&r(h.texture)))}),yte="modulepreload",xte=function(t,e){return new URL(t,e).href},vI={},d5=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=xte(s,i),s in vI)return;vI[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let d=r.length-1;d>=0;d--){const c=r[d];if(c.href===s&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":yte,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,c)=>{u.addEventListener("load",d),u.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function _te(t,{whileHover:e,onHoverStart:n,onHoverEnd:i,onPointerOver:r,onPointerOut:s},o){return t||!o||!(e||n||i)?{}:{onPointerOver:l=>{var u;(u=o.animationState)===null||u===void 0||u.setActive("whileHover",!0),r&&r(l)},onPointerOut:l=>{var u;(u=o.animationState)===null||u===void 0||u.setActive("whileHover",!1),s&&s(l)}}}function wte(t,{whileTap:e,onTapStart:n,onTap:i,onTapCancel:r,onPointerDown:s},o){const a=i||n||r||e,l=Se.useRef(!1),u=Se.useRef(null);if(t||!o||!a)return{};function d(){var m;(m=u.current)===null||m===void 0||m.call(u),u.current=null}function c(){var m;return d(),l.current=!1,(m=o.animationState)===null||m===void 0||m.setActive("whileTap",!1),!OT()}function h(m,x){c()&&(i==null||i(m,x))}function f(m,x){c()&&(r==null||r(m,x))}return{onPointerDown:lB((m,x)=>{var y;if(d(),l.current)return;l.current=!0;const v={passive:!(n||i||r||s)};u.current=za(mo(window,"pointerup",h,v),mo(window,"pointercancel",f,v)),(y=o.animationState)===null||y===void 0||y.setActive("whileTap",!0),s==null||s(m),n==null||n(m,x)})}}const Ste=(t,e,n,i,r,s)=>{const o=bte(e);return Se.createElement(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({ref:n},eB(e,!1,!1)),o),{onUpdate:e.onInstanceUpdate}),_te(r,e,s)),wte(r,e,s)))};function bte(t){return Se.useMemo(()=>{const e={};for(const n in t){const i=t[n];hi(i)?e[n]=i.get():Array.isArray(i)&&i.includes(hi)&&(e[n]=i.map(im))}return e},[])}function Mte(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}const f5=(t,e)=>n=>(i,r)=>{i[t]===void 0&&(i[t]=new O(e)),i[t].setComponent(n,r)},Ate=(t,e)=>n=>(i,r)=>{i[t]===void 0&&(i[t]=new ta(e));const s=i[t];s[n]=r},yI=t=>(e,n)=>{e[t]===void 0&&(e[t]=new We(n)),e[t].set(n)},WS=f5("scale",1),$S=f5("position",0),qS=Ate("rotation",0),xI={x:$S(0),y:$S(1),z:$S(2),scale:(t,e)=>{t.scale===void 0&&(t.scale=new O(1)),t.scale.set(e,e,e)},scaleX:WS(0),scaleY:WS(1),scaleZ:WS(2),rotateX:qS("x"),rotateY:qS("y"),rotateZ:qS("z"),color:yI("color"),specular:yI("specular")};function Ete(t,e,n){xI[e]?xI[e](t,n[e]):(e==="opacity"&&!t.transparent&&(t.transparent=!0),t[e]=n[e])}const HT=(t,e)=>n=>i=>{const r=i[t];return r?r[n]:e},XS=HT("position",0),Wv=HT("scale",1),YS=HT("rotation",0),_I={x:XS("x"),y:XS("y"),z:XS("z"),scale:Wv("x"),scaleX:Wv("x"),scaleY:Wv("y"),scaleZ:Wv("z"),rotateX:YS("x"),rotateY:YS("y"),rotateZ:YS("z")};function Tte(t){if(t!==void 0)return t instanceof We?t.getStyle():t}function Cte(t,e){return _I[e]?_I[e](t):Tte(t[e])||0}const Pte=["x","y","z"],wI={"position-x":"x","position-y":"y","position-z":"z","rotation-x":"rotateX","rotation-y":"rotateY","rotation-z":"rotateZ","scale-x":"scaleX","scale-y":"scaleY","scale-z":"scaleZ"},p5=(t,e)=>{const n={};for(const i in t){const r=t[i];if(hi(r)||hi(e[i]))n[wI[i]||i]=r;else if(Array.isArray(r))for(let s=0;s<r.length;s++){const o=r[s];if(hi(o)||Array.isArray(e[i])&&hi(e[i][s])){const a=wI[i+"-"+Pte[s]];n[a]=o}}}return n},Rte=()=>({});class Lte extends c5{constructor(){super(...arguments),this.type="three"}readValueFromInstance(e,n){return Cte(e,n)}getBaseTargetFromProps(){}sortInstanceNodePosition(e,n){return e.id-n.id}makeTargetAnimatableFromInstance(e){var{transition:n,transitionEnd:i}=e,r=Mte(e,["transition","transitionEnd"]);return HB(this,r,{}),Object.assign(Object.assign({},r),{transition:n,transitionEnd:i})}removeValueFromRenderState(){}measureInstanceViewportBox(){return ei()}scrapeMotionValuesFromProps(e,n){return p5(e,n)}build(e,n){for(const i in n)e[i]=n[i]}renderInstance(e,n){for(const i in n)Ete(e,i,n)}}const Dte=(t,e)=>new Lte(e,{}),Ite=IT({scrapeMotionValuesFromProps:p5,createRenderState:Rte}),Ote=Object.assign({},$B);function SI(t){return W4({Component:t,preloadedFeatures:Ote,useRender:Ste,useVisualState:Ite,createVisualElement:Dte})}const ZS=new Map,Yn=new Proxy(SI,{get:(t,e)=>(!ZS.has(e)&&ZS.set(e,SI(e)),ZS.get(e))});function Nte(t,e=!1){const n=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Ke;let u=0;for(let d=0;d<t.length;++d){const c=t[d];let h=0;if(n!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const f in c.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(c.attributes[f]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(a!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const f in c.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(c.morphAttributes[f])}if(e){let f;if(n)f=c.index.count;else if(c.attributes.position!==void 0)f=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,f,d),u+=f}}if(n){let d=0;const c=[];for(let h=0;h<t.length;++h){const f=t[h].index;for(let m=0;m<f.count;++m)c.push(f.getX(m)+d);d+=t[h].attributes.position.count}l.setIndex(c)}for(const d in s){const c=bI(s[d]);if(!c)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,c)}for(const d in o){const c=o[d][0].length;if(c===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let h=0;h<c;++h){const f=[];for(let x=0;x<o[d].length;++x)f.push(o[d][x][h]);const m=bI(f);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(m)}}return l}function bI(t){let e,n,i,r=-1,s=0;for(let u=0;u<t.length;++u){const d=t[u];if(d.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=d.array.constructor),e!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=d.itemSize),n!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=d.normalized),i!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=d.gpuType),r!==d.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=d.array.length}const o=new e(s);let a=0;for(let u=0;u<t.length;++u)o.set(t[u].array,a),a+=t[u].array.length;const l=new ht(o,n,i);return r!==void 0&&(l.gpuType=r),l}function m5(t,e=!1){return console.warn("THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries()."),Nte(t,e)}const KS=new WeakMap;class kte extends sr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,i,r){const s=new Hs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,n,r)},i,r)}parse(e,n,i){this.decodeDracoFile(e,n,null,null,ni).catch(i)}decodeDracoFile(e,n,i,r,s=yo){const o={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s};return this.decodeGeometry(e,o).then(n)}decodeGeometry(e,n){const i=JSON.stringify(n);if(KS.has(e)){const l=KS.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((u,d)=>{r._callbacks[s]={resolve:u,reject:d},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),KS.set(e,{key:i,promise:a}),a}_createGeometry(e){const n=new Ke;e.index&&n.setIndex(new ht(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize,l=new ht(o,a);s==="color"&&(this._assignVertexColorSpace(l,r.vertexColorSpace),l.normalized=!(o instanceof Float32Array)),n.setAttribute(s,l)}return n}_assignVertexColorSpace(e,n){if(n!==ni)return;const i=new We;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,n){const i=new Hs(this.manager);return i.setPath(this.decoderPath),i.setResponseType(n),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Ute.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=n,i._taskLoad+=n,i})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Ute(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(d){t.onModuleLoaded=function(c){d({draco:c})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,u=a.taskConfig;e.then(d=>{const c=d.draco,h=new c.Decoder;try{const f=n(c,h,new Int8Array(l),u),m=f.attributes.map(x=>x.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{c.destroy(h)}});break}};function n(o,a,l,u){const d=u.attributeIDs,c=u.attributeTypes;let h,f;const m=a.GetEncodedGeometryType(l);if(m===o.TRIANGULAR_MESH)h=new o.Mesh,f=a.DecodeArrayToMesh(l,l.byteLength,h);else if(m===o.POINT_CLOUD)h=new o.PointCloud,f=a.DecodeArrayToPointCloud(l,l.byteLength,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const x={index:null,attributes:[]};for(const y in d){const v=self[c[y]];let _,w;if(u.useUniqueIDs)w=d[y],_=a.GetAttributeByUniqueId(h,w);else{if(w=a.GetAttributeId(h,o[d[y]]),w===-1)continue;_=a.GetAttribute(h,w)}const b=r(o,a,h,y,v,_);y==="color"&&(b.vertexColorSpace=u.vertexColorSpace),x.attributes.push(b)}return m===o.TRIANGULAR_MESH&&(x.index=i(o,a,h)),o.destroy(h),x}function i(o,a,l){const d=l.num_faces()*3,c=d*4,h=o._malloc(c);a.GetTrianglesUInt32Array(l,c,h);const f=new Uint32Array(o.HEAPF32.buffer,h,d).slice();return o._free(h),{array:f,itemSize:1}}function r(o,a,l,u,d,c){const h=c.num_components(),m=l.num_points()*h,x=m*d.BYTES_PER_ELEMENT,y=s(o,d),v=o._malloc(x);a.GetAttributeDataArrayForAllPoints(l,c,y,x,v);const _=new d(o.HEAPF32.buffer,v,m).slice();return o._free(v),{name:u,array:_,itemSize:h}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var zte=Object.create,Xx=Object.defineProperty,Fte=Object.getOwnPropertyDescriptor,Bte=Object.getOwnPropertyNames,Vte=Object.getPrototypeOf,jte=Object.prototype.hasOwnProperty,Gte=(t,e,n)=>e in t?Xx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wr=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Hte=(t,e)=>{for(var n in e)Xx(t,n,{get:e[n],enumerable:!0})},Wte=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Bte(e))!jte.call(t,r)&&r!==n&&Xx(t,r,{get:()=>e[r],enumerable:!(i=Fte(e,r))||i.enumerable});return t},Tr=(t,e,n)=>(n=t!=null?zte(Vte(t)):{},Wte(e||!t||!t.__esModule?Xx(n,"default",{value:t,enumerable:!0}):n,t)),pr=(t,e,n)=>(Gte(t,typeof e!="symbol"?e+"":e,n),n),$te=Wr((t,e)=>{(function(n,i){typeof t=="object"?e.exports=i():typeof define=="function"&&define.amd?define(i):n.Alea=i()})(t,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var u=i();s=u(" "),o=u(" "),a=u(" ");for(var d=0;d<r.length;d++)s-=u(r[d]),s<0&&(s+=1),o-=u(r[d]),o<0&&(o+=1),a-=u(r[d]),a<0&&(a+=1);u=null;var c=function(){var h=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=h-(l=h|0)};return c.next=c,c.uint32=function(){return c()*4294967296},c.fract53=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.version="Alea 0.9",c.args=r,c.exportState=function(){return[s,o,a,l]},c.importState=function(h){s=+h[0]||0,o=+h[1]||0,a=+h[2]||0,l=+h[3]||0},c}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),qte=Wr((t,e)=>{(function(n,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})(t,function(n){n.SVD=function(i,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,u,d,c,h,f,m,x,y,v,_,w,b=i[0].length,E=i.length;if(E<b)throw new TypeError("Invalid matrix: m < n");for(var A=[],T=[],L=[],P=r==="f"?E:b,C=v=m=0;C<E;C++)T[C]=new Array(P).fill(0);for(C=0;C<b;C++)L[C]=new Array(b).fill(0);var D,U=new Array(b).fill(0);for(C=0;C<E;C++)for(l=0;l<b;l++)T[C][l]=i[C][l];for(C=0;C<b;C++){for(A[C]=m,y=0,d=C+1,l=C;l<E;l++)y+=Math.pow(T[l][C],2);if(y<a)m=0;else for(x=(f=T[C][C])*(m=f<0?Math.sqrt(y):-Math.sqrt(y))-y,T[C][C]=f-m,l=d;l<b;l++){for(y=0,u=C;u<E;u++)y+=T[u][C]*T[u][l];for(f=y/x,u=C;u<E;u++)T[u][l]=T[u][l]+f*T[u][C]}for(U[C]=m,y=0,l=d;l<b;l++)y+=Math.pow(T[C][l],2);if(y<a)m=0;else{for(x=(f=T[C][C+1])*(m=f<0?Math.sqrt(y):-Math.sqrt(y))-y,T[C][C+1]=f-m,l=d;l<b;l++)A[l]=T[C][l]/x;for(l=d;l<E;l++){for(y=0,u=d;u<b;u++)y+=T[l][u]*T[C][u];for(u=d;u<b;u++)T[l][u]=T[l][u]+y*A[u]}}v<(_=Math.abs(U[C])+Math.abs(A[C]))&&(v=_)}if(s)for(C=b-1;0<=C;C--){if(m!==0){for(x=T[C][C+1]*m,l=d;l<b;l++)L[l][C]=T[C][l]/x;for(l=d;l<b;l++){for(y=0,u=d;u<b;u++)y+=T[C][u]*L[u][l];for(u=d;u<b;u++)L[u][l]=L[u][l]+y*L[u][C]}}for(l=d;l<b;l++)L[C][l]=0,L[l][C]=0;L[C][C]=1,m=A[C],d=C}if(r){if(r==="f")for(C=b;C<E;C++){for(l=b;l<E;l++)T[C][l]=0;T[C][C]=1}for(C=b-1;0<=C;C--){for(d=C+1,m=U[C],l=d;l<P;l++)T[C][l]=0;if(m!==0){for(x=T[C][C]*m,l=d;l<P;l++){for(y=0,u=d;u<E;u++)y+=T[u][C]*T[u][l];for(f=y/x,u=C;u<E;u++)T[u][l]=T[u][l]+f*T[u][C]}for(l=C;l<E;l++)T[l][C]=T[l][C]/m}else for(l=C;l<E;l++)T[l][C]=0;T[C][C]=T[C][C]+1}}for(o*=v,u=b-1;0<=u;u--)for(var G=0;G<50;G++){for(D=!1,d=u;0<=d;d--){if(Math.abs(A[d])<=o){D=!0;break}if(Math.abs(U[d-1])<=o)break}if(!D){for(h=0,c=d-(y=1),C=d;C<u+1&&(f=y*A[C],A[C]=h*A[C],!(Math.abs(f)<=o));C++)if(m=U[C],U[C]=Math.sqrt(f*f+m*m),h=m/(x=U[C]),y=-f/x,r)for(l=0;l<E;l++)_=T[l][c],w=T[l][C],T[l][c]=_*h+w*y,T[l][C]=-_*y+w*h}if(w=U[u],d===u){if(w<0&&(U[u]=-w,s))for(l=0;l<b;l++)L[l][u]=-L[l][u];break}for(v=U[d],f=(((_=U[u-1])-w)*(_+w)+((m=A[u-1])-(x=A[u]))*(m+x))/(2*x*_),m=Math.sqrt(f*f+1),f=((v-w)*(v+w)+x*(_/(f<0?f-m:f+m)-x))/v,C=d+(y=h=1);C<u+1;C++){if(m=A[C],_=U[C],x=y*m,m*=h,w=Math.sqrt(f*f+x*x),f=v*(h=f/(A[C-1]=w))+m*(y=x/w),m=-v*y+m*h,x=_*y,_*=h,s)for(l=0;l<b;l++)v=L[l][C-1],w=L[l][C],L[l][C-1]=v*h+w*y,L[l][C]=-v*y+w*h;if(w=Math.sqrt(f*f+x*x),f=(h=f/(U[C-1]=w))*m+(y=x/w)*_,v=-y*m+h*_,r)for(l=0;l<E;l++)_=T[l][C-1],w=T[l][C],T[l][C-1]=_*h+w*y,T[l][C]=-_*y+w*h}A[d]=0,A[u]=f,U[u]=v}for(C=0;C<b;C++)U[C]<o&&(U[C]=0);return{u:T,q:U,v:L}},n.VERSION="1.1.1",Object.defineProperty(n,"__esModule",{value:!0})})}),Xte=Wr((t,e)=>{(function(n,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(n=n||self,n.TinyQueue=i())})(t,function(){var n=function(r,s){if(r===void 0&&(r=[]),s===void 0&&(s=i),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};n.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(r){for(var s=this,o=s.data,a=s.compare,l=o[r];r>0;){var u=r-1>>1,d=o[u];if(a(l,d)>=0)break;o[r]=d,r=u}o[r]=l},n.prototype._down=function(r){for(var s=this,o=s.data,a=s.compare,l=this.length>>1,u=o[r];r<l;){var d=(r<<1)+1,c=o[d],h=d+1;if(h<this.length&&a(o[h],c)<0&&(d=h,c=o[h]),a(c,u)>=0)break;o[r]=c,r=d}o[r]=u};function i(r,s){return r<s?-1:r>s?1:0}return n})}),Yte=Wr((t,e)=>{var n=Xte();n.default&&(n=n.default),e.exports=i,e.exports.default=i;function i(u,d,c){d=d||1;for(var h,f,m,x,y=0;y<u[0].length;y++){var v=u[0][y];(!y||v[0]<h)&&(h=v[0]),(!y||v[1]<f)&&(f=v[1]),(!y||v[0]>m)&&(m=v[0]),(!y||v[1]>x)&&(x=v[1])}var _=m-h,w=x-f,b=Math.min(_,w),E=b/2;if(b===0){var A=[h,f];return A.distance=0,A}for(var T=new n(void 0,r),L=h;L<m;L+=b)for(var P=f;P<x;P+=b)T.push(new s(L+E,P+E,E,u));var C=a(u),D=new s(h+_/2,f+w/2,0,u);D.d>C.d&&(C=D);for(var U=T.length;T.length;){var G=T.pop();G.d>C.d&&(C=G,c&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),!(G.max-C.d<=d)&&(E=G.h/2,T.push(new s(G.x-E,G.y-E,E,u)),T.push(new s(G.x+E,G.y-E,E,u)),T.push(new s(G.x-E,G.y+E,E,u)),T.push(new s(G.x+E,G.y+E,E,u)),U+=4)}c&&(console.log("num probes: "+U),console.log("best distance: "+C.d));var k=[C.x,C.y];return k.distance=C.d,k}function r(u,d){return d.max-u.max}function s(u,d,c,h){this.x=u,this.y=d,this.h=c,this.d=o(u,d,h),this.max=this.d+this.h*Math.SQRT2}function o(u,d,c){for(var h=!1,f=1/0,m=0;m<c.length;m++)for(var x=c[m],y=0,v=x.length,_=v-1;y<v;_=y++){var w=x[y],b=x[_];w[1]>d!=b[1]>d&&u<(b[0]-w[0])*(d-w[1])/(b[1]-w[1])+w[0]&&(h=!h),f=Math.min(f,l(u,d,w,b))}return f===0?0:(h?1:-1)*Math.sqrt(f)}function a(u){for(var d=0,c=0,h=0,f=u[0],m=0,x=f.length,y=x-1;m<x;y=m++){var v=f[m],_=f[y],w=v[0]*_[1]-_[0]*v[1];c+=(v[0]+_[0])*w,h+=(v[1]+_[1])*w,d+=w*3}return d===0?new s(f[0][0],f[0][1],0,u):new s(c/d,h/d,0,u)}function l(u,d,c,h){var f=c[0],m=c[1],x=h[0]-f,y=h[1]-m;if(x!==0||y!==0){var v=((u-f)*x+(d-m)*y)/(x*x+y*y);v>1?(f=h[0],m=h[1]):v>0&&(f+=x*v,m+=y*v)}return x=u-f,y=d-m,x*x+y*y}}),Zte=Wr(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var c=this||n;return c._counter=1e3,c._html5AudioPool=[],c.html5PoolSize=10,c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c._canPlayEvent="canplaythrough",c._navigator=typeof window<"u"&&window.navigator?window.navigator:null,c.masterGain=null,c.noAudio=!1,c.usingWebAudio=!0,c.autoSuspend=!0,c.ctx=null,c.autoUnlock=!0,c._setup(),c},volume:function(c){var h=this||n;if(c=parseFloat(c),h.ctx||d(),typeof c<"u"&&c>=0&&c<=1){if(h._volume=c,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(c,n.ctx.currentTime);for(var f=0;f<h._howls.length;f++)if(!h._howls[f]._webAudio)for(var m=h._howls[f]._getSoundIds(),x=0;x<m.length;x++){var y=h._howls[f]._soundById(m[x]);y&&y._node&&(y._node.volume=y._volume*c)}return h}return h._volume},mute:function(c){var h=this||n;h.ctx||d(),h._muted=c,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(c?0:h._volume,n.ctx.currentTime);for(var f=0;f<h._howls.length;f++)if(!h._howls[f]._webAudio)for(var m=h._howls[f]._getSoundIds(),x=0;x<m.length;x++){var y=h._howls[f]._soundById(m[x]);y&&y._node&&(y._node.muted=c?!0:y._muted)}return h},stop:function(){for(var c=this||n,h=0;h<c._howls.length;h++)c._howls[h].stop();return c},unload:function(){for(var c=this||n,h=c._howls.length-1;h>=0;h--)c._howls[h].unload();return c.usingWebAudio&&c.ctx&&typeof c.ctx.close<"u"&&(c.ctx.close(),c.ctx=null,d()),c},codecs:function(c){return(this||n)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||n;if(c.state=c.ctx&&c.ctx.state||"suspended",c._autoSuspend(),!c.usingWebAudio)if(typeof Audio<"u")try{var h=new Audio;typeof h.oncanplaythrough>"u"&&(c._canPlayEvent="canplay")}catch{c.noAudio=!0}else c.noAudio=!0;try{var h=new Audio;h.muted&&(c.noAudio=!0)}catch{}return c.noAudio||c._setupCodecs(),c},_setupCodecs:function(){var c=this||n,h=null;try{h=typeof Audio<"u"?new Audio:null}catch{return c}if(!h||typeof h.canPlayType!="function")return c;var f=h.canPlayType("audio/mpeg;").replace(/^no$/,""),m=c._navigator?c._navigator.userAgent:"",x=m.match(/OPR\/([0-6].)/g),y=x&&parseInt(x[0].split("/")[1],10)<33,v=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,_=m.match(/Version\/(.*?) /),w=v&&_&&parseInt(_[1],10)<15;return c._codecs={mp3:!!(!y&&(f||h.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},c},_unlockAudio:function(){var c=this||n;if(!(c._audioUnlocked||!c.ctx)){c._audioUnlocked=!1,c.autoUnlock=!1,!c._mobileUnloaded&&c.ctx.sampleRate!==44100&&(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var h=function(f){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,c._releaseHtml5Audio(m)}catch{c.noAudio=!0;break}for(var x=0;x<c._howls.length;x++)if(!c._howls[x]._webAudio)for(var y=c._howls[x]._getSoundIds(),v=0;v<y.length;v++){var _=c._howls[x]._soundById(y[v]);_&&_._node&&!_._node._unlocked&&(_._node._unlocked=!0,_._node.load())}c._autoResume();var w=c.ctx.createBufferSource();w.buffer=c._scratchBuffer,w.connect(c.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof c.ctx.resume=="function"&&c.ctx.resume(),w.onended=function(){w.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),c}},_obtainHtml5Audio:function(){var c=this||n;if(c._html5AudioPool.length)return c._html5AudioPool.pop();var h=new Audio().play();return h&&typeof Promise<"u"&&(h instanceof Promise||typeof h.then=="function")&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(c){var h=this||n;return c._unlocked&&h._html5AudioPool.push(c),h},_autoSuspend:function(){var c=this;if(!(!c.autoSuspend||!c.ctx||typeof c.ctx.suspend>"u"||!n.usingWebAudio)){for(var h=0;h<c._howls.length;h++)if(c._howls[h]._webAudio){for(var f=0;f<c._howls[h]._sounds.length;f++)if(!c._howls[h]._sounds[f]._paused)return c}return c._suspendTimer&&clearTimeout(c._suspendTimer),c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null,c.state="suspending";var m=function(){c.state="suspended",c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(m,m)}},3e4),c}},_autoResume:function(){var c=this;if(!(!c.ctx||typeof c.ctx.resume>"u"||!n.usingWebAudio))return c.state==="running"&&c.ctx.state!=="interrupted"&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):c.state==="suspended"||c.state==="running"&&c.ctx.state==="interrupted"?(c.ctx.resume().then(function(){c.state="running";for(var h=0;h<c._howls.length;h++)c._howls[h]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):c.state==="suspending"&&(c._resumeAfterSuspend=!0),c}};var n=new e,i=function(c){var h=this;if(!c.src||c.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}h.init(c)};i.prototype={init:function(c){var h=this;return n.ctx||d(),h._autoplay=c.autoplay||!1,h._format=typeof c.format!="string"?c.format:[c.format],h._html5=c.html5||!1,h._muted=c.mute||!1,h._loop=c.loop||!1,h._pool=c.pool||5,h._preload=typeof c.preload=="boolean"||c.preload==="metadata"?c.preload:!0,h._rate=c.rate||1,h._sprite=c.sprite||{},h._src=typeof c.src!="string"?c.src:[c.src],h._volume=c.volume!==void 0?c.volume:1,h._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=c.onend?[{fn:c.onend}]:[],h._onfade=c.onfade?[{fn:c.onfade}]:[],h._onload=c.onload?[{fn:c.onload}]:[],h._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],h._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[],h._onpause=c.onpause?[{fn:c.onpause}]:[],h._onplay=c.onplay?[{fn:c.onplay}]:[],h._onstop=c.onstop?[{fn:c.onstop}]:[],h._onmute=c.onmute?[{fn:c.onmute}]:[],h._onvolume=c.onvolume?[{fn:c.onvolume}]:[],h._onrate=c.onrate?[{fn:c.onrate}]:[],h._onseek=c.onseek?[{fn:c.onseek}]:[],h._onunlock=c.onunlock?[{fn:c.onunlock}]:[],h._onresume=[],h._webAudio=n.usingWebAudio&&!h._html5,typeof n.ctx<"u"&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h._preload!=="none"&&h.load(),h},load:function(){var c=this,h=null;if(n.noAudio){c._emit("loaderror",null,"No audio support.");return}typeof c._src=="string"&&(c._src=[c._src]);for(var f=0;f<c._src.length;f++){var m,x;if(c._format&&c._format[f])m=c._format[f];else{if(x=c._src[f],typeof x!="string"){c._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(x),m||(m=/\.([^.]+)$/.exec(x.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&n.codecs(m)){h=c._src[f];break}}if(!h){c._emit("loaderror",null,"No codec support for selected audio sources.");return}return c._src=h,c._state="loading",window.location.protocol==="https:"&&h.slice(0,5)==="http:"&&(c._html5=!0,c._webAudio=!1),new r(c),c._webAudio&&o(c),c},play:function(c,h){var f=this,m=null;if(typeof c=="number")m=c,c=null;else{if(typeof c=="string"&&f._state==="loaded"&&!f._sprite[c])return null;if(typeof c>"u"&&(c="__default",!f._playLock)){for(var x=0,y=0;y<f._sounds.length;y++)f._sounds[y]._paused&&!f._sounds[y]._ended&&(x++,m=f._sounds[y]._id);x===1?c=null:m=null}}var v=m?f._soundById(m):f._inactiveSound();if(!v)return null;if(m&&!c&&(c=v._sprite||"__default"),f._state!=="loaded"){v._sprite=c,v._ended=!1;var _=v._id;return f._queue.push({event:"play",action:function(){f.play(_)}}),_}if(m&&!v._paused)return h||f._loadQueue("play"),v._id;f._webAudio&&n._autoResume();var w=Math.max(0,v._seek>0?v._seek:f._sprite[c][0]/1e3),b=Math.max(0,(f._sprite[c][0]+f._sprite[c][1])/1e3-w),E=b*1e3/Math.abs(v._rate),A=f._sprite[c][0]/1e3,T=(f._sprite[c][0]+f._sprite[c][1])/1e3;v._sprite=c,v._ended=!1;var L=function(){v._paused=!1,v._seek=w,v._start=A,v._stop=T,v._loop=!!(v._loop||f._sprite[c][2])};if(w>=T){f._ended(v);return}var P=v._node;if(f._webAudio){var C=function(){f._playLock=!1,L(),f._refreshBuffer(v);var k=v._muted||f._muted?0:v._volume;P.gain.setValueAtTime(k,n.ctx.currentTime),v._playStart=n.ctx.currentTime,typeof P.bufferSource.start>"u"?v._loop?P.bufferSource.noteGrainOn(0,w,86400):P.bufferSource.noteGrainOn(0,w,b):v._loop?P.bufferSource.start(0,w,86400):P.bufferSource.start(0,w,b),E!==1/0&&(f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),E)),h||setTimeout(function(){f._emit("play",v._id),f._loadQueue()},0)};n.state==="running"&&n.ctx.state!=="interrupted"?C():(f._playLock=!0,f.once("resume",C),f._clearTimer(v._id))}else{var D=function(){P.currentTime=w,P.muted=v._muted||f._muted||n._muted||P.muted,P.volume=v._volume*n.volume(),P.playbackRate=v._rate;try{var k=P.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(f._playLock=!0,L(),k.then(function(){f._playLock=!1,P._unlocked=!0,h?f._loadQueue():f._emit("play",v._id)}).catch(function(){f._playLock=!1,f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):h||(f._playLock=!1,L(),f._emit("play",v._id)),P.playbackRate=v._rate,P.paused){f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}c!=="__default"||v._loop?f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),E):(f._endTimers[v._id]=function(){f._ended(v),P.removeEventListener("ended",f._endTimers[v._id],!1)},P.addEventListener("ended",f._endTimers[v._id],!1))}catch(H){f._emit("playerror",v._id,H)}};P.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(P.src=f._src,P.load());var U=window&&window.ejecta||!P.readyState&&n._navigator.isCocoonJS;if(P.readyState>=3||U)D();else{f._playLock=!0,f._state="loading";var G=function(){f._state="loaded",D(),P.removeEventListener(n._canPlayEvent,G,!1)};P.addEventListener(n._canPlayEvent,G,!1),f._clearTimer(v._id)}}return v._id},pause:function(c){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(c)}}),h;for(var f=h._getSoundIds(c),m=0;m<f.length;m++){h._clearTimer(f[m]);var x=h._soundById(f[m]);if(x&&!x._paused&&(x._seek=h.seek(f[m]),x._rateSeek=0,x._paused=!0,h._stopFade(f[m]),x._node))if(h._webAudio){if(!x._node.bufferSource)continue;typeof x._node.bufferSource.stop>"u"?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),h._cleanBuffer(x._node)}else(!isNaN(x._node.duration)||x._node.duration===1/0)&&x._node.pause();arguments[1]||h._emit("pause",x?x._id:null)}return h},stop:function(c,h){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(c)}}),f;for(var m=f._getSoundIds(c),x=0;x<m.length;x++){f._clearTimer(m[x]);var y=f._soundById(m[x]);y&&(y._seek=y._start||0,y._rateSeek=0,y._paused=!0,y._ended=!0,f._stopFade(m[x]),y._node&&(f._webAudio?y._node.bufferSource&&(typeof y._node.bufferSource.stop>"u"?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),f._cleanBuffer(y._node)):(!isNaN(y._node.duration)||y._node.duration===1/0)&&(y._node.currentTime=y._start||0,y._node.pause(),y._node.duration===1/0&&f._clearSound(y._node))),h||f._emit("stop",y._id))}return f},mute:function(c,h){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(c,h)}}),f;if(typeof h>"u")if(typeof c=="boolean")f._muted=c;else return f._muted;for(var m=f._getSoundIds(h),x=0;x<m.length;x++){var y=f._soundById(m[x]);y&&(y._muted=c,y._interval&&f._stopFade(y._id),f._webAudio&&y._node?y._node.gain.setValueAtTime(c?0:y._volume,n.ctx.currentTime):y._node&&(y._node.muted=n._muted?!0:c),f._emit("mute",y._id))}return f},volume:function(){var c=this,h=arguments,f,m;if(h.length===0)return c._volume;if(h.length===1||h.length===2&&typeof h[1]>"u"){var x=c._getSoundIds(),y=x.indexOf(h[0]);y>=0?m=parseInt(h[0],10):f=parseFloat(h[0])}else h.length>=2&&(f=parseFloat(h[0]),m=parseInt(h[1],10));var v;if(typeof f<"u"&&f>=0&&f<=1){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,h)}}),c;typeof m>"u"&&(c._volume=f),m=c._getSoundIds(m);for(var _=0;_<m.length;_++)v=c._soundById(m[_]),v&&(v._volume=f,h[2]||c._stopFade(m[_]),c._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(f,n.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=f*n.volume()),c._emit("volume",v._id))}else return v=m?c._soundById(m):c._sounds[0],v?v._volume:0;return c},fade:function(c,h,f,m){var x=this;if(x._state!=="loaded"||x._playLock)return x._queue.push({event:"fade",action:function(){x.fade(c,h,f,m)}}),x;c=Math.min(Math.max(0,parseFloat(c)),1),h=Math.min(Math.max(0,parseFloat(h)),1),f=parseFloat(f),x.volume(c,m);for(var y=x._getSoundIds(m),v=0;v<y.length;v++){var _=x._soundById(y[v]);if(_){if(m||x._stopFade(y[v]),x._webAudio&&!_._muted){var w=n.ctx.currentTime,b=w+f/1e3;_._volume=c,_._node.gain.setValueAtTime(c,w),_._node.gain.linearRampToValueAtTime(h,b)}x._startFadeInterval(_,c,h,f,y[v],typeof m>"u")}}return x},_startFadeInterval:function(c,h,f,m,x,y){var v=this,_=h,w=f-h,b=Math.abs(w/.01),E=Math.max(4,b>0?m/b:m),A=Date.now();c._fadeTo=f,c._interval=setInterval(function(){var T=(Date.now()-A)/m;A=Date.now(),_+=w*T,_=Math.round(_*100)/100,w<0?_=Math.max(f,_):_=Math.min(f,_),v._webAudio?c._volume=_:v.volume(_,c._id,!0),y&&(v._volume=_),(f<h&&_<=f||f>h&&_>=f)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,v.volume(f,c._id),v._emit("fade",c._id))},E)},_stopFade:function(c){var h=this,f=h._soundById(c);return f&&f._interval&&(h._webAudio&&f._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(f._interval),f._interval=null,h.volume(f._fadeTo,c),f._fadeTo=null,h._emit("fade",c)),h},loop:function(){var c=this,h=arguments,f,m,x;if(h.length===0)return c._loop;if(h.length===1)if(typeof h[0]=="boolean")f=h[0],c._loop=f;else return x=c._soundById(parseInt(h[0],10)),x?x._loop:!1;else h.length===2&&(f=h[0],m=parseInt(h[1],10));for(var y=c._getSoundIds(m),v=0;v<y.length;v++)x=c._soundById(y[v]),x&&(x._loop=f,c._webAudio&&x._node&&x._node.bufferSource&&(x._node.bufferSource.loop=f,f&&(x._node.bufferSource.loopStart=x._start||0,x._node.bufferSource.loopEnd=x._stop,c.playing(y[v])&&(c.pause(y[v],!0),c.play(y[v],!0)))));return c},rate:function(){var c=this,h=arguments,f,m;if(h.length===0)m=c._sounds[0]._id;else if(h.length===1){var x=c._getSoundIds(),y=x.indexOf(h[0]);y>=0?m=parseInt(h[0],10):f=parseFloat(h[0])}else h.length===2&&(f=parseFloat(h[0]),m=parseInt(h[1],10));var v;if(typeof f=="number"){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"rate",action:function(){c.rate.apply(c,h)}}),c;typeof m>"u"&&(c._rate=f),m=c._getSoundIds(m);for(var _=0;_<m.length;_++)if(v=c._soundById(m[_]),v){c.playing(m[_])&&(v._rateSeek=c.seek(m[_]),v._playStart=c._webAudio?n.ctx.currentTime:v._playStart),v._rate=f,c._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(f,n.ctx.currentTime):v._node&&(v._node.playbackRate=f);var w=c.seek(m[_]),b=(c._sprite[v._sprite][0]+c._sprite[v._sprite][1])/1e3-w,E=b*1e3/Math.abs(v._rate);(c._endTimers[m[_]]||!v._paused)&&(c._clearTimer(m[_]),c._endTimers[m[_]]=setTimeout(c._ended.bind(c,v),E)),c._emit("rate",v._id)}}else return v=c._soundById(m),v?v._rate:c._rate;return c},seek:function(){var c=this,h=arguments,f,m;if(h.length===0)c._sounds.length&&(m=c._sounds[0]._id);else if(h.length===1){var x=c._getSoundIds(),y=x.indexOf(h[0]);y>=0?m=parseInt(h[0],10):c._sounds.length&&(m=c._sounds[0]._id,f=parseFloat(h[0]))}else h.length===2&&(f=parseFloat(h[0]),m=parseInt(h[1],10));if(typeof m>"u")return 0;if(typeof f=="number"&&(c._state!=="loaded"||c._playLock))return c._queue.push({event:"seek",action:function(){c.seek.apply(c,h)}}),c;var v=c._soundById(m);if(v)if(typeof f=="number"&&f>=0){var _=c.playing(m);_&&c.pause(m,!0),v._seek=f,v._ended=!1,c._clearTimer(m),!c._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=f);var w=function(){_&&c.play(m,!0),c._emit("seek",m)};if(_&&!c._webAudio){var b=function(){c._playLock?setTimeout(b,0):w()};setTimeout(b,0)}else w()}else if(c._webAudio){var E=c.playing(m)?n.ctx.currentTime-v._playStart:0,A=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(A+E*Math.abs(v._rate))}else return v._node.currentTime;return c},playing:function(c){var h=this;if(typeof c=="number"){var f=h._soundById(c);return f?!f._paused:!1}for(var m=0;m<h._sounds.length;m++)if(!h._sounds[m]._paused)return!0;return!1},duration:function(c){var h=this,f=h._duration,m=h._soundById(c);return m&&(f=h._sprite[m._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var c=this,h=c._sounds,f=0;f<h.length;f++)h[f]._paused||c.stop(h[f]._id),c._webAudio||(c._clearSound(h[f]._node),h[f]._node.removeEventListener("error",h[f]._errorFn,!1),h[f]._node.removeEventListener(n._canPlayEvent,h[f]._loadFn,!1),h[f]._node.removeEventListener("ended",h[f]._endFn,!1),n._releaseHtml5Audio(h[f]._node)),delete h[f]._node,c._clearTimer(h[f]._id);var m=n._howls.indexOf(c);m>=0&&n._howls.splice(m,1);var x=!0;for(f=0;f<n._howls.length;f++)if(n._howls[f]._src===c._src||c._src.indexOf(n._howls[f]._src)>=0){x=!1;break}return s&&x&&delete s[c._src],n.noAudio=!1,c._state="unloaded",c._sounds=[],c=null,null},on:function(c,h,f,m){var x=this,y=x["_on"+c];return typeof h=="function"&&y.push(m?{id:f,fn:h,once:m}:{id:f,fn:h}),x},off:function(c,h,f){var m=this,x=m["_on"+c],y=0;if(typeof h=="number"&&(f=h,h=null),h||f)for(y=0;y<x.length;y++){var v=f===x[y].id;if(h===x[y].fn&&v||!h&&v){x.splice(y,1);break}}else if(c)m["_on"+c]=[];else{var _=Object.keys(m);for(y=0;y<_.length;y++)_[y].indexOf("_on")===0&&Array.isArray(m[_[y]])&&(m[_[y]]=[])}return m},once:function(c,h,f){var m=this;return m.on(c,h,f,1),m},_emit:function(c,h,f){for(var m=this,x=m["_on"+c],y=x.length-1;y>=0;y--)(!x[y].id||x[y].id===h||c==="load")&&(setTimeout((function(v){v.call(this,h,f)}).bind(m,x[y].fn),0),x[y].once&&m.off(c,x[y].fn,x[y].id));return m._loadQueue(c),m},_loadQueue:function(c){var h=this;if(h._queue.length>0){var f=h._queue[0];f.event===c&&(h._queue.shift(),h._loadQueue()),c||f.action()}return h},_ended:function(c){var h=this,f=c._sprite;if(!h._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(h._ended.bind(h,c),100),h;var m=!!(c._loop||h._sprite[f][2]);if(h._emit("end",c._id),!h._webAudio&&m&&h.stop(c._id,!0).play(c._id),h._webAudio&&m){h._emit("play",c._id),c._seek=c._start||0,c._rateSeek=0,c._playStart=n.ctx.currentTime;var x=(c._stop-c._start)*1e3/Math.abs(c._rate);h._endTimers[c._id]=setTimeout(h._ended.bind(h,c),x)}return h._webAudio&&!m&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,h._clearTimer(c._id),h._cleanBuffer(c._node),n._autoSuspend()),!h._webAudio&&!m&&h.stop(c._id,!0),h},_clearTimer:function(c){var h=this;if(h._endTimers[c]){if(typeof h._endTimers[c]!="function")clearTimeout(h._endTimers[c]);else{var f=h._soundById(c);f&&f._node&&f._node.removeEventListener("ended",h._endTimers[c],!1)}delete h._endTimers[c]}return h},_soundById:function(c){for(var h=this,f=0;f<h._sounds.length;f++)if(c===h._sounds[f]._id)return h._sounds[f];return null},_inactiveSound:function(){var c=this;c._drain();for(var h=0;h<c._sounds.length;h++)if(c._sounds[h]._ended)return c._sounds[h].reset();return new r(c)},_drain:function(){var c=this,h=c._pool,f=0,m=0;if(!(c._sounds.length<h)){for(m=0;m<c._sounds.length;m++)c._sounds[m]._ended&&f++;for(m=c._sounds.length-1;m>=0;m--){if(f<=h)return;c._sounds[m]._ended&&(c._webAudio&&c._sounds[m]._node&&c._sounds[m]._node.disconnect(0),c._sounds.splice(m,1),f--)}}},_getSoundIds:function(c){var h=this;if(typeof c>"u"){for(var f=[],m=0;m<h._sounds.length;m++)f.push(h._sounds[m]._id);return f}else return[c]},_refreshBuffer:function(c){var h=this;return c._node.bufferSource=n.ctx.createBufferSource(),c._node.bufferSource.buffer=s[h._src],c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node),c._node.bufferSource.loop=c._loop,c._loop&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0),c._node.bufferSource.playbackRate.setValueAtTime(c._rate,n.ctx.currentTime),h},_cleanBuffer:function(c){var h=this,f=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=null,c.bufferSource.disconnect(0),f))try{c.bufferSource.buffer=n._scratchBuffer}catch{}return c.bufferSource=null,h},_clearSound:function(c){var h=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);h||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(c){this._parent=c,this.init()};r.prototype={init:function(){var c=this,h=c._parent;return c._muted=h._muted,c._loop=h._loop,c._volume=h._volume,c._rate=h._rate,c._seek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++n._counter,h._sounds.push(c),c.create(),c},create:function(){var c=this,h=c._parent,f=n._muted||c._muted||c._parent._muted?0:c._volume;return h._webAudio?(c._node=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),c._node.gain.setValueAtTime(f,n.ctx.currentTime),c._node.paused=!0,c._node.connect(n.masterGain)):n.noAudio||(c._node=n._obtainHtml5Audio(),c._errorFn=c._errorListener.bind(c),c._node.addEventListener("error",c._errorFn,!1),c._loadFn=c._loadListener.bind(c),c._node.addEventListener(n._canPlayEvent,c._loadFn,!1),c._endFn=c._endListener.bind(c),c._node.addEventListener("ended",c._endFn,!1),c._node.src=h._src,c._node.preload=h._preload===!0?"auto":h._preload,c._node.volume=f*n.volume(),c._node.load()),c},reset:function(){var c=this,h=c._parent;return c._muted=h._muted,c._loop=h._loop,c._volume=h._volume,c._rate=h._rate,c._seek=0,c._rateSeek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++n._counter,c},_errorListener:function(){var c=this;c._parent._emit("loaderror",c._id,c._node.error?c._node.error.code:0),c._node.removeEventListener("error",c._errorFn,!1)},_loadListener:function(){var c=this,h=c._parent;h._duration=Math.ceil(c._node.duration*10)/10,Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue()),c._node.removeEventListener(n._canPlayEvent,c._loadFn,!1)},_endListener:function(){var c=this,h=c._parent;h._duration===1/0&&(h._duration=Math.ceil(c._node.duration*10)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=h._duration*1e3),h._ended(c)),c._node.removeEventListener("ended",c._endFn,!1)}};var s={},o=function(c){var h=c._src;if(s[h]){c._duration=s[h].duration,u(c);return}if(/^data:[^;]+;base64,/.test(h)){for(var f=atob(h.split(",")[1]),m=new Uint8Array(f.length),x=0;x<f.length;++x)m[x]=f.charCodeAt(x);l(m.buffer,c)}else{var y=new XMLHttpRequest;y.open(c._xhr.method,h,!0),y.withCredentials=c._xhr.withCredentials,y.responseType="arraybuffer",c._xhr.headers&&Object.keys(c._xhr.headers).forEach(function(v){y.setRequestHeader(v,c._xhr.headers[v])}),y.onload=function(){var v=(y.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){c._emit("loaderror",null,"Failed loading audio file with status: "+y.status+".");return}l(y.response,c)},y.onerror=function(){c._webAudio&&(c._html5=!0,c._webAudio=!1,c._sounds=[],delete s[h],c.load())},a(y)}},a=function(c){try{c.send()}catch{c.onerror()}},l=function(c,h){var f=function(){h._emit("loaderror",null,"Decoding audio data failed.")},m=function(x){x&&h._sounds.length>0?(s[h._src]=x,u(h,x)):f()};typeof Promise<"u"&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(c).then(m).catch(f):n.ctx.decodeAudioData(c,m,f)},u=function(c,h){h&&!c._duration&&(c._duration=h.duration),Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue())},d=function(){if(n.usingWebAudio){try{typeof AudioContext<"u"?n.ctx=new AudioContext:typeof webkitAudioContext<"u"?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var c=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),h=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=h?parseInt(h[1],10):null;if(c&&f&&f<9){var m=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!m&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:n,Howl:i}}),typeof t<"u"&&(t.Howler=n,t.Howl=i),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=n,global.Howl=i,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var r=i._howls.length-1;r>=0;r--)i._howls[r].stereo(n);return i},HowlerGlobal.prototype.pos=function(n,i,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,r=typeof r!="number"?s._pos[2]:r,typeof n=="number")s._pos=[n,i,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(n,i,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var u=l._orientation;if(i=typeof i!="number"?u[1]:i,r=typeof r!="number"?u[2]:r,s=typeof s!="number"?u[3]:s,o=typeof o!="number"?u[4]:o,a=typeof a!="number"?u[5]:a,typeof n=="number")l._orientation=[n,i,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(n,i,r,s,o,a);else return u;return l},Howl.prototype.init=function(n){return function(i){var r=this;return r._orientation=i.orientation||[1,0,0],r._stereo=i.stereo||null,r._pos=i.pos||null,r._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},r._onstereo=i.onstereo?[{fn:i.onstereo}]:[],r._onpos=i.onpos?[{fn:i.onpos}]:[],r._onorientation=i.onorientation?[{fn:i.onorientation}]:[],n.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,i){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(n,i)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof n=="number")r._stereo=n,r._pos=[n,0,0];else return r._stereo;for(var o=r._getSoundIds(i),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof n=="number")l._stereo=n,l._pos=[n,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(n,0,0):l._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(n,i,r,s)}}),o;if(i=typeof i!="number"?0:i,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof n=="number")o._pos=[n,i,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof n=="number")u._pos=[n,i,r],u._node&&((!u._panner||u._panner.pan)&&e(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(n,i,r)),o._emit("pos",u._id);else return u._pos}return o},Howl.prototype.orientation=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(n,i,r,s)}}),o;if(i=typeof i!="number"?o._orientation[1]:i,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof n=="number")o._orientation=[n,i,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof n=="number")u._orientation=[n,i,r],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(n,i,r)),o._emit("orientation",u._id);else return u._orientation}return o},Howl.prototype.pannerAttr=function(){var n=this,i=arguments,r,s,o;if(!n._webAudio)return n;if(i.length===0)return n._pannerAttr;if(i.length===1)if(typeof i[0]=="object")r=i[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),n._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:n._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:n._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:n._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:n._panningModel});else return o=n._soundById(parseInt(i[0],10)),o?o._pannerAttr:n._pannerAttr;else i.length===2&&(r=i[0],s=parseInt(i[1],10));for(var a=n._getSoundIds(s),l=0;l<a.length;l++)if(o=n._soundById(a[l]),o){var u=o._pannerAttr;u={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:u.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:u.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:u.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:u.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:u.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:u.panningModel};var d=o._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor,d.panningModel=u.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),e(o,"spatial"))}return n},Sound.prototype.init=function(n){return function(){var i=this,r=i._parent;i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,n.call(this),i._stereo?r.stereo(i._stereo):i._pos&&r.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var i=this,r=i._parent;return i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,i._stereo?r.stereo(i._stereo):i._pos?r.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,r._refreshBuffer(i)),n.call(this)}}(Sound.prototype.reset);var e=function(n,i){i=i||"spatial",i==="spatial"?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.panningModel=n._pannerAttr.panningModel,typeof n._panner.positionX<"u"?(n._panner.positionX.setValueAtTime(n._pos[0],Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(n._pos[1],Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(n._pos[2],Howler.ctx.currentTime)):n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),typeof n._panner.orientationX<"u"?(n._panner.orientationX.setValueAtTime(n._orientation[0],Howler.ctx.currentTime),n._panner.orientationY.setValueAtTime(n._orientation[1],Howler.ctx.currentTime),n._panner.orientationZ.setValueAtTime(n._orientation[2],Howler.ctx.currentTime)):n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.setValueAtTime(n._stereo,Howler.ctx.currentTime)),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id,!0)}}()}),Kte=Wr((t,e)=>{function n(i){for(var r=new Array(i),s=0;s<i;++s)r[s]=s;return r}e.exports=n}),Qte=Wr((t,e)=>{e.exports=function(r){return r!=null&&(n(r)||i(r)||!!r._isBuffer)};function n(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function i(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&n(r.slice(0,0))}}),Pg=Wr((t,e)=>{var n=Kte(),i=Qte(),r=typeof Float64Array<"u";function s(c,h){return c[0]-h[0]}function o(){var c=this.stride,h=new Array(c.length),f;for(f=0;f<h.length;++f)h[f]=[Math.abs(c[f]),f];h.sort(s);var m=new Array(h.length);for(f=0;f<m.length;++f)m[f]=h[f][1];return m}function a(c,h){var f=["View",h,"d",c].join("");h<0&&(f="View_Nil"+c);var m=c==="generic";if(h===-1){var x="function "+f+"(a){this.data=a;};var proto="+f+".prototype;proto.dtype='"+c+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+f+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+f+"(a){return new "+f+"(a);}",C=new Function(x);return C()}else if(h===0){var x="function "+f+"(a,d) {this.data = a;this.offset = d};var proto="+f+".prototype;proto.dtype='"+c+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+f+"_copy() {return new "+f+"(this.data,this.offset)};proto.pick=function "+f+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+f+"_get(){return "+(m?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+f+"_set(v){return "+(m?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+f+"(a,b,c,d){return new "+f+"(a,d)}",C=new Function("TrivialArray",x);return C(u[c][0])}var x=["'use strict'"],y=n(h),v=y.map(function(D){return"i"+D}),_="this.offset+"+y.map(function(D){return"this.stride["+D+"]*i"+D}).join("+"),w=y.map(function(D){return"b"+D}).join(","),b=y.map(function(D){return"c"+D}).join(",");x.push("function "+f+"(a,"+w+","+b+",d){this.data=a","this.shape=["+w+"]","this.stride=["+b+"]","this.offset=d|0}","var proto="+f+".prototype","proto.dtype='"+c+"'","proto.dimension="+h),x.push("Object.defineProperty(proto,'size',{get:function "+f+"_size(){return "+y.map(function(D){return"this.shape["+D+"]"}).join("*"),"}})"),h===1?x.push("proto.order=[0]"):(x.push("Object.defineProperty(proto,'order',{get:"),h<4?(x.push("function "+f+"_order(){"),h===2?x.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):h===3&&x.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):x.push("ORDER})")),x.push("proto.set=function "+f+"_set("+v.join(",")+",v){"),m?x.push("return this.data.set("+_+",v)}"):x.push("return this.data["+_+"]=v}"),x.push("proto.get=function "+f+"_get("+v.join(",")+"){"),m?x.push("return this.data.get("+_+")}"):x.push("return this.data["+_+"]}"),x.push("proto.index=function "+f+"_index(",v.join(),"){return "+_+"}"),x.push("proto.hi=function "+f+"_hi("+v.join(",")+"){return new "+f+"(this.data,"+y.map(function(D){return["(typeof i",D,"!=='number'||i",D,"<0)?this.shape[",D,"]:i",D,"|0"].join("")}).join(",")+","+y.map(function(D){return"this.stride["+D+"]"}).join(",")+",this.offset)}");var E=y.map(function(D){return"a"+D+"=this.shape["+D+"]"}),A=y.map(function(D){return"c"+D+"=this.stride["+D+"]"});x.push("proto.lo=function "+f+"_lo("+v.join(",")+"){var b=this.offset,d=0,"+E.join(",")+","+A.join(","));for(var T=0;T<h;++T)x.push("if(typeof i"+T+"==='number'&&i"+T+">=0){d=i"+T+"|0;b+=c"+T+"*d;a"+T+"-=d}");x.push("return new "+f+"(this.data,"+y.map(function(D){return"a"+D}).join(",")+","+y.map(function(D){return"c"+D}).join(",")+",b)}"),x.push("proto.step=function "+f+"_step("+v.join(",")+"){var "+y.map(function(D){return"a"+D+"=this.shape["+D+"]"}).join(",")+","+y.map(function(D){return"b"+D+"=this.stride["+D+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var T=0;T<h;++T)x.push("if(typeof i"+T+"==='number'){d=i"+T+"|0;if(d<0){c+=b"+T+"*(a"+T+"-1);a"+T+"=ceil(-a"+T+"/d)}else{a"+T+"=ceil(a"+T+"/d)}b"+T+"*=d}");x.push("return new "+f+"(this.data,"+y.map(function(D){return"a"+D}).join(",")+","+y.map(function(D){return"b"+D}).join(",")+",c)}");for(var L=new Array(h),P=new Array(h),T=0;T<h;++T)L[T]="a[i"+T+"]",P[T]="b[i"+T+"]";x.push("proto.transpose=function "+f+"_transpose("+v+"){"+v.map(function(D,U){return D+"=("+D+"===undefined?"+U+":"+D+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+f+"(this.data,"+L.join(",")+","+P.join(",")+",this.offset)}"),x.push("proto.pick=function "+f+"_pick("+v+"){var a=[],b=[],c=this.offset");for(var T=0;T<h;++T)x.push("if(typeof i"+T+"==='number'&&i"+T+">=0){c=(c+this.stride["+T+"]*i"+T+")|0}else{a.push(this.shape["+T+"]);b.push(this.stride["+T+"])}");x.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),x.push("return function construct_"+f+"(data,shape,stride,offset){return new "+f+"(data,"+y.map(function(D){return"shape["+D+"]"}).join(",")+","+y.map(function(D){return"stride["+D+"]"}).join(",")+",offset)}");var C=new Function("CTOR_LIST","ORDER",x.join(`
`));return C(u[c],o)}function l(c){if(i(c))return"buffer";if(r)switch(Object.prototype.toString.call(c)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(c)?"array":"generic"}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function d(c,h,f,m){if(c===void 0){var b=u.array[0];return b([])}else typeof c=="number"&&(c=[c]);h===void 0&&(h=[c.length]);var x=h.length;if(f===void 0){f=new Array(x);for(var y=x-1,v=1;y>=0;--y)f[y]=v,v*=h[y]}if(m===void 0){m=0;for(var y=0;y<x;++y)f[y]<0&&(m-=(h[y]-1)*f[y])}for(var _=l(c),w=u[_];w.length<=x+1;)w.push(a(_,w.length-1));var b=w[x+1];return b(c,h,f,m)}e.exports=d}),Jte=Wr((t,e)=>{function n(s,o){for(var a=1,l=s.length,u=s[0],d=s[0],c=1;c<l;++c)if(d=u,u=s[c],o(u,d)){if(c===a){a++;continue}s[a++]=u}return s.length=a,s}function i(s){for(var o=1,a=s.length,l=s[0],u=s[0],d=1;d<a;++d,u=l)if(u=l,l=s[d],l!==u){if(d===o){o++;continue}s[o++]=l}return s.length=o,s}function r(s,o,a){return s.length===0?s:o?(a||s.sort(o),n(s,o)):(a||s.sort(),i(s))}e.exports=r}),ene=Wr((t,e)=>{var n=Jte();function i(u,d,c){var h=u.length,f=d.arrayArgs.length,m=d.indexArgs.length>0,x=[],y=[],v=0,_=0,w,b;for(w=0;w<h;++w)y.push(["i",w,"=0"].join(""));for(b=0;b<f;++b)for(w=0;w<h;++w)_=v,v=u[w],w===0?y.push(["d",b,"s",w,"=t",b,"p",v].join("")):y.push(["d",b,"s",w,"=(t",b,"p",v,"-s",_,"*t",b,"p",_,")"].join(""));for(y.length>0&&x.push("var "+y.join(",")),w=h-1;w>=0;--w)v=u[w],x.push(["for(i",w,"=0;i",w,"<s",v,";++i",w,"){"].join(""));for(x.push(c),w=0;w<h;++w){for(_=v,v=u[w],b=0;b<f;++b)x.push(["p",b,"+=d",b,"s",w].join(""));m&&(w>0&&x.push(["index[",_,"]-=s",_].join("")),x.push(["++index[",v,"]"].join(""))),x.push("}")}return x.join(`
`)}function r(u,d,c,h){for(var f=d.length,m=c.arrayArgs.length,x=c.blockSize,y=c.indexArgs.length>0,v=[],_=0;_<m;++_)v.push(["var offset",_,"=p",_].join(""));for(var _=u;_<f;++_)v.push(["for(var j"+_+"=SS[",d[_],"]|0;j",_,">0;){"].join("")),v.push(["if(j",_,"<",x,"){"].join("")),v.push(["s",d[_],"=j",_].join("")),v.push(["j",_,"=0"].join("")),v.push(["}else{s",d[_],"=",x].join("")),v.push(["j",_,"-=",x,"}"].join("")),y&&v.push(["index[",d[_],"]=j",_].join(""));for(var _=0;_<m;++_){for(var w=["offset"+_],b=u;b<f;++b)w.push(["j",b,"*t",_,"p",d[b]].join(""));v.push(["p",_,"=(",w.join("+"),")"].join(""))}v.push(i(d,c,h));for(var _=u;_<f;++_)v.push("}");return v.join(`
`)}function s(u){for(var d=0,c=u[0].length;d<c;){for(var h=1;h<u.length;++h)if(u[h][d]!==u[0][d])return d;++d}return d}function o(u,d,c){for(var h=u.body,f=[],m=[],x=0;x<u.args.length;++x){var y=u.args[x];if(!(y.count<=0)){var v=new RegExp(y.name,"g"),_="",w=d.arrayArgs.indexOf(x);switch(d.argTypes[x]){case"offset":var b=d.offsetArgIndex.indexOf(x),E=d.offsetArgs[b];w=E.array,_="+q"+b;case"array":_="p"+w+_;var A="l"+x,T="a"+w;if(d.arrayBlockIndices[w]===0)y.count===1?c[w]==="generic"?y.lvalue?(f.push(["var ",A,"=",T,".get(",_,")"].join("")),h=h.replace(v,A),m.push([T,".set(",_,",",A,")"].join(""))):h=h.replace(v,[T,".get(",_,")"].join("")):h=h.replace(v,[T,"[",_,"]"].join("")):c[w]==="generic"?(f.push(["var ",A,"=",T,".get(",_,")"].join("")),h=h.replace(v,A),y.lvalue&&m.push([T,".set(",_,",",A,")"].join(""))):(f.push(["var ",A,"=",T,"[",_,"]"].join("")),h=h.replace(v,A),y.lvalue&&m.push([T,"[",_,"]=",A].join("")));else{for(var L=[y.name],P=[_],C=0;C<Math.abs(d.arrayBlockIndices[w]);C++)L.push("\\s*\\[([^\\]]+)\\]"),P.push("$"+(C+1)+"*t"+w+"b"+C);if(v=new RegExp(L.join(""),"g"),_=P.join("+"),c[w]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");h=h.replace(v,[T,"[",_,"]"].join(""))}break;case"scalar":h=h.replace(v,"Y"+d.scalarArgs.indexOf(x));break;case"index":h=h.replace(v,"index");break;case"shape":h=h.replace(v,"shape");break}}}return[f.join(`
`),h,m.join(`
`)].join(`
`).trim()}function a(u){for(var d=new Array(u.length),c=!0,h=0;h<u.length;++h){var f=u[h],m=f.match(/\d+/);m?m=m[0]:m="",f.charAt(0)===0?d[h]="u"+f.charAt(1)+m:d[h]=f.charAt(0)+m,h>0&&(c=c&&d[h]===d[h-1])}return c?d[0]:d.join("")}function l(u,d){for(var c=d[1].length-Math.abs(u.arrayBlockIndices[0])|0,h=new Array(u.arrayArgs.length),f=new Array(u.arrayArgs.length),m=0;m<u.arrayArgs.length;++m)f[m]=d[2*m],h[m]=d[2*m+1];for(var x=[],y=[],v=[],_=[],w=[],m=0;m<u.arrayArgs.length;++m){u.arrayBlockIndices[m]<0?(v.push(0),_.push(c),x.push(c),y.push(c+u.arrayBlockIndices[m])):(v.push(u.arrayBlockIndices[m]),_.push(u.arrayBlockIndices[m]+c),x.push(0),y.push(u.arrayBlockIndices[m]));for(var b=[],E=0;E<h[m].length;E++)v[m]<=h[m][E]&&h[m][E]<_[m]&&b.push(h[m][E]-v[m]);w.push(b)}for(var A=["SS"],T=["'use strict'"],L=[],E=0;E<c;++E)L.push(["s",E,"=SS[",E,"]"].join(""));for(var m=0;m<u.arrayArgs.length;++m){A.push("a"+m),A.push("t"+m),A.push("p"+m);for(var E=0;E<c;++E)L.push(["t",m,"p",E,"=t",m,"[",v[m]+E,"]"].join(""));for(var E=0;E<Math.abs(u.arrayBlockIndices[m]);++E)L.push(["t",m,"b",E,"=t",m,"[",x[m]+E,"]"].join(""))}for(var m=0;m<u.scalarArgs.length;++m)A.push("Y"+m);if(u.shapeArgs.length>0&&L.push("shape=SS.slice(0)"),u.indexArgs.length>0){for(var P=new Array(c),m=0;m<c;++m)P[m]="0";L.push(["index=[",P.join(","),"]"].join(""))}for(var m=0;m<u.offsetArgs.length;++m){for(var C=u.offsetArgs[m],D=[],E=0;E<C.offset.length;++E)C.offset[E]!==0&&(C.offset[E]===1?D.push(["t",C.array,"p",E].join("")):D.push([C.offset[E],"*t",C.array,"p",E].join("")));D.length===0?L.push("q"+m+"=0"):L.push(["q",m,"=",D.join("+")].join(""))}var U=n([].concat(u.pre.thisVars).concat(u.body.thisVars).concat(u.post.thisVars));L=L.concat(U),L.length>0&&T.push("var "+L.join(","));for(var m=0;m<u.arrayArgs.length;++m)T.push("p"+m+"|=0");u.pre.body.length>3&&T.push(o(u.pre,u,f));var G=o(u.body,u,f),k=s(w);k<c?T.push(r(k,w[0],u,G)):T.push(i(w[0],u,G)),u.post.body.length>3&&T.push(o(u.post,u,f)),u.debug&&console.log("-----Generated cwise routine for ",d,`:
`+T.join(`
`)+`
----------`);var H=[u.funcName||"unnamed","_cwise_loop_",h[0].join("s"),"m",k,a(f)].join(""),K=new Function(["function ",H,"(",A.join(","),"){",T.join(`
`),"} return ",H].join(""));return K()}e.exports=l}),tne=Wr((t,e)=>{var n=ene();function i(r){var s=["'use strict'","var CACHED={}"],o=[],a=r.funcName+"_cwise_thunk";s.push(["return function ",a,"(",r.shimArgs.join(","),"){"].join(""));for(var l=[],u=[],d=[["array",r.arrayArgs[0],".shape.slice(",Math.max(0,r.arrayBlockIndices[0]),r.arrayBlockIndices[0]<0?","+r.arrayBlockIndices[0]+")":")"].join("")],c=[],h=[],f=0;f<r.arrayArgs.length;++f){var m=r.arrayArgs[f];o.push(["t",m,"=array",m,".dtype,","r",m,"=array",m,".order"].join("")),l.push("t"+m),l.push("r"+m),u.push("t"+m),u.push("r"+m+".join()"),d.push("array"+m+".data"),d.push("array"+m+".stride"),d.push("array"+m+".offset|0"),f>0&&(c.push("array"+r.arrayArgs[0]+".shape.length===array"+m+".shape.length+"+(Math.abs(r.arrayBlockIndices[0])-Math.abs(r.arrayBlockIndices[f]))),h.push("array"+r.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[0])+"]===array"+m+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[f])+"]"))}r.arrayArgs.length>1&&(s.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),s.push("for(var shapeIndex=array"+r.arrayArgs[0]+".shape.length-"+Math.abs(r.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),s.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),s.push("}"));for(var f=0;f<r.scalarArgs.length;++f)d.push("scalar"+r.scalarArgs[f]);o.push(["type=[",u.join(","),"].join()"].join("")),o.push("proc=CACHED[type]"),s.push("var "+o.join(",")),s.push(["if(!proc){","CACHED[type]=proc=compile([",l.join(","),"])}","return proc(",d.join(","),")}"].join("")),r.debug&&console.log(`-----Generated thunk:
`+s.join(`
`)+`
----------`);var x=new Function("compile",s.join(`
`));return x(n.bind(void 0,r))}e.exports=i}),nne=Wr((t,e)=>{var n=tne();function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(s){var o=new i;o.pre=s.pre,o.body=s.body,o.post=s.post;var a=s.args.slice(0);o.argTypes=a;for(var l=0;l<a.length;++l){var u=a[l];if(u==="array"||typeof u=="object"&&u.blockIndices){if(o.argTypes[l]="array",o.arrayArgs.push(l),o.arrayBlockIndices.push(u.blockIndices?u.blockIndices:0),o.shimArgs.push("array"+l),l<o.pre.args.length&&o.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array args");if(l<o.post.args.length&&o.post.args[l].count>0)throw new Error("cwise: post() block may not reference array args")}else if(u==="scalar")o.scalarArgs.push(l),o.shimArgs.push("scalar"+l);else if(u==="index"){if(o.indexArgs.push(l),l<o.pre.args.length&&o.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array index");if(l<o.body.args.length&&o.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array index");if(l<o.post.args.length&&o.post.args[l].count>0)throw new Error("cwise: post() block may not reference array index")}else if(u==="shape"){if(o.shapeArgs.push(l),l<o.pre.args.length&&o.pre.args[l].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(l<o.body.args.length&&o.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array shape");if(l<o.post.args.length&&o.post.args[l].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if(typeof u=="object"&&u.offset)o.argTypes[l]="offset",o.offsetArgs.push({array:u.array,offset:u.offset}),o.offsetArgIndex.push(l);else throw new Error("cwise: Unknown argument type "+a[l])}if(o.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(o.pre.args.length>a.length)throw new Error("cwise: Too many arguments in pre() block");if(o.body.args.length>a.length)throw new Error("cwise: Too many arguments in body() block");if(o.post.args.length>a.length)throw new Error("cwise: Too many arguments in post() block");return o.debug=!!s.printCode||!!s.debug,o.funcName=s.funcName||"cwise",o.blockSize=s.blockSize||64,n(o)}e.exports=r}),Rg=Wr(t=>{var e=nne(),n={body:"",args:[],thisVars:[],localVars:[]};function i(h){if(!h)return n;for(var f=0;f<h.args.length;++f){var m=h.args[f];f===0?h.args[f]={name:m,lvalue:!0,rvalue:!!h.rvalue,count:h.count||1}:h.args[f]={name:m,lvalue:!1,rvalue:!0,count:1}}return h.thisVars||(h.thisVars=[]),h.localVars||(h.localVars=[]),h}function r(h){return e({args:h.args,pre:i(h.pre),body:i(h.body),post:i(h.proc),funcName:h.funcName})}function s(h){for(var f=[],m=0;m<h.args.length;++m)f.push("a"+m);var x=new Function("P",["return function ",h.funcName,"_ndarrayops(",f.join(","),") {P(",f.join(","),");return a0}"].join(""));return x(r(h))}var o={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var h in o){var f=o[h];t[h]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+f+"c"},funcName:h}),t[h+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+f+"=b"},rvalue:!0,funcName:h+"eq"}),t[h+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+f+"s"},funcName:h+"s"}),t[h+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+f+"=s"},rvalue:!0,funcName:h+"seq"})}})();var a={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var h in a){var f=a[h];t[h]=s({args:["array","array"],body:{args:["a","b"],body:"a="+f+"b"},funcName:h}),t[h+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+f+"a"},rvalue:!0,count:2,funcName:h+"eq"})}})();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var h in l){var f=l[h];t[h]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+f+"c"},funcName:h}),t[h+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+f+"s"},funcName:h+"s"}),t[h+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+f+"b"},rvalue:!0,count:2,funcName:h+"eq"}),t[h+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+f+"s"},rvalue:!0,count:2,funcName:h+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var h=0;h<u.length;++h){var f=u[h];t[f]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f}),t[f+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"})}})();var d=["max","min","atan2","pow"];(function(){for(var h=0;h<d.length;++h){var f=d[h];t[f]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f}),t[f+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"}),t[f+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"}),t[f+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"seq"})}})();var c=["atan2","pow"];(function(){for(var h=0;h<c.length;++h){var f=c[h];t[f+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"}),t[f+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"}),t[f+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opeq"}),t[f+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opseq"})}})(),t.any=e({args:["array"],pre:n,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=e({args:["array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=e({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=e({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=e({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=e({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=e({args:["array","array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),ine=Wr((t,e)=>{e.exports=function(n,i){for(var r=n.split("."),s=i.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}});function rne(t){for(let e of Object.keys(t))t[e]===void 0&&delete t[e];return t}function Ya(t,e){return Object.setPrototypeOf(t,e),t}function g5(t){return Array.isArray(t)?t:[t]}function sne(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var one=typeof global=="object"&&global&&global.Object===Object&&global,v5=one,ane=typeof self=="object"&&self&&self.Object===Object&&self,lne=v5||ane||Function("return this")(),aa=lne,une=aa.Symbol,Ws=une,y5=Object.prototype,cne=y5.hasOwnProperty,hne=y5.toString,gp=Ws?Ws.toStringTag:void 0;function dne(t){var e=cne.call(t,gp),n=t[gp];try{t[gp]=void 0;var i=!0}catch{}var r=hne.call(t);return i&&(e?t[gp]=n:delete t[gp]),r}var fne=dne,pne=Object.prototype,mne=pne.toString;function gne(t){return mne.call(t)}var vne=gne,yne="[object Null]",xne="[object Undefined]",MI=Ws?Ws.toStringTag:void 0;function _ne(t){return t==null?t===void 0?xne:yne:MI&&MI in Object(t)?fne(t):vne(t)}var Hc=_ne;function wne(t){return t!=null&&typeof t=="object"}var Za=wne,Sne="[object Symbol]";function bne(t){return typeof t=="symbol"||Za(t)&&Hc(t)==Sne}var WT=bne;function Mne(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var x5=Mne,Ane=Array.isArray,xo=Ane,Ene=1/0,AI=Ws?Ws.prototype:void 0,EI=AI?AI.toString:void 0;function _5(t){if(typeof t=="string")return t;if(xo(t))return x5(t,_5)+"";if(WT(t))return EI?EI.call(t):"";var e=t+"";return e=="0"&&1/t==-Ene?"-0":e}var Tne=_5;function Cne(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Pc=Cne;function Pne(t){return t}var Rne=Pne,Lne="[object AsyncFunction]",Dne="[object Function]",Ine="[object GeneratorFunction]",One="[object Proxy]";function Nne(t){if(!Pc(t))return!1;var e=Hc(t);return e==Dne||e==Ine||e==Lne||e==One}var w5=Nne,kne=aa["__core-js_shared__"],QS=kne,TI=function(){var t=/[^.]+$/.exec(QS&&QS.keys&&QS.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Une(t){return!!TI&&TI in t}var zne=Une,Fne=Function.prototype,Bne=Fne.toString;function Vne(t){if(t!=null){try{return Bne.call(t)}catch{}try{return t+""}catch{}}return""}var Wc=Vne,jne=/[\\^$.*+?()[\]{}|]/g,Gne=/^\[object .+?Constructor\]$/,Hne=Function.prototype,Wne=Object.prototype,$ne=Hne.toString,qne=Wne.hasOwnProperty,Xne=RegExp("^"+$ne.call(qne).replace(jne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Yne(t){if(!Pc(t)||zne(t))return!1;var e=w5(t)?Xne:Gne;return e.test(Wc(t))}var Zne=Yne;function Kne(t,e){return t==null?void 0:t[e]}var Qne=Kne;function Jne(t,e){var n=Qne(t,e);return Zne(n)?n:void 0}var $c=Jne,eie=$c(aa,"WeakMap"),I2=eie,CI=Object.create,tie=function(){function t(){}return function(e){if(!Pc(e))return{};if(CI)return CI(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),nie=tie;function iie(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var rie=iie;function sie(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var oie=sie,aie=800,lie=16,uie=Date.now;function cie(t){var e=0,n=0;return function(){var i=uie(),r=lie-(i-n);if(n=i,r>0){if(++e>=aie)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var hie=cie;function die(t){return function(){return t}}var fie=die,pie=function(){try{var t=$c(Object,"defineProperty");return t({},"",{}),t}catch{}}(),P1=pie,mie=P1?function(t,e){return P1(t,"toString",{configurable:!0,enumerable:!1,value:fie(e),writable:!0})}:Rne,gie=mie,vie=hie(gie),yie=vie;function xie(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var _ie=xie,wie=9007199254740991,Sie=/^(?:0|[1-9]\d*)$/;function bie(t,e){var n=typeof t;return e=e??wie,!!e&&(n=="number"||n!="symbol"&&Sie.test(t))&&t>-1&&t%1==0&&t<e}var $T=bie;function Mie(t,e,n){e=="__proto__"&&P1?P1(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var S5=Mie;function Aie(t,e){return t===e||t!==t&&e!==e}var qT=Aie,Eie=Object.prototype,Tie=Eie.hasOwnProperty;function Cie(t,e,n){var i=t[e];(!(Tie.call(t,e)&&qT(i,n))||n===void 0&&!(e in t))&&S5(t,e,n)}var XT=Cie;function Pie(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?S5(n,a,l):XT(n,a,l)}return n}var Lg=Pie,PI=Math.max;function Rie(t,e,n){return e=PI(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=PI(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),rie(t,this,a)}}var Lie=Rie,Die=9007199254740991;function Iie(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Die}var YT=Iie;function Oie(t){return t!=null&&YT(t.length)&&!w5(t)}var b5=Oie,Nie=Object.prototype;function kie(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Nie;return t===n}var ZT=kie;function Uie(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var zie=Uie,Fie="[object Arguments]";function Bie(t){return Za(t)&&Hc(t)==Fie}var RI=Bie,M5=Object.prototype,Vie=M5.hasOwnProperty,jie=M5.propertyIsEnumerable,Gie=RI(function(){return arguments}())?RI:function(t){return Za(t)&&Vie.call(t,"callee")&&!jie.call(t,"callee")},KT=Gie;function Hie(){return!1}var Wie=Hie,A5=typeof exports=="object"&&exports&&!exports.nodeType&&exports,LI=A5&&typeof module=="object"&&module&&!module.nodeType&&module,$ie=LI&&LI.exports===A5,DI=$ie?aa.Buffer:void 0,qie=DI?DI.isBuffer:void 0,Xie=qie||Wie,R1=Xie,Yie="[object Arguments]",Zie="[object Array]",Kie="[object Boolean]",Qie="[object Date]",Jie="[object Error]",ere="[object Function]",tre="[object Map]",nre="[object Number]",ire="[object Object]",rre="[object RegExp]",sre="[object Set]",ore="[object String]",are="[object WeakMap]",lre="[object ArrayBuffer]",ure="[object DataView]",cre="[object Float32Array]",hre="[object Float64Array]",dre="[object Int8Array]",fre="[object Int16Array]",pre="[object Int32Array]",mre="[object Uint8Array]",gre="[object Uint8ClampedArray]",vre="[object Uint16Array]",yre="[object Uint32Array]",wn={};wn[cre]=wn[hre]=wn[dre]=wn[fre]=wn[pre]=wn[mre]=wn[gre]=wn[vre]=wn[yre]=!0;wn[Yie]=wn[Zie]=wn[lre]=wn[Kie]=wn[ure]=wn[Qie]=wn[Jie]=wn[ere]=wn[tre]=wn[nre]=wn[ire]=wn[rre]=wn[sre]=wn[ore]=wn[are]=!1;function xre(t){return Za(t)&&YT(t.length)&&!!wn[Hc(t)]}var _re=xre;function wre(t){return function(e){return t(e)}}var QT=wre,E5=typeof exports=="object"&&exports&&!exports.nodeType&&exports,om=E5&&typeof module=="object"&&module&&!module.nodeType&&module,Sre=om&&om.exports===E5,JS=Sre&&v5.process,bre=function(){try{var t=om&&om.require&&om.require("util").types;return t||JS&&JS.binding&&JS.binding("util")}catch{}}(),Zd=bre,II=Zd&&Zd.isTypedArray,Mre=II?QT(II):_re,T5=Mre,Are=Object.prototype,Ere=Are.hasOwnProperty;function Tre(t,e){var n=xo(t),i=!n&&KT(t),r=!n&&!i&&R1(t),s=!n&&!i&&!r&&T5(t),o=n||i||r||s,a=o?zie(t.length,String):[],l=a.length;for(var u in t)(e||Ere.call(t,u))&&!(o&&(u=="length"||r&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||$T(u,l)))&&a.push(u);return a}var C5=Tre;function Cre(t,e){return function(n){return t(e(n))}}var P5=Cre,Pre=P5(Object.keys,Object),Rre=Pre,Lre=Object.prototype,Dre=Lre.hasOwnProperty;function Ire(t){if(!ZT(t))return Rre(t);var e=[];for(var n in Object(t))Dre.call(t,n)&&n!="constructor"&&e.push(n);return e}var Ore=Ire;function Nre(t){return b5(t)?C5(t):Ore(t)}var JT=Nre;function kre(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Ure=kre,zre=Object.prototype,Fre=zre.hasOwnProperty;function Bre(t){if(!Pc(t))return Ure(t);var e=ZT(t),n=[];for(var i in t)i=="constructor"&&(e||!Fre.call(t,i))||n.push(i);return n}var Vre=Bre;function jre(t){return b5(t)?C5(t,!0):Vre(t)}var eC=jre,Gre=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hre=/^\w*$/;function Wre(t,e){if(xo(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||WT(t)?!0:Hre.test(t)||!Gre.test(t)||e!=null&&t in Object(e)}var $re=Wre,qre=$c(Object,"create"),tg=qre;function Xre(){this.__data__=tg?tg(null):{},this.size=0}var Yre=Xre;function Zre(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Kre=Zre,Qre="__lodash_hash_undefined__",Jre=Object.prototype,ese=Jre.hasOwnProperty;function tse(t){var e=this.__data__;if(tg){var n=e[t];return n===Qre?void 0:n}return ese.call(e,t)?e[t]:void 0}var nse=tse,ise=Object.prototype,rse=ise.hasOwnProperty;function sse(t){var e=this.__data__;return tg?e[t]!==void 0:rse.call(e,t)}var ose=sse,ase="__lodash_hash_undefined__";function lse(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=tg&&e===void 0?ase:e,this}var use=lse;function yf(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}yf.prototype.clear=Yre;yf.prototype.delete=Kre;yf.prototype.get=nse;yf.prototype.has=ose;yf.prototype.set=use;var OI=yf;function cse(){this.__data__=[],this.size=0}var hse=cse;function dse(t,e){for(var n=t.length;n--;)if(qT(t[n][0],e))return n;return-1}var Yx=dse,fse=Array.prototype,pse=fse.splice;function mse(t){var e=this.__data__,n=Yx(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():pse.call(e,n,1),--this.size,!0}var gse=mse;function vse(t){var e=this.__data__,n=Yx(e,t);return n<0?void 0:e[n][1]}var yse=vse;function xse(t){return Yx(this.__data__,t)>-1}var _se=xse;function wse(t,e){var n=this.__data__,i=Yx(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var Sse=wse;function xf(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}xf.prototype.clear=hse;xf.prototype.delete=gse;xf.prototype.get=yse;xf.prototype.has=_se;xf.prototype.set=Sse;var Zx=xf,bse=$c(aa,"Map"),ng=bse;function Mse(){this.size=0,this.__data__={hash:new OI,map:new(ng||Zx),string:new OI}}var Ase=Mse;function Ese(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Tse=Ese;function Cse(t,e){var n=t.__data__;return Tse(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Kx=Cse;function Pse(t){var e=Kx(this,t).delete(t);return this.size-=e?1:0,e}var Rse=Pse;function Lse(t){return Kx(this,t).get(t)}var Dse=Lse;function Ise(t){return Kx(this,t).has(t)}var Ose=Ise;function Nse(t,e){var n=Kx(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var kse=Nse;function _f(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}_f.prototype.clear=Ase;_f.prototype.delete=Rse;_f.prototype.get=Dse;_f.prototype.has=Ose;_f.prototype.set=kse;var Qx=_f,Use="Expected a function";function tC(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Use);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(tC.Cache||Qx),n}tC.Cache=Qx;var zse=tC,Fse=500;function Bse(t){var e=zse(t,function(i){return n.size===Fse&&n.clear(),i}),n=e.cache;return e}var Vse=Bse,jse=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gse=/\\(\\)?/g,Hse=Vse(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(jse,function(n,i,r,s){e.push(r?s.replace(Gse,"$1"):i||n)}),e}),Wse=Hse;function $se(t){return t==null?"":Tne(t)}var qse=$se;function Xse(t,e){return xo(t)?t:$re(t,e)?[t]:Wse(qse(t))}var wf=Xse,Yse=1/0;function Zse(t){if(typeof t=="string"||WT(t))return t;var e=t+"";return e=="0"&&1/t==-Yse?"-0":e}var Jx=Zse;function Kse(t,e){e=wf(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[Jx(e[n++])];return n&&n==i?t:void 0}var R5=Kse;function Qse(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var nC=Qse,NI=Ws?Ws.isConcatSpreadable:void 0;function Jse(t){return xo(t)||KT(t)||!!(NI&&t&&t[NI])}var eoe=Jse;function L5(t,e,n,i,r){var s=-1,o=t.length;for(n||(n=eoe),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?L5(a,e-1,n,i,r):nC(r,a):i||(r[r.length]=a)}return r}var toe=L5;function noe(t){var e=t==null?0:t.length;return e?toe(t,1):[]}var ioe=noe;function roe(t){return yie(Lie(t,void 0,ioe),t+"")}var D5=roe,soe=P5(Object.getPrototypeOf,Object),iC=soe,ooe="[object Object]",aoe=Function.prototype,loe=Object.prototype,I5=aoe.toString,uoe=loe.hasOwnProperty,coe=I5.call(Object);function hoe(t){if(!Za(t)||Hc(t)!=ooe)return!1;var e=iC(t);if(e===null)return!0;var n=uoe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&I5.call(n)==coe}var doe=hoe;function foe(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}var poe=foe;function moe(){this.__data__=new Zx,this.size=0}var goe=moe;function voe(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var yoe=voe;function xoe(t){return this.__data__.get(t)}var _oe=xoe;function woe(t){return this.__data__.has(t)}var Soe=woe,boe=200;function Moe(t,e){var n=this.__data__;if(n instanceof Zx){var i=n.__data__;if(!ng||i.length<boe-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Qx(i)}return n.set(t,e),this.size=n.size,this}var Aoe=Moe;function Sf(t){var e=this.__data__=new Zx(t);this.size=e.size}Sf.prototype.clear=goe;Sf.prototype.delete=yoe;Sf.prototype.get=_oe;Sf.prototype.has=Soe;Sf.prototype.set=Aoe;var Ny=Sf;function Eoe(t,e){return t&&Lg(e,JT(e),t)}var Toe=Eoe;function Coe(t,e){return t&&Lg(e,eC(e),t)}var Poe=Coe,O5=typeof exports=="object"&&exports&&!exports.nodeType&&exports,kI=O5&&typeof module=="object"&&module&&!module.nodeType&&module,Roe=kI&&kI.exports===O5,UI=Roe?aa.Buffer:void 0,zI=UI?UI.allocUnsafe:void 0;function Loe(t,e){if(e)return t.slice();var n=t.length,i=zI?zI(n):new t.constructor(n);return t.copy(i),i}var Doe=Loe;function Ioe(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var Ooe=Ioe;function Noe(){return[]}var N5=Noe,koe=Object.prototype,Uoe=koe.propertyIsEnumerable,FI=Object.getOwnPropertySymbols,zoe=FI?function(t){return t==null?[]:(t=Object(t),Ooe(FI(t),function(e){return Uoe.call(t,e)}))}:N5,rC=zoe;function Foe(t,e){return Lg(t,rC(t),e)}var Boe=Foe,Voe=Object.getOwnPropertySymbols,joe=Voe?function(t){for(var e=[];t;)nC(e,rC(t)),t=iC(t);return e}:N5,k5=joe;function Goe(t,e){return Lg(t,k5(t),e)}var Hoe=Goe;function Woe(t,e,n){var i=e(t);return xo(t)?i:nC(i,n(t))}var U5=Woe;function $oe(t){return U5(t,JT,rC)}var O2=$oe;function qoe(t){return U5(t,eC,k5)}var z5=qoe,Xoe=$c(aa,"DataView"),N2=Xoe,Yoe=$c(aa,"Promise"),k2=Yoe,Zoe=$c(aa,"Set"),U2=Zoe,BI="[object Map]",Koe="[object Object]",VI="[object Promise]",jI="[object Set]",GI="[object WeakMap]",HI="[object DataView]",Qoe=Wc(N2),Joe=Wc(ng),eae=Wc(k2),tae=Wc(U2),nae=Wc(I2),$u=Hc;(N2&&$u(new N2(new ArrayBuffer(1)))!=HI||ng&&$u(new ng)!=BI||k2&&$u(k2.resolve())!=VI||U2&&$u(new U2)!=jI||I2&&$u(new I2)!=GI)&&($u=function(t){var e=Hc(t),n=e==Koe?t.constructor:void 0,i=n?Wc(n):"";if(i)switch(i){case Qoe:return HI;case Joe:return BI;case eae:return VI;case tae:return jI;case nae:return GI}return e});var ig=$u,iae=Object.prototype,rae=iae.hasOwnProperty;function sae(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&rae.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var oae=sae,aae=aa.Uint8Array,L1=aae;function lae(t){var e=new t.constructor(t.byteLength);return new L1(e).set(new L1(t)),e}var sC=lae;function uae(t,e){var n=e?sC(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var cae=uae,hae=/\w*$/;function dae(t){var e=new t.constructor(t.source,hae.exec(t));return e.lastIndex=t.lastIndex,e}var fae=dae,WI=Ws?Ws.prototype:void 0,$I=WI?WI.valueOf:void 0;function pae(t){return $I?Object($I.call(t)):{}}var mae=pae;function gae(t,e){var n=e?sC(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var vae=gae,yae="[object Boolean]",xae="[object Date]",_ae="[object Map]",wae="[object Number]",Sae="[object RegExp]",bae="[object Set]",Mae="[object String]",Aae="[object Symbol]",Eae="[object ArrayBuffer]",Tae="[object DataView]",Cae="[object Float32Array]",Pae="[object Float64Array]",Rae="[object Int8Array]",Lae="[object Int16Array]",Dae="[object Int32Array]",Iae="[object Uint8Array]",Oae="[object Uint8ClampedArray]",Nae="[object Uint16Array]",kae="[object Uint32Array]";function Uae(t,e,n){var i=t.constructor;switch(e){case Eae:return sC(t);case yae:case xae:return new i(+t);case Tae:return cae(t,n);case Cae:case Pae:case Rae:case Lae:case Dae:case Iae:case Oae:case Nae:case kae:return vae(t,n);case _ae:return new i;case wae:case Mae:return new i(t);case Sae:return fae(t);case bae:return new i;case Aae:return mae(t)}}var zae=Uae;function Fae(t){return typeof t.constructor=="function"&&!ZT(t)?nie(iC(t)):{}}var Bae=Fae,Vae="[object Map]";function jae(t){return Za(t)&&ig(t)==Vae}var Gae=jae,qI=Zd&&Zd.isMap,Hae=qI?QT(qI):Gae,Wae=Hae,$ae="[object Set]";function qae(t){return Za(t)&&ig(t)==$ae}var Xae=qae,XI=Zd&&Zd.isSet,Yae=XI?QT(XI):Xae,Zae=Yae,Kae=1,Qae=2,Jae=4,F5="[object Arguments]",ele="[object Array]",tle="[object Boolean]",nle="[object Date]",ile="[object Error]",B5="[object Function]",rle="[object GeneratorFunction]",sle="[object Map]",ole="[object Number]",V5="[object Object]",ale="[object RegExp]",lle="[object Set]",ule="[object String]",cle="[object Symbol]",hle="[object WeakMap]",dle="[object ArrayBuffer]",fle="[object DataView]",ple="[object Float32Array]",mle="[object Float64Array]",gle="[object Int8Array]",vle="[object Int16Array]",yle="[object Int32Array]",xle="[object Uint8Array]",_le="[object Uint8ClampedArray]",wle="[object Uint16Array]",Sle="[object Uint32Array]",mn={};mn[F5]=mn[ele]=mn[dle]=mn[fle]=mn[tle]=mn[nle]=mn[ple]=mn[mle]=mn[gle]=mn[vle]=mn[yle]=mn[sle]=mn[ole]=mn[V5]=mn[ale]=mn[lle]=mn[ule]=mn[cle]=mn[xle]=mn[_le]=mn[wle]=mn[Sle]=!0;mn[ile]=mn[B5]=mn[hle]=!1;function ky(t,e,n,i,r,s){var o,a=e&Kae,l=e&Qae,u=e&Jae;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!Pc(t))return t;var d=xo(t);if(d){if(o=oae(t),!a)return oie(t,o)}else{var c=ig(t),h=c==B5||c==rle;if(R1(t))return Doe(t,a);if(c==V5||c==F5||h&&!r){if(o=l||h?{}:Bae(t),!a)return l?Hoe(t,Poe(o,t)):Boe(t,Toe(o,t))}else{if(!mn[c])return r?t:{};o=zae(t,c,a)}}s||(s=new Ny);var f=s.get(t);if(f)return f;s.set(t,o),Zae(t)?t.forEach(function(y){o.add(ky(y,e,n,y,t,s))}):Wae(t)&&t.forEach(function(y,v){o.set(v,ky(y,e,n,v,t,s))});var m=u?l?z5:O2:l?eC:JT,x=d?void 0:m(t);return _ie(x||t,function(y,v){x&&(v=y,y=t[v]),XT(o,v,ky(y,e,n,v,t,s))}),o}var j5=ky,ble=1,Mle=4;function Ale(t){return j5(t,ble|Mle)}var e_=Ale,Ele="__lodash_hash_undefined__";function Tle(t){return this.__data__.set(t,Ele),this}var Cle=Tle;function Ple(t){return this.__data__.has(t)}var Rle=Ple;function D1(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Qx;++e<n;)this.add(t[e])}D1.prototype.add=D1.prototype.push=Cle;D1.prototype.has=Rle;var Lle=D1;function Dle(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var Ile=Dle;function Ole(t,e){return t.has(e)}var Nle=Ole,kle=1,Ule=2;function zle(t,e,n,i,r,s){var o=n&kle,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var u=s.get(t),d=s.get(e);if(u&&d)return u==e&&d==t;var c=-1,h=!0,f=n&Ule?new Lle:void 0;for(s.set(t,e),s.set(e,t);++c<a;){var m=t[c],x=e[c];if(i)var y=o?i(x,m,c,e,t,s):i(m,x,c,t,e,s);if(y!==void 0){if(y)continue;h=!1;break}if(f){if(!Ile(e,function(v,_){if(!Nle(f,_)&&(m===v||r(m,v,n,i,s)))return f.push(_)})){h=!1;break}}else if(!(m===x||r(m,x,n,i,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var G5=zle;function Fle(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var Ble=Fle;function Vle(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var jle=Vle,Gle=1,Hle=2,Wle="[object Boolean]",$le="[object Date]",qle="[object Error]",Xle="[object Map]",Yle="[object Number]",Zle="[object RegExp]",Kle="[object Set]",Qle="[object String]",Jle="[object Symbol]",eue="[object ArrayBuffer]",tue="[object DataView]",YI=Ws?Ws.prototype:void 0,eb=YI?YI.valueOf:void 0;function nue(t,e,n,i,r,s,o){switch(n){case tue:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case eue:return!(t.byteLength!=e.byteLength||!s(new L1(t),new L1(e)));case Wle:case $le:case Yle:return qT(+t,+e);case qle:return t.name==e.name&&t.message==e.message;case Zle:case Qle:return t==e+"";case Xle:var a=Ble;case Kle:var l=i&Gle;if(a||(a=jle),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;i|=Hle,o.set(t,e);var d=G5(a(t),a(e),i,r,s,o);return o.delete(t),d;case Jle:if(eb)return eb.call(t)==eb.call(e)}return!1}var iue=nue,rue=1,sue=Object.prototype,oue=sue.hasOwnProperty;function aue(t,e,n,i,r,s){var o=n&rue,a=O2(t),l=a.length,u=O2(e),d=u.length;if(l!=d&&!o)return!1;for(var c=l;c--;){var h=a[c];if(!(o?h in e:oue.call(e,h)))return!1}var f=s.get(t),m=s.get(e);if(f&&m)return f==e&&m==t;var x=!0;s.set(t,e),s.set(e,t);for(var y=o;++c<l;){h=a[c];var v=t[h],_=e[h];if(i)var w=o?i(_,v,h,e,t,s):i(v,_,h,t,e,s);if(!(w===void 0?v===_||r(v,_,n,i,s):w)){x=!1;break}y||(y=h=="constructor")}if(x&&!y){var b=t.constructor,E=e.constructor;b!=E&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof E=="function"&&E instanceof E)&&(x=!1)}return s.delete(t),s.delete(e),x}var lue=aue,uue=1,ZI="[object Arguments]",KI="[object Array]",$v="[object Object]",cue=Object.prototype,QI=cue.hasOwnProperty;function hue(t,e,n,i,r,s){var o=xo(t),a=xo(e),l=o?KI:ig(t),u=a?KI:ig(e);l=l==ZI?$v:l,u=u==ZI?$v:u;var d=l==$v,c=u==$v,h=l==u;if(h&&R1(t)){if(!R1(e))return!1;o=!0,d=!1}if(h&&!d)return s||(s=new Ny),o||T5(t)?G5(t,e,n,i,r,s):iue(t,e,l,n,i,r,s);if(!(n&uue)){var f=d&&QI.call(t,"__wrapped__"),m=c&&QI.call(e,"__wrapped__");if(f||m){var x=f?t.value():t,y=m?e.value():e;return s||(s=new Ny),r(x,y,n,i,s)}}return h?(s||(s=new Ny),lue(t,e,n,i,r,s)):!1}var due=hue;function H5(t,e,n,i,r){return t===e?!0:t==null||e==null||!Za(t)&&!Za(e)?t!==t&&e!==e:due(t,e,n,i,H5,r)}var fue=H5;function pue(t,e){return t!=null&&e in Object(t)}var mue=pue;function gue(t,e,n){e=wf(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=Jx(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&YT(r)&&$T(o,r)&&(xo(t)||KT(t)))}var vue=gue;function yue(t,e){return t!=null&&vue(t,e,mue)}var xue=yue;function _ue(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var wue=_ue;function Sue(t,e){return e.length<2?t:R5(t,poe(e,0,-1))}var bue=Sue;function Mue(t,e){return fue(t,e)}var Aue=Mue;function Eue(t,e){return e=wf(e,t),t=bue(t,e),t==null||delete t[Jx(wue(e))]}var Tue=Eue;function Cue(t){return doe(t)?void 0:t}var Pue=Cue,Rue=1,Lue=2,Due=4,Iue=D5(function(t,e){var n={};if(t==null)return n;var i=!1;e=x5(e,function(s){return s=wf(s,t),i||(i=s.length>1),s}),Lg(t,z5(t),n),i&&(n=j5(n,Rue|Lue|Due,Pue));for(var r=e.length;r--;)Tue(n,e[r]);return n}),z2=Iue;function Oue(t,e,n,i){if(!Pc(t))return t;e=wf(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=Jx(e[r]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var d=a[l];u=i?i(d,l,a):void 0,u===void 0&&(u=Pc(d)?d:$T(e[r+1])?[]:{})}XT(a,l,u),a=a[l]}return t}var Nue=Oue;function kue(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var o=e[i],a=R5(t,o);n(a,o)&&Nue(s,wf(o,t),a)}return s}var Uue=kue;function zue(t,e){return Uue(t,e,function(n,i){return xue(t,i)})}var Fue=zue,Bue=D5(function(t,e){return t==null?{}:Fue(t,e)}),Ql=Bue,Nt=class{modifyById(t,e){let n=this;if(n[t]===void 0)throw new Error("not expected");{let i={...n,[t]:e};return Object.setPrototypeOf(i,Nt.prototype),i}}add(t,e){var n;return((n=this.runOp({type:1,id:t,data:e}))==null?void 0:n.data)??this}runOp(t){let e=this;if(t.type===1){let n=e[t.id],i;n===void 0?i={type:2,id:t.id}:i={type:1,id:t.id,data:n};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,Nt.prototype),{data:o,actual:t,reverse:i}}else if(t.type===2){let{id:n}=t,i=e[n];if(i===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,Nt.prototype),delete r[n],{data:r,actual:t,reverse:{type:1,id:n,data:i}}}}return null}};function oC(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let n of e){let i=t[n];i&&typeof i=="object"&&oC(i)}return Object.freeze(t)}function Vue(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var W5=class extends Error{};function tb(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function Dl(t,e,n){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;i.push(o)}return i}function aC(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function jue(){return typeof process<"u"}function $5(t,e){for(let n of t)e(n.id,n.data)!==!0&&$5(n.children,e)}function q5(t,e){if(e(t.id,t.data)!==!0)for(let n of t.children)q5(n,e)}var Hr=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Hr.prototype)}deepFreeze(){let t=0;for(;t<this.length;)oC(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let n of t.children)this.fillCaches0(n,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}rootAcestor(t){for(;t;){let e=this.parent(t);if(e)t=e;else return t}return t}isDescendantOf(t,e){for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let n=this.get(t);n&&q5(n,e)}}traverse(t){$5(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this.parent(t),i=this.childrenArray(n),r=i.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:e},this.modifyArrayBy(n,i)}}modifyArrayBy(t,e){let n=t,i=e;for(;n!==null;){let s=i,o=n;if(n=this.parent(n),n===void 0)throw new Error;i=this.childrenArray(n);let a=i.findIndex(l=>l.id===o);if(a<0)throw new Error;i=[...i],i[a]={...i[a],children:s}}Object.setPrototypeOf(i,Hr.prototype);let r=i;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let n of e)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(t){let{parent:e,fi:n,id:i,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:n,id:i,data:r,children:s};return a=[...a,l],a.sort((u,d)=>u.fi-d.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:i}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let n=this.parent(e);if(n===void 0)return null;let i=this.childrenArray(n),r=i.findIndex(o=>o.id===e);t.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:t,reverse:{type:7,...s,parent:n}}}}moveOp(t){let{parent:e,fi:n,id:i}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:i});if(e!==null){let c=e;for(;c!==null;){if(c===void 0)throw new Error;if(c===i)throw new W5("cyclic tree");c=this.parent(c)}}let r=this.parent(i);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(c=>c.id===i);o=[...o];let l=o.splice(a,1)[0],u=this.modifyArrayBy(r,o);r=e,o=u.childrenArray(r);let d=l.fi;return l={...l,fi:n},o=[...o,l],o.sort((c,h)=>c.fi-h.fi),t.localIndex=o.indexOf(l),u=u.modifyArrayBy(r,o),{data:u,actual:t,reverse:{type:9,parent:s,fi:d,id:i}}}previous(t,e){if(e===null){let i=this.childrenArray(t);return i.length===0?null:i[i.length-1].id}let n=null;for(let i of this.childrenArray(t)){if(i.id===e)return n;n=i.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)+1;if(i<n.length)return n[i].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)-1;return i>=0?this.traverseSortPrevious(n[i].id):e}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push({...n,...i})}e.sort((n,i)=>Vue(n.sortKey,i.sortKey));for(let n of e)delete n.sortKey;return e}getWithSortKey(t){var e=t;let n=[],i=this.get(e),r=i;if(i!==void 0){for(;e;)n.splice(0,0,i.fi),e=this.parent(e),e!==null&&(i=this.get(e));return{...r,sortKey:n}}}insertBeforeHelper(t,e,n){return this.insertAfterHelper(t,this.previous(t,e),n)}insertAfterHelper(t,e,n){let i=this.childrenArray(t);if(e===null){if(i.length===0)return Dl(0,n,n);{let r=i[0].fi;return Dl(r-n,r,n)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return Dl(o,o+n,n)}else return Dl(r.fi,s.fi,n)}}},I1;(t=>{function e(n,i){if(i.type!==0)return null;if(Array.isArray(n)){let r=i.props,s={},o=[...n],a=!1;if(r)for(let l of Object.keys(r)){let u=parseInt(l);if(isNaN(u))throw new Error("wrong index");s[l]=o[u],o[u]=r[l],a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}else{let r=i.props,s={},o={...n},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let u=r[l];u===void 0?delete o[l]:o[l]=u,a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}}t.runOp=e})(I1||(I1={}));var Yt=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Yt.prototype)}deepFreeze(){let t=0;for(;t<this.length;)oC(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){var e;return(e=this.get(t))==null?void 0:e.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this,i=n.findIndex(s=>s.id===t);if(i<0)throw new Error("not expected");let r=n[i];return n=[...n],n[i]={...r,data:e},this.modifyArrayBy(n)}}modifyArrayBy(t){Object.setPrototypeOf(t,Yt.prototype);let e=t;return jue()||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:n,data:i}=t,r=this,s={fi:e,id:n,data:i};return r=[...r,s],r.sort((o,a)=>o.fi-a.fi),t.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:t,reverse:{type:5,id:n}}}deleteOp(t){let{id:e}=t,n=this,i=n.findIndex(s=>s.id===e);if(i===-1)return null;t.localIndex=i,n=[...n];let r=n.splice(i,1)[0];return{data:this.modifyArrayBy(n),actual:t,reverse:{type:4,...r}}}moveOp(t){let{fi:e,id:n}=t,i=this;i=[...i];let r=i.findIndex(a=>a.id===n);if(r===-1)return null;let s=i[r].fi,o={...i[r],fi:e};return i[r]=o,i.sort((a,l)=>a.fi-l.fi),t.localIndex=i.indexOf(o),{data:this.modifyArrayBy(i),actual:t,reverse:{type:6,fi:s,id:n}}}previous(t){if(t===null)return this.length===0?null:this[this.length-1].id;let e=null;for(let n of this){if(n.id===t)return e;e=n.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let n=this;if(t===null){if(n.length===0)return Dl(0,e,e);{let i=n[0].fi;return Dl(i-e,i,e)}}else{let i=this.get(t);if(i===void 0)throw new Error("illegal args");let r=n.find(s=>s.fi>i.fi);if(r===void 0){let s=n[n.length-1].fi;return Dl(s,s+e,e)}else return Dl(i.fi,r.fi,e)}}};function Kd(t){return t&&typeof t=="object"&&t instanceof _i}var _i=class{unusedFunOverridesTable(t){}runOp(t){let e=[],n=this,i=0,r={};for(;i<t.path.length;){if(e.push(n),n=n===void 0?void 0:n[t.path[i]],n!==void 0&&!Kd(n))return null;i+=1}n=n?tb(n):new _i;for(let[a,l]of Object.entries(t.props)){let u=n[a];r[a]=u,l===void 0?delete n[a]:n[a]=l}for(;i>0;){if(Object.keys(n).length===0){let a=e[i-1];a&&(n=tb(a),delete n[t.path[i-1]])}else{let a=e[i-1];if(a){let l=tb(a);l[t.path[i-1]]=n,n=l}else{let l=new _i;l[t.path[i-1]]=n,n=l}}i-=1}let s=Object.setPrototypeOf(n,_i.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},Jl;(t=>{function e(r,s){return rg(r,s)??r}t.apply=e;function n(r,s){return uC(r,s)}t.merge=n;function i(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=yr.zoomOnce(l,a[o]),l===void 0)return s;if(!Kd(l))return;o+=1}if(l===void 0)return s;if(Kd(l))if(s.type===0){let u={...s.props};for(let d of Object.keys(l))delete u[d];return{...s,props:u}}else if(s.type===1||s.type===4||s.type===7){let u=lC([s],l);return u?(console.log(u),u):s}else return s}t.filterOp=i})(Jl||(Jl={}));function lC(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=rg(r.data,e[s]);if(n=n||o!==void 0,o===void 0&&(o=r.data),r.children){let a=lC(r.children,e);return a!==void 0?n=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(n)return i}function Gue(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=rg(r.data,e[s]);return n=n||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}function rg(t,e){if(!Kd(e))return e;if(t instanceof Hr){let n=lC(t,e);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof Yt)return Gue(t,e);if(Array.isArray(t)){let n=!1,i=t.map((r,s)=>{let o=rg(r,e[s]);return n=n||o!==void 0,o===void 0&&(o=r),o});return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else{if(t instanceof _i)return uC(t,e);if(t&&typeof t=="object"){let n={},i=!1;for(let[r,s]of Object.entries(t)){let o=rg(s,e[r]);i=i||o!==void 0,o===void 0&&(o=s),n[r]=o}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}}}}function uC(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!Kd(e))return e;if(!Kd(t))return Jl.apply(t,e);let n=new Set;for(let r of Object.keys(t))n.add(r);for(let r of Object.keys(e))n.add(r);let i=new _i;for(let r of n){let s=uC(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);i[r]=s}return i}function Hue(t,e){let n={cur:[],result:[],len:0};return t=sg(t,e,n)??t,[t,n.result]}function O1(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function N1(t){t&&(t.len-=1)}function Wue(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function X5(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=sg(s.data,e,O1(n,o));N1(n),i=i||l!==void 0,l===void 0&&(l=s.data);let u=X5(s.children,e,n);return u!==void 0?i=!0:u=s.children,{...s,id:o,data:l,children:u}});if(i)return r}function $ue(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=sg(s.data,e,O1(n,o));return N1(n),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function sg(t,e,n){if(t instanceof Hr){let i=X5(t,e,n);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof Yt)return $ue(t,e,n);if(Array.isArray(t)){let i=!1,r=t.map((s,o)=>{let a=sg(s,e,O1(n,o));return N1(n),i=i||a!==void 0,a===void 0&&(a=s),a});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!aC(t)){let i={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"){let a=e[s];if(typeof a=="string"){if(n!==null)throw new Error("not supported");r=!0,s=a}let l=sg(o,e,O1(n,s));N1(n),r=r||l!==void 0,l===void 0&&(l=o),i[s]=l}else i[s]=o;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else if(typeof t=="string"){let i=e[t];return i!==void 0&&Wue(n),i}else return}}var F2;(t=>{function e(n,i){let r=yr.zoom(i,n.path);if(typeof r=="object"){let s={};for(let o of Object.keys(n.props))s[o]=r[o];return{...n,props:s}}else return{...n,props:{}}}t.replaceProps=e})(F2||(F2={}));var nr;(t=>{function e(l,u){return{...l,path:l.path.slice(u)}}t.drop=e;function n(l,u){var d;return((d=i(l,u))==null?void 0:d.data)??l}t.applySimple=n;function i(l,u){var h,f;let d=u.path;for(var c=[];;){let m;if(l instanceof _i&&u.type===0&&(m=l.runOp({...u,path:d.slice(c.length)}),m===null&&(m=void 0)),m===void 0&&c.length===d.length&&(l instanceof Hr||l instanceof Yt||l instanceof Nt?m=l.runOp(u):m=I1.runOp(l,u)),m!==void 0)if(m!==null){let v=m.data;for(let _=c.length-1;_>=0;_--){let w=d[_],b=c[_];if(b instanceof Hr){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof Yt){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof Nt){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof _i){let E={...b,[w]:v};v=Object.setPrototypeOf(E,_i.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof w=="string"&&(w=parseInt(w),isNaN(w)))throw new Error("Invalid path");let E=v;v=[...b],v[w]=E}else v={...b,[w]:v};else return null}return{data:v,actual:{...m.actual,path:d},reverse:{...m.reverse,path:d}}}else return null;let x=d[c.length],y;if(l instanceof Hr){if(typeof x=="number")throw new Error("");y=(h=l.get(x))==null?void 0:h.data}else if(l instanceof Yt){if(typeof x=="number")throw new Error("");y=(f=l.get(x))==null?void 0:f.data}else l!==null&&(y=l[x]);if(y!==void 0)c.push(l),l=y;else return null}}t.apply=i;function r(l,u){for(let d=0;d<l.length&&d<u.length;d++)if(l[d]!==u[d])return!0;return!1}t.pathDisjoint=r;function s(l,u){if(l.length!==u.length)return!1;for(let d=0;d<l.length;d++)if(l[d]!==u[d])return!1;return!0}t.pathEq=s;function o(l,u){return r(l.path,u.path)}t.commutative=o;function a(l,u){return l.type===0&&u.type===0&&s(l.path,u.path)?Object.keys(l.props).every(d=>u.props[d]!==void 0):!1}t.subsumed=a})(nr||(nr={}));var B2;(t=>{function e(){return[]}t.empty=e;function n(u,d){let c=[];for(let h of u){let[f,...m]=h.path;f===d&&c.push({...h,path:m})}return c}t.removePrefix=n;function i(u,d){return u.map(c=>({...c,path:[d,...c.path]}))}t.addPrefix=i;function r(u,d){return[...u,...d]}t.concat=r;function s(u,d){return[...u.filter(c=>!d.some(h=>nr.subsumed(c,h))),...d]}t.compress=s;function o(u,d){return u.every(c=>d.every(h=>nr.commutative(c,h)))}t.commutative=o;function a(u,d){for(let c of d){let h=l(u,c);h!==null&&(u=h.data)}return u}t.applyAll=a;function l(u,d){var c=u;let h=[],f=[];for(let m of d)try{if(m.type===3||m.type===5&&m.path[m.path.length-1]==="variables"){let x,y,v;if(m.type===3?(x=yr.zoom(c,[...m.path,m.id]),v=nr.apply(c,{...m,type:2})):(x=yr.zoom(c,[...m.path,m.id,"value"]),v=nr.apply(c,m)),v!==null){c=v.data;let[_,w]=Hue(c,{[m.id]:x});c=_;for(let b=0;b<w.length;b++){let E=w[b],A=E.pop();if(typeof A=="number"){let T=[A];for(let P=b+1;P<w.length;P++){let C=w[P],D=C[C.length-1];if(typeof D=="number"&&yr.equal(E,C.slice(0,C.length-1)))T.push(D),w.splice(P,1);else break}let L=yr.zoom(c,E);y=L.map((P,C)=>T.includes(C)?m.id:P),x=L,A=E.pop()}else{if(A==="alphaOverride"||A==="alpha"){x/=100;let T=x,L=yr.zoom(c,E.slice(0,E.length-2)),P=L.layers.map(C=>C.id===E[E.length-1]?{...C,data:{...C.data,[A]:T}}:C);Object.setPrototypeOf(P,Object.getPrototypeOf(L.layers)),L.layers=P}y=m.id}h.push({type:0,path:E,props:{[A]:x}}),f.push({type:0,path:E,props:{[A]:y}})}f.push(v.reverse),h.push(v.actual)}}else{let x=nr.apply(c,m);x!==null&&(h.push(x.actual),c=x.data,f.push(x.reverse))}}catch(x){if(x instanceof W5)return null;throw x}return{data:c,actual:h,reverse:f.reverse()}}t.apply=l})(B2||(B2={}));var Y5=Symbol(),que=Symbol(),t_=Symbol(),Dg=class{reportOp(t,e,n=[]){let i=this;if(e===null)return;i._current=e.data;let r=n;for(;!(i instanceof K5);){let s=i._path,o=i._current;if(s!==""&&r.splice(0,0,s),i=i._parent,i===null)return;i.update(s,o)}i.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let n=e[t_];n&&n(),delete this._children[t]}}}},Xue=class extends Dg{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,I1.runOp(this._current,t),t.path)}},Yue=class extends Dg{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,Nt.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},Z5={get(t,e){if(e===t_)return()=>{t._parent=null};if(e===Y5)return t._current;if(e===que)return t;let{_current:n,_children:i}=t;if(e==="push"&&Array.isArray(n))throw new Error("not supported to expand array");let r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=n[e],o=n_(t,e,s);return o!==s?(i===void 0&&(i={},t._children=i),i[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let n=t._current,i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[e]}}},Zue={...Z5,set(t,e,n){let i={type:0,props:{[e]:di(n)??n}};return t.deleteChildren(e),t.runOp(i),!0},deleteProperty(t,e){let n={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(n),!0}},Kue={...Z5,set(t,e,n){return n===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:n})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},cC=class extends Dg{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[t_]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,n)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=n_(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}add(t,e,n,i,r){this.runOp({type:7,parent:t,fi:e,id:n,data:i,children:r})}move(t,e,n){this.runOp({type:9,parent:t,fi:e,id:n})}insertAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}insertBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}moveAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}moveBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},hC=class extends Dg{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[t_]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id,r=this._current[n].fi;t(this.data(this._current[n].id),i,r)}}find(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id;if(t(this.data(i),i))return this.get(i)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=n_(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,n){this.runOp({type:4,fi:t,id:e,data:n})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}insertBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}moveAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}moveBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function nb(t,e,n){if(t.length>0){let i=t[t.length-1];if(i.type===0&&e.type===0&&yr.equal(i.path,n)){Object.assign(i.props,e.props);return}}t.push({...e,path:n})}var K5=class extends Dg{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,n,i){nb(this.ts,e,t),nb(this.actual,n,t),nb(this.reverse,i,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function n_(t,e,n){return n instanceof Hr?new cC(t,e,n):n instanceof Yt?new hC(t,e,n):n instanceof Nt?new Proxy(new Yue(t,e,n),Kue):n!==null&&typeof n=="object"?aC(n)?n:new Proxy(new Xue(t,e,n),Zue):n}function Q5(t){let e=new K5(t);return[n_(e,"",t),e]}function og(t,e){let[n,i]=Q5(t);return e(n),i.result()}function di(t){return t instanceof cC||t instanceof hC?t._current:t!==null&&typeof t=="object"?t[Y5]:t}var yr;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function n(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let u={...o};return Object.keys(l).forEach(d=>{delete u[d]}),u}else return o}t.removeOverridden=n;function i(s,o){if((s instanceof Hr||s instanceof cC)&&typeof o=="string"||(s instanceof Yt||s instanceof hC)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=i;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=i(s,o[a]),a+=1;return s}t.zoom=r})(yr||(yr={}));function Que(t,e){let n=[];if(e.length===t.length)for(var i=0;i<t.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}function ks(t,e){let n=[];if(e.length<=t.length)for(var i=0;i<e.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}var J5=class{},JI=class extends J5{constructor(t){super(),this.id=t}},eO=class extends J5{constructor(t){super(),this.data=t}},V2;try{V2=new TextDecoder}catch{}var et,eu,de=0,Ur={},nn,Il,Rs=0,Wo=0,ts,Ba,Mr=[],sn,tO={useRecords:!1,mapsAsObjects:!0},eV=class{},tV=new eV;tV.name="MessagePack 0xC1";var Qd=!1,k1=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(et)return aV(()=>(G2(),this?this.unpack(t,e):k1.prototype.unpack.call(tO,t,e)));eu=e>-1?e:t.length,de=0,Wo=0,Il=null,ts=null,et=t;try{sn=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(n){throw et=null,t instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof k1){if(Ur=this,this.structures)return nn=this.structures,qv();(!nn||nn.length>0)&&(nn=[])}else Ur=tO,(!nn||nn.length>0)&&(nn=[]);return qv()}unpackMultiple(t,e){let n,i=0;try{Qd=!0;let r=t.length,s=this?this.unpack(t,r):r_.unpack(t,r);if(e){for(e(s);de<r;)if(i=de,e(qv())===!1)return}else{for(n=[s];de<r;)i=de,n.push(qv());return n}}catch(r){throw r.lastPosition=i,r.values=n,r}finally{Qd=!1,G2()}}_mergeStructures(t,e){t=t||[];for(let n=0,i=t.length;n<i;n++){let r=t[n];r&&(r.isShared=!0,n>=32&&(r.highByte=n-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let i=t[n],r=e[n];r&&(i&&((t.restoreStructures||(t.restoreStructures=[]))[n]=i),t[n]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function qv(){try{if(!Ur.trusted&&!Qd){let e=nn.sharedLength||0;e<nn.length&&(nn.length=e)}let t=Wn();if(de==eu)nn.restoreStructures&&nO(),nn=null,et=null,Ba&&(Ba=null);else if(de>eu){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!Qd)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw nn.restoreStructures&&nO(),G2(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function nO(){for(let t in nn.restoreStructures)nn[t]=nn.restoreStructures[t];nn.restoreStructures=null}function Wn(){let t=et[de++];if(t<160)if(t<128){if(t<64)return t;{let e=nn[t&63]||Ur.getStructures&&nV()[t&63];return e?(e.read||(e.read=dC(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Ur.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[rV()]=Wn();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Wn(),Wn());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Wn();return e}else if(t<192){let e=t-160;if(Wo>=de)return Il.slice(de-Rs,(de+=e)-Rs);if(Wo==0&&eu<140){let n=e<16?fC(e):iV(e);if(n!=null)return n}return j2(e)}else{let e;switch(t){case 192:return null;case 193:return ts?(e=Wn(),e>0?ts[1].slice(ts.position1,ts.position1+=e):ts[0].slice(ts.position0,ts.position0-=e)):tV;case 194:return!1;case 195:return!0;case 196:return ib(et[de++]);case 197:return e=sn.getUint16(de),de+=2,ib(e);case 198:return e=sn.getUint32(de),de+=4,ib(e);case 199:return Uu(et[de++]);case 200:return e=sn.getUint16(de),de+=2,Uu(e);case 201:return e=sn.getUint32(de),de+=4,Uu(e);case 202:if(e=sn.getFloat32(de),Ur.useFloat32>2){let n=pC[(et[de]&127)<<1|et[de+1]>>7];return de+=4,(n*e+(e>0?.5:-.5)>>0)/n}return de+=4,e;case 203:return e=sn.getFloat64(de),de+=8,e;case 204:return et[de++];case 205:return e=sn.getUint16(de),de+=2,e;case 206:return e=sn.getUint32(de),de+=4,e;case 207:return Ur.int64AsNumber?(e=sn.getUint32(de)*4294967296,e+=sn.getUint32(de+4)):e=sn.getBigUint64(de),de+=8,e;case 208:return sn.getInt8(de++);case 209:return e=sn.getInt16(de),de+=2,e;case 210:return e=sn.getInt32(de),de+=4,e;case 211:return Ur.int64AsNumber?(e=sn.getInt32(de)*4294967296,e+=sn.getUint32(de+4)):e=sn.getBigInt64(de),de+=8,e;case 212:if(e=et[de++],e==114)return aO(et[de++]&63);{let n=Mr[e];if(n)return n.read?(de++,n.read(Wn())):n.noBuffer?(de++,n()):n(et.subarray(de,++de));throw new Error("Unknown extension "+e)}case 213:return e=et[de],e==114?(de++,aO(et[de++]&63,et[de++])):Uu(2);case 214:return Uu(4);case 215:return Uu(8);case 216:return Uu(16);case 217:return e=et[de++],Wo>=de?Il.slice(de-Rs,(de+=e)-Rs):ece(e);case 218:return e=sn.getUint16(de),de+=2,Wo>=de?Il.slice(de-Rs,(de+=e)-Rs):tce(e);case 219:return e=sn.getUint32(de),de+=4,Wo>=de?Il.slice(de-Rs,(de+=e)-Rs):nce(e);case 220:return e=sn.getUint16(de),de+=2,rO(e);case 221:return e=sn.getUint32(de),de+=4,rO(e);case 222:return e=sn.getUint16(de),de+=2,sO(e);case 223:return e=sn.getUint32(de),de+=4,sO(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}var Jue=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function dC(t,e){function n(){if(n.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>Jue.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Wn);return t.highByte===0&&(t.read=iO(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let o=t[r];i[o]=Wn()}return i}return n.count=0,t.highByte===0?iO(e,n):n}var iO=(t,e)=>function(){let n=et[de++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=nn[i]||nV()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=dC(r,t)),r.read()};function nV(){let t=aV(()=>(et=null,Ur.getStructures()));return nn=Ur._mergeStructures(t,nn)}var j2=i_,ece=i_,tce=i_,nce=i_;function i_(t){let e;if(t<16&&(e=fC(t)))return e;if(t>64&&V2)return V2.decode(et.subarray(de,de+=t));let n=de+t,i=[];for(e="";de<n;){let r=et[de++];if(!(r&128))i.push(r);else if((r&224)===192){let s=et[de++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){let s=et[de++]&63,o=et[de++]&63;i.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=et[de++]&63,o=et[de++]&63,a=et[de++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(r);i.length>=4096&&(e+=Li.apply(String,i),i.length=0)}return i.length>0&&(e+=Li.apply(String,i)),e}function rO(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Wn();return e}function sO(t){if(Ur.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[rV()]=Wn();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Wn(),Wn());return e}}var Li=String.fromCharCode;function iV(t){let e=de,n=new Array(t);for(let i=0;i<t;i++){let r=et[de++];if((r&128)>0){de=e;return}n[i]=r}return Li.apply(String,n)}function fC(t){if(t<4)if(t<2){if(t===0)return"";{let e=et[de++];if((e&128)>1){de-=1;return}return Li(e)}}else{let e=et[de++],n=et[de++];if((e&128)>0||(n&128)>0){de-=2;return}if(t<3)return Li(e,n);let i=et[de++];if((i&128)>0){de-=3;return}return Li(e,n,i)}else{let e=et[de++],n=et[de++],i=et[de++],r=et[de++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){de-=4;return}if(t<6){if(t===4)return Li(e,n,i,r);{let s=et[de++];if((s&128)>0){de-=5;return}return Li(e,n,i,r,s)}}else if(t<8){let s=et[de++],o=et[de++];if((s&128)>0||(o&128)>0){de-=6;return}if(t<7)return Li(e,n,i,r,s,o);let a=et[de++];if((a&128)>0){de-=7;return}return Li(e,n,i,r,s,o,a)}else{let s=et[de++],o=et[de++],a=et[de++],l=et[de++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){de-=8;return}if(t<10){if(t===8)return Li(e,n,i,r,s,o,a,l);{let u=et[de++];if((u&128)>0){de-=9;return}return Li(e,n,i,r,s,o,a,l,u)}}else if(t<12){let u=et[de++],d=et[de++];if((u&128)>0||(d&128)>0){de-=10;return}if(t<11)return Li(e,n,i,r,s,o,a,l,u,d);let c=et[de++];if((c&128)>0){de-=11;return}return Li(e,n,i,r,s,o,a,l,u,d,c)}else{let u=et[de++],d=et[de++],c=et[de++],h=et[de++];if((u&128)>0||(d&128)>0||(c&128)>0||(h&128)>0){de-=12;return}if(t<14){if(t===12)return Li(e,n,i,r,s,o,a,l,u,d,c,h);{let f=et[de++];if((f&128)>0){de-=13;return}return Li(e,n,i,r,s,o,a,l,u,d,c,h,f)}}else{let f=et[de++],m=et[de++];if((f&128)>0||(m&128)>0){de-=14;return}if(t<15)return Li(e,n,i,r,s,o,a,l,u,d,c,h,f,m);let x=et[de++];if((x&128)>0){de-=15;return}return Li(e,n,i,r,s,o,a,l,u,d,c,h,f,m,x)}}}}}function ib(t){return Ur.copyBuffers?Uint8Array.prototype.slice.call(et,de,de+=t):et.subarray(de,de+=t)}function Uu(t){let e=et[de++];if(Mr[e])return Mr[e](et.subarray(de,de+=t));throw new Error("Unknown extension type "+e)}var oO=new Array(4096);function rV(){let t=et[de++];if(t>=160&&t<192){if(t=t-160,Wo>=de)return Il.slice(de-Rs,(de+=t)-Rs);if(!(Wo==0&&eu<180))return j2(t)}else return de--,Wn();let e=(t<<5^(t>1?sn.getUint16(de):t>0?et[de]:0))&4095,n=oO[e],i=de,r=de+t-3,s,o=0;if(n&&n.bytes==t){for(;i<r;){if(s=sn.getUint32(i),s!=n[o++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=et[i++],s!=n[o++]){i=1879048192;break}if(i===r)return de=i,n.string;r-=3,i=de}for(n=[],oO[e]=n,n.bytes=t;i<r;)s=sn.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=et[i++],n.push(s);let a=t<16?fC(t):iV(t);return a!=null?n.string=a:n.string=j2(t)}var aO=(t,e)=>{var n=Wn();let i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=nn[t];return r&&r.isShared&&((nn.restoreStructures||(nn.restoreStructures=[]))[t]=r),nn[t]=n,n.read=dC(n,i),n.read()},sV=typeof self=="object"?self:global;Mr[0]=()=>{};Mr[0].noBuffer=!0;Mr[101]=()=>{let t=Wn();return(sV[t[0]]||Error)(t[1])};Mr[105]=t=>{let e=sn.getUint32(de-4);Ba||(Ba=new Map);let n=et[de],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};Ba.set(e,r);let s=Wn();return r.used?Object.assign(i,s):(r.target=s,s)};Mr[112]=t=>{let e=sn.getUint32(de-4),n=Ba.get(e);return n.used=!0,n.target};Mr[115]=()=>new Set(Wn());var oV=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");Mr[116]=t=>{let e=t[0],n=oV[e];if(!n)throw new Error("Could not find typed array for code "+e);return new sV[n](Uint8Array.prototype.slice.call(t,1).buffer)};Mr[120]=()=>{let t=Wn();return new RegExp(t[0],t[1])};Mr[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=de;de+=e-4,ts=[Wn(),Wn()],ts.position0=0,ts.position1=0;let i=de;de=n;try{return Wn()}finally{de=i}};Mr[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function aV(t){let e=eu,n=de,i=Rs,r=Wo,s=Il,o=Ba,a=ts,l=new Uint8Array(et.slice(0,eu)),u=nn,d=nn.slice(0,nn.length),c=Ur,h=Qd,f=t();return eu=e,de=n,Rs=i,Wo=r,Il=s,Ba=o,ts=a,et=l,Qd=h,nn=u,nn.splice(0,nn.length,...d),Ur=c,sn=new DataView(et.buffer,et.byteOffset,et.byteLength),f}function G2(){et=null,Ba=null,nn=null}function ice(t){t.unpack?Mr[t.type]=t.unpack:Mr[t.type]=t}var pC=new Array(147);for(let t=0;t<256;t++)pC[t]=+("1e"+Math.floor(45.15-t*.30103));var r_=new k1({useRecords:!1});r_.unpack;r_.unpackMultiple;r_.unpack;var rce=new Float32Array(1);new Uint8Array(rce.buffer,0,4);var Uy;try{Uy=new TextEncoder}catch{}var U1,mC,s_=typeof Buffer<"u",rb=s_?Buffer.allocUnsafeSlow:Uint8Array,lV=s_?Buffer:Uint8Array,lO=s_?4294967296:2144337920,Pe,Qn,ye=0,Oo,No=null,sce=/[\u0080-\uFFFF]/,vp=Symbol("record-id"),uV=class extends k1{constructor(t){super(t),this.offset=0;let e,n,i,r,s,o=0,a=lV.prototype.utf8Write?function(A,T,L){return Pe.utf8Write(A,T,L)}:Uy&&Uy.encodeInto?function(A,T){return Uy.encodeInto(A,Pe.subarray(T)).written}:!1,l=this;t||(t={});let u=t&&t.sequential,d=t.structures||t.saveStructures,c=t.maxSharedStructures;if(c==null&&(c=d?32:0),c>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=t.maxOwnStructures;h==null&&(h=d?32:64),u&&!t.saveStructures&&(this.structures=[]);let f=c>32||h+c>64,m=c+64,x=c+h+64;if(x>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let y=[],v=0,_=0;this.pack=this.encode=function(A,T){if(Pe||(Pe=new rb(8192),Qn=new DataView(Pe.buffer,0,8192),ye=0),Oo=Pe.length-10,Oo-ye<2048?(Pe=new rb(Pe.length),Qn=new DataView(Pe.buffer,0,Pe.length),Oo=Pe.length-10,ye=0):ye=ye+7&2147483640,e=ye,s=l.structuredClone?new Map:null,l.bundleStrings?(No=["",""],Pe[ye++]=214,Pe[ye++]=98,No.position=ye-e,ye+=4):No=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let L=n.sharedLength||0;if(L>c)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let P=0;P<L;P++){let C=n[P];if(!C)continue;let D,U=n.transitions;for(let G=0,k=C.length;G<k;G++){let H=C[G];D=U[H],D||(D=U[H]=Object.create(null)),U=D}U[vp]=P+64}o=L}u||(n.nextId=L+64)}i&&(i=!1),r=n||[];try{if(w(A),No){Qn.setUint32(No.position+e,ye-No.position-e);let L=No;No=null,w(L[0]),w(L[1])}if(l.offset=ye,s&&s.idsToInsert){ye+=s.idsToInsert.length*6,ye>Oo&&E(ye),l.offset=ye;let L=ace(Pe.subarray(e,ye),s.idsToInsert);return s=null,L}return T&lce?(Pe.start=e,Pe.end=ye,Pe):Pe.subarray(e,ye)}finally{if(n){if(_<10&&_++,v>1e4)n.transitions=null,_=0,v=0,y.length>0&&(y=[]);else if(y.length>0&&!u){for(let L=0,P=y.length;L<P;L++)y[L][vp]=0;y=[]}if(i&&l.saveStructures){let L=n.sharedLength||c;n.length>L&&(n=n.slice(0,L));let P=Pe.subarray(e,ye);return l.saveStructures(n,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(A)):(o=L,P)}}T&uce&&(ye=e)}};let w=A=>{ye>Oo&&(Pe=E(ye));var T=typeof A,L;if(T==="string"){let P=A.length;if(No&&P>=8&&P<4096){let U=sce.test(A);No[U?0:1]+=A,Pe[ye++]=193,w(U?-P:P);return}let C;P<32?C=1:P<256?C=2:P<65536?C=3:C=5;let D=P*3;if(ye+D>Oo&&(Pe=E(ye+D)),P<64||!a){let U,G,k,H=ye+C;for(U=0;U<P;U++)G=A.charCodeAt(U),G<128?Pe[H++]=G:G<2048?(Pe[H++]=G>>6|192,Pe[H++]=G&63|128):(G&64512)===55296&&((k=A.charCodeAt(U+1))&64512)===56320?(G=65536+((G&1023)<<10)+(k&1023),U++,Pe[H++]=G>>18|240,Pe[H++]=G>>12&63|128,Pe[H++]=G>>6&63|128,Pe[H++]=G&63|128):(Pe[H++]=G>>12|224,Pe[H++]=G>>6&63|128,Pe[H++]=G&63|128);L=H-ye-C}else L=a(A,ye+C,D);L<32?Pe[ye++]=160|L:L<256?(C<2&&Pe.copyWithin(ye+2,ye+1,ye+1+L),Pe[ye++]=217,Pe[ye++]=L):L<65536?(C<3&&Pe.copyWithin(ye+3,ye+2,ye+2+L),Pe[ye++]=218,Pe[ye++]=L>>8,Pe[ye++]=L&255):(C<5&&Pe.copyWithin(ye+5,ye+3,ye+3+L),Pe[ye++]=219,Qn.setUint32(ye,L),ye+=4),ye+=L}else if(T==="number")if(A>>>0===A)A<64?Pe[ye++]=A:A<256?(Pe[ye++]=204,Pe[ye++]=A):A<65536?(Pe[ye++]=205,Pe[ye++]=A>>8,Pe[ye++]=A&255):(Pe[ye++]=206,Qn.setUint32(ye,A),ye+=4);else if(A>>0===A)A>=-32?Pe[ye++]=256+A:A>=-128?(Pe[ye++]=208,Pe[ye++]=A+256):A>=-32768?(Pe[ye++]=209,Qn.setInt16(ye,A),ye+=2):(Pe[ye++]=210,Qn.setInt32(ye,A),ye+=4);else{let P;if((P=this.useFloat32)>0&&A<4294967296&&A>=-2147483648){Pe[ye++]=202,Qn.setFloat32(ye,A);let C;if(P<4||(C=A*pC[(Pe[ye]&127)<<1|Pe[ye+1]>>7])>>0===C){ye+=4;return}else ye--}Pe[ye++]=203,Qn.setFloat64(ye,A),ye+=8}else if(T==="object")if(!A)Pe[ye++]=192;else{if(s){let C=s.get(A);if(C){if(!C.id){let D=s.idsToInsert||(s.idsToInsert=[]);C.id=D.push(C)}Pe[ye++]=214,Pe[ye++]=112,Qn.setUint32(ye,C.id),ye+=4;return}else s.set(A,{offset:ye-e})}let P=A.constructor;if(P===Object)b(A,!0);else if(P===Array){L=A.length,L<16?Pe[ye++]=144|L:L<65536?(Pe[ye++]=220,Pe[ye++]=L>>8,Pe[ye++]=L&255):(Pe[ye++]=221,Qn.setUint32(ye,L),ye+=4);for(let C=0;C<L;C++)w(A[C])}else if(P===Map){L=A.size,L<16?Pe[ye++]=128|L:L<65536?(Pe[ye++]=222,Pe[ye++]=L>>8,Pe[ye++]=L&255):(Pe[ye++]=223,Qn.setUint32(ye,L),ye+=4);for(let[C,D]of A)w(C),w(D)}else{for(let C=0,D=U1.length;C<D;C++){let U=mC[C];if(A instanceof U){let G=U1[C];if(G.write){G.type&&(Pe[ye++]=212,Pe[ye++]=G.type,Pe[ye++]=0),w(G.write.call(this,A));return}let k=Pe,H=Qn,K=ye;Pe=null;let q;try{q=G.pack.call(this,A,N=>(Pe=k,k=null,ye+=N,ye>Oo&&E(ye),{target:Pe,targetView:Qn,position:ye-N}),w)}finally{k&&(Pe=k,Qn=H,ye=K,Oo=Pe.length-10)}q&&(q.length+ye>Oo&&E(q.length+ye),ye=oce(q,Pe,ye,G.type));return}}b(A,!A.hasOwnProperty)}}else if(T==="boolean")Pe[ye++]=A?195:194;else if(T==="bigint"){if(A<BigInt(1)<<BigInt(63)&&A>=-(BigInt(1)<<BigInt(63)))Pe[ye++]=211,Qn.setBigInt64(ye,A);else if(A<BigInt(1)<<BigInt(64)&&A>0)Pe[ye++]=207,Qn.setBigUint64(ye,A);else if(this.largeBigIntToFloat)Pe[ye++]=203,Qn.setFloat64(ye,Number(A));else throw new RangeError(A+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ye+=8}else if(T==="undefined")this.encodeUndefinedAsNil?Pe[ye++]=192:(Pe[ye++]=212,Pe[ye++]=0,Pe[ye++]=0);else if(T==="function")w(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+T)},b=this.useRecords===!1?this.variableMapSize?A=>{let T=Object.keys(A),L=T.length;L<16?Pe[ye++]=128|L:L<65536?(Pe[ye++]=222,Pe[ye++]=L>>8,Pe[ye++]=L&255):(Pe[ye++]=223,Qn.setUint32(ye,L),ye+=4);let P;for(let C=0;C<L;C++)w(P=T[C]),w(A[P])}:(A,T)=>{Pe[ye++]=222;let L=ye-e;ye+=2;let P=0;for(let C in A)(T||A.hasOwnProperty(C))&&(w(C),w(A[C]),P++);Pe[L+++e]=P>>8,Pe[L+e]=P&255}:A=>{let T=Object.keys(A),L,P=r.transitions||(r.transitions=Object.create(null)),C=0;for(let U=0,G=T.length;U<G;U++){let k=T[U];L=P[k],L||(L=P[k]=Object.create(null),C++),P=L}let D=P[vp];if(D)D>=96&&f?(Pe[ye++]=((D-=96)&31)+96,Pe[ye++]=D>>5):Pe[ye++]=D;else{D=r.nextId,D||(D=64),D<m&&this.shouldShareStructure&&!this.shouldShareStructure(T)?(D=r.nextOwnId,D<x||(D=m),r.nextOwnId=D+1):(D>=x&&(D=m),r.nextId=D+1);let U=T.highByte=D>=96&&f?D-96>>5:-1;P[vp]=D,r[D-64]=T,D<m?(T.isShared=!0,r.sharedLength=D-63,i=!0,U>=0?(Pe[ye++]=(D&31)+96,Pe[ye++]=U):Pe[ye++]=D):(U>=0?(Pe[ye++]=213,Pe[ye++]=114,Pe[ye++]=(D&31)+96,Pe[ye++]=U):(Pe[ye++]=212,Pe[ye++]=114,Pe[ye++]=D),C&&(v+=_*C),y.length>=h&&(y.shift()[vp]=0),y.push(P),w(T))}for(let U=0,G=T.length;U<G;U++)w(A[T[U]])},E=A=>{let T;if(A>16777216){if(A-e>lO)throw new Error("Packed buffer would be larger than maximum buffer size");T=Math.min(lO,Math.round(Math.max((A-e)*(A>67108864?1.25:2),4194304)/4096)*4096)}else T=(Math.max(A-e<<2,Pe.length-1)>>12)+1<<12;let L=new rb(T);return Qn=new DataView(L.buffer,0,T),Pe.copy?Pe.copy(L,0,e,A):L.set(Pe.slice(e,A)),ye-=e,e=0,Oo=L.length-10,Pe=L}}useBuffer(t){Pe=t,Qn=new DataView(Pe.buffer,Pe.byteOffset,Pe.byteLength),ye=0}};mC=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,eV];U1=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){let i=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.structuredClone?uO(t,16,e):cO(s_?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==lV&&this.structuredClone?uO(t,oV.indexOf(n.name),e):cO(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function uO(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=n(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=n(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=n(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function cO(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function oce(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function ace(t,e){let n,i=e.length*6,r=t.length-i;for(e.sort((s,o)=>s.offset>o.offset?1:-1);n=e.pop();){let s=n.offset,o=n.id;t.copyWithin(s+i,s,r),i-=6;let a=s+i;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function bf(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");mC.unshift(t.Class),U1.unshift(t)}ice(t)}var cV=new uV({useRecords:!1});cV.pack;cV.pack;var lce=512,uce=1024,hO=new uV({structuredClone:!0});bf({Class:Nt.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Nt.prototype),t}});bf({Class:Yt.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,Yt.prototype),t}});bf({Class:Hr.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,Hr.prototype),t}});bf({Class:JI.prototype.constructor,type:4,write(t){return t.id},read(t){return new JI(t)}});bf({Class:eO.prototype.constructor,type:5,write(t){return t.data},read(t){return new eO(t)}});bf({Class:_i.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,_i.prototype),t}});function cce(t){var e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){let i=t[n];e=(e<<5)-e+i,e=e&e}return e}function H2(t){if(aC(t))return t;if(Array.isArray(t))return t.map(H2);if(typeof t=="object"&&t!==null){let e={};for(let n of Object.keys(t).sort())e[n]=H2(t[n]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var W2;(t=>{function e(r){return hO.pack(r)}t.serialize=e;function n(r){return hO.unpack(r)}t.deserialize=n;function i(r){return cce(e(H2(r))).toString()}t.checksum=i})(W2||(W2={}));var o_="personal camera",am="a218fcc3-276b-49b9-b485-49037fd14f5f",hce=2960946,$s=5526619,dO;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s]}t.lerp=n})(dO||(dO={}));var Md;(t=>{function e(l,u){return l[0]===u[0]&&l[1]===u[1]&&l[2]===u[2]}t.isEqual=e;function n(l,u){return[l[0]+u[0],l[1]+u[1],l[2]+u[2]]}t.add=n;function i(l,u){return[l[0]-u[0],l[1]-u[1],l[2]-u[2]]}t.sub=i;function r(l,u){return[l[0]/u[0],l[1]/u[1],l[2]/u[2]]}t.div=r;function s(l,u){return[l[0]*u[0],l[1]*u[1],l[2]*u[2]]}t.mul=s;function o(l,u){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])}t.dist=o;function a(l,u,d){return[l[0]+(u[0]-l[0])*d,l[1]+(u[1]-l[1])*d,l[2]+(u[2]-l[2])*d]}t.lerp=a})(Md||(Md={}));var fO;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s,i[2]+(r[2]-i[2])*s,i[3]+(r[3]-i[3])*s]}t.lerp=n})(fO||(fO={}));var Jd;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function n(r){return r??t.identity}t.simplify=n;function i(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let u=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/u,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/u,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/u}return o}t.applyMatrix4=i})(Jd||(Jd={}));var mr;(t=>{function e(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function n(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}t.toRgb255a1=n;function i(l){return{r:l.r,g:l.g,b:l.b}}t.clone=i;function r(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}t.fromHex=r;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}t.toHex=s;function o(l,u){return l.r===u.r&&l.g===u.g&&l.b===u.b}t.equals=o;function a(l,u,d){return{r:l.r+(u.r-l.r)*d,g:l.g+(u.g-l.g)*d,b:l.b+(u.b-l.b)*d}}t.lerp=a})(mr||(mr={}));var oo;(t=>{t.white={...mr.white,a:1},t.transparent={...mr.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function n(o,a){return{...mr.fromHex(o),a}}t.fromHexAndA=n;function i(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=i;function r(o,a){return mr.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(oo||(oo={}));var $2;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})($2||($2={}));var pO;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(pO||(pO={}));var mO;(t=>t.defaultData={control1:[.5,0],control2:[.5,1]})(mO||(mO={}));var gO;(t=>(t.linear=[0,0,1,1],t.ease=[.25,.1,.25,1],t.easeIn=[.42,0,1,1],t.easeOut=[0,0,.58,1],t.easeInOut=[.42,0,.58,1]))(gO||(gO={}));function dce(t){return typeof t=="string"&&t.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t):!1}var Rc;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(n){return t.all.includes(n)}t.is=e})(Rc||(Rc={}));var ef;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(n){return n.type==="PerspectiveCamera"?n.perspective.zoom:n.orthographic.zoom}t.getZoom=e})(ef||(ef={}));var Ol;(t=>{function e(i,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*r,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function n(i,r){let s={...i};if(fce.forEach(o=>{Object.assign(s,{[o]:r[o]??i[o]})}),s.radial={...i.radial},r.radial){let o=i.radial,a=r.radial;pce.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...i.linear},r.linear){let o=i.linear,a=r.linear;mce.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...i.grid},r.grid){let o=i.grid,a=r.grid;gce.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...i.toObject},r.toObject){let o=i.toObject,a=r.toObject;vce.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...i.randomnessObject},r.randomnessObject){let o=i.randomnessObject,a=r.randomnessObject;yce.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=n})(Ol||(Ol={}));var q2;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function n(i,r){let s=[];i.count!==void 0&&s.push({type:0,path:r,props:{count:i.count}});for(let o of e){let a=i[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=n})(q2||(q2={}));var fce=["count"],pce=["radius","start","end","position","scale","rotation"],mce=["position","scale","rotation"],gce=["count","size"],vce=["count","position","scale","rotation"],yce=["strength","scale","rotation","position","movement","seed","freqScale"],X2;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(n){return t.all.includes(n)}t.is=e})(X2||(X2={}));var Y2;(t=>{function e(i){return n(i)}t.defaultData=e;function n(i){if(i==="PointLight")return{type:i,color:oo.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:oo.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:oo.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(Y2||(Y2={}));var tf;(t=>t.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(tf||(tf={}));var Z2;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(n,i){return n.castShadow===i.castShadow&&n.receiveShadow===i.receiveShadow}t.equals=e})(Z2||(Z2={}));var K2;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(n,i){return n.flatShading===i.flatShading&&n.side===i.side&&n.wireframe===i.wireframe}t.equals=e})(K2||(K2={}));var Q2;(t=>t.defaultData={...K2.defaultData,...Z2.defaultData})(Q2||(Q2={}));var vO;(t=>{function e(n,i){var s,o;let r=[];if("material"in n){let a=typeof n.material=="string"?i.materials[n.material]??((s=i.lib.materials[n.material])==null?void 0:s.asset):n.material;a&&r.push(a)}else if("materials"in n)for(let a of n.materials){let l=typeof a=="string"?i.materials[a]??((o=i.lib.materials[a])==null?void 0:o.asset):a;l&&r.push(l)}return r}t.getMaterialData=e})(vO||(vO={}));var z1;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(z1||(z1={}));var yO;(t=>{function e(n){return n==="texture"||n==="video"||n==="color"||n==="depth"||n==="normal"||n==="gradient"||n==="noise"||n==="fresnel"||n==="rainbow"||n==="toon"||n==="outline"||n==="transmission"||n==="matcap"||n==="displace"||n==="pattern"||n==="light"}t.is=e})(yO||(yO={}));function xce(t){return t.type!=="displace"}var xO;(t=>{function e(n){return n==="phong"||n==="toon"||n==="lambert"||n==="physical"}t.is=e})(xO||(xO={}));var _ce=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],wce=["wrapping","image","video","name"],Os;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let u=s.texture;u&&Object.assign(u,a)}}t.patch=e;function n(s,o){return s==="light"&&o?i(o):r(s)}t.defaultData=n;function i(s){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function r(s){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:z1.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...o,type:"color",color:mr.fromHex($s)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...mr.fromHex(6710886),a:1},colorB:{...mr.fromHex(6710886),a:1},colorC:{...mr.fromHex(16777215),a:1},colorD:{...mr.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:oo.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:oo.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:oo.fromHexAndA(0,1),contourColor:oo.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...mr.fromHex(0),a:1},colorB:{...mr.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Os||(Os={}));var as;(t=>{function e(u){return!u.layers.some(d=>d.data.type==="texture"&&d.data.projection!==0||d.data.type==="depth"&&!d.data.isWorldSpace||d.data.type==="noise"||d.data.type==="displace")}t.isMergable=e;function n(u){let d="";return u.layers.forEach(c=>{Object.entries(c.data).forEach(([h,f])=>{d+=`${h}${f}`,Array.isArray(f)?f.forEach(m=>d+=`${m}`):typeof f=="object"?Object.values(f).forEach(m=>{typeof m=="number"?d+=`${m.toFixed(4)}`:d+=`${m}`}):d+=`${f}`})}),d}t.getHash=n;function i(){return{layers:new Yt}}t.defaultEmptyData=i;function r(u="layer1",d="layer2"){return o("phong",u,d)}t.defaultData=r;function s(u,d){return{...u,name:d}}t.withName=s;function o(u,d="layer1",c="layer2"){let h=new Yt;return h.push({fi:0,data:Os.defaultData("light",u),id:d}),h.push({fi:1,data:Os.defaultData("color"),id:c}),{layers:h}}t.defaultTwoLayerData=o;function a(u,d="phong",c="layer1",h="layer2"){let f=Os.defaultData("texture");Object.assign(f.texture,{image:u});let m=new Yt;return m.push({fi:0,data:f,id:c}),m.push({fi:1,data:Os.defaultData("light",d),id:h}),{layers:m}}t.defaultTwoLayerTextureData=a;function l(u,d="phong",c="layer1",h="layer2"){let f=Os.defaultData("video");Object.assign(f.texture,{video:u});let m=new Yt;return m.push({fi:0,data:f,id:c}),m.push({fi:1,data:Os.defaultData("light",d),id:h}),{layers:m}}t.defaultTwoLayerVideoTextureData=l})(as||(as={}));var F1;(t=>{function e(){return{points:new Yt,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(F1||(F1={}));var B1;(t=>{function e(){return{points:new Yt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(B1||(B1={}));var hV={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},J2;(t=>{function e(n,i){let r={...n};return Sce.forEach(s=>{Object.assign(r,{[s]:i[s]??n[s]})}),r}t.merge=e})(J2||(J2={}));var dV={shape:hV,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},Sce=["depth","offset","angle","twist","startScale","endScale"],V1;(t=>{function e(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"}t.is2DParametricMesh=e;function n(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}t.isParametricMesh=n})(V1||(V1={}));var eA;(t=>{function e(n,i){let r={...n};return Object.assign(r,i),r.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(r.extrusion={...n.extrusion},Object.assign(r.extrusion,J2.merge(r.extrusion,i.extrusion))),r}t.merge=e})(eA||(eA={}));var Ad;(t=>{function e(n){if(n==="RectangleGeometry")return{width:320,height:320,type:n,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="PathGeometry")return{type:n,width:1,height:1,depth:1,path:B1.defaultData(),extrusion:dV};if(n==="VectorGeometry")return{width:1,height:1,type:n,subdivisions:12,shape:F1.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="BooleanGeometry")return{type:n,operation:2,width:0,height:0,depth:0,phongAngle:35};if(n==="TextGeometry")return{type:n,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}t.defaultData=e})(Ad||(Ad={}));var tA;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:mr.white,near:.1,far:2e3})(tA||(tA={}));var nA;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(nA||(nA={}));var iA;(t=>t.defaultData={softShadowQuality:"low"})(iA||(iA={}));var rA;(t=>t.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(rA||(rA={}));var sA;(t=>t.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(sA||(sA={}));var j1;(t=>t.defaultData={usePhysics:!1,gravity:-10})(j1||(j1={}));var oA;(t=>t.defaultData={playCamera:o_,gameControlObject:null})(oA||(oA={}));var aA;(t=>t.defaultData={backgroundColor:oo.fromHexAndA(hce,1),postprocessing:nA.defaultData,fog:tA.defaultData,globalPhysics:j1.defaultData,ambient:rA.defaultData,ao:sA.defaultData,shadow:iA.defaultData,publish:oA.defaultData})(aA||(aA={}));var _O;(t=>{function e(i){return i==="Component"||i==="Instance"}t.isComponentRelated=e;function n(i){return i==="Empty"||i==="Instance"}t.isEmptyOrComponent=n})(_O||(_O={}));var nf;(t=>{t.identity={...$2.identity,hiddenMatrix:Jd.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function n(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=n;function i(r,s){return rne({position:Md.isEqual(r.position,s.position)?void 0:s.position,rotation:Md.isEqual(r.rotation,s.rotation)?void 0:s.rotation,scale:Md.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:Jd.isEqual(r.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}t.diff=i})(nf||(nf={}));var br;(t=>t.defaultData={states:new Yt,events:new Yt,visible:!0,raycastLock:!1,physics:tf.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...nf.identity,cloner:null})(br||(br={}));var lA;(t=>t.defaultData={type:"Empty",...br.defaultData})(lA||(lA={}));var wO;(t=>t.defaultData={type:"Component",...br.defaultData})(wO||(wO={}));var Ed;(t=>t.defaultData={type:"Mesh",...br.defaultData,...Q2.defaultData})(Ed||(Ed={}));var ag;(t=>t.defaultData={...br.defaultData,...nf.identity,position:[0,0,ef.DefaultTargetOffset],...ef.defaultData})(ag||(ag={}));var uA;(t=>{function e(n){return{...br.defaultData,...Y2.defaultData(n)}}t.defaultData=e,t.defaultDirectionalLightData={...t.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(uA||(uA={}));var G1;(t=>{function e(i,r,s=0){for(;s<r.length;){let o=i?i[r[s]]:void 0;if(r.length===s+1)return o;if(o)i=o.descendants,s+=1;else return}}t.resolveWithDes=e;function n(i,r,s=0){let o=e(i,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=n})(G1||(G1={}));var Nl;(t=>{t.rootOverrideProps=["physics","events"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(i,r){return{...br.defaultData,...r,component:i,overrides:new _i,physics:void 0,events:void 0,type:"Instance"}}t.ofComponent=e;function n(i){let r=nf.fromObject(i.data);return e(i.id,r)}t.fromComponentData=n})(Nl||(Nl={}));var rf;(t=>t.defaultData={type:"Page",...br.defaultData,physics:{...tf.defaultData,fusedBody:!1},...aA.defaultData,camera:ag.defaultData})(rf||(rf={}));var cA;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Jd.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:tf.defaultData,states:new Yt,events:new Yt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...ef.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...br.defaultData,...Ed.defaultData,geometry:Ad.defaultData("RectangleGeometry"),material:as.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...br.defaultData,...Ed.defaultData,geometry:Ad.defaultData("BooleanGeometry"),material:as.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...br.defaultData,...Ed.defaultData,geometry:Ad.defaultData("TextGeometry"),material:as.defaultTwoLayerData("phong","layer1","layer2")}))(cA||(cA={}));var md;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new _i}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new _i})))):Rc.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function n(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=og(a.material,l=>{if(typeof l!="string")for(let[u,d]of Object.entries(o.material.layers)){let c=l.layers.data(u);c&&Os.patch(c,d)}}).data),a.materials&&o.materials&&(a.materials=og(a.materials,l=>{var u,d;for(let c=0;c<a.materials.length;c++){let h=o.materials[c];if(typeof h!="string")for(let[f,m]of Object.entries(h.layers)){let x=(d=(u=l[c])==null?void 0:u.layers)==null?void 0:d.data(f);x&&Os.patch(x,m)}}}).data),a}function i(s,o){let a,l=[],u={orthographic:0,perspective:0,geometry:0};function d(c,h){for(let[f,m]of Object.entries(h.layers)){let{texture:x,...y}=m;if(x!==void 0&&Object.keys(x).length>0){let v={path:[...c,"layers",f,"texture"],props:x,type:0};l.push(v)}if(Object.keys(y).length>0){let v={path:[...c,"layers",f],props:y,type:0};l.push(v)}}}for(let[c,h]of Object.entries(o))if(c!=="name")if(c==="cloner")l.push(...q2.toOps(h,["cloner"]));else if(c==="pathSnapping")l.push({path:[c],props:{slide:h.slide,offset:h.offset},type:0});else if(c==="material")d(["material"],h);else if(c==="materials")for(let[f,m]of Object.entries(h))d(["materials",f],m);else if(u[c]===0){if(c==="geometry"&&h.extrusion!==void 0){let f={path:[c,"extrusion"],props:h.extrusion,type:0};l.push(f),h={...h},delete h.extrusion}if(Object.keys(h).length>0){let f={path:[c],props:h,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[c]=h;return l}t.toOps=i;function r(s,o){var l,u,d,c,h,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,nf.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((u=a.pathSnapping)==null?void 0:u.slide)??0,offset:((d=o.pathSnapping)==null?void 0:d.offset)??((c=a.pathSnapping)==null?void 0:c.offset)??0})}),Rc.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let m=o;((h=m.orthographic)==null?void 0:h.zoom)!==void 0&&(a.orthographic.zoom=m.orthographic.zoom),((f=m.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=m.perspective.zoom),m.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=m.isUpVectorFlipped),m.targetOffset!==void 0&&(a.targetOffset=m.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:eA.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=n(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:Ol.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:Ol.merge(a.cloner,o.cloner)});else if(X2.is(s.type)){let m=o;m.intensity!==void 0&&(a.intensity=m.intensity),m.color!==void 0&&(typeof m.color=="string"?a.color=m.color:a.color=mr.clone(m.color))}return a}t.patch=r})(md||(md={}));var H1;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(H1||(H1={}));var mc;(t=>t.defaultData={orbitControls:H1.defaultData,playPage:am,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((e,n)=>{let i=0,r=0;return n<5?r=-30:n<10&&(r=30),n===0||n===10||n===5?i=30:(n===4||n===11||n===9)&&(i=-30),[120,[i,r],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(mc||(mc={}));var hA;(t=>t.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(hA||(hA={}));var dA;(t=>t.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(dA||(dA={}));var Td;(t=>(t.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...hA.defaultData},isRandomSeed:!0,seed:t.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:dA.defaultData}),t.generateSeed=()=>Math.round(Math.random()*1e5)))(Td||(Td={}));var SO;(t=>{function e(i){return i.find(r=>r.data.type==="Page"&&r.data.globalPhysics.usePhysics)!==void 0}t.physicsEnabled=e;function n(i,r,s){i.scene.objects.traverseFrom(r,(o,a)=>{var l;if(a.type==="Instance"){let u=(l=$1.getComponentData(i,a.component))==null?void 0:l.data;u&&s(o,a,u.events)}else s(o,a,a.events)})}t.traverseModuleInstances=n})(SO||(SO={}));var Cd;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(r={withLight:!0,withSquare:!0}){let s=[],o=cA.defaultMeshObject;r.withLight===!0&&s.push({fi:-1,data:uA.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]});let a=new Hr;return a.push({fi:1,id:am,data:{...rf.defaultData,name:"Scene 1"},children:s}),a}t.defaultData={objects:e(),publish:mc.defaultData,styles:Td.defaultData()},t.emptyDataWithoutPage=function(){return{objects:new Hr,publish:mc.defaultData,styles:Td.defaultData()}},t.emptyDataWithPage=function(r){return{objects:e(r),publish:mc.defaultData,styles:Td.defaultData()}};function n(r){return{...t.defaultData,objects:Ya(r,Hr.prototype)}}t.withObjs=n;function i(r,s){return n([{id:r,data:s,children:[],fi:0}])}t.withObj=i})(Cd||(Cd={}));var lm;(t=>t.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(lm||(lm={}));var W1;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(W1||(W1={}));var fA;(t=>{function e(o){return o.textValue!==void 0}t.isTextValue=e;function n(o){return typeof o=="number"}t.isNumber=n;function i(o){return typeof o=="boolean"}t.isBoolean=i;function r(o){return e(o)?"string":i(o)?"boolean":"number"}t.typeOfVariable=r;function s(o){return t.isTextValue(o)?Array.isArray(o.textValue)?o.textValue.map(a=>a.toString().padStart(o.padding??2,"0")).join(o.deliminator??":")+(o.suffix!==void 0?" "+o.suffix:""):o.textValue.toString():t.isBoolean(o)?o?"True":"False":t.isNumber(o)?parseFloat(o.toFixed(3)).toString():o.toString()}t.getDisplayedValue=s})(fA||(fA={}));var pA;(t=>t.all=["images","videos","colors","audios","fonts","materials","variables"])(pA||(pA={}));var bO;(t=>t.all=[...pA.all,"components"])(bO||(bO={}));var MO;(t=>{function e(){return{images:new Nt,videos:new Nt,colors:new Nt,audios:new Nt,fonts:new Nt,materials:new Nt,components:new Nt,variables:new Nt}}t.defaultData=e})(MO||(MO={}));var sf;(t=>{function e(){return{images:new Nt,videos:new Nt,colors:new Nt,audios:new Nt,fonts:new Nt,materials:new Nt,components:new Nt,variables:new Nt}}t.defaultData=e})(sf||(sf={}));var Ra;(t=>{function e(){let o={};return o["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Ya(o,Nt.prototype)}t.defaultColors=e;function n(o){let a={};return o!=null&&o.withAITexture&&(a["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...W1.emptyImage,name:"AI generated image"}),Ya(a,Nt.prototype)}t.defaultImages=n;function i(){return{catelogs:new Nt,materials:new Nt,images:new Nt,videos:new Nt,colors:new Nt,audios:new Nt,fonts:new Nt,variables:new Yt,lib:sf.defaultData()}}t.emptyData=i;function r(o){switch(o){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let a=[0,0,0];return{name:"Time",value:{textValue:a,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:a,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",o)}}t.defaultVariables=r;function s(o,a){if(a.format==="HH:mm:ss"){let l=Math.floor(o/3600),u=Math.floor((o-l*3600)/60),d=Math.round(o-l*3600-u*60);return{textValue:[l,u,d]}}else if(a.format==="mm:ss"){let l=Math.floor(o/60),u=Math.round(o-l*60);return{textValue:[l,u]}}else return a.format==="number"?o=Math.round(o):o=Math.round(o*1e3)/1e3,o}t.getFormattedTimerTime=s})(Ra||(Ra={}));var mA;(t=>t.list=["idle","move","jump","run"])(mA||(mA={}));var gA;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Yt,move:new Yt,jump:new Yt,run:new Yt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:oo.fromHexAndA(3728051,1)}}))(gA||(gA={}));function AO(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let n=e.colorA,i=e.colorB,r=[[n.r,n.g,n.b,n.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...Ql(di(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let n={...di(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,n)}})}function El(t,e){Object.values(t.shared.materials).forEach(n=>e(n))}function Tl(t,e){t.scene.objects.traverse((n,i)=>{"materials"in i?i.materials.forEach((r,s)=>{r===void 0&&(i.materials[s]=as.defaultData(),r=i.materials[s]),typeof r!="string"&&e(r)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=as.defaultData()),e(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=as.defaultData()),e(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(r=>{r.material&&typeof r.material!="string"&&e(r.material)})})}function bce(t){Object.assign(t.scene.publish,{orbitControls:{...H1.defaultData,...di(t.scene.publish.orbitControls)}})}function Mce(t){Object.assign(t.scene.publish.settings,{video:{...mc.defaultData.settings.video,...di(t.scene.publish.settings.video)}})}function Ace(t){function e(n){if(n.layers){for(let i of Object.values(n.layers))if(i){for(let[r,s]of Object.entries(i))if((_ce.includes(r)||typeof s=="boolean")&&delete i[r],r==="texture")for(let[o,a]of Object.entries(s))(wce.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((n,i)=>{i.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function Ece(t){t.scene.publish.withBackground=!0}function Tce(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function Cce(t){t.scene.objects.traverse((e,n)=>{let i=n.cloner;i&&(i.radial.scale=i.radial.scale.map(r=>r+1),i.linear.scale=i.linear.scale.map(r=>r+1))})}function Pce(t){t.scene.objects.traverse((e,n)=>{let i=n.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function Rce(t){t.scene.objects.traverse((e,n)=>{let i=t.scene.objects.unproxy().parent(e);if(i){let r=di(t.scene.objects.data(i));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&n.type==="Mesh"&&(n.visible=di(n).booleanExclude!==!0)}})}function Lce(t){t.scene.objects.traverse((e,n)=>{if(n.type==="Mesh"){let i=n;n.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function Dce(t){function e(i){Object.setPrototypeOf(i,_i.prototype),i.texture&&Object.setPrototypeOf(i.texture,_i.prototype)}function n(i){Object.setPrototypeOf(i,_i.prototype);for(let r in i)e(i[r])}t.scene.objects.traverse((i,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=di(o.material).layers;n(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],u=di(l).layers;n(u),l.layers=u}})})}function EO(t){t.layers===void 0&&Object.assign(t,as.defaultTwoLayerData("lambert"))}function sb(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let n=[...e.colors];n.push(e.colors[9]);let i=[...e.steps];i.push(e.steps[9]);let r={...di(e),colors:n,steps:i};Object.assign(e,r)}})}function Ice(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&(n.geometry.type==="BooleanGeometry"||n.geometry.type==="SubdivGeometry")&&(n.geometry.phongAngle=35)})}function TO(t){t.scene.objects.traverse((e,n)=>{"materials"in n?n.materials.forEach(i=>{typeof i!="string"&&sb(i)}):"material"in n&&typeof n.material!="string"&&sb(n.material)}),Object.values(t.shared.materials).forEach(e=>sb(e))}function Oce(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,n)=>{(n.type==="DirectionalLight"||n.type==="SpotLight")&&(n.shadowResolution=1024,n.shadowRadius=1,n.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function Nce(t){t.shared.audios=Ya({},Nt.prototype)}function kce(t){t.shared.videos=Ya({},Nt.prototype)}function Uce(t){let e=t.shared.materials;Object.entries(e).forEach(([n,i])=>{if(!i.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[n]:r})}})}function zce(t){Object.entries(di(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(di(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function Fce(t){t.scene.publish.settings.web.preload=!1}function CO(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function PO(t){t.layers&&t.layers.forEach(e=>{xce(e)&&e.isMask===void 0&&(e.isMask=!1),(e.type==="texture"||e.type==="video")&&e.blending===void 0&&(e.blending=0),(e.type==="noise"||e.type==="displace"&&e.displacementType==="noise")&&(e.voronoiStyle===void 0&&(e.voronoiStyle=0),e.highCut===void 0&&(e.highCut=1),e.lowCut===void 0&&(e.lowCut=0),e.smoothness===void 0&&(e.smoothness=.3),e.seed===void 0&&(e.seed=0),e.quality===void 0&&(e.quality=1))})}function Bce(t){t.shared.fonts=Ya({},Nt.prototype)}function Vce(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function jce(t){let e=[];t.scene.objects.traverse((n,i)=>{let r=i;if(r.type==="TextFrame"){let s=as.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=Vce(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,...br.defaultData,...Ed.defaultData,flatShading:!1,wireframe:!1,geometry:{...Ad.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:di(r.states),events:di(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},u=di(t.scene.objects).parent(n);t.scene.objects.insertAfter(u??null,n,[{id:n+"new",data:l,children:[]}]),e.push(n)}}),e.forEach(n=>{t.scene.objects.delete(n)})}function Gce(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((n,i)=>{i.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new Yt,move:new Yt,jump:new Yt}});else{let s=new Yt;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:Ut.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let u={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},d={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(d,Ql(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(d,{control1:{...o.control1},control2:{...o.control2}});let c={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},h={state:o.state,...c,...d},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Yt({fi:0,id:Ut.generateUUID(),data:u},{fi:1,id:Ut.generateUUID(),data:h})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function Hce(t){t.scene.objects.traverse((e,n)=>{function i(r,s){var l;let o=new Yt,a=[];if(n.events.forEach((u,d,c)=>{if(u.type==="Audio"&&u.trigger===s){let h;a.push(d),u.interaction==="play"?h={...Ql(u,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in u?u.after:void 0,toggle:"after"in u?u.toggle:void 0,type:"Audio"}:(u.interaction==="pause"||u.interaction==="stop")&&(h={...Ql(u,"interaction","delay","object","playAudio"),type:"Audio"}),h&&o.push({fi:c,id:d,data:h})}}),a.forEach(u=>n.events.delete(u)),o.length){let u=(l=n.events.find(d=>d.type===r))==null?void 0:l.data;u?"actions"in u&&u.actions.insertBefore(null,o):n.events.insertBefore(null,[{id:Ut.generateUUID(),data:{type:r,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function RO(t){var n;let e=(n=t.layers.find(i=>i.type==="light"))==null?void 0:n.data;if((e==null?void 0:e.category)==="basic"){let i=Os.defaultData("light","phong"),r=e;Object.assign(r,i),r.visible=!1}}function LO(t){El(t,RO),Tl(t,RO)}function Wce(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(n.geometry.scaleBaked||(n.geometry.scaleBaked=[1,1,1]))})}function $ce(t){t.scene.objects.traverse((e,n)=>{(n.type==="Empty"||n.type==="Mesh")&&n.cloner&&!n.cloner.randomnessObject&&!n.cloner.toObject&&!n.cloner.randomness&&(n.cloner={...n.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function qce(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="NonParametricGeometry"&&!("material"in n)&&!("materials"in n)&&(n.material=as.defaultTwoLayerData("phong"))})}function Xce(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,n)=>{(n.type==="OrthographicCamera"||n.type==="PerspectiveCamera")&&(n.orthographic.autoZoom===void 0&&(n.orthographic.autoZoom=!1),n.orthographic.autoZoomFrustumSize===void 0&&(n.orthographic.autoZoomFrustumSize=790))})}function Yce(t){t.scene.objects.traverse((e,n)=>{n.pathSnapping===void 0&&(n.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),n.pathSnapping.offset===void 0&&(n.pathSnapping.offset=0)})}function Zce(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function Kce(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function Qce(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-n.position[1]))})})}function Jce(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((n,i)=>{e&&i.physics===null?i.collision=!1:i.collision="visibility"})}function ehe(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=gA.defaultDataThirdPerson.navmesh)})})}function the(t){t.scene.styles||(t.scene.styles=Td.defaultData())}function DO(t){t.layers.forEach(e=>{e.type==="light"&&e.category!=="toon"&&e.occlusion===void 0&&(e.occlusion=!0)})}function nhe(t){t.scene.environment.ambientLight.occlusion===void 0&&(t.scene.environment.ambientLight.occlusion=!1),t.scene.environment.ambientLight.aoFullRes===void 0&&(t.scene.environment.ambientLight.aoFullRes=!1),t.scene.environment.ambientLight.radius===void 0&&(t.scene.environment.ambientLight.radius=256),t.scene.environment.ambientLight.bias===void 0&&(t.scene.environment.ambientLight.bias=.5),t.scene.environment.ambientLight.aoColor===void 0&&(t.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Tl(t,DO),El(t,DO)}function ihe(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new Yt})})})}function rhe(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run",""],["none","Ctrl"]])})})}function IO(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.bumpMapIntensity===void 0&&(e.bumpMapIntensity=5)})}function she(t,e){if(e<1&&(Tl(t,AO),El(t,AO),t.schema=1),e<2&&(bce(t),t.schema=2),e<3&&(Ace(t),t.schema=3),e<4&&(Ece(t),t.schema=4),e<5&&(Tce(t),t.schema=5),e<6&&(Cce(t),t.schema=6),e<7&&(Pce(t),t.schema=7),e<8&&(t.schema=8),e<9&&(TO(t),t.schema=9),e<10&&(Ice(t),t.schema=10),e<11&&(Oce(t),t.schema=11),e<12&&(TO(t),t.schema=12),e<13&&(Nce(t),t.schema=13),e<14&&(Uce(t),t.schema=14),e<15&&(zce(t),t.schema=15),e<16&&(Fce(t),t.schema=16),e<17&&(Tl(t,CO),El(t,CO),t.schema=17),e<18&&(Tl(t,EO),El(t,EO),t.schema=18),e<19&&(Mce(t),t.schema=19),e<20&&(Bce(t),jce(t),t.schema=20),e<21&&(Gce(t),Hce(t),t.schema=21),e<22&&(LO(t),t.schema=22),e<23&&(Wce(t),t.schema=23),e<24&&($ce(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(kce(t),e<25&&(t.schema=25)),e<26&&(Rce(t),t.schema=26),e<27&&(Lce(t),t.schema=27),e<28&&(LO(t),t.schema=28),e<29&&(Dce(t),t.schema=29),e<30&&(qce(t),t.schema=30),e<31&&(Xce(t),t.schema=31),e<33&&(Yce(t),t.schema=33),e<34&&(Zce(t),t.schema=34),e<35&&(Kce(t),t.schema=35),e<36&&(Qce(t),t.schema=36),e<37&&(Jce(t),t.schema=37),e<38&&(Tl(t,PO),El(t,PO),t.schema=38),e<39&&(ehe(t),t.schema=39),e<40&&(the(t),t.schema=40),e<41&&(nhe(t),t.schema=41),e<42&&(ihe(t),t.schema=42),e<43&&(rhe(t),t.schema=43),e<99){Tl(t,IO),El(t,IO),t.scene.publish.playCamera===null&&(t.scene.publish.playCamera=o_);let n=di(t.scene.objects),i=t.scene.objects;t.scene.publish.playPage=am,i.insertBefore(null,null,[{id:am,data:{...rf.defaultData,backgroundColor:t.scene.backgroundColor,fog:t.scene.fog,postprocessing:t.scene.postprocessing,ao:Ql(t.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:t.scene.publish.playCamera,gameControlObject:t.scene.publish.gameControlObject},shadow:Ql(t.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...j1.defaultData,...Ql(t.scene.environment,"usePhysics","gravity")},camera:di(t.scene.ownerCamera)??rf.defaultData.camera,name:"Scene"},children:[]}]);for(let o of n)o.id!==Cd.TRASH_CAN_ID&&i.move(am,o.fi,o.id);let r=0,s=0;t.shared.penumbraSize&&t.scene.objects.traverse((o,a)=>{a.type==="DirectionalLight"?(a.penumbraSize=t.shared.penumbraSize[Math.min(r,2)],r+=1):a.type==="SpotLight"&&(a.penumbraSize=t.shared.penumbraSize[3+Math.min(s,1)],s+=1),(a.physics===void 0||a.physics===null)&&a.type!=="Instance"&&(a.physics={},Object.assign(a.physics,tf.defaultData)),a.physics!==void 0&&a.physics!==null&&(a.physics.enabled=a.collision??"visibility",delete a.collision)}),t.schema=99}}function OO(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.alphaOverride===void 0&&(e.alphaOverride=1)})}function ohe(t){t.scene.objects.traverse((e,n)=>{let i=n.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}var Hh=180/Math.PI;function NO(t){t.rotation=t.rotation.slice(0,3).map(e=>e*Hh)}function fV(t){var n,i;NO(t),t.type==="Page"&&NO(t.camera),(n=t.states)==null||n.forEach(r=>{r.rotation===void 0||r.rotation===null||(r.rotation=r.rotation.slice(0,3).map(s=>s*Hh))});let e=t.geometry;e&&e.type==="SphereGeometry"&&(e.thetaLength=(e.thetaLength??180)*Hh),e&&e.type==="TorusGeometry"&&(e.arc=e.arc*Hh),e&&e.type==="PathGeometry"&&(e.extrusion.angle*=Hh,e.extrusion.twist*=Hh),t.type==="Mesh"&&t.geometry.type==="TextGeometry"&&(t.geometry.text={textValue:t.geometry.text}),Array.isArray(di(t.events))&&((i=t.events)==null||i.forEach(r=>{(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress"||r.type==="KeyDown"||r.type==="KeyUp"||r.type==="KeyPress"||r.type==="Collision"||r.type==="Trigger")&&(r.runMode=r.toggle?"Toggle":"Once")}))}function ahe(t){t.shared.variables=Ya({},Nt.prototype)}function lhe(t){let e=di(t.shared.variables);t.shared.variables=Ya(Object.entries(e??{}).map(([n,i],r)=>({fi:r,id:n,data:i})),Yt.prototype)}var Cl=107;function pV(t,e){e(t.data);for(let n of t.children)pV(n,e)}function uhe(t){let e=t.schema??104;e!==Cl&&e<105&&(pV(t.asset,fV),t.schema=105)}function mV(t){let e=t.schema??0;if(e!==Cl){console.warn("updating from ",e,"to ",Cl),she(t,e),e<100&&(t.scene.publish.joystickSizeAndXYOffset===void 0&&(t.scene.publish.joystickSizeAndXYOffset=mc.defaultData.joystickSizeAndXYOffset),t.schema=100),e<101&&(Tl(t,OO),El(t,OO),t.schema=101),e<102&&(ohe(t),t.schema=102),e<104&&(t.shared.catelogs=new Nt,t.shared.lib=sf.defaultData(),t.schema=104),e<105&&(ahe(t),t.scene.objects.traverse((n,i)=>{fV(i)}),t.schema=105);for(let n of Object.values(t.shared.lib.components))uhe(n);e<106&&(lhe(t),t.schema=106),e<107&&(t.shared.lib.variables=sf.defaultData().variables,t.schema=107)}}var $1;(t=>{t.defaultData={schema:Cl,scene:Cd.defaultData,frames:new Nt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",lm.defaultData),shared:{...Ra.emptyData(),colors:Ra.defaultColors()}},t.emptyDataForImports=function(r){let s=Cd.emptyDataWithPage(r);return{schema:Cl,scene:s,frames:new Nt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",lm.defaultData),shared:{...Ra.emptyData(),colors:Ra.defaultColors(),images:Ra.defaultImages(r)}}},t.emptyData=function(){return{schema:Cl,scene:Cd.emptyDataWithPage(),frames:new Nt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",lm.defaultData),shared:Ra.emptyData()}},t.collabHelper={...B2,updateSchema(r){return(r.schema??0)<Cl?og(r,mV):(r.schema??0)-Cl}};function e(r){let s=t.collabHelper.updateSchema(r);return typeof s=="number"?s===0?r:null:s.data}t.updateSchemaDirectly=e;function n(r){return{...r,shared:{...r.shared,lib:sf.defaultData()}}}t.withoutLib=n;function i(r,s){let o=r.scene.objects.get(s);if(o&&o.data.type==="Component")return o;{let a=r.shared.lib.components[s];if(a)return a.asset}}t.getComponentData=i})($1||($1={}));var yp=Tr($te()),che=.5*(Math.sqrt(3)-1),xp=(3-Math.sqrt(3))/6,hhe=1/3,ko=1/6,um=t=>Math.floor(t)|0,kO=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),ob=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function ab(t=Math.random){let e=gV(t),n=new Float64Array(e).map(r=>kO[r%12*2]),i=new Float64Array(e).map(r=>kO[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,u=(r+s)*che,d=um(r+u),c=um(s+u),h=(d+c)*xp,f=d-h,m=c-h,x=r-f,y=s-m,v,_;x>y?(v=1,_=0):(v=0,_=1);let w=x-v+xp,b=y-_+xp,E=x-1+2*xp,A=y-1+2*xp,T=d&255,L=c&255,P=.5-x*x-y*y;if(P>=0){let U=T+e[L],G=n[U],k=i[U];P*=P,o=P*P*(G*x+k*y)}let C=.5-w*w-b*b;if(C>=0){let U=T+v+e[L+_],G=n[U],k=i[U];C*=C,a=C*C*(G*w+k*b)}let D=.5-E*E-A*A;if(D>=0){let U=T+1+e[L+1],G=n[U],k=i[U];D*=D,l=D*D*(G*E+k*A)}return 70*(o+a+l)}}function dhe(t=Math.random){let e=gV(t),n=new Float64Array(e).map(s=>ob[s%12*3]),i=new Float64Array(e).map(s=>ob[s%12*3+1]),r=new Float64Array(e).map(s=>ob[s%12*3+2]);return function(s,o,a){let l,u,d,c,h=(s+o+a)*hhe,f=um(s+h),m=um(o+h),x=um(a+h),y=(f+m+x)*ko,v=f-y,_=m-y,w=x-y,b=s-v,E=o-_,A=a-w,T,L,P,C,D,U;b>=E?E>=A?(T=1,L=0,P=0,C=1,D=1,U=0):b>=A?(T=1,L=0,P=0,C=1,D=0,U=1):(T=0,L=0,P=1,C=1,D=0,U=1):E<A?(T=0,L=0,P=1,C=0,D=1,U=1):b<A?(T=0,L=1,P=0,C=0,D=1,U=1):(T=0,L=1,P=0,C=1,D=1,U=0);let G=b-T+ko,k=E-L+ko,H=A-P+ko,K=b-C+2*ko,q=E-D+2*ko,N=A-U+2*ko,V=b-1+3*ko,j=E-1+3*ko,z=A-1+3*ko,$=f&255,te=m&255,Q=x&255,J=.6-b*b-E*E-A*A;if(J<0)l=0;else{let le=$+e[te+e[Q]];J*=J,l=J*J*(n[le]*b+i[le]*E+r[le]*A)}let ie=.6-G*G-k*k-H*H;if(ie<0)u=0;else{let le=$+T+e[te+L+e[Q+P]];ie*=ie,u=ie*ie*(n[le]*G+i[le]*k+r[le]*H)}let se=.6-K*K-q*q-N*N;if(se<0)d=0;else{let le=$+C+e[te+D+e[Q+U]];se*=se,d=se*se*(n[le]*K+i[le]*q+r[le]*N)}let pe=.6-V*V-j*j-z*z;if(pe<0)c=0;else{let le=$+1+e[te+1+e[Q+1]];pe*=pe,c=pe*pe*(n[le]*V+i[le]*j+r[le]*z)}return 32*(l+u+d+c)}}function gV(t){let e=new Uint8Array(512);for(let n=0;n<512/2;n++)e[n]=n;for(let n=0;n<512/2-1;n++){let i=n+~~(t()*(256-n)),r=e[n];e[n]=e[i],e[i]=r}for(let n=256;n<512;n++)e[n]=e[n-256];return e}var Js=new Bi,fhe=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let i=0;i<t.count;i+=3){let r=1;Js.a.fromBufferAttribute(t,i),Js.b.fromBufferAttribute(t,i+1),Js.c.fromBufferAttribute(t,i+2),r*=Js.getArea(),e[i/3]=r}this.distribution=new Float32Array(t.count/3);let n=0;for(let i=0;i<e.length;i++)n+=e[i],this.distribution[i]=n;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,n=0,i=e.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?i=s-1:n=s+1}return r}sampleFace(t,e,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),Js.a.fromBufferAttribute(this.positionAttribute,t*3),Js.b.fromBufferAttribute(this.positionAttribute,t*3+1),Js.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(Js.a,i).addScaledVector(Js.b,r).addScaledVector(Js.c,1-(i+r)),Js.getNormal(n),this}},phe=Tr(qte()),mhe=new Ue,ghe=new Ue,vhe=new Ue,lg;(t=>{function e(n){return n&&n.__isSPEObject}t.is=e})(lg||(lg={}));var gC=t=>class extends t{constructor(){super(...arguments),this.previousModelViewMatrix=new Ue,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Ue,this.matrixWorldRigid=new Ue,this.shearScale=new Ue,this.shearScaleInv=new Ue}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof jt&&(e=e.uuid);let n=this;for(;n.parent;){if(n.parent.uuid===e)return!0;n=n.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let n of this.children)n.updateMatrixWorld(e)}updateWorldMatrix(e,n){let i=this.parent;if(e&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),n)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseChildren(e,n=0){for(let i of this.children)lg.is(i)&&i.traverseObject(e,n+1)}traverseObject(e,n=0){if(e(this,n)!==!0)for(let i of this.children)lg.is(i)&&i.traverseObject(e,n+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,n=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:i,v:r,q:s}=(0,phe.SVD)(n),o=mhe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=ghe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=vhe.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(u=>Math.abs(s[0]-u)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,n){this.updateWorldMatrix(!0,!1);let i=new Ue().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof Ue?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),n!==void 0&&(this.children.pop(),this.children.splice(n,0,e)),this}copy(e,n=!1){return super.copy(e,n),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,n,i,r,s,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},yhe=class extends gC(jt){},xhe=t=>t.type==="Mesh",Op=class extends yhe{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,e){}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let n=this.children[t];(n==null?void 0:n.object)!==e&&(n&&this.remove(n),n=new Op(e),this.add(n),this.children.splice(t,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=e.matrix,n.hiddenMatrix=e.hiddenMatrix),n.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return xhe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Ku=new O,Qu=new O,Pd=new Ue,vV=[new O(-1,1,1),new O(-1,-1,1),new O(1,-1,1),new O(1,1,1),new O(-1,1,-1),new O(-1,-1,-1),new O(1,-1,-1),new O(1,1,-1)],_he=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],whe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],UO=(t,e,n)=>{t.updateEntityBoxSize(Ku,Qu),Pd.copy(e).multiply(t.matrixWorld),Qu.x===0&&Qu.y===0&&Qu.z===0?n.push(new O(Ku.x,Ku.y,Ku.z).applyMatrix4(Pd)):vV.forEach(i=>{n.push(i.clone().multiply(Qu).add(Ku).applyMatrix4(Pd))})},zO=class extends Hi{constructor(){super(...arguments),this.matrix=new Ue,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let n=new Ue().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,n,e)}expandByObjectSize(t,e,n=!1){let i=[];return n===!0?t.traverseEntity(r=>{if(r.visible||r.cloner&&r.data.visible){if(!("geometry"in r)){i.push(new O);return}UO(r,e,i)}}):UO(t,e,i),this.setFromPoints(i)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(Pd.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(Qu).multiplyScalar(.5),this.getCenter(Ku),Pd.copy(this.matrix).setPosition(Ku),this.vertices=vV.map(t=>t.clone().multiply(Qu).applyMatrix4(Pd))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=_he.map(([t,e])=>new h4(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new O))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=whe.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},kl={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},She=class extends eT{constructor(){super()}getPoints(t=12){let e=[],n,i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?i[s]:i[s]-i[s-1],u=Math.ceil(t*l/r),d=a.getPoints(u);for(let c=0;c<d.length;c++){let h=d[c];n&&n.equals(h)||(e.push(h),n=h)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},vA=.001;function yA(t,e,n){return e.clone().sub(t).cross(e.clone().sub(n)).length()<=vA}function lb(t,e){let n=new O(...t.position),i=new O(...t.controlNext.position),r=new O(...e.controlPrevious.position),s=new O(...e.position);return yA(n,i,s)&&yA(n,r,s)}function yV(t){let e=t.points.map(d=>new O(...d.data.position)),n=[t.points[0]],i=new O(...n[0].data.position);for(let d=0;d<t.points.length-1;d++)yA(i,e[d],e[d+1])||(n.push(t.points[d]),i=e[d]);n.push(t.points[t.points.length-1]);let r=t.isClosed,s=n.length-(r?0:1),o=n.length,a=[];for(let d=0;d<o;d++){let c=n[d].data,h=new O(...c.position),f=new O(...c.controlPrevious.position),m=new O(...c.controlNext.position),x={position:h,baseRoundness:c.roundness,controlPrevious:f,controlNext:m};if(c.roundness===0||!t.isClosed&&(d===0||d===o-1)){a[d]={...x,removedLength:0};continue}let y=r&&d==0?o-1:d-1,v=r&&d==o-1?0:d+1,_=n[y].data,w=n[v].data,b=new O(..._.position),E=new O(...w.position),A=b.clone().sub(h).normalize(),T=E.clone().sub(h).normalize();Object.assign(x,{prevDir:A,nextDir:T});let L=lb(_,c),P=lb(c,w);if(!L||!P)a[d]={...x,removedLength:0};else{let C=A.clone().add(T).normalize(),D=C.clone().cross(A).length()/A.dot(C);a[d]={...x,tan:D,removedLength:c.roundness/D}}}for(let d=0;d<s;d++){let c=d,h=r&&d===o-1?0:d+1,f=a[c],m=a[h];if(f.removedLength!==0||m.removedLength!==0){let x=f.position.distanceTo(m.position);f.removedLength=Math.min(f.removedLength,x/2),m.removedLength=Math.min(m.removedLength,x/2)}}let l=[];for(let d=0;d<s;d++){let c=d,h=r&&d===o-1?0:d+1,f=a[c],m=a[h],x=null;if(!lb(n[c].data,n[h].data))f.position.distanceTo(m.position)>vA&&(x=new em(f.position,f.controlNext,m.controlPrevious,m.position));else{let y=f.position.clone(),v=m.position.clone();(f.removedLength!==0||m.removedLength!==0)&&(f.nextDir&&y.add(f.nextDir.clone().setLength(f.removedLength)),m.prevDir&&v.add(m.prevDir.clone().setLength(m.removedLength))),y.distanceTo(v)>vA&&(x=new em(y,y.clone().lerp(v,.3),v.clone().lerp(y,.3),v))}l[2*d+1]=x}for(let d=0;d<o;d++){let c=a[d];if(c.removedLength===0){l[2*d]=null;continue}let h=c.position,f=c.prevDir.clone().multiplyScalar(c.removedLength).add(h),m=c.nextDir.clone().multiplyScalar(c.removedLength).add(h),x=c.tan*c.removedLength,y=c.prevDir.clone().add(c.nextDir).normalize(),v=f.clone().lerp(m,.5),_=f.distanceTo(m)/2,w=y.clone().multiplyScalar(Math.sqrt(Math.pow(x,2)-Math.pow(_,2))).add(v),b=y.clone().multiplyScalar(-x).add(w),E=h.distanceTo(b)/h.distanceTo(v),A=c.prevDir.clone().multiplyScalar(E*h.distanceTo(f)).add(h),T=A.clone().lerp(b,2),L=f.clone().lerp(A,4/3),P=m.clone().lerp(T,4/3);l[2*d]=new em(f,L,P,m)}let u=new She;return l.forEach(d=>{d&&u.add(d)}),u}var rn;(t=>{function e(n){return n&&n.__isEntity}t.is=e})(rn||(rn={}));var Oh=t=>rn.is(t),bhe={type:"completeState",isfromEntity:!0},Mhe=["x","y","z"],ub=new O,Ahe=new O().set(0,1,0),vC=t=>class extends gC(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new zO,this._recursiveBBox=new zO,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let n=this.children[e];if(rn.is(n))return n}entityChildrenCount(){let e=this.children.length;for(;e--;)if(rn.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let n=e.parent;if(rn.is(n))e=n;else return}return e}forInstancesRec(e){this.instances.forEach(n=>{n.disposed||e(n),n.forInstancesRec(e)})}super_Entity(e,n){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=n,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,n,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)md.toOps(this.data,r.data).forEach(s=>{let o=F2.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,n)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=md.patch(this.data,r),md.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,n)}))}i&&this.updateTransformState(this.dataPatched,n),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,n){e.setScalar(0),n.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{Oh(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let n;return this.traverseEntity(i=>{i.uuid===e&&(n=i)}),n}traverseSortNextHelper(){let e=this.parent;if(e){let n=e.children,i=n.indexOf(this)+1;if(rn.is(n[i]))return n[i];if(rn.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&rn.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let n=this;for(;e>0&&n!==null;)n=n.parent,e-=1;return n}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let n=this.parent;for(;n;){if(e===n)return!0;n=n.parent}return!1}countToAccestor(e){let n=0,i=this;for(;i!==e;){if(i===null)return-1;i=i.parent,n+=1}return n}forEachEntity(e){for(let n of this.children)Oh(n)&&e(n)}traverseEntityAncestors(e){this.traverseAncestors(n=>{rn.is(n)&&e(n)})}traverseConcreteEntity(e,n=0){if(e(this,n)!==!0)for(let i of this.children)Oh(i)&&i.isConcreteEntity&&i.traverseEntity(e,n+1)}traverseEntity(e,n=0){if(e(this,n)!==!0)for(let i of this.children)Oh(i)&&i.traverseEntity(e,n+1)}traverseVisibleEntity(e){e(this);for(let n of this.children)Oh(n)&&n.visible&&n.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e,n=!1){return super.copy(e,n),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>Oh(e))}isAncestorOf(e){if(this.uuid===e)return!1;let n=!1;return this.traverseEntity(i=>{i.uuid===e&&(n=!0)}),n}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let n={position:this.position.toArray(),rotation:[this.rotation.x*Ut.RAD2DEG,this.rotation.y*Ut.RAD2DEG,this.rotation.z*Ut.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return z2(n,e)}getTransformValues(e,n,i){return n[e].map((r,s)=>(i==null?void 0:i.shared.getVariable(r,[this.uuid,e,Mhe[s]]))??r)}updateTransformState(e,n){let i=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,n)),i=!0),e.rotation&&(ub.fromArray(this.getTransformValues("rotation",e,n)).multiplyScalar(Ut.DEG2RAD),this.rotation.setFromVector3(ub),i=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,n)),i=!0),e.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??Jd.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(e=!1){if(e){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)rn.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{rn.is(e)&&e.disposeRecursively()})}toState(e=[]){let n={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return z2(n,e)}updateByObjUpdateOp(e,n){e!==void 0&&this.updateByOp({type:0,props:e,path:[]},{...this.data,...e},n,!1)}updateByOp(e,n,i,r){let s=this.data;this.data=n;let o=e,a=ks(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let u={...e.props};if(delete u.name,Object.values(e.props).some(d=>d===void 0)){let d=this.data;if(d!==void 0){let c=yr.zoom(d,e.path.slice(2));if(c)for(let h in e.props)e.props[h]===void 0&&h in c&&(u[h]=c[h])}}o={...e,props:u,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:d,...c}=l;l=c}if(e.props.material!==void 0&&"material"in l){let{material:d,...c}=l;l=c}let u=yr.removeOverridden(e.path,e.props,l);o={...e,props:u}}}if(this.updateByPatchedOpBase(o,md.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),ks(e.path,["overrides"])){let l=[],u=[...e.path];for(l.push(u[1]),u.splice(0,2);u.length>0&&u[0]==="descendants";)l.push(u[1]),u.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let d of Object.keys(e.props)){l[l.length-1]=d;let c=i.scene.findInstance([this.uuid,...l]);c&&(c.overrideData=e.props[d],c.updateState(Jl.apply(c.component.data,c.overrideData),i))}}else{let d=i.scene.findInstance([this.uuid,...l]);if(d){let c=yr.zoom(d.component.data,u);if(e={...e,path:u},e.type===0){let h=e.props;if(c)for(let[f,m]of Object.entries(e.props))m===void 0&&(h===e.props&&(h={...e.props}),h[f]=c[f]);e={...e,props:h}}d.overrideData=G1.resolve(n.overrides,l),d.updateByOp(e,nr.applySimple(d.data,e),i,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let u;for(let d of Nl.rootOverrideProps)d in e.props&&(u===void 0&&(u={}),u[d]=e.props[d]);u&&(l={...e,props:u})}else for(let u of Nl.rootOverrideProps)if(ks(e.path,[u])){l=e;break}l!==void 0&&this.instances.forEach(u=>{if(u.isInstanceRoot){let d=Jl.filterOp(u.overrideData,l);d&&u.updateByOp(d,nr.applySimple(u.data,d),i,!0)}}),this.instances.forEach(u=>{if(!u.isInstanceRoot){let d=Jl.filterOp(u.overrideData,e);if(d){let c;s===u.data&&e===d?c=n:c=nr.applySimple(u.data,d),u.updateByOp(d,c,i,!0)}}})}}updateByPatchedOpBase(e,n,i){if(this.dataPatched=n,e.path.length===0&&e.type===0)e.props.type!==void 0&&!Rc.is(e.props.type)&&kl.changeEntityProptotype(this,n,i);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){kl.changeEntityProptotype(this,n,i);for(let r of this.children)rn.is(r)&&r.updateVisible(i.scene)}this.updateByPatchedOp(e,n,i)}updateByPatchedOp(e,n,i){if(e.path.length===0&&e.type===0&&this.updateState(e.props,i),ks(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(n.pathSnapping),ks(e.path,["cloner"])!==null){let r=nr.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(n.cloner,i.scene):(this.setFromClonerState(n.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(e=this.dataPatched.pathSnapping){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var m,x,y,v,_;let n=((m=this._updatedPathSnapping)==null?void 0:m.pathId)??this.dataPatched.pathSnapping.pathId,i=((x=this._updatedPathSnapping)==null?void 0:x.slide)??this.dataPatched.pathSnapping.slide??0,r=((y=this._updatedPathSnapping)==null?void 0:y.offset)??this.dataPatched.pathSnapping.offset??0,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(n===null)return;let o=e.find(n);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data;if(a.geometry.path.points.length<=1)return;let l=yV(a.geometry.path),u=(i+r)%1;i+r===1&&u===0&&(u=1);let d=l.getPointAt(u),c=this.parent?(_=this.parent)==null?void 0:_.matrixWorld:new Ue;o.updateMatrixWorld();let h=new Ue().multiplyMatrices(c.clone().invert(),o.matrixWorld);d.applyMatrix4(h);let f={position:d.toArray(),rotation:a.rotation};if(s==="tangential"){let w=new Ue().extractRotation(o.matrixWorld),b=l.getTangentAt(u).applyMatrix4(w).add(d),E=new Ue().lookAt(d,b,Ahe),A=ub.setFromEuler(new ta().setFromRotationMatrix(E)).multiplyScalar(Ut.RAD2DEG);f={...f,rotation:A.toArray()}}this.updateTransformState(f),this.traverseEntity(w=>{w._cameraType&&w.dispatchEvent(bhe)})}updateVisible(e){var i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((i=this.dataPatched.cloner)==null?void 0:i.hideBase)!==!0),!e)return;let n=!1;this.traverseEntity(r=>{if(r.data.type==="Splat")return n=!0,!0}),n&&e.reloadSplats()}updateState_Entity(e,n){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(n==null?void 0:n.scene),this.resetBBoxNeedsUpdate()),n&&"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,n),this.updateVisible(n.scene)),this.updateTransformState(e,n)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof kl.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,n){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new kl.Cloner(this,e),n.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,n.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},Ehe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters);n.thetaLength=Ut.clamp(n.thetaLength,0,360);let i=n.width/2,r=n.radiusTop??i,s=n.radiusBottom??i;return r===s?(r=i,s=i):r>s?(r=i,s=s*i/r):(r=r*i/s,s=i),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:u,radiusBottom:d,cornerRadius:c,cornerSegments:h,hollow:f}=t.parameters,m;return l===0?(m=new Ke,m.setAttribute("position",new Ne([],3))):c||f?m=new xV(u,d,i,r,s,o,a,l*Math.PI/180,c,c,h,f):m=new zc(u,d,i,r,s,o,a,l*Math.PI/180),m.scale(1,1,n/e),Object.assign(m,{userData:{...t,type:"CylinderGeometry"}})}};function gl(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function FO(t){return new ee(t.y,-t.x)}var xV=class extends Ke{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,u=0);let f=[],m=[],x=[],y=[],v=0,_=n/2,w=new O,b=new O;h&&t==0&&(t=l),h&&e==0&&(e=u);let E=new ee(t,_),A=new ee(e,-_),T=null,L=null,P=null,C=null,D=E.clone().sub(A),U=0,G=0,k=0;c>0&&(U=Math.min(t,e)*(1-c),G=t-U,k=e-U);let H=E.clone();H.x-=U;let K=Math.PI-D.angle(),q=D.angle(),N=Math.tan(q/2),V=Math.tan(K/2),j=N+V,z=c?j:V,$=c?j:N;if(l=Math.min(l,(t-G)/z,D.length()/j),u=Math.min(u,(e-k)/$,D.length()/j),l>0){let pe=l/N;T=E.clone().sub(new ee(pe,l)),c&&(P=T.clone(),P.x-=U-j*l),E.sub(D.clone().setLength(pe))}if(u>0){let pe=u/V;L=A.clone().sub(new ee(pe,-u)),A.add(D.clone().setLength(pe)),c&&(C=L.clone(),C.x-=U-j*u,H.sub(D.clone().setLength(pe)))}D=E.clone().sub(A);let te=D.length()<.5,Q=[];for(let pe=0;pe<=i;pe++){let le=[],Ae=pe/i,ae=Ae*a+o,W=new ee(Math.sin(ae),Math.cos(ae));C&&L?(J(le,Ae,W,K,u,C,-1,!0),J(le,Ae,W,q,u,L,-1,!1)):L?(ie(le,W,L.x,0,-1),J(le,Ae,W,q,u,L,-1,!1)):s||ie(le,W,e,k,-1);let me=FO(D).normalize();if(gl(me,W,w),!te)for(let ue=0;ue<=r;ue++){let ce=ue/r,ge=D.clone().multiplyScalar(ce).add(A);gl(ge,W,b),m.push(b.x,b.y,b.z),x.push(w.x,w.y,w.z),y.push(Ae,.5+b.y/n),le.push(v++)}if(P&&T?(J(le,Ae,W,K,l,T,1,!1),J(le,Ae,W,q,l,P,1,!0)):T?(J(le,Ae,W,K,l,T,1,!1),ie(le,W,T.x,0,1)):s||ie(le,W,t,G,1),c&&!te){let ue=FO(D).multiplyScalar(-1).normalize();gl(ue,W,w);for(let ce=0;ce<=r;ce++){let ge=ce/r,De=D.clone().multiplyScalar(-ge).add(H);gl(De,W,b),m.push(b.x,b.y,b.z),x.push(w.x,w.y,w.z),y.push(Ae,.5+b.y/n),le.push(v++)}}c&&!s&&le.push(le[0]),Q.push(le)}for(let pe=0;pe<Q.length-1;pe++)for(let le=0;le<Q[0].length-1;le++){if(s&&c&&le==r)continue;let Ae=Q[pe][le],ae=Q[pe+1][le],W=Q[pe+1][le+1],me=Q[pe][le+1],ue=m[W*3+0],ce=m[W*3+2];f.push(Ae,ae,me),(ue!=0||ce!=0)&&f.push(ae,W,me)}a<Math.PI*2&&(se(-1,Q[0],o),se(1,Q[Q.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new Ne(m,3)),this.setAttribute("normal",new Ne(x,3)),this.setAttribute("uv",new Ne(y,2));function J(pe,le,Ae,ae,W,me,ue,ce){for(let ge=0;ge<d+1;ge++){let De=ge/d,Me=ue<0?De:1-De;ce&&(Me-=1),Me*=ae;let Ce=new ee(Math.sin(Me),Math.cos(Me)*ue),ke=Ce.clone().multiplyScalar(W).add(me);gl(ke,Ae,b),m.push(b.x,b.y,b.z),gl(Ce,Ae,w),x.push(w.x,w.y,w.z),y.push(le,.5+b.y/n),pe.push(v++)}}function ie(pe,le,Ae,ae,W){let me=new O,ue=new ee,ce=[Ae,ae];W<0&&ce.reverse();for(let ge of ce)ue.set(ge,_*W),gl(ue,le,me),m.push(me.x,me.y,me.z),x.push(0,W,0),y.push(.5,.5),pe.push(v++)}function se(pe,le,Ae){let ae=new ee(Math.sin(Ae),Math.cos(Ae)),W=new ee(-Math.cos(Ae),Math.sin(Ae)),me=new O,ue=pe<0?(De,Me,Ce)=>f.push(De,Me,Ce):(De,Me,Ce)=>f.push(De,Ce,Me),ce=new ee((t+e+G+k)/4,0);gl(ce,ae,me),m.push(me.x,me.y,me.z),x.push(W.x,0,W.y),y.push(.5,.5);let ge=v++;for(let De of le){let Me=m.slice(De*3,De*3+3);m.push(...Me),x.push(W.x,0,W.y);let Ce=y.slice(De*2,De*2+2);y.push(...Ce),v++}for(let De=ge+1;De<v-1;De++)ue(ge,De,De+1);ue(ge,v-1,ge+1)}}},The=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return n.thetaLength=Ut.clamp(n.thetaLength,0,360),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:u,cornerRadiusBottom:d,cornerSegments:c}=t.parameters,h;return l===0?(h=new Ke,h.setAttribute("position",new Ne([],3))):u>0||d>0||l<360?h=new xV(0,e/2,i,r,s,o,a,l*Math.PI/180,u,d,c,0,!0):h=new yg(e/2,i,r,s,o),h.scale(1,1,n/e),Object.assign(h,{userData:{...t,type:"ConeGeometry"}})}},Che=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,u;return a==0?u=new us(e,n,i,r,s,o):u=new Phe(e,n,i,r,s,o,a,l),Object.assign(u,{userData:{...t,type:"CubeGeometry"}})}},cb=Math.PI/2,Phe=class extends Ke{constructor(t=1,e=1,n=1,i=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,n/2);let u=[],d=[],c=[],h=[],f=0,m=0;x("z","y","x",-1,-1,n,e,t,s,r,0),x("z","y","x",1,-1,n,e,-t,s,r,1),x("x","z","y",1,1,t,n,e,i,s,2),x("x","z","y",1,-1,t,n,-e,i,s,3),x("x","y","z",1,-1,t,e,n,i,r,4),x("x","y","z",-1,-1,t,e,-n,i,r,5),o>0&&(y("z","y","x",-1,-1,1,n,e,t,s,0),y("z","y","x",1,-1,-1,n,e,t,s,1),y("z","y","x",-1,1,-1,n,e,t,s,1),y("z","y","x",1,1,1,n,e,t,s,0),y("x","y","z",-1,-1,-1,t,e,n,i,0),y("x","y","z",1,-1,1,t,e,n,i,1),y("x","y","z",-1,1,1,t,e,n,i,0),y("x","y","z",1,1,-1,t,e,n,i,1),y("y","x","z",-1,-1,1,e,t,n,r,0),y("y","x","z",1,-1,-1,e,t,n,r,1),y("y","x","z",1,1,1,e,t,n,r,1),y("y","x","z",-1,1,-1,e,t,n,r,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(u),this.setAttribute("position",new Ne(d,3)),this.setAttribute("normal",new Ne(c,3)),this.setAttribute("uv",new Ne(h,2));function x(_,w,b,E,A,T,L,P,C,D,U){let G=(T-2*o)/C,k=(L-2*o)/D,H=T/2-o,K=L/2-o,q=P/2,N=C+1,V=D+1,j=0,z=0,$=new O;for(let te=0;te<V;te++){let Q=te*k-K;for(let J=0;J<N;J++){let ie=J*G-H;$[_]=ie*E,$[w]=Q*A,$[b]=q,d.push($.x,$.y,$.z),$[_]=0,$[w]=0,$[b]=P>0?1:-1,c.push($.x,$.y,$.z),h.push(J/C),h.push(1-te/D),j+=1}}for(let te=0;te<D;te++)for(let Q=0;Q<C;Q++){let J=f+Q+N*te,ie=f+Q+N*(te+1),se=f+(Q+1)+N*(te+1),pe=f+(Q+1)+N*te;u.push(J,ie,pe),u.push(ie,se,pe),z+=6}l.addGroup(m,z,U),m+=z,f+=j}function y(_,w,b,E,A,T,L,P,C,D,U){let G=(L-2*o)/D,k=L/2-o,H=P/2-o,K=C/2,q=D+1,N=0,V=0,j=new O,z=new O;for(let $=0;$<a+1;$++){let te=$/a*cb,Q=Math.sin(te)*o,J=(1-Math.cos(te))*o,ie=Math.sin(te),se=Math.cos(te);j[w]=(H+Q)*A,j[b]=(K-J)*T,z[_]=0,z[w]=ie*Math.sign(j[w]),z[b]=se*Math.sign(j[b]);for(let pe=0;pe<q;pe++){let le=pe*G-k;j[_]=le*E,d.push(j.x,j.y,j.z),c.push(z.x,z.y,z.z),h.push(pe/D),h.push(0),N+=1}}for(let $=0;$<a;$++)for(let te=0;te<D;te++){let Q=f+te+q*$,J=f+te+q*($+1),ie=f+(te+1)+q*($+1),se=f+(te+1)+q*$;u.push(Q,J,se),u.push(J,ie,se),V+=6}l.addGroup(m,V,U),m+=V,f+=N}function v(_,w,b){let E=new O,A=new O(t/2,e/2,n/2);A.subScalar(o);let T=[],L=_*w*b>0?(C,D,U)=>u.push(C,D,U):(C,D,U)=>u.push(C,U,D);for(let C=0;C<=a;C++){let D=[],U=cb*(1-C/a),G=Math.cos(U),k=Math.sin(U),H=0;for(let K=0;K<=C;K++){let q=Math.cos(H),N=Math.sin(H);E.x=G*q,E.y=k,E.z=G*N;let V=A.clone().addScaledVector(E,o);d.push(_*V.x,w*V.y,b*V.z),c.push(_*E.x,w*E.y,b*E.z),h.push(0,0),D.push(f++),H+=cb/C}T.push(D)}let P=T.length-1;for(let C=0;C<P;C++){let D=T[C],U=T[C+1],G=D.length-1;L(D[0],U[1],U[0]);for(let k=1;k<=G;k++)L(D[k-1],D[k],U[k]),L(D[k],U[k+1],U[k])}}}},yC=class extends Ke{constructor(t=[],e=[],n="",i=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];u(),d(),this.setAttribute("position",new Ne(o,3)),this.setAttribute("normal",new Ne(l,3)),this.setAttribute("uv",new Ne(a,2));return;function u(){var q;r=Math.min(1-1e-5,r),r==0&&(s=0);let c={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],h=new O,f=h.clone(),m=new Bi,x=r*i,y=i-x,v=s+1,_=new O,w=(N,V)=>_.subVectors(N,V).normalize(),b=(N,V)=>Array(N).fill(void 0).map(V),E=b(t.length/3,(N,V)=>new O().fromArray(t,V*3).setLength(i)),A=[],T=1e6;for(let N=0;N<E.length;N++){let V=E[N],j=[],z,$,te,Q=1e10,J=-1;for(;(J=e.indexOf(N,J+1))!=-1;){let le=J-J%3;z=e[le+(J+1)%3],$=e[le+(J+2)%3],te=V.distanceToSquared(E[z]),Q=Math.min(Q,te),j.push([z,$,te])}Q+=1e-6;let ie=[],se=0,pe=j.length;for(let le=0;le<pe;le++){[z,$,te]=j[se];let Ae=((q=A[z])==null?void 0:q.includes(N))==!0;te<=Q&&ie.push(z+ +Ae*T),se=j.findIndex(ae=>ae[0]==$)}A.push(ie)}let L=[];{let N=0,V=0,j,z,$=c==3;for(let te=0;te<=s;te++){j=te*(te+1)/2,z=(te+1)*(te+2)/2;for(let Q=0;Q<s-te;Q++)[N,V]=[j+Q+te+2,z+Q+te+3],L.push(j,z,...$?[V,j]:[N,z],V,N),[j,z]=[N,V];L.push(j,z,j+s+2)}}let P=h.clone(),C=h.clone(),D=h.clone(),U=h.clone(),G=h.clone(),k=[],H=b(E.length,()=>b(c,()=>h.clone()));for(let N=0;N<E.length;N++){h.copy(E[N]).normalize(),P.copy(h).multiplyScalar(y);let V=A[N];for(let ie=0;ie<V.length;ie++){let se=V[ie],pe=V[(ie+1)%c];m.setFromPointsAndIndices(E,N,se%T,pe%T),m.b.sub(m.a).setLength(1e10).add(m.a),m.c.sub(m.a).setLength(1e10).add(m.a),m.closestPointToPoint(P,H[N][ie])}let j=[],z=[],$=[],te=new O;s==0&&[...H[N]].reduce((ie,se)=>ie.add(se),te).multiplyScalar(1/c);for(let ie=0;ie<c;ie++){let se=[],pe=(ie-1+c)%c,le=H[N][pe],Ae=H[N][ie];h.copy(le).sub(P),f.copy(Ae).sub(P);let ae=P.angleTo(h),W=h.angleTo(f),me=Math.cos(ae)*x;s==0?C.copy(te):C.copy(P).setLength(y+me),z.push(me);let ue=[C,le,Ae];for(let ce=0;ce<2;ce++){let ge=ue[ce],De=ue[ce+1];U.subVectors(ge,P),G.subVectors(De,P),D.crossVectors(U,G).normalize();for(let Me=0;Me<v;Me++){let Ce=[ae,W][ce]*Me/v;h.copy(U).applyAxisAngle(D,Ce).add(P),j.push(h.clone()),ce&&(w(h,P),se.push([Me==0?ge:h.clone(),_.clone()]))}ce&&(w(De,P),se.push([De,_.clone()]))}$.push(se)}k.push($);let Q=2*v,J=2;for(let ie=0;ie<c;ie++){let se=Q*ie,pe=Q*((ie+1)%c),le=[j[se]];for(let ae=1;ae<v;ae++){U=j[se+ae],G=j[pe+ae],le.push(U);for(let W=1,me=ae-J+1;W<=me;W++)h.lerpVectors(U,G,W/(me+1)),h.sub(P).setLength(z[ie]).add(P),le.push(h.clone());le.push(G)}for(let ae=0;ae<v;ae++)le.push(j[ae+v+se]);le.push(j[pe+v]);let Ae=L.map(ae=>le[ae]);o.push(...Ae.map(ae=>[ae.x,ae.y,ae.z]).flat()),l.push(...Ae.map(ae=>(w(ae,P),[_.x,_.y,_.z])).flat())}}let K=[];for(let N=0;N<A.length;N++)for(let V=0;V<c;V++){let j=A[N][V];if(j<T){let z=A[j].findIndex(Q=>Q%T==N),$=k[N][V],te=k[j][z];for(let Q=0;Q<v;Q++){let J=$[Q],ie=te[v-Q],se=$[Q+1],pe=te[v-(Q+1)];[J,ie,se,se,ie,pe].forEach(le=>{o.push(le[0].x,le[0].y,le[0].z),l.push(le[1].x,le[1].y,le[1].z)})}K.push($[0][0],te[v][0],$[v][0],te[0][0])}}for(;K.length;){let N,V,j,z;[N,V]=K.splice(0,2);let $=[N];for(;N!=V;)$.push(V),j=K.indexOf(V),z=j%2,V=K.splice(j-z,2)[1-z];_.subVectors($[0],$[1]).cross(h.subVectors($[0],$[2])).normalize();let te=_.dot($[0])<0;te&&_.negate();for(let Q=1;Q<=$.length-2;Q++)[$[Q+ +te],$[Q+1-+te],$[0]].forEach(J=>{o.push(J.x,J.y,J.z),l.push(_.x,_.y,_.z)})}}function d(){let c=new O;for(let A=0;A<o.length;A+=3){c.x=o[A+0],c.y=o[A+1],c.z=o[A+2];let T=b(c)/2/Math.PI+.5,L=E(c)/Math.PI+.5;a.push(T,1-L)}let h=new O,f=new O,m=new O,x=new O,y=new ee,v=new ee,_=new ee,w=(A,T,L,P)=>{P<0&&A.x===1&&(a[T]=A.x-1),L.x===0&&L.z===0&&(a[T]=P/2/Math.PI+.5)};for(let A=0,T=0;A<o.length;A+=9,T+=6){h.set(o[A+0],o[A+1],o[A+2]),f.set(o[A+3],o[A+4],o[A+5]),m.set(o[A+6],o[A+7],o[A+8]),y.set(a[T+0],a[T+1]),v.set(a[T+2],a[T+3]),_.set(a[T+4],a[T+5]),x.copy(h).add(f).add(m).divideScalar(3);let L=b(x);w(y,T+0,h,L),w(v,T+2,f,L),w(_,T+4,m,L)}for(let A=0;A<a.length;A+=6){let T=a[A+0],L=a[A+2],P=a[A+4],C=Math.max(T,L,P),D=Math.min(T,L,P);C>.9&&D<.1&&(T<.2&&(a[A+0]+=1),L<.2&&(a[A+2]+=1),P<.2&&(a[A+4]+=1))}function b(A){return Math.atan2(A.z,-A.x)}function E(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}}static fromJSON(t){return new yC(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},Rhe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new _V(e*.5,s,o):new xg(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},_V=class extends yC{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,n),this.type=a}static fromJSON(t){return new _V(t.radius,t.corner,t.cornerSides)}},_p=1e-12,xC=class{constructor(t){this.position=new ee,this.startPosition=new ee,this.uuid=Ut.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new xC(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},xA=class extends xC{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new xA(this.parent).copy(this)}},Rd=class extends xC{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new xA(this),new xA(this))}static create(t,e){let n=new Rd(t,new ee(...e.position));return n.controls[0].position.set(...e.controlPrevious.position),n.controls[1].position.set(...e.controlNext.position),n.roundness=e.roundness,n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,n}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let n=0,i=this.controls.length;n<i;n++){let r=this.controls[n];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new Rd(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var n,i;let t=(n=this.curveBefore)==null?void 0:n.getTangentAt(1),e=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[t,e]}computeNormals(t=new ee,e=new ee){let[n,i]=this.computeTangents();return n&&i&&(BO(n,t),BO(i,e)),[t,e]}computeTangent(t=new ee){let[e,n]=this.computeTangents();return e&&n&&t.copy(e).add(n).normalize(),t}computeNormal(t=new ee){let[e,n]=this.computeNormals();return t.copy(e).add(n).normalize(),t}};function BO(t,e=new ee){let n=t.length();return e.set(-t.y/n,t.x/n)}var _C=t=>t,Mf=new ee,a_=new ee,Lhe=new ee,Dhe=new ee,Ihe=new ee,Ohe=new ee,wV=new O,SV=new O;function Nhe(t){let e=new ee;e.addVectors(t.v0,Mf.subVectors(t.v1,t.v0).multiplyScalar(2/3));let n=new ee;return n.addVectors(t.v2,a_.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new zs(t.v0,e,n,t.v2)}function Np(t,e,n=Number.EPSILON){return Math.abs(t-e)<n}function khe(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function Uhe(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function bV(t,e,n){let i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function zhe(t,e,n){return jO(t,e)&&jO(e,n)&&_A(t.position,e.position,n.position)}function _A(t,e,n){return Mf.copy(e).sub(t).cross(a_.copy(n).sub(t))===0}function Fhe(t,e,n,i,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.y-e.y)/s,u=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return i.set(a+l,o+u),r.set(a-l,o-u),[i,r]}function Bhe(t,e,n){let i=t.distanceTo(n),r=e.distanceTo(n);return i<r?e:t}function Vhe(t,e,n,i,r,s){let o=e.x-t.x,a=e.y-t.y,l=n.x-t.x,u=n.y-t.y,d=Math.sqrt((o+l)*(o+l)+(a+u)*(a+u)),c;return bV(e,t,n)>Math.PI&&(d*=-1),Np(u,a)?c=(a+u)*(i/d-.5)*8/3/(o-l):c=(o+l)*(i/d-.5)*8/3/(u-a),r.set(e.x-c*a,e.y+c*o),s.set(n.x+c*u,n.y-c*l),[r,s]}function VO(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function jO(t,e){return _A(t.position,t.controls[1].position,e.position)&&_A(t.position,e.controls[0].position,e.position)}function jhe(t,e,n,i,r=.5){let s=Mf.subVectors(e,t).multiplyScalar(r).add(t),o=a_.subVectors(n,e).multiplyScalar(r).add(e),a=Lhe.subVectors(i,n).multiplyScalar(r).add(n),l=s,u=Dhe.subVectors(o,s).multiplyScalar(r).add(s),d=Ihe.subVectors(a,o).multiplyScalar(r).add(o),c=a,h=Ohe.subVectors(d,u).multiplyScalar(r).add(u);return[t.x,t.y,l.x,l.y,u.x,u.y,h.x,h.y,d.x,d.y,c.x,c.y,i.x,i.y]}function Ghe(t,e,n=12,i=!0){let r=SV.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=_C(e[a]),u=Mf,d=gc(l,n);for(let c=0;c<=d;c++)if(l instanceof zs||l instanceof qa||l instanceof ho){if(l.getPoint(c/d,u),r.set(u.x,u.y,0),s!==void 0&&Uhe(s,r))continue;s===void 0&&(s=wV),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return i&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function Hhe(t,e,n,i=12,r=!0){let s=SV.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(n[l]===!1)continue;let u,d=_C(e[l]),c=Mf,h=gc(d,i);a.push(h);for(let f=0;f<=h;f++)if(d instanceof zs||d instanceof qa||d instanceof ho){if(d.getPoint(f/h,c),s.set(c.x,c.y,0),u==null?void 0:u.equals(s))continue;u===void 0?u=wV:(t.setXYZ(o,u.x,u.y,u.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),u.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function GO(t,e=12,n=!1){let i=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(n&&o.roundedCurveCorner!==void 0){let l=gc(o.roundedCurveCorner,e)*.5;r>0&&(i[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=gc(o.curveAfter,e)),i.push(a)}return t.length>0&&n&&t[0].roundedCurveCorner!==void 0&&(i[t.length-1]+=gc(t[0].roundedCurveCorner,e)*.5),i}function gc(t,e=12){return t&&t instanceof vg?e*2:t&&(t instanceof ho||t instanceof QE)?1:t&&t instanceof Px?e*t.points.length:e}function Whe(t,e,n=12,i=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=_C(e[o]),l=gc(a,n),u=Mf;for(let d=0;d<=l;d++)if(a instanceof zs||a instanceof qa||a instanceof ho){if(a.getPoint(d/l,u),r!==void 0&&khe(r,u,_p))continue;r===void 0&&(r=a_),r.copy(u),t.push(u.x,u.y),s++}}return Np(t[0],t[t.length-2],_p)&&Np(t[1],t[t.length-1],_p)&&(t.pop(),t.pop()),i&&s>1&&!(Np(t[s-1],t[1],_p)&&Np(t[s-2],t[0],_p))&&(t.push(t[0],t[1]),s++),t}var hb=new ee,$he=new ee,qhe=new ee,Xhe=new ee,Yhe=new ee,Zhe=new ee,qn=class extends fo{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Pa(new O(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Ut.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,n){let i=new qn;return i.isClosed=t.isClosed,i.points=t.points.map(r=>Rd.create(r.id,r.data)),typeof t.roundness=="number"&&(i.roundness=t.roundness),i.shapeHoles=t.shapeHoles.map(r=>qn.createFromState(r)),e!==void 0&&n!==void 0&&i.applySize(e,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,n=this.points.length;e<n;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,n=this.points.findIndex(i=>i.uuid===t);if(n<0){let i=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)i+=a;else return l+i}}return n}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let n=hb.set(t,e);for(let i=0,r=this.points.length;i<r;i++){let s=this.points[i];s.position.multiply(n),s.controls[0].position.multiply(n),s.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(t,e);this._update()}createPoint(t,e=0,n=Ut.generateUUID()){let i;t instanceof ee?i=t:i=new ee(t,e);let r=new Rd(n,i);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(i.uuid===t)return i}for(let e=0,n=this.shapeHoles.length;e<n;e++){let i=this.shapeHoles[e].getPointByUuid(t);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(n=>n.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,n=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let i=n?this.roundedCurveDivisions:this.curveDivisions;return Ghe(t,n?this.roundedCurves:this.curves,e,this.autoClose),i.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=GO(this.points,t,!1),this.roundedCurveDivisions=GO(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,n=12){return Hhe(t,this.curves,e,n,this.autoClose).reduce((i,r)=>i+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),Whe(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let n=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=gc(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=i.reduce((o,a)=>o+a,0));for(let o=0,a=i.length;o<a;o++){let l=i[o];if(s<n+l)return[o,(s-n+1)/l];n+=l}return[0,1]}getCurveT(t,e,n){let i=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(VO(i,r)){let l=i.position.distanceTo(r.position);return i.position.distanceTo(hb.set(n.x,n.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){VO(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let n=this.curves[this.curves.length-1];t.curveBefore=n,e.curveAfter=n;let i=n.clone();t.roundedCurveBefore=i,e.roundedCurveAfter=i,t.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(e===0)this.moveTo(i.position.x,i.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(i,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],n=this.points[this.points.length-1];this._applyCurveForPoint(e,n)}if(this.points.length>2){let e=0;for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n],s=this.points[n-1]??this.points[this.points.length-1],o=this.points[n+1]??this.points[0],a=r.roundness,l=s&&o&&zhe(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let u=r.curveBefore,d=r.curveAfter;if(u===void 0||d===void 0)continue;let c=r.roundedCurveBefore,h=r.roundedCurveAfter,f=u.getLength(),m=d.getLength(),x=Math.min(a,f*.499),y=Math.min(a,m*.499),v=Math.min(x,y),_=1-v/f,w=v/m,b=u.getPointAt(_,hb),E=d.getPointAt(w,$he);this._subSplitCurve(u,c,_,b,void 0),this._subSplitCurve(d,h,w,void 0,E);let A;if(this.useCubicForRoundedCorners){let T=bV(b,r.position,E)/2,L=Math.tan(T)*b.distanceTo(r.position),[P,C]=Fhe(b,E,L,qhe,Xhe),D=Bhe(P,C,r.position),[U,G]=Vhe(D,b,E,L,Yhe,Zhe);A=new zs(b.clone(),U.clone(),G.clone(),E.clone())}else A=new qa(b.clone(),r.position.clone(),E.clone());r.roundedCurveCorner=A,this.roundedCurves.splice(n+e,0,A),e++}}}}_subSplitCurve(t,e,n,i,r){if(t instanceof ho)i!==void 0&&e.v2.copy(i),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(n,0),l=jhe(s.v0,s.v1,s.v2,s.v3,a);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new qn(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var n;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let i=0;i<e;i++){let r=i*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],u=t.points[r+4],d=t.points[r+5],c=t.points[r+6],h=new Rd(Ut.generateUUID(),new ee(s,o));h.controls[0].position.set(a,l),h.controls[1].position.set(u,d),h.roundness=c,this.points.push(h)}return this.shapeHoles=(n=t.shapeHoles)!=null&&n.length?t.shapeHoles.map(i=>{let r=new qn;return r.fromJSON(i),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t,e=!1){this.isText=e;let n=(r,s)=>{s instanceof zs&&s.v3.equals(r.position)&&r.controls[0].position.copy(s.v2)},i=r=>{let s=[],o,a;for(o=0,a=r.length;o<a;o++)r[o]instanceof qa&&(r[o]=Nhe(r[o]));for(o=0,a=r.length;o<a;o++){let d=r[o],c=o>0?r[o-1]:null,h;d instanceof zs?(h=this.createPoint(d.v0),h.controls[1].position.copy(d.v1)):d instanceof ho&&(h=this.createPoint(d.v1)),h!==void 0&&(c!==null&&n(h,c),s.push(h))}let l=r[r.length-1],u=!1;return l instanceof zs?l.v3.equals(s[0].position)&&(s[0].controls[0].position.copy(l.v2),u=!0):l instanceof ho&&l.v2.equals(s[0].position)&&(u=!0),this.isClosed=u,s};return this.points=i(t.curves),t instanceof fo&&(this.shapeHoles=t.holes.map(r=>{let s=new qn;return s.fromShape(r),s})),this.update(),this}updatePoint(t,e){let n=this.getPointByUuid(t);n&&(e.position!==void 0&&n.position.fromArray(e.position),e.roundness!==void 0&&(n.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[0];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[1];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}},wA=Math.PI*2;function db({x:t,y:e},n,i,r,s){return{x:t*n+r,y:e*i+s}}function Khe(t,e){let n=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:i-r*n,y:r+i*n},{x:s+o*n,y:o-s*n},{x:s,y:o}]}function HO(t,e,n,i){let r=t*i-e*n<0?-1:1,s=Math.min(1,Math.max(-1,t*n+e*i));return r*Math.acos(s)}function Qhe(t,e,n,i,r,s,o,a,l,u){let d=Math.pow(r,2),c=Math.pow(s,2),h=Math.pow(o,2),f=Math.pow(a,2),m=d*c-d*f-c*h;m<0&&(m=0),m/=d*f+c*h,m=Math.sqrt(m)*(l===u?-1:1);let x=m*r/s*a,y=m*-s/r*o,v=x+(t+n)/2,_=y+(e+i)/2,w=(o-x)/r,b=(a-y)/s,E=(-o-x)/r,A=(-a-y)/s,T=HO(1,0,w,b),L=HO(w,b,E,A);return!u&&L>0&&(L-=wA),u&&L<0&&(L+=wA),{centerx:v,centery:_,ang1:T,ang2:L}}function Jhe({px:t,py:e,cx:n,cy:i,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let u=(t-n)/2,d=(e-i)/2;if(u===0&&d===0)return[];r=Math.abs(r),s=Math.abs(s);let c=Math.pow(u,2)/Math.pow(r,2)+Math.pow(d,2)/Math.pow(s,2);c>1&&(r*=Math.sqrt(c),s*=Math.sqrt(c));let h=Qhe(t,e,n,i,r,s,u,d,o,a),{ang1:f,ang2:m}=h,{centerx:x,centery:y}=h,v=Math.abs(m)/(wA/4);Math.abs(1-v)<1e-7&&(v=1);let _=Math.max(Math.ceil(v),1);m/=_;for(let w=0;w<_;w++)l.push(Khe(f,m)),f+=m;return l.map(w=>{let{x:b,y:E}=db(w[0],r,s,x,y),{x:A,y:T}=db(w[1],r,s,x,y),{x:L,y:P}=db(w[2],r,s,x,y);return{x1:b,y1:E,x2:A,y2:T,x:L,y:P}})}var un;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(un||(un={}));var ci;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(ci||(ci={}));function mt(t,e){if(!t)throw e||"Assertion Failed!"}var ct=function(){function t(){}return t.vertEq=function(e,n){return e.s===n.s&&e.t===n.t},t.vertLeq=function(e,n){return e.s<n.s||e.s===n.s&&e.t<=n.t},t.transLeq=function(e,n){return e.t<n.t||e.t===n.t&&e.s<=n.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,n){return Math.abs(e.s-n.s)+Math.abs(e.t-n.t)},t.edgeEval=function(e,n,i){mt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?r<s?n.t-e.t+(e.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,n,i){mt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-e.t)*s:0},t.transEval=function(e,n,i){mt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?r<s?n.s-e.s+(e.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-e.s)*(s/(r+s)):0},t.transSign=function(e,n,i){mt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-e.s)*s:0},t.vertCCW=function(e,n,i){return e.s*(n.t-i.t)+n.s*(i.t-e.t)+i.s*(e.t-n.t)>=0},t.interpolate=function(e,n,i,r){return e=e<0?0:e,i=i<0?0:i,e<=i?i===0?(n+r)/2:n+(r-n)*(e/(e+i)):r+(n-r)*(i/(e+i))},t.intersect=function(e,n,i,r,s){var o,a,l;t.vertLeq(e,n)||(l=e,e=n,n=l),t.vertLeq(i,r)||(l=i,i=r,r=l),t.vertLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.vertLeq(i,n)?t.vertLeq(n,r)?(o=t.edgeEval(e,i,n),a=t.edgeEval(i,n,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,n.s)):(o=t.edgeSign(e,i,n),a=-t.edgeSign(e,r,n),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,r.s)):s.s=(i.s+n.s)/2,t.transLeq(e,n)||(l=e,e=n,n=l),t.transLeq(i,r)||(l=i,i=r,r=l),t.transLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.transLeq(i,n)?t.transLeq(n,r)?(o=t.transEval(e,i,n),a=t.transEval(i,n,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,n.t)):(o=t.transSign(e,i,n),a=-t.transSign(e,r,n),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,r.t)):s.t=(i.t+n.t)/2},t}(),wp=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),Xv=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),Wh=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),WO=function(){function t(){var e=new Wh,n=new wp,i=new Xv(0),r=new Xv(1);e.next=e.prev=e,e.anEdge=null,n.next=n.prev=n,i.next=i,i.Sym=r,r.next=r,r.Sym=i,this.vHead=e,this.fHead=n,this.eHead=i,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var n=new Xv(0),i=new Xv(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return i.next=r,r.Sym.next=n,n.next=e,e.Sym.next=i,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n},t.prototype.splice_=function(e,n){var i=e.Onext,r=n.Onext;i.Sym.Lnext=n,r.Sym.Lnext=e,e.Onext=r,n.Onext=i},t.prototype.makeVertex_=function(e,n,i){var r=e;mt(r,"Vertex can't be null!");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n;var o=n;do o.Org=r,o=o.Onext;while(o!==n)},t.prototype.makeFace_=function(e,n,i){var r=e;mt(r,"Face can't be null");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n,r.trail=null,r.marked=!1,r.inside=i.inside;var o=n;do o.Lface=r,o=o.Lnext;while(o!==n)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var n=e.next,i=e.Sym.next;n.Sym.next=i,i.Sym.next=n},t.prototype.killVertex_=function(e,n){var i=e.anEdge,r=i;do r.Org=n,r=r.Onext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,n){var i=e.anEdge,r=i;do r.Lface=n,r=r.Lnext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new Wh,n=new Wh,i=new wp,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(n,r.Sym,this.vHead),this.makeFace_(i,r,this.fHead),r},t.prototype.splice=function(e,n){var i=!1,r=!1;if(e!==n){if(n.Org!==e.Org&&(r=!0,this.killVertex_(n.Org,e.Org)),n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(n,e),!r){var s=new Wh;this.makeVertex_(s,n,e.Org),e.Org.anEdge=e}if(!i){var o=new wp;this.makeFace_(o,n,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var n=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var r=new wp;this.makeFace_(r,e,e.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(e.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var n=this.makeEdge_(e),i=n.Sym;this.splice_(n,e.Lnext),n.Org=e.Dst;var r=new Wh;return this.makeVertex_(r,i,n.Org),n.Lface=i.Lface=e.Lface,n},t.prototype.splitEdge=function(e){var n=this.addEdgeVertex(e),i=n.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,i),e.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=e.Rface,i.winding=e.winding,i.Sym.winding=e.Sym.winding,i.idx=e.idx,i.Sym.idx=e.Sym.idx,i},t.prototype.connect=function(e,n){var i=!1,r=this.makeEdge_(e),s=r.Sym;if(n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,n),r.Org=e.Dst,s.Org=n.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!i){var o=new wp;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var n=e.anEdge,i,r,s,o,a;r=n.Lnext;do i=r,r=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=n);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var n=e.anEdge,i=0;do i++,n=n.Lnext;while(n!==e.anEdge);return i},t.prototype.mergeConvexFaces=function(e){var n,i,r,s,o,a,l;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(i=n.anEdge,o=i.Org;r=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(n),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&ct.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&ct.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===o);)i=r;return!0},t.prototype.check=function(){var e=this.fHead,n=this.vHead,i=this.eHead,r,s,o,a,l,u;for(s=e,s=e;(r=s.next)!==e;s=r){mt(r.prev===s),l=r.anEdge;do mt(l.Sym!==l),mt(l.Sym.Sym===l),mt(l.Lnext.Onext.Sym===l),mt(l.Onext.Sym.Lnext===l),mt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(mt(r.prev===s&&r.anEdge===null),a=n,a=n;(o=a.next)!==n;a=o){mt(o.prev===a),l=o.anEdge;do mt(l.Sym!==l),mt(l.Sym.Sym===l),mt(l.Lnext.Onext.Sym===l),mt(l.Onext.Sym.Lnext===l),mt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(mt(o.prev===a&&o.anEdge===null),u=i,u=i;(l=u.next)!==i;u=l)mt(l.Sym.next===u.Sym),mt(l.Sym!==l),mt(l.Sym.Sym===l),mt(l.Org!==null),mt(l.Dst!==null),mt(l.Lnext.Onext.Sym===l),mt(l.Onext.Sym.Lnext===l);mt(l.Sym.next===u.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),$O=function(){function t(){this.handle=null}return t}(),qO=function(){function t(){this.key=null,this.node=0}return t}(),ede=function(){function t(e,n){this.leq=n,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var i=0;i<e+1;i++)this.nodes[i]=new $O,this.handles[i]=new qO;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e<<1,o<this.size&&this.leq(i[n[o+1].handle].key,i[n[o].handle].key)&&++o,mt(o<=this.max),s=n[o].handle,o>this.size||this.leq(i[r].key,i[s].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.floatUp_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e>>1,s=n[o].handle,o===0||this.leq(i[s].key,i[r].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var n,i;if(n=++this.size,n*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new $O;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new qO}return this.freeList===0?i=n:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[n].handle=i,this.handles[i].node=n,this.handles[i].key=e,this.initialized&&this.floatUp_(n),i},t.prototype.extractMin=function(){var e=this.nodes,n=this.handles,i=e[1].handle,r=n[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,n[e[1].handle].node=1,n[i].key=null,n[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var n=this.nodes,i=this.handles,r;mt(e>=1&&e<=this.max&&i[e].key!==null),r=i[e].node,n[r].handle=n[this.size].handle,i[n[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(i[n[r>>1].handle].key,i[n[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},t}(),fb=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),XO=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),tde=function(){function t(e,n){this.frame=e,this.leq=n,this.head=new XO,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,e,n.key));return n},t.prototype.insertBefore=function(e,n){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,n));var i=new XO;return i.key=n,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),nde=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.edgeLeq=function(e,n,i){var r=e.event,s=n.eUp,o=i.eUp;if(s.Dst===r)return o.Dst===r?ct.vertLeq(s.Org,o.Org)?ct.edgeSign(o.Dst,s.Org,o.Org)<=0:ct.edgeSign(s.Dst,o.Org,s.Org)>=0:ct.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return ct.edgeSign(s.Dst,r,s.Org)>=0;var a=ct.edgeEval(s.Dst,r,s.Org),l=ct.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,n){n.fixUpperEdge&&mt(n.eUp.winding===0),n.eUp.activeRegion=null,e.dict.delete(n.nodeUp)},t.fixUpperEdge=function(e,n,i){mt(n.fixUpperEdge),e.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=i,i.activeRegion=n},t.topLeftRegion=function(e,n){var i=n.eUp.Org,r;do n=t.regionAbove(n);while(n.eUp.Org===i);if(n.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(n).eUp.Sym,n.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,n,r),n=t.regionAbove(n)}return n},t.topRightRegion=function(e){var n=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===n);return e},t.addRegionBelow=function(e,n,i){var r=new fb;return r.eUp=i,r.nodeUp=e.dict.insertBefore(n.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,i.activeRegion=r,r},t.isWindingInside=function(e,n){switch(e.windingRule){case un.ODD:return(n&1)!==0;case un.NONZERO:return n!==0;case un.POSITIVE:return n>0;case un.NEGATIVE:return n<0;case un.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,n){n.windingNumber=t.regionAbove(n).windingNumber+n.eUp.winding,n.inside=t.isWindingInside(e,n.windingNumber)},t.finishRegion=function(e,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,t.deleteRegion(e,n)},t.finishLeftRegions=function(e,n,i){for(var r,s=null,o=n,a=n.eUp;o!==i;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,n,i,r,s,o){var a,l,u,d,c=!0;u=i;do mt(ct.vertLeq(u.Org,u.Dst)),t.addRegionBelow(e,n,u.Sym),u=u.Onext;while(u!==r);for(s===null&&(s=t.regionBelow(n).eUp.Rprev),l=n,d=s;a=t.regionBelow(l),u=a.eUp.Sym,u.Org===d.Org;)u.Onext!==d&&(e.mesh.splice(u.Oprev,u),e.mesh.splice(d.Oprev,u)),a.windingNumber=l.windingNumber-u.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!c&&t.checkForRightSplice(e,l)&&(t.addWinding(u,d),t.deleteRegion(e,l),e.mesh.delete(d)),c=!1,l=a,d=u;l.dirty=!0,mt(l.windingNumber-u.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,n,i){e.mesh.splice(n,i)},t.vertexWeights=function(e,n,i){var r=ct.vertL1dist(n,e),s=ct.vertL1dist(i,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*n.coords[0]+a*i.coords[0],e.coords[1]+=o*n.coords[1]+a*i.coords[1],e.coords[2]+=o*n.coords[2]+a*i.coords[2]},t.getIntersectData=function(e,n,i,r,s,o){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,t.vertexWeights(n,i,r),t.vertexWeights(n,s,o)},t.checkForRightSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp;if(ct.vertLeq(r.Org,s.Org)){if(ct.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;ct.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(ct.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o;if(mt(!ct.vertEq(r.Dst,s.Dst)),ct.vertLeq(r.Dst,s.Dst)){if(ct.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=n.inside}else{if(ct.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;n.dirty=i.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=n.inside}return!0},t.checkForIntersect=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o=r.Org,a=s.Org,l=r.Dst,u=s.Dst,d,c,h=new Wh,f,m;if(mt(!ct.vertEq(u,l)),mt(ct.edgeSign(l,e.event,o)<=0),mt(ct.edgeSign(u,e.event,a)>=0),mt(o!==e.event&&a!==e.event),mt(!n.fixUpperEdge&&!i.fixUpperEdge),o===a||(d=Math.min(o.t,l.t),c=Math.max(a.t,u.t),d>c))return!1;if(ct.vertLeq(o,a)){if(ct.edgeSign(u,o,a)>0)return!1}else if(ct.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),ct.intersect(l,o,u,a,h),mt(Math.min(o.t,l.t)<=h.t),mt(h.t<=Math.max(a.t,u.t)),mt(Math.min(u.s,l.s)<=h.s),mt(h.s<=Math.max(a.s,o.s)),ct.vertLeq(h,e.event)&&(h.s=e.event.s,h.t=e.event.t),f=ct.vertLeq(o,a)?o:a,ct.vertLeq(f,h)&&(h.s=f.s,h.t=f.t),ct.vertEq(h,o)||ct.vertEq(h,a)?(t.checkForRightSplice(e,n),!1):!ct.vertEq(l,e.event)&&ct.edgeSign(l,e.event,h)>=0||!ct.vertEq(u,e.event)&&ct.edgeSign(u,e.event,h)<=0?u===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),n=t.topLeftRegion(e,n),r=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),i),t.addRightEdges(e,n,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),i=n,n=t.topRightRegion(n),m=t.regionBelow(n).eUp.Rprev,i.eUp=s.Oprev,s=t.finishLeftRegions(e,i,null),t.addRightEdges(e,n,s.Onext,r.Rprev,m,!0),!0):(ct.edgeSign(l,e.event,h)>=0&&(t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),ct.edgeSign(u,e.event,h)<=0&&(n.dirty=i.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=h.s,r.Org.t=h.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,u),t.regionAbove(n).dirty=n.dirty=i.dirty=!0,!1)},t.walkDirtyRegions=function(e,n){for(var i=t.regionBelow(n),r,s;;){for(;i.dirty;)n=i,i=t.regionBelow(i);if(!n.dirty&&(i=n,n=t.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,r=n.eUp,s=i.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,n)&&(i.fixUpperEdge?(t.deleteRegion(e,i),e.mesh.delete(s),i=t.regionBelow(n),s=i.eUp):n.fixUpperEdge&&(t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i),r=n.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!n.fixUpperEdge&&!i.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,n))return}else t.checkForRightSplice(e,n);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i))}},t.connectRightVertex=function(e,n,i){var r,s=i.Onext,o=t.regionBelow(n),a=n.eUp,l=o.eUp,u=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,n),ct.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),n=t.topLeftRegion(e,n),s=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),o),u=!0),ct.vertEq(l.Org,e.event)&&(e.mesh.splice(i,l.Oprev),i=t.finishLeftRegions(e,o,null),u=!0),u){t.addRightEdges(e,n,i.Onext,s,s,!0);return}ct.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(i.Lprev,r),t.addRightEdges(e,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,n)},t.connectLeftDegenerate=function(e,n,i){var r,s,o,a,l;if(r=n.eUp,ct.vertEq(r.Org,i)){mt(!1),t.spliceMergeVertices(e,r,i.anEdge);return}if(!ct.vertEq(r.Dst,i)){e.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(e.mesh.delete(r.Onext),n.fixUpperEdge=!1),e.mesh.splice(i.anEdge,r),t.sweepEvent(e,i);return}mt(!1),n=t.topRightRegion(n),l=t.regionBelow(n),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(mt(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(i.anEdge,o),ct.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,n,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,n){var i,r,s,o,a,l,u=new fb;if(u.eUp=n.anEdge.Sym,i=e.dict.search(u).key,r=t.regionBelow(i),!!r){if(o=i.eUp,a=r.eUp,ct.edgeSign(o.Dst,n,o.Org)===0){t.connectLeftDegenerate(e,i,n);return}if(s=ct.vertLeq(a.Dst,o.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=e.mesh.connect(n.anEdge.Sym,o.Lnext);else{var d=e.mesh.connect(a.Dnext,n.anEdge);l=d.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,i,l)),t.sweepEvent(e,n)}else t.addRightEdges(e,i,n.anEdge,n.anEdge,null,!0)}},t.sweepEvent=function(e,n){e.event=n,t.debugEvent(e);for(var i=n.anEdge;i.activeRegion===null;)if(i=i.Onext,i===n.anEdge){t.connectLeftVertex(e,n);return}var r=t.topLeftRegion(e,i.activeRegion);mt(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,n,i,r){var s=new fb,o=e.mesh.makeEdge();o.Org.s=i,o.Org.t=r,o.Dst.s=n,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new tde(e,t.edgeLeq);var n=e.bmax[0]-e.bmin[0],i=e.bmax[1]-e.bmin[1],r=e.bmin[0]-n,s=e.bmax[0]+n,o=e.bmin[1]-i,a=e.bmax[1]+i;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var n,i=0;(n=e.dict.min().key)!==null;)n.sentinel||(mt(n.fixUpperEdge),mt(++i===1)),mt(n.windingNumber===0),t.deleteRegion(e,n)},t.removeDegenerateEdges=function(e){var n,i,r,s=e.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,ct.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(t.spliceMergeVertices(e,r,n),e.mesh.delete(n),n=r,r=n.Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),e.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),e.mesh.delete(n))},t.initPriorityQ=function(e){var n,i,r,s=0;for(r=e.mesh.vHead,i=r.next;i!==r;i=i.next)s++;for(s+=8,n=e.pq=new ede(s,ct.vertLeq),r=e.mesh.vHead,i=r.next;i!==r;i=i.next)i.pqHandle=n.insert(i);return i!==r?!1:(n.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,s=i.anEdge,mt(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,n){n===void 0&&(n=!0);var i,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(i=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!ct.vertEq(r,i));)r=e.pq.extractMin(),t.spliceMergeVertices(e,i.anEdge,r.anEdge);t.sweepEvent(e,i)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(n&&e.mesh.check(),!0):!1},t}(),ide=function(){function t(){this.mesh=new WO,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=un.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},t.prototype.normalize_=function(e){var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),e[0]/=n,e[1]/=n,e[2]/=n},t.prototype.longAxis_=function(e){var n=0;return Math.abs(e[1])>Math.abs(e[0])&&(n=1),Math.abs(e[2])>Math.abs(e[n])&&(n=2),n},t.prototype.computeNormal_=function(e){var n,i,r,s,o,a,l=[0,0,0],u=[0,0,0],d=[0,0,0],c=[0,0,0],h=[0,0,0],f=[null,null,null],m=[null,null,null],x=this.mesh.vHead;n=x.next;for(var y=0;y<3;++y)s=n.coords[y],u[y]=s,m[y]=n,l[y]=s,f[y]=n;for(n=x.next;n!==x;n=n.next)for(var v=0;v<3;++v)s=n.coords[v],s<u[v]&&(u[v]=s,m[v]=n),s>l[v]&&(l[v]=s,f[v]=n);var _=0;if(l[1]-u[1]>l[0]-u[0]&&(_=1),l[2]-u[2]>l[_]-u[_]&&(_=2),u[_]>=l[_]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,i=m[_],r=f[_],d[0]=i.coords[0]-r.coords[0],d[1]=i.coords[1]-r.coords[1],d[2]=i.coords[2]-r.coords[2],n=x.next;n!==x;n=n.next)c[0]=n.coords[0]-r.coords[0],c[1]=n.coords[1]-r.coords[1],c[2]=n.coords[2]-r.coords[2],h[0]=d[1]*c[2]-d[2]*c[1],h[1]=d[2]*c[0]-d[0]*c[2],h[2]=d[0]*c[1]-d[1]*c[0],o=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],o>a&&(a=o,e[0]=h[0],e[1]=h[1],e[2]=h[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(d)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,n,i=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(n=i.next;n!==i;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,n=[0,0,0],i,r,s=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),s=!0),i=this.sUnit,r=this.tUnit;var o=this.longAxis_(n);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=n[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,i),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,u=e.next;u!==e;u=u.next)l?(this.bmin[0]=this.bmax[0]=u.s,this.bmin[1]=this.bmax[1]=u.t,l=!1):(u.s<this.bmin[0]&&(this.bmin[0]=u.s),u.s>this.bmax[0]&&(this.bmax[0]=u.s),u.t<this.bmin[1]&&(this.bmin[1]=u.t),u.t>this.bmax[1]&&(this.bmax[1]=u.t))},t.prototype.addWinding_=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,n){var i,r;if(i=n.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;ct.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;ct.vertLeq(i.Org,i.Dst);i=i.Lnext);r=i.Lprev;for(var s=void 0;i.Lnext!==r;)if(ct.vertLeq(i.Dst,r.Org)){for(;r.Lnext!==i&&(ct.edgeGoesLeft(r.Lnext)||ct.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==i&&(ct.edgeGoesRight(i.Lprev)||ct.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=e.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(r.Lnext===i)throw"Mono region invalid";for(;r.Lnext.Lnext!==i;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)if(n=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0},t.prototype.discardExterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)n=i.next,i.inside||e.zapFace(i)},t.prototype.setWindingNumber_=function(e,n,i){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?n:-n:i?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,n,i,r){var s,o=0,a=0,l;i>3&&e.mergeConvexFaces(i);for(var u=e.vHead.next;u!==e.vHead;u=u.next)u.n=-1;for(var d=e.fHead.next;d!==e.fHead;d=d.next)if(d.n=-1,!!d.inside){s=d.anEdge,l=0;do{var u=s.Org;u.n===-1&&(u.n=a,a++),l++,s=s.Lnext}while(s!==d.anEdge);if(l>i)throw"Face vertex greater that support polygon";d.n=o,++o}this.elementCount=o,n===ci.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var u=e.vHead.next;u!==e.vHead;u=u.next)if(u.n!==-1){var c=u.n*r;this.vertices[c+0]=u.coords[0],this.vertices[c+1]=u.coords[1],r>2&&(this.vertices[c+2]=u.coords[2]),this.vertexIndices[u.n]=u.idx}for(var h=0,d=e.fHead.next;d!==e.fHead;d=d.next)if(d.inside){s=d.anEdge,l=0;do{var u=s.Org;this.elements[h++]=u.n,l++,s=s.Lnext}while(s!==d.anEdge);for(var f=l;f<i;++f)this.elements[h++]=-1;if(n===ci.CONNECTED_POLYGONS){s=d.anEdge;do this.elements[h++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==d.anEdge);for(var m=l;m<i;++m)this.elements[h++]=-1}}},t.prototype.outputContours_=function(e,n){var i,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=i=a.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,u=0,d=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=i=a.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],n>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[u++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==r);this.elements[d++]=s,this.elements[d++]=o,s+=o}},t.prototype.addContour=function(e,n){this.mesh===null&&(this.mesh=new WO),e<2&&(e=2),e>3&&(e=3);for(var i=null,r=0;r<n.length;r+=e)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=n[r+0],i.Org.coords[1]=n[r+1],e>2?i.Org.coords[2]=n[r+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},t.prototype.tesselate=function(e,n,i,r,s,o){if(e===void 0&&(e=un.ODD),n===void 0&&(n=ci.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),nde.computeInterior(this,o);var a=this.mesh;return n===ci.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),n===ci.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,n,i,r),!0},t}();function Ul(t){var e=t.windingRule,n=e===void 0?un.ODD:e,i=t.elementType,r=i===void 0?ci.POLYGONS:i,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,u=t.normal,d=u===void 0?[0,0,1]:u,c=t.contours,h=c===void 0?[]:c,f=t.strict,m=f===void 0?!0:f,x=t.debug,y=x===void 0?!1:x;if(!h&&m)throw new Error("Contours can't be empty");if(h){var v=new ide;t.edgeCreateCallback&&(v.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(v.vertexIdCallback=t.vertexIdCallback);for(var _=0;_<h.length;_++)v.addContour(l||2,h[_]);return v.tesselate(n,r,o,l,d,m),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:y?v.mesh:void 0}}}un.ODD;un.NONZERO;un.POSITIVE;un.NEGATIVE;un.ABS_GEQ_TWO;ci.POLYGONS;ci.CONNECTED_POLYGONS;ci.BOUNDARY_CONTOURS;var SA=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let n=t*SA.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*i,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let n=t*SA.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(i,s*r,3*t);s+=3*t;let a=new Float32Array(i,s*r,3*t);s+=3*t;let l=new Float32Array(i,s*r,2*t);e?(o.set(this.positions.subarray(0,this.size*3)),a.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(o.set(this.positions),a.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let i=this.capacity;for(;e>i;)i*=2;this.realloc(i)}let n=this.size;return this.size=e,n}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},MV=SA;MV.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var rde=Tr(Yte()),wC={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},AV={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},EV={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},pb=(t,e)=>([n,i])=>(i<n&&(i+=e),(t>=n?t:t+e)<=i),SC=class extends Ke{constructor(t,e,n=0,i=12,r=3,s=un.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._curveSegments=i,this._bevelSegmentsInput=r;let a=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(P=>{let C=P.extractShapePointsToFlatArray([],i),D=[];for(let U=C.length-1;U>=1;U-=2){let G=C[U-1],k=C[U-0];D.push(G,k)}return D}),u=[],d=[];for(let P=0;P<a.length;P+=2)d.push([a[P],a[P+1]]);u.push(d);for(let P=0;P<l.length;P++){let C=l[P],D=[];for(let U=0;U<C.length;U+=2)D.push([C[U],C[U+1]]);u.push(D)}let c;t.isText?c=new yT().setFromPoints(t.points.map(P=>P.position)).getSize(new ee).length()*.1:u[0].length===0?c=n:c=(0,rde.default)(u).distance,n<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(n,c,e/2),this._bevelSegments=Math.floor(r));let h;try{h=Ul({windingRule:s,elementType:ci.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a]})}catch{h=wC}let f;try{f=Ul({windingRule:un.ODD,elementType:ci.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=AV}if(!h)throw new Error("error generating geometry");let m=h.elementCount;if(f){h.elementCount+=f.elementCount;for(let P=0;P<f.elements.length;P++){let C=f.elements[P],D=P%2===0?h.vertexCount:0;h.elements.push(C+D)}for(let P=0;P<f.vertexIndices.length;P++){let C=f.vertexIndices[P],D=h.vertexCount;h.vertexIndices.push(C+D)}for(let P=0;P<f.vertices.length;P++){let C=f.vertices[P];h.vertices.push(C)}}let x=1/0,y=-1/0,v=1/0,_=-1/0;for(let P=0,C=h.vertexCount;P<C;P++){let D=P*2,U=h.vertices[D+0],G=h.vertices[D+1];U<x&&(x=U),U>y&&(y=U),G<v&&(v=G),G>_&&(_=G)}this._minX=x,this._minY=v,this._width=y-x,this._height=_-v,this._buffer=new MV(this._computeBufferEstimatedSize(h));let w=[],b=[];for(let P=h.elementCount-1;P>=0;P--){let C=P>=m,D=P*2,U=h.elements[D+0],G=h.elements[D+1],k=U+G,H={start:U,count:G,normals:[],continuous:[],concave:[]},K=U,q=k-1,N=U+1,V=this._shape.roundedCurves.length;do{let Q=K-U,J=h.vertices[q*2+0],ie=h.vertices[q*2+1],se=h.vertices[K*2+0],pe=h.vertices[K*2+1],le=h.vertices[N*2+0],Ae=h.vertices[N*2+1],ae=se-J,W=pe-ie,me=Math.sqrt(ae*ae+W*W);ae/=me,W/=me;let ue=se-le,ce=pe-Ae,ge=Math.sqrt(ue*ue+ce*ce);ue/=ge,ce/=ge,H.normals[Q*2+0]=-ce,H.normals[Q*2+1]=ue,H.concave[Q]=ae*ce-W*ue>0;let De=h.vertexIndices[K];if(Array.isArray(De))H.continuous[Q]=!1;else{let[Me,Ce]=this._shape.getCurveIndexFromVertexId(De-1,!0);if(Ce>0&&Ce<1)H.continuous[Q]=!0;else{let ke=Ce===1?Me+1:Me-1;ke=(ke+V)%V;let He=Ce===1?0:1,bt=this._shape.roundedCurves[Me].getTangent(Ce),Y=this._shape.roundedCurves[ke].getTangent(He);H.continuous[Q]=bt.dot(Y)>.95}}C&&(H.normals[Q*2+0]*=-1,H.normals[Q*2+1]*=-1),[q,K,N]=[K,N,N+1],N>=k&&(N-=G)}while(N!==U+1);let j=[];j.push({bevelI:0,angle:0,size:0,boundary:{vertices:h.vertices.slice(U*2,k*2),vertexCount:G,vertexIndices:new Array(G).fill(!0).map((Q,J)=>[J,J]),elements:[0,G],elementCount:1,mesh:null},reverseMap:[],insetPoints:h.vertices.slice(U*2,k*2)});let z=0;for(let Q=1;Q<=this._bevelSegments;Q++){let J=Q/this._bevelSegments*Math.PI/2,ie=(1-Math.cos(J))*this._bevel,se=[],pe=[],le=0;for(let ae=0;ae<G;ae++){let W=ae*2,me=(ae-1+G)%G*2,ue=h.vertices[H.start*2+W+0],ce=h.vertices[H.start*2+W+1],ge=-H.normals[me+0]*ie,De=-H.normals[me+1]*ie,Me=-H.normals[W+0]*ie,Ce=-H.normals[W+1]*ie;if(H.concave[ae]||!H.concave[ae]&&C){let ke=Math.atan2(De,ge),He=Math.atan2(Ce,Me);He>ke&&(He-=Math.PI*2);let bt=He-ke;if(H.continuous[ae]||C){let Y=ke+bt/2,B=Math.cos(Y)*ie,he=Math.sin(Y)*ie;se[2*le+0]=ue+B*(C?-1:1),se[2*le+1]=ce+he*(C?-1:1),pe[le]=ae,le++}else{let Y=Math.max(1,Math.floor(i/4*Math.abs(bt)/Math.PI));for(let B=0;B<=Y;B++){let he=ke+bt*(B/Y),Re=Math.cos(he)*ie,Le=Math.sin(he)*ie;se[2*le+0]=ue+Re,se[2*le+1]=ce+Le,pe[le]=ae,le++}}}else se[2*le+0]=ue+ge,se[2*le+1]=ce+De,pe[le]=ae,le++,se[2*le+0]=ue,se[2*le+1]=ce,pe[le]=ae,le++,se[2*le+0]=ue+Me,se[2*le+1]=ce+Ce,pe[le]=ae,le++}let Ae=Ul({windingRule:un.POSITIVE,elementType:ci.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[se],edgeCreateCallback:ae=>{let W=ae.Org.idx,me=pe[W],ue=pe[(W+1)%pe.length];ae.idx=[me,ue],ae.Sym.idx=[ue,me]},vertexIdCallback:ae=>{let W=ae.Lprev.idx;return[W?W[1]:0,ae.idx?ae.idx[0]:0]}});if(!Ae)throw console.log("Error"),new Error(`error generating bevel geometry for ${Q}'th loop`);if(!Ae.vertexCount){let ae=(Q-1)/this._bevelSegments*Math.PI/2;z=(1-Math.sin(ae))*this._bevel;break}for(let ae=0;ae<Ae.vertexIndices.length;ae++){let[W,me]=Ae.vertexIndices[ae];if(W===me)continue;let ue=me;me<W&&(ue+=G);for(let ce=W;ce<ue;ce++){let ge=ce%G,De=(ce+1)%G;if(!H.continuous[ge]||!H.continuous[De]){Ae.vertexIndices[ae]=[W,ge],Ae.vertexIndices.splice(ae+1,0,[De,me]),Ae.vertices.splice((ae+1)*2,0,Ae.vertices[ae*2],Ae.vertices[ae*2+1]);break}}}j.push({bevelI:Q,angle:J,size:ie,boundary:Ae,reverseMap:pe,insetPoints:se})}let $=(Q,J,ie)=>{let se=0,pe=Q.boundary.vertexIndices.length;for(;se<pe&&ie(Q.boundary.vertexIndices[J]);)J=(J+1)%pe,se++;return se},te=w.length;for(let Q=1;Q<j.length;Q++){let J=j[Q-1],ie=j[Q],se=J.boundary.vertexIndices.length,pe=ie.boundary.vertexIndices.length;if(!se||!pe)break;let le=H.concave.length,Ae=0,ae=pb(Ae,G);for(;!J.boundary.vertexIndices.filter(ae).length||!ie.boundary.vertexIndices.filter(ae).length;)Ae++,ae=pb(Ae,G);let W=J.boundary.vertexIndices.findIndex(ae),me=ie.boundary.vertexIndices.findIndex(ae);do W=(W+1)%se;while(ae(J.boundary.vertexIndices[W]));do me=(me+1)%pe;while(ae(ie.boundary.vertexIndices[me]));Ae=(Ae+1)%G;let ue=Ae,ce=0,ge=this._buildBevelVert(H,J,(W-1+se)%se,void 0,ce),De=this._buildBevelVert(H,ie,(me-1+pe)%pe,void 0,ce),Me=ge,Ce=De,ke,He,bt=!1;do{ce=(Ae||le)/le,ae=pb(Ae,G);let Y=$(J,W,ae),B=$(ie,me,ae),he=bt;if(bt=!1,Y&&!B){for(let Re=0;Re<Y;Re++)ke=this._buildBevelVert(H,J,(W+Re)%se,Re/(Y-1),ce),w.push(Me.topN,ke.topP,Ce.topN),o===!1&&w.push(ke.bottomP,Me.bottomN,Ce.bottomN),Me=ke;bt=!0}else if(!Y&&B)for(let Re=0;Re<B;Re++)He=this._buildBevelVert(H,ie,(me+Re)%pe,Re/(B-1),ce),w.push(Ce.topN,Me.topP,He.topP),o===!1&&w.push(Me.bottomP,Ce.bottomN,He.bottomP),Ce=He;else if(Y&&B)if(ke=this._buildBevelVert(H,J,W,0,ce),He=this._buildBevelVert(H,ie,me,0,ce),he?(w.push(Me.topN,He.topP,Ce.topN),w.push(Me.topN,ke.topP,He.topP),o===!1&&(w.push(He.bottomP,Me.bottomN,Ce.bottomN),w.push(He.bottomP,ke.bottomP,Me.bottomN))):(w.push(Ce.topN,Me.topN,ke.topP),w.push(Ce.topN,ke.topP,He.topP),o===!1&&(w.push(ke.bottomP,Me.bottomN,Ce.bottomN),w.push(ke.bottomP,Ce.bottomN,He.bottomP))),Me=ke,Ce=He,Y===B)for(let Re=1;Re<Y;Re++)ke=this._buildBevelVert(H,J,(W+Re)%se,Re/(Y-1),ce),He=this._buildBevelVert(H,ie,(me+Re)%pe,Re/(B-1),ce),w.push(Me.topN,ke.topP,Ce.topN),w.push(Ce.topN,ke.topP,He.topP),o===!1&&(w.push(ke.bottomP,Me.bottomN,Ce.bottomN),w.push(ke.bottomP,Ce.bottomN,He.bottomP)),Me=ke,Ce=He;else if(Y>B){let Re=Y/B,Le=0;for(let Ie=1;Ie<Y;Ie++)ke=this._buildBevelVert(H,J,(W+Ie)%se,Ie/(Y-1),ce),w.push(Me.topN,ke.topP,Ce.topN),o===!1&&w.push(ke.bottomP,Me.bottomN,Ce.bottomN),Me=ke,Ie>(Le+1)*Re&&(Le++,He=this._buildBevelVert(H,ie,(me+Le)%pe,Le/(B-1),ce),w.push(Ce.topN,ke.topP,He.topP),o===!1&&w.push(ke.bottomP,Ce.bottomN,He.bottomP),Ce=He)}else{let Re=B/Y,Le=0;for(let Ie=1;Ie<B;Ie++)He=this._buildBevelVert(H,ie,(me+Ie)%pe,Ie/(B-1),ce),w.push(Ce.topN,ke.topP,He.topP),o===!1&&w.push(ke.bottomP,Ce.bottomN,He.bottomP),Ce=He,Ie>(Le+1)*Re&&(Le++,ke=this._buildBevelVert(H,J,(W+Le)%se,Le/(Y-1),ce),w.push(Me.topN,ke.topP,Ce.topN),o===!1&&w.push(ke.bottomP,Me.bottomN,Ce.bottomN),Me=ke)}W=(W+Y)%se,me=(me+B)%pe,Ae=(Ae+1)%le}while(Ae!==ue)}if(o===!1&&this._depth>this._bevel*2&&this._buildWall(j,H,w),C){let Q=[];for(let J=w.length-1;J>=te+2;J-=3){let ie=w[J-2],se=w[J-1],pe=w[J-0];Q.push(pe,se,ie)}w.splice(te,w.length-te,...Q)}if(C){let Q=[];for(let J=j[j.length-1].boundary.vertices.length-1;J>=1;J-=2){let ie=j[j.length-1].boundary.vertices[J-1],se=j[j.length-1].boundary.vertices[J-0];Q.push(ie,se)}b.push(Q)}if(!C){let Q=j[j.length-1],J;try{J=Ul({windingRule:j.length>1?un.POSITIVE:un.ODD,elementType:ci.POLYGONS,vertexSize:2,strict:!0,contours:[Q.insetPoints,...b]})}catch{J=EV}if(!J)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<c&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ie=0;ie<J.elementCount*3;ie+=3){let se=this._buildSurfaceVert(J,J.elements[ie+0],z),pe=this._buildSurfaceVert(J,J.elements[ie+1],z),le=this._buildSurfaceVert(J,J.elements[ie+2],z);w.push(se.top,pe.top,le.top),o===!1&&w.push(le.bottom,pe.bottom,se.bottom)}}this.vertexCache={}}this._buffer.shrink();let E=new ht(Uint32Array.from(w),1),A=new ht(this._buffer.positions,3),T=new ht(this._buffer.normals,3),L=new ht(this._buffer.uvs,2);A.needsUpdate=!0,T.needsUpdate=!0,L.needsUpdate=!0,E.needsUpdate=!0,this.setAttribute("position",A),this.setAttribute("normal",T),this.setAttribute("uv",L),this.setIndex(E)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e,n){let i=e.toString();if(i in this.vertexCache)return this.vertexCache[i];let r=t.vertices[e*2+0],s=t.vertices[e*2+1],o=(r-this._minX)/this._width,a=(s-this._minY)/this._height;this.forPathBevel&&(a=1);let l=this._buffer.get(this.forPathBevel?1:2),u=l*3,d=l*2,c={top:l+0,bottom:l+1};return this._buffer.positions[u+0]=r,this._buffer.positions[u+1]=s,this._buffer.positions[u+2]=this.forPathBevel?this._bevel:this._depth-n,this._buffer.normals[u+0]=0,this._buffer.normals[u+1]=0,this._buffer.normals[u+2]=1,this._buffer.uvs[d+0]=o,this._buffer.uvs[d+1]=a,this.forPathBevel===!1&&(this._buffer.positions[u+3]=r,this._buffer.positions[u+4]=s,this._buffer.positions[u+5]=n,this._buffer.normals[u+3]=0,this._buffer.normals[u+4]=0,this._buffer.normals[u+5]=-1,this._buffer.uvs[d+2]=o,this._buffer.uvs[d+3]=a),this.vertexCache[i]=c,c}_buildBevelVert(t,e,n,i=1,r){let s=`${e.bevelI}:${n}`;if(s in this.vertexCache&&r!==0&&r!==1&&(!r||r===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[o,a]=e.boundary.vertexIndices[n],l,u,d,c;o!==a?(u=o,l=a,c=!1,d=t.continuous[u]&&t.continuous[l]):(l=o,u=(l-1+t.count)%t.count,c=t.concave[l]&&e.bevelI>0,d=t.continuous[l]||c);let h=Math.cos(e.angle),f=Math.sin(e.angle),m=n*2,x=l*2,y=u*2,v=e.boundary.vertices[m+0],_=e.boundary.vertices[m+1],w=(1-f)*this._bevel,b=(v-this._minX)/this._width,E=(_-this._minY)/this._height;this.forPathBevel&&(r!==void 0&&(b=r),E=1);let A=t.normals[x+0],T=t.normals[x+1],L=t.normals[y+0],P=t.normals[y+1];if(c){let k=L-A,H=P-T;A=A+k*(1-i),T=T+H*(1-i);let K=Math.sqrt(A*A+T*T);A/=K,T/=K}let C=this.forPathBevel?this._buffer.get(d?1:2):this._buffer.get(d?2:4),D=C*3,U=C*2,G={i:n,fi:l,topP:C+0,topN:C+0,bottomP:C+1,bottomN:C+1,pathBevelUCoord:r};return this._buffer.positions[D+0]=v,this._buffer.positions[D+1]=_,this._buffer.positions[D+2]=(this.forPathBevel?this._bevel:this._depth)-w,this._buffer.normals[D+0]=A*h,this._buffer.normals[D+1]=T*h,this._buffer.normals[D+2]=f,this._buffer.uvs[U+0]=b,this._buffer.uvs[U+1]=E,this.forPathBevel===!1&&(this._buffer.positions[D+3]=v,this._buffer.positions[D+4]=_,this._buffer.positions[D+5]=w,this._buffer.normals[D+3]=A*h,this._buffer.normals[D+4]=T*h,this._buffer.normals[D+5]=-f,this._buffer.uvs[U+2]=E,this._buffer.uvs[U+3]=b),d||(this.forPathBevel?(C+=1,D+=3,U+=2):(C+=2,D+=6,U+=4),G.topP=C+0,G.bottomP=C+1,this._buffer.positions[D+0]=v,this._buffer.positions[D+1]=_,this._buffer.positions[D+2]=(this.forPathBevel?this._bevel:this._depth)-w,this._buffer.normals[D+0]=L*h,this._buffer.normals[D+1]=P*h,this._buffer.normals[D+2]=f,this._buffer.uvs[U+0]=b,this._buffer.uvs[U+1]=E,this.forPathBevel===!1&&(this._buffer.positions[D+3]=v,this._buffer.positions[D+4]=_,this._buffer.positions[D+5]=w,this._buffer.normals[D+3]=L*h,this._buffer.normals[D+4]=P*h,this._buffer.normals[D+5]=-f,this._buffer.uvs[U+2]=E,this._buffer.uvs[U+3]=b)),this.vertexCache[s]=G,G}clone(){let t=new SC(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=e_(this.userData),t}},TV=class extends Ke{constructor(t,e=12,n={}){super(),this.type="ShapeGeometry",this.windingRule=un.ODD,this.elementType=ci.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:un.ODD,elementType:ci.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(h=>h.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,u;for(let h=0,f=i.length/2;h<f;h++){let m=h*2,x=i[m+0],y=i[m+1];if(l!==void 0&&x!==l&&(o=!1),u!==void 0&&y!==u&&(a=!1),l=x,u=y,!o&&!a)break}if(!o&&!a)try{s=Ul({contours:[i,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=wC}let d=(s==null?void 0:s.vertexCount)??1,c=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new ht(new Float32Array(d*3),3),this._normalAttribute=new ht(new Float32Array(d*3),3),this._uvAttribute=new ht(new Float32Array(d*2),2),this._indexAttribute=new ht(new Uint32Array(c*3),1),s){let h=1/0,f=-1/0,m=1/0,x=-1/0;for(let _=0,w=d;_<w;_++){let b=_*2,E=s.vertices[b+0],A=s.vertices[b+1];E<h&&(h=E),E>f&&(f=E),A<m&&(m=A),A>x&&(x=A)}let y=f-h,v=x-m;for(let _=0,w=d;_<w;_++){let b=_*2,E=s.vertices[b+0],A=s.vertices[b+1],T=(E-h)/y,L=(A-m)/v;this._positionAttribute.setXYZ(_,E,A,0),this._normalAttribute.setXYZ(_,0,0,1),this._uvAttribute.setXY(_,T,L)}for(let _=0,w=c;_<w;_++){let b=_*3,E=s.elements[b+0],A=s.elements[b+1],T=s.elements[b+2];this._indexAttribute.setX(b+0,E),this._indexAttribute.setX(b+1,A),this._indexAttribute.setX(b+2,T)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new TV(this._shape,this._curveSegments);return t.userData=e_(this.userData),t}},CV=class extends SC{constructor(t,e,n=0,i=12,r=3,s=un.ODD){super(t,e,n,i,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new CV(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=e_(this.userData),t}},qc=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var u,d;let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:un.ODD},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??n.roundness;o!==void 0&&(o instanceof qn?(o.width!==i||o.height!==r)&&o.applySize(i,r):o=new qn(i,r).fromJSON(o),((u=t.parameters)==null?void 0:u.roundness)!==void 0&&((d=t.parameters)==null?void 0:d.roundness)>0&&o.update());let l=o??new qn(i,r);return{parameters:Object.assign(n,{width:i,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new TV(t.shape,r,{windingRule:o}):a=new CV(t.shape,e,n,r,i,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},PV=Math.PI*2,bC=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return n.angle=Ut.clamp(n.angle,0,360),{shape:t.shape&&t.shape instanceof qn?t.shape:new qn,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u=t.shape,d=e*.5,c=n*.5,h=sde(u,d,c,r*Math.PI/180,i,s);u.isClosed=!0,u.update();let f;return r===0?(f=new Ke,f.setAttribute("position",new Ne([],3))):f=qc.create({shape:u,parameters:{subdivisions:h,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}}),Object.assign(f,{userData:{...t,type:"EllipseGeometry"}})}};function sde(t,e,n,i,r,s){if(i>=PV)return r>30||r%4===0?(ade(t,e,n,s),Math.round(r/4)):YO(t,i,r,e,n,s);i=Math.max(i,.001);let o={x:0,y:n},a=i+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*n},u=Jhe({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%u.length===0?ode(t,o.x,o.y,u,r,e,n,s):YO(t,i,r,e,n,s)}function ode(t,e,n,i,r,s,o,a){let l=Math.round(r/i.length);t.addPoint(Ld(e,n));for(let u=0,d=i.length;u<d;u++){let c=i[u],h=t.points[u],f=Ld(c.x,c.y);h.controls[1].position.set(c.x1,c.y1),f.controls[0].position.set(c.x2,c.y2),t.addPoint(f)}return a>0?RV(t,s,o,a):t.addPoint(Ld(0,0)),l}function YO(t,e,n,i,r,s){let o=-e/n;for(let a=0;a<=n;a++){let l=o*a,u=Math.sin(l)*i,d=Math.cos(l)*r;t.addPoint(Ld(u,d))}return e<PV?s>0?RV(t,i,r,s):t.addPoint(Ld(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&LV(t,i,r,s)),1}function ade(t,e,n,i=0,r=0,s=0){let o=.5522847498,a=e*o,l=n*o;t.addPoint(Yv(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(Yv(r,s+n,r-a,s+n,r+a,s+n)),t.addPoint(Yv(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(Yv(r,s-n,r+a,s-n,r-a,s-n)),i>0&&LV(t,e,n,i)}function Ld(t,e){return new Rd(Ut.generateUUID(),new ee(t,e))}function Yv(t,e,n,i,r,s){let o=Ld(t,e);return o.controls[0].position.set(n,i),o.controls[1].position.set(r,s),o}function RV(t,e,n,i){DV(t,e,n,i).forEach(r=>t.addPoint(r))}function LV(t,e,n,i){let r=DV(t,e,n,i),s=new qn;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function DV(t,e,n,i){let r=i*e/100,s=r*(Math.abs(n)/Math.abs(e)),o=new ee(r/e,s/n),a=t.points.map(l=>{let u=l.clone();return u.uuid=Ut.generateUUID(),u}).reverse();return a.forEach(l=>{l.position.multiply(o);let u=l.controls[0].position.clone().multiply(o),d=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(d),l.controls[1].position.copy(u)}),a}var lde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??i),s=Math.abs(n.depth??i),o=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(n,{width:i,height:r,depth:s,radius:o,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(t){let{width:e,height:n,depth:i,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:u,cornerRadius:d,cornerSegments:c}=t.parameters,h=new IV(!1,e,n,i,r,s,o,a,l,u,d,c);return Object.assign(h,{userData:{...t,type:"HelixGeometry"}})}},mb=new pc([0,0,0],1),IV=class extends Ke{constructor(t=!0,e=1,n=1,i=1,r=1,s=1,o=1,a=1,l=1,u=1,d=1,c=1){if(super(),s===0)return;let h=t&&s===1;h&&(c=0),d>100&&(d=100),d===0&&(c=0);let f=()=>new O,m=new O,x=f(),y=f(),v=f(),_,w,b,E,A,T,L,P,C=f(),D=f(),U=f(),G=f(),k=f(),H=f(),K=f(),q=f(),N=n-2*a+.001,V=N/s,j=Math.ceil(o*s),z=j+1,$=N/j,te=-N/2,Q=u+1,J=2*Math.PI/u,ie=Math.PI/2/c,se=.01,pe=Math.min((1-d/100)*a,a-se),le=a-pe,Ae=0,ae=2,W=c*ae+ae,me=Q*W/ae,ue=me+Q*z,ce=Math.max(0,Q*(z+W)),[ge,De,Me]=[3,3,2].map(Oe=>Array(ce*Oe).fill(0)),Ce=[],ke=r-a;function He(Oe,Ge){let ot=Math.PI/2;T=Ge*$,P=2*Math.PI*(T%V)/V+ot,T+=te,L=Math.sin(P)*ke,A=Math.cos(P)*ke,t?Oe.set(A,L,T):Oe.set(A,T,L)}He(m,-1e-10),He(x,0),C.copy(m),He(m,1);let bt=m.distanceTo(x),Y=h?0:le+pe,B=bt*j+2*Y,he=pe,Re=B-Y;for(let Oe=0;Oe<=j;Oe++){He(y,Oe),q.subVectors(y,C).normalize(),C.copy(y),H.copy(y).setComponent(+t+1,0).normalize(),K.crossVectors(q,H).normalize();let Ge=Oe===0,ot=Oe===j,Wt=Ge?3*Math.PI/2:ie,Fe=Ge?he:Re,Qt=Ge?Q:ue,Mt=Ge?0:ce-Q,gt=q.clone().multiplyScalar(Ge?-le:le).add(y),ft=q.clone().multiplyScalar(Ge?-1:1).normalize();for(let Xe=0;Xe<Q;Xe++){let Ft=Xe*J;if(D.addVectors(m.copy(H).multiplyScalar(a*Math.cos(Ft)),x.copy(K).multiplyScalar(a*Math.sin(Ft))),U.copy(D).normalize(),Ge||ot){h||(Ae=Mt+Xe,[0,1,2].forEach(ne=>{ge[Ae*3+ne]=gt.getComponent(ne),De[Ae*3+ne]=ft.getComponent(ne)}),Me[Ae*2]=+ot,Me[Ae*2+1]=Xe/u),x.copy(U).multiplyScalar(pe),v.addVectors(y,x);for(let ne=0;ne<c;ne++){let Ye=ne*ie+Wt;G.addVectors(m.copy(q).multiplyScalar(le*Math.sin(Ye)),x.copy(U).multiplyScalar(le*Math.cos(Ye))),k.copy(G).normalize(),x.addVectors(v,G),G.normalize(),Ae=Qt+ne*Q+Xe,[0,1,2].forEach(Te=>{ge[Ae*3+Te]=x.getComponent(Te),De[Ae*3+Te]=k.getComponent(Te)});let je=+Ge+Math.sin(Ye);Me[Ae*2]=(Fe+le*je)/B,Me[Ae*2+1]=Xe/u}}x.addVectors(y,D),Ae=me+Oe*Q+Xe,[0,1,2].forEach(ne=>{ge[Ae*3+ne]=x.getComponent(ne),De[Ae*3+ne]=U.getComponent(ne)}),Me[Ae*2]=(Y+Oe*bt)/B,Me[Ae*2+1]=Xe/u}}let Le=z+2*c+ae,[Ie,rt]=[+h,Le-1];for(let Oe=Ie;Oe<=rt-1;Oe++){let Ge=h&&Oe===rt-1;for(let ot=0;ot<Q-1;ot++)_=Oe*Q+ot,w=_+1,b=(Ge?ot:_)+Q,E=(Ge?ot+1:w)+Q,Oe===0?Ce.push(w,E,b):Oe===Le-2?Ce.push(_,w,b):Ce.push(_,w,b,w,E,b)}this.setIndex(Ce),this.setAttribute("position",new Ne(ge,3)),this.setAttribute("normal",new Ne(De,3)),this.setAttribute("uv",new Ne(Me,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let t=this.userData.parameters,e=Math.ceil(t.tubularSegments),n=t.radialSegments+1,i=Array.from(this.getIndex().array),r,s,o,a,l=6*(e-1)*t.radialSegments,u=e,d=u===e;for(let c=0;c<t.radialSegments;c++)r=u*n+c,s=r+1,o=(d?c:r)+n,a=(d?c+1:s)+n,i[l++]=r,i[l++]=s,i[l++]=o,i[l++]=s,i[l++]=a,i[l++]=o;return i.length=l,mb.array=i,mb.count=i.length,mb}},ude=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new OV(e*.5,s,o):new _g(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},OV=class extends yC{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,n),this.type=o}static fromJSON(t){return new OV(t.radius,t.corner,t.cornerSides)}},cde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var i;(((i=t.parameters)==null?void 0:i.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{points:e,segments:n,verticalSegments:i}=t.parameters,r=new fo;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new mf(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},Uo=new Ue,gb=new jt,Zv=new O,q1=class extends sa{constructor(){super(),this.uuid=Ut.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new St().getNormalMatrix(t);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return Uo.makeRotationX(t),this.applyMatrix4(Uo),this}rotateY(t){return Uo.makeRotationY(t),this.applyMatrix4(Uo),this}rotateZ(t){return Uo.makeRotationZ(t),this.applyMatrix4(Uo),this}translate(t,e,n){return Uo.makeTranslation(t,e,n),this.applyMatrix4(Uo),this}scale(t,e,n){return Uo.makeScale(t,e,n),this.applyMatrix4(Uo),this}lookAt(t){return gb.lookAt(t),gb.updateMatrix(),this.applyMatrix4(gb.matrix),this}fromBufferGeometry(t){let e=this,n=t.index!==null?t.index:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,o=i.color,a=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let c=0;c<r.count;c++)e.vertices.push(new O().fromBufferAttribute(r,c)),o!==void 0&&e.colors.push(new We().fromBufferAttribute(o,c));function u(c,h,f,m){let x=o===void 0?[]:[e.colors[c].clone(),e.colors[h].clone(),e.colors[f].clone()],y=s===void 0?[]:[new O().fromBufferAttribute(s,c),new O().fromBufferAttribute(s,h),new O().fromBufferAttribute(s,f)],v=new bA(c,h,f,y,x,m);e.faces.push(v),a!==void 0&&e.faceVertexUvs[0].push([new ee().fromBufferAttribute(a,c),new ee().fromBufferAttribute(a,h),new ee().fromBufferAttribute(a,f)]),l!==void 0&&e.faceVertexUvs[1].push([new ee().fromBufferAttribute(l,c),new ee().fromBufferAttribute(l,h),new ee().fromBufferAttribute(l,f)])}let d=t.groups;if(d.length>0)for(let c=0;c<d.length;c++){let h=d[c],f=h.start,m=h.count;for(let x=f,y=f+m;x<y;x+=3)n!==void 0?u(n.getX(x),n.getX(x+1),n.getX(x+2),h.materialIndex):u(x,x+1,x+2,h.materialIndex)}else if(n!==void 0)for(let c=0;c<n.count;c+=3)u(n.getX(c),n.getX(c+1),n.getX(c+2));else for(let c=0;c<r.count;c+=3)u(c,c+1,c+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zv).negate(),this.translate(Zv.x,Zv.y,Zv.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,n=e===0?1:1/e,i=new Ue;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let t=new O,e=new O;for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)e[n]=new O;if(t){let n=new O,i=new O;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c];n.subVectors(u,l),i.subVectors(a,l),n.cross(i),e[o.a].add(n),e[o.b].add(n),e[o.c].add(n)}}else{this.computeFaceNormals();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)e[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let r=0,s=i.vertexNormals.length;r<s;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}let t=new q1;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new O,u={a:new O,b:new O,c:new O};r.push(l),s.push(u)}}let i=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=i.faceNormals[r],l=i.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gi),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,n=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let i,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,u=this.colors,d=t.colors;e!==void 0&&(i=new St().getNormalMatrix(e));for(let c=0,h=o.length;c<h;c++){let f=o[c].clone();e!==void 0&&f.applyMatrix4(e),s.push(f)}for(let c=0,h=d.length;c<h;c++)u.push(d[c].clone());for(let c=0,h=l.length;c<h;c++){let f=l[c],m,x,y=f.vertexNormals,v=f.vertexColors,_=new bA(f.a+r,f.b+r,f.c+r);_.normal.copy(f.normal),i!==void 0&&_.normal.applyMatrix3(i).normalize();for(let w=0,b=y.length;w<b;w++)m=y[w].clone(),i!==void 0&&m.applyMatrix3(i).normalize(),_.vertexNormals.push(m);_.color.copy(f.color);for(let w=0,b=v.length;w<b;w++)x=v[w],_.vertexColors.push(x.clone());_.materialIndex=f.materialIndex+n,a.push(_)}for(let c=0,h=t.faceVertexUvs.length;c<h;c++){let f=t.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let m=0,x=f.length;m<x;m++){let y=f[m],v=[];for(let _=0,w=y.length;_<w;_++)v.push(y[_].clone());this.faceVertexUvs[c].push(v)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},n=[],i=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let u=this.vertices[a],d=Math.round(u.x*r)+"_"+Math.round(u.y*r)+"_"+Math.round(u.z*r);e[d]===void 0?(e[d]=a,n.push(this.vertices[a]),i[a]=n.length-1):i[a]=i[e[d]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let u=this.faces[a];u.a=i[u.a],u.b=i[u.b],u.c=i[u.c];let d=[u.a,u.b,u.c];for(let c=0;c<3;c++)if(d[c]===d[(c+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let u=0,d=this.faceVertexUvs.length;u<d;u++)this.faceVertexUvs[u].splice(l,1)}let o=this.vertices.length-n.length;return this.vertices=n,o}setFromPoints(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){let i=t[e];this.vertices.push(new O(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function n(a,l){return a.materialIndex-l.materialIndex}t.sort(n);let i=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;i&&i.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(i[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let m in f)f[m]!==void 0&&(t[m]=f[m]);return t}let e=[];for(let f=0;f<this.vertices.length;f++){let m=this.vertices[f];e.push(m.x,m.y,m.z)}let n=[],i=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let m=this.faces[f],x=!0,y=!1,v=this.faceVertexUvs[0][f]!==void 0,_=m.normal.length()>0,w=m.vertexNormals.length>0,b=m.color.r!==1||m.color.g!==1||m.color.b!==1,E=m.vertexColors.length>0,A=0;if(A=u(A,0,0),A=u(A,1,x),A=u(A,2,y),A=u(A,3,v),A=u(A,4,_),A=u(A,5,w),A=u(A,6,b),A=u(A,7,E),n.push(A),n.push(m.a,m.b,m.c),n.push(m.materialIndex),v){let T=this.faceVertexUvs[0][f];n.push(h(T[0]),h(T[1]),h(T[2]))}if(_&&n.push(d(m.normal)),w){let T=m.vertexNormals;n.push(d(T[0]),d(T[1]),d(T[2]))}if(b&&n.push(c(m.color)),E){let T=m.vertexColors;n.push(c(T[0]),c(T[1]),c(T[2]))}}function u(f,m,x){return x?f|1<<m:f&~(1<<m)}function d(f){let m=f.x.toString()+f.y.toString()+f.z.toString();return r[m]!==void 0||(r[m]=i.length/3,i.push(f.x,f.y,f.z)),r[m]}function c(f){let m=f.r.toString()+f.g.toString()+f.b.toString();return o[m]!==void 0||(o[m]=s.length,s.push(f.getHex())),o[m]}function h(f){let m=f.x.toString()+f.y.toString();return l[m]!==void 0||(l[m]=a.length/2,a.push(f.x,f.y)),l[m]}return t.data={},t.data.vertices=e,t.data.normals=i,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=n,t}clone(){return new q1().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let c=0,h=e.length;c<h;c++)this.vertices.push(e[c].clone());let n=t.colors;for(let c=0,h=n.length;c<h;c++)this.colors.push(n[c].clone());let i=t.faces;for(let c=0,h=i.length;c<h;c++)this.faces.push(i[c].clone());for(let c=0,h=t.faceVertexUvs.length;c<h;c++){let f=t.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let m=0,x=f.length;m<x;m++){let y=f[m],v=[];for(let _=0,w=y.length;_<w;_++){let b=y[_];v.push(b.clone())}this.faceVertexUvs[c].push(v)}}let r=t.morphTargets;for(let c=0,h=r.length;c<h;c++){let f={};if(f.name=r[c].name,r[c].vertices!==void 0){f.vertices=[];for(let m=0,x=r[c].vertices.length;m<x;m++)f.vertices.push(r[c].vertices[m].clone())}if(r[c].normals!==void 0){f.normals=[];for(let m=0,x=r[c].normals.length;m<x;m++)f.normals.push(r[c].normals[m].clone())}this.morphTargets.push(f)}let s=t.morphNormals;for(let c=0,h=s.length;c<h;c++){let f={};if(s[c].vertexNormals!==void 0){f.vertexNormals=[];for(let m=0,x=s[c].vertexNormals.length;m<x;m++){let y=s[c].vertexNormals[m],v={};v.a=y.a.clone(),v.b=y.b.clone(),v.c=y.c.clone(),f.vertexNormals.push(v)}}if(s[c].faceNormals!==void 0){f.faceNormals=[];for(let m=0,x=s[c].faceNormals.length;m<x;m++)f.faceNormals.push(s[c].faceNormals[m].clone())}this.morphNormals.push(f)}let o=t.skinWeights;for(let c=0,h=o.length;c<h;c++)this.skinWeights.push(o[c].clone());let a=t.skinIndices;for(let c=0,h=a.length;c<h;c++)this.skinIndices.push(a[c].clone());let l=t.lineDistances;for(let c=0,h=l.length;c<h;c++)this.lineDistances.push(l[c]);let u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());let d=t.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new hde().fromGeometry(this),e=new Ke,n=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",Kv.call(new ht(n,3),t.vertices)),t.normals.length>0){let i=new Float32Array(t.normals.length*3);e.setAttribute("normal",Kv.call(new ht(i,3),t.normals))}if(t.colors.length>0){let i=new Float32Array(t.colors.length*3);e.setAttribute("color",ZO.call(new ht(i,3),t.colors))}if(t.uvs.length>0){let i=new Float32Array(t.uvs.length*2);e.setAttribute("uv",KO.call(new ht(i,2),t.uvs))}if(t.uvs2.length>0){let i=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",KO.call(new ht(i,2),t.uvs2))}e.groups=t.groups;for(let i in t.morphTargets){let r=[],s=t.morphTargets[i];for(let o=0,a=s.length;o<a;o++){let l=s[o],u=new Ne(l.data.length*3,3);u.name=l.name,r.push(Kv.call(u,l.data))}e.morphAttributes[i]=r}if(t.skinIndices.length>0){let i=new Ne(t.skinIndices.length*4,4);e.setAttribute("skinIndex",QO.call(i,t.skinIndices))}if(t.skinWeights.length>0){let i=new Ne(t.skinWeights.length*4,4);e.setAttribute("skinWeight",QO.call(i,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Ke,n=t.geometry;if(t.isPoints||t.isLine){let i=new Ne(n.vertices.length*3,3),r=new Ne(n.colors.length*3,3);if(e.setAttribute("position",Kv.call(i,n.vertices)),e.setAttribute("color",ZO.call(r,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let s=new Ne(n.lineDistances.length,1);e.setAttribute("lineDistance",dde.call(s,n.lineDistances))}n.boundingSphere!==null&&(e.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(e.boundingBox=n.boundingBox.clone())}else t.isMesh&&(e=n.toBufferGeometry());return e}};q1.prototype.isGeometry=!0;var hde=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],n,i,r,s=t.faces;for(i=0;i<s.length;i++){let o=s[i];o.materialIndex!==r&&(r=o.materialIndex,n!==void 0&&(n.count=i*3-n.start,e.push(n)),n={start:i*3,materialIndex:r})}n!==void 0&&(n.count=i*3-n.start,e.push(n)),this.groups=e}fromGeometry(t){let e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let y=0;y<a;y++)l[y]={name:o[y].name,data:[]};this.morphTargets.position=l}let u=t.morphNormals,d=u.length,c;if(d>0){c=[];for(let y=0;y<d;y++)c[y]={name:u[y].name,data:[]};this.morphTargets.normal=c}let h=t.skinIndices,f=t.skinWeights,m=h.length===n.length,x=f.length===n.length;n.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let y=0;y<e.length;y++){let v=e[y];this.vertices.push(n[v.a],n[v.b],n[v.c]);let _=v.vertexNormals;if(_.length===3)this.normals.push(_[0],_[1],_[2]);else{let b=v.normal;this.normals.push(b,b,b)}let w=v.vertexColors;if(w.length===3)this.colors.push(w[0],w[1],w[2]);else{let b=v.color;this.colors.push(b,b,b)}if(r===!0){let b=i[0][y];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",y),this.uvs.push(new ee,new ee,new ee))}if(s===!0){let b=i[1][y];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",y),this.uvs2.push(new ee,new ee,new ee))}for(let b=0;b<a;b++){let E=o[b].vertices;l[b].data.push(E[v.a],E[v.b],E[v.c])}for(let b=0;b<d;b++){let E=u[b].vertexNormals[y];c[b].data.push(E.a,E.b,E.c)}m&&this.skinIndices.push(h[v.a],h[v.b],h[v.c]),x&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},bA=class{constructor(t,e,n,i,r,s=0){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new O,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new We,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function dde(t){return this.array.set(t),this}function ZO(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new We),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}function KO(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new ee),e[n++]=s.x,e[n++]=s.y}return this}function Kv(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new O),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}function QO(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Ct),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}var fde=["a","b","c"];function pde(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function vb(t,e,n){let i=Math.min(t,e),r=Math.max(t,e),s=i+"_"+r;return n.get(s)}function yb(t,e,n,i,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,u;if(i.has(l))u=i.get(l);else{let d=n[o],c=n[a];u={a:d,b:c,newEdge:null,faces:[]},i.set(l,u)}u.faces.push(r),s[t].edges.push(u),s[e].edges.push(u)}function mde(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;r++)n[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],yb(o.a,o.b,t,i,o,n),yb(o.b,o.c,t,i,o,n),yb(o.c,o.a,t,i,o,n)}function Qv(t,e,n,i,r){t.push(new bA(e,n,i,void 0,void 0,r))}function Nh(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function Jv(t,e,n,i){t.push([e.clone(),n.clone(),i.clone()])}var gde=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Ke?t=new q1().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new O,n,i,r,s,o,a=t.vertices,l=t.faces,u=t.faceVertexUvs[0],d=u!==void 0&&u.length>0,c=[],h=new Map;mde(a,l,c,h);let f=[],m,x,y,v,_,w,b;for(let se of Array.from(h.keys())){for(x=h.get(se),y=new O,_=3/8,w=1/8,b=x.faces.length,b!=2&&(_=.5,w=0,b!=1),y.addVectors(x.a,x.b).multiplyScalar(_),e.set(0,0,0),s=0;s<b;s++){for(v=x.faces[s],o=0;o<3&&(m=a[pde(v,fde[o])],!(m!==x.a&&m!==x.b));o++);m&&e.add(m)}e.multiplyScalar(w),y.add(e),x.newEdge=f.length,f.push(y)}let E,A,T,L,P,C,D,U=[];for(i=0,r=a.length;i<r;i++){for(C=a[i],P=c[i].edges,n=P.length,n==3?E=3/16:n>3&&(E=3/(8*n)),A=1-n*Number(E),T=E,n<=2&&(n==2?(A=3/4,T=1/8):n==1||n==0),D=C.clone().multiplyScalar(A),e.set(0,0,0),s=0;s<n;s++)L=P[s],m=L.a!==C?L.a:L.b,e.add(m);e.multiplyScalar(Number(T)),D.add(e),U.push(D)}let G=U.concat(f),k=U.length,H,K,q,N=[],V=[],j,z,$,te,Q=new ee,J=new ee,ie=new ee;for(i=0,r=l.length;i<r;i++)v=l[i],H=Number(vb(v.a,v.b,h).newEdge)+k,K=Number(vb(v.b,v.c,h).newEdge)+k,q=Number(vb(v.c,v.a,h).newEdge)+k,Qv(N,H,K,q,v.materialIndex),Qv(N,v.a,H,q,v.materialIndex),Qv(N,v.b,K,H,v.materialIndex),Qv(N,v.c,q,K,v.materialIndex),d&&(j=u[i],z=j[0],$=j[1],te=j[2],Q.set(Nh(z.x,$.x),Nh(z.y,$.y)),J.set(Nh($.x,te.x),Nh($.y,te.y)),ie.set(Nh(z.x,te.x),Nh(z.y,te.y)),Jv(V,Q,J,ie),Jv(V,z,Q,ie),Jv(V,$,J,Q),Jv(V,te,ie,J));t.vertices=G,t.faces=N,d&&(t.faceVertexUvs[0]=V)}},pi=new O,vde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=t.geometry??(e==null?void 0:e.geometry)??new Ke().copy(new us(100,100,100)),i;e===void 0?(n.computeBoundingBox(),n.boundingBox.getSize(pi),i={width:pi.x,height:pi.y,depth:pi.z,subdivisions:0}):i=e.parameters;let r={...i,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:n}}static build(t){let{width:e,height:n,depth:i,subdivisions:r}=t.parameters,s=t.geometry??new Ke().copy(new us(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(pi)):pi.set(o.width,o.height,o.depth),(e!==pi.x||n!==pi.y||i!==pi.z)&&s.scale(pi.x===0?1:e/pi.x,pi.y===0?1:n/pi.y,pi.z===0?1:i/pi.z);let a=s.originalGeometry;try{r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new gde(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,n){new Bx(n).load(t,i=>{let r=this.normalizeInputs({geometry:i});i.boundingBox.getSize(pi);let s=100/pi.x;Object.assign(r.parameters,{width:100,height:pi.y*s,depth:pi.z*s}),e(this.build(r))})}},NV=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof qn?t.shape:new qn,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,u=e*.5,d=n*.5,c=0,h=0,f=2*Math.PI/i;for(let x=0;x<i;x++){let y=f*x,v=c+Math.sin(y)*u,_=h+Math.cos(y)*d;l.addPoint(l.createPoint(v,_))}l.isClosed=!0;for(let x=0,y=l.points.length;x<y;x++)l.points[x].roundness=r;l.roundness=r,l.update();let m=qc.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(m,{userData:{...t,type:"PolygonGeometry"}})}},yde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=new _de(e*.5,n,r,s,o,a,l);return u.scale(1,1,i/e),Object.assign(u,{userData:{...t,type:"PyramidGeometry"}})}};function Sp(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function xb(t,e,n,i,r,s){let o=e.clone().sub(t),a=n.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),i===r){let u=o.add(a).normalize();s.copy(t).addScaledVector(u,i/Math.sin(l/2))}else{let u=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(u)),s.addScaledVector(a,i/Math.sin(u))}}function xde(t,e,n){let i=t.clone().sub(e),r=n.clone().sub(e);return i.projectOnVector(r),i.add(e)}var _de=class extends Ke{constructor(t=.5,e=1,n=4,i=1,r=!1,s=0,o=4){super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),o=Math.floor(o);let a=[],l=[],u=[],d=[],c=0,h=e/2,f=Math.PI/n,m=t*Math.cos(Math.PI/n),x=2*Math.PI/n,y=(n-2)*Math.PI/n,v=Math.PI-y,_=new O(0,-h,0),w=new O(0,h,0),b=new ee(t,-h),E=new ee(m,-h),A=new ee(0,w.y).sub(E),T=new ee(0,w.y).sub(b),L=new ee(A.y,-A.x).normalize(),P=new ee(T.y,-T.x).normalize(),C=t*Math.cos(Math.PI/n)*Math.tan((Math.PI-A.angle())/2)-1e-8;s=Math.min(s,C);let D;{let q=new O(L.x,L.y,0),N=new O(Math.cos(x)*q.x,q.y,Math.sin(x)*q.x);D=q.angleTo(N)}let U=s/Math.tan((Math.PI-A.angle())/2),G=s/Math.tan((Math.PI-D)/2),k=new O;if(!r){l.push(_.x,_.y,_.z),u.push(0,-1,0),d.push(0,0);let q=c++,N=[],V=b.clone(),j=U/Math.cos(Math.PI/n);V.x-=j;for(let z=0;z<n;z++){let $=z/n*Math.PI*2+f,te=new ee(Math.sin($),Math.cos($));Sp(V,te,k),l.push(k.x,k.y,k.z),u.push(0,-1,0),d.push(0,0),N.push(c++)}for(let z=0;z<N.length;z++)a.push(N[z],q,N[(z+1)%N.length])}{let q=new O,N=new O,V=new O,j=new O,z=new O,$=new O;for(let te=0;te<n;te++){let Q=te/n*Math.PI*2+f,J=(te+.5)/n*Math.PI*2+f,ie=(te+1)/n*Math.PI*2+f,se=new ee(Math.sin(Q),Math.cos(Q)),pe=new ee(Math.sin(J),Math.cos(J)),le=new ee(Math.sin(ie),Math.cos(ie));Sp(b,se,N),Sp(b,le,V),Sp(L,pe,q),xb(w,N,V,G,G,j),l.push(j.x,j.y,j.z),xb(N,w,V,G,U,z),l.push(z.x,z.y,z.z),xb(V,N,w,U,G,$),l.push($.x,$.y,$.z),u.push(q.x,q.y,q.z),u.push(q.x,q.y,q.z),u.push(q.x,q.y,q.z),d.push(0,0),d.push(0,0),d.push(0,0);let Ae=c++,ae=c++,W=c++;if(a.push(Ae,ae,W),s>0){{let ce=N.clone().add(V).multiplyScalar(.5),ge=w.clone().sub(ce).normalize(),De=_.clone().sub(ce).normalize().add(ge).normalize().multiplyScalar(-1),Me=$.clone().sub(z);H(ce,Me,De,A.angle())}let me,ue;{let ce=new O;Sp(P,le,ce);let ge=$.clone().add(j).multiplyScalar(.5);ge=xde(ge,V,w);let De=$.clone().sub(j);[me,ue]=H(ge,De,ce,D,j.y)}{let ce=me,ge=ce.clone().setY(0).normalize(),De=new O(0,-1,0),Me=ge.clone().cross(De);K(ce,ge,De,Me)}{let ce=A.angle(),ge=Math.PI-ce,De=w.clone();De.y-=s/Math.sin(ce-Math.PI/2);let Me=new O,Ce=[];for(let He=0;He<o;He++){let bt=[],Y=Math.PI/2-ge*He/o,B=Math.cos(Y),he=Math.sin(Y),Re=J;for(let Le=0;Le<=He;Le++){let Ie=Math.cos(Re),rt=Math.sin(Re);q.x=B*rt,q.y=he,q.z=B*Ie,Me.copy(De).addScaledVector(q,s),l.push(Me.x,Me.y,Me.z),u.push(q.x,q.y,q.z),d.push(0,0),bt.push(c++),Re+=Math.PI*2/He/n}Ce.push(bt)}ue.reverse(),Ce.push(ue);let ke=Ce.length-1;for(let He=0;He<ke;He++){let bt=Ce[He],Y=Ce[He+1],B=bt.length-1;a.push(Y[1],bt[0],Y[0]);for(let he=1;he<=B;he++)a.push(bt[he],bt[he-1],Y[he]),a.push(Y[he+1],bt[he],Y[he])}}}}}this.setIndex(a),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2));function H(q,N,V,j,z){let $=-j/2,te=(Math.PI-j)/2,Q=N.clone().normalize().cross(V);q.addScaledVector(V,-s/Math.sin(te));let J=new O,ie=new O,se=1,pe=c,le=[];for(let Ae=0;Ae<=o;Ae++){let ae=$+Ae/o*j;ie.set(0,0,0),ie.addScaledVector(Q,Math.sin(ae)),ie.addScaledVector(V,Math.cos(ae));for(let W=0;W<=se;W++){let me=W/se-.5;if(J.copy(q),J.addScaledVector(N,me),J.addScaledVector(ie,s),z!=null){let ue=Math.max(0,J.y-z);J.addScaledVector(N,-ue/N.y)}l.push(J.x,J.y,J.z),u.push(ie.x,ie.y,ie.z),d.push(0,0),W===0&&le.push(c),c++}}for(let Ae=0;Ae<o;Ae++)for(let ae=0;ae<se;ae++){let W=pe+ae+(se+1)*Ae,me=W+(se+1),ue=me+1,ce=W+1;a.push(W,me,ce),a.push(me,ue,ce)}return[q.clone().addScaledVector(N,.5),le]}function K(q,N,V,j){let z=Math.PI/2,$=T.angle()-z,te=[],Q=new O,J=new O;for(let se=0;se<=o;se++){let pe=[],le=se/o;for(let Ae=0;Ae<=se;Ae++){let ae=((se?Ae/se:0)-.5)*v,W=Math.cos(ae),me=Math.sin(ae),ue=Math.atan(Math.tan($)*W),ce=(z+ue)*le,ge=Math.cos(ce),De=Math.sin(ce);Q.set(0,0,0),Q.addScaledVector(N,De*W),Q.addScaledVector(V,ge),Q.addScaledVector(j,De*me),J.copy(q).addScaledVector(Q,s),l.push(J.x,J.y,J.z),u.push(Q.x,Q.y,Q.z),d.push(0,0),pe.push(c++)}te.push(pe)}let ie=te.length-1;for(let se=0;se<ie;se++){let pe=te[se],le=te[se+1],Ae=pe.length-1;a.push(pe[0],le[1],le[0]);for(let ae=1;ae<=Ae;ae++)a.push(pe[ae-1],pe[ae],le[ae]),a.push(pe[ae],le[ae+1],le[ae])}}}},kV=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),i=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof qn?t.shape:new qn,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:i}}static build(t){let e=t.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u={x:n*.5,y:i*.5},d={x:-u.x,y:-u.y},c={x:u.x,y:u.y};function h(b,E,A){return E>n&&A>i?Math.min(b*n/E,b*i/A):E>n?b*n/E:A>i?b*i/A:b}let f=[];f[0]=r[0]===0?0:h(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:h(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:h(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:h(r[3],r[3]+r[0],r[3]+r[2]);let m=d.x,x=c.x,y=c.y,v=d.y;e.addPoint(e.createPoint(m,y)),e.addPoint(e.createPoint(x,y)),e.addPoint(e.createPoint(x,v)),e.addPoint(e.createPoint(m,v)),e.isClosed=!0;let _=!0;for(let b=0,E=e.points.length;b<E;b++)e.points[b].roundness=f[b],b>0&&f[b]!==f[b-1]&&(_=!1);_&&(e.roundness=f[0]),e.useCubicForRoundedCorners=s!==1,e.update();let w=qc.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(w,{userData:{...t,type:"RectangleGeometry"}})}},wde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},t.parameters);return n.thetaLength=Ut.clamp(n.thetaLength,0,180),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e=100,height:n=e,depth:i=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:u}=t.parameters,d;return u===0?(d=new Ke,d.setAttribute("position",new Ne([],3))):d=new gf(.5*e,r,s,o,a,l,u*Ut.DEG2RAD),d.scale(1,n/e,i/e),Object.assign(d,{userData:{...t,type:"SphereGeometry"}})}},Sde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(t){let{width:e=100,height:n=e,widthSegments:i=8,heightSegments:r=8}=t.parameters,s=new Uc(e,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},bde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new Mde(e,n,i,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},Mde=class extends Ke{constructor(t=1,e=1,n=1,i=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],u=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-u,i),i*=Math.PI/180;let d=[],c=Math.PI/2,h=(se=0,pe=0,le=0)=>new O(se,pe,le),f=h(),m=h(),[x,y,v]=[e/2,t/2,n/2],_=-y,w=+y,[b,E,A]=[h(_,-x,+v),h(_,-x,-v),h(_,+x,-v)],T=(se,pe=!1)=>Math.sin(se-Math.PI/(1+ +pe)),L=(se,pe=!1)=>Math.cos(se-Math.PI/(1+ +pe));A.y=Math.sin(i)*e-x;let P=Math.cos(i)*e-v,C=b.z-u;i<=c?(A.z=Math.min(P,C),A.z==C&&(A.y-=(P-C)/Math.tan(c-i))):E.z=Math.min(E.z-P-v,b.z-u),f.subVectors(b,E),m.subVectors(A,E);let D=Math.min(f.length(),m.length())*r/100,U=D*Math.tan(i/2),G=D/Math.cos(i/2),k=f.clone().normalize().add(m.normalize()).setLength(G).add(E);f.set(0,T(i,!0),L(i,!0)),d.push([A,f.clone()]);let H=(Math.PI-i)/s;for(let se=0;se<=s;se++){let pe=c+i+se*H;f.set(0,Math.sin(pe)*U,Math.cos(pe)*U),f.add(k),m.set(0,T(pe),L(pe)),d.push([f.clone(),m.clone()])}d.push([b,h(0,1,0)]);let K=Math.sin(H/2)*U*2,q=d.length-1,N=d[0][0].distanceTo(d[1][0]),V=d[q-1][0].distanceTo(d[q][0]),j=N+K*s+V;d[0].push(1);for(let se=0;se<=s;se++)d[se+1].push(1-(N+se*K)/j);d[q].push(0);let[z,$,te]=d[0],Q,J,ie;for(let se=1;se<d.length;se++)[Q,J,ie]=d[se],o.push(_,z.y,z.z,_,Q.y,Q.z,w,z.y,z.z,w,z.y,z.z,_,Q.y,Q.z,w,Q.y,Q.z),a.push(0,$.y,$.z,0,J.y,J.z,0,$.y,$.z,0,$.y,$.z,0,J.y,J.z,0,J.y,J.z),l.push(0,te,0,ie,1,te,1,te,0,ie,1,ie),[z,$,te]=[Q,J,ie];this.setAttribute("position",new Ne(o,3)),this.setAttribute("normal",new Ne(a,3)),this.setAttribute("uv",new Ne(l,2))}},UV=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof qn?t.shape:new qn,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}=t.parameters,d=t.shape,c=e*.5,h=n*.5,f=0,m=0,x=o*Math.PI/360/r,y=Math.PI/2*3*-1,v=c*i/100,_=h*i/100;if(r===3&&i===50){x=2*Math.PI/r;for(let b=0;b<r;b++){let E=x*b,A=f+Math.sin(E)*c,T=m+Math.cos(E)*h;d.addPoint(d.createPoint(A,T))}}else for(let b=0;b<r;b++){let E=f+Math.cos(y)*c,A=m+Math.sin(y)*h;d.addPoint(d.createPoint(E,A)),y+=x,E=f+Math.cos(y)*v,A=m+Math.sin(y)*_,d.addPoint(d.createPoint(E,A)),y+=x}d.isClosed=!0;for(let b=0,E=d.points.length;b<E;b++)d.points[b].roundness=s;d.roundness=s,d.update();let w=qc.create({shape:d,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}});return Object.assign(w,{userData:{...t,type:"StarGeometry"}})}},Ade=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n}=t.parameters,i=new Uc(e,n);return Object.assign(i,{userData:{...t,type:"TextFrameGeometry"}})}},Ede=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.round(Math.abs(n.depth??n.width*.25));return{parameters:Object.assign(n,{width:i,height:r,depth:s})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=Tde(e,n,i,e*.5,o,s,0,0,r,a,l);return u.scale(1,n/e,1),Object.assign(u,{userData:{...t,type:"TorusGeometry"}})}};function Tde(t,e,n,i,r,s,o,a,l,u,d){[e,n]=[n,e],o=e/2;let c=Ut.clamp(r/360,0,1);if(c===0){let h=new Ke;return h.setAttribute("position",new Ne([],3)),h}return c===1&&(u=0),new IV(!0,t,e,n,i,c,s,o,a,l,u,d)}var Cde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??n.width*.125})}}static build(t){let{width:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==n&&(a-=n);let l=new Sg(a,n,i,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},Pde=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof qn?t.shape:new qn,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,u=e*.5,d=n*.5;a?(l.addPoint(l.createPoint(-u,d)),l.addPoint(l.createPoint(u,-d)),l.addPoint(l.createPoint(-u,-d))):(l.addPoint(l.createPoint(0,d)),l.addPoint(l.createPoint(u,-d)),l.addPoint(l.createPoint(-u,-d))),l.isClosed=!0;for(let h=0,f=l.points.length;h<f;h++)l.points[h].roundness=i;l.roundness=i,l.update();let c=qc.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(c,{userData:{...t,type:"TriangleGeometry"}})}};function Rde(t,e){let n=2*Math.PI;return(t%n+n)%n===(e%n+n)%n}var Lde=new Ue,Dde=new Ue;function Ide(t,e,n){let i=[new O,new O,new O],r=[new O,new O,new O];return t.extractBasis(i[0],i[1],i[2]),e.extractBasis(r[0],r[1],r[2]),i.forEach((s,o)=>{let a=r[o],l=Ut.lerp(s.length(),a.length(),n);s.lerp(a,n).setLength(l)}),new Ue().makeBasis(i[0],i[1],i[2])}var Ode=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=(e==null?void 0:e.shapeData)??bC.create({parameters:hV}).userData.shape;return{path:t.path??B1.defaultData(),parameters:Object.assign(n,{width:i,height:r,depth:s,extrusion:{...dV,...n.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new Nde(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Ke,{userData:{...t,type:"PathGeometry"}})}},Nde=class extends Ke{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!Rde(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:n,offset:i}=this.inputs.parameters.extrusion;n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1));let r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(i*r),o=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],u=[];for(let q=0;q<a;q++){let N=this.inputs.path.isClosed?(q+s)%t.length:Math.min(q+s,t.length-1);l.push(t[N].clone()),u.push(e[N].clone())}let d=(q,N,V)=>{l[q]=l[q].clone().lerp(l[N],V),u[q]=Ide(u[q],u[N],V)},c=0,h=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(h||i===0)&&(c=h,d(0,1,c));let f=0,m=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&m&&(f=m,d(l.length-1,l.length-2,1-f)),n===0){let q=l.length-1;l[q].copy(l[0]),u[q].copy(u[0])}this._applyPathModifiers(u,c,f);let{bevel:x,bevelSides:y}=this.inputs.parameters.extrusion,v=x>0?this.inputs.parameters.extrusion.capType:"flat",_=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(_=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:w,infos:b,vertices:E}=this._computeShapePoints(_),A=0,T;v==="round"&&(T=new SC(this.inputs.shapeData,2*x,x,_,y,void 0,!0),A=T.getAttribute("position").count);let L=0,P=0;b.sort((q,N)=>q.start-N.start),b.forEach(q=>{q.verticesStart=L,q.verticesCount=q.continuous.reduce((N,V,j)=>N+(j===0||!V?2:1),0),P+=q.verticesCount,L=P});let C=P*a,D,U=0;if(this._isOpenEnded()&&v==="flat"){try{D=Ul({windingRule:un.ODD,elementType:ci.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:w})}catch{D=EV}U=D.vertexCount}let G=C+2*U+A*2,k=C+2*U,H={positions:new Float32Array(G*3),normals:new Float32Array(G*3),uvs:new Float32Array(G*2)},K=[];if(b.forEach(q=>{this._extrudeRegion(q,E,u,l,H,K,this._isGeometryClosed()&&!this._isOpenEnded())}),D&&(this._closeEnd(D,C,K,H,u[0],l[0],!1),this._closeEnd(D,C+U,K,H,u[u.length-1],l[l.length-1],!0)),T){H.positions.set(T.getAttribute("position").array,k*3),H.normals.set(T.getAttribute("normal").array,k*3),H.uvs.set(T.getAttribute("uv").array,k*2);let q=K.length;K.push(...T.getIndex().array.map(j=>j+k)),k+=A,H.positions.set(T.getAttribute("position").array,k*3),H.normals.set(T.getAttribute("normal").array,k*3),H.uvs.set(T.getAttribute("uv").array,k*2);let N=K.length;K.push(...T.getIndex().array.map(j=>j+k)),this.setAttribute("position",new ht(H.positions,3)),this.setAttribute("normal",new ht(H.normals,3)),this.setAttribute("uv",new ht(H.uvs,2)),this.setIndex(K);let V=Lde;V.copy(u[u.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(V,k,G),V.copy(u[0]).setPosition(l[0]).multiply(Dde.makeScale(1,1,-1)),this.applyMatrix4OnRange(V,k-A,k),this.reverseIndicesOnRange(q,N)}else this.setAttribute("position",new ht(H.positions,3)),this.setAttribute("normal",new ht(H.normals,3)),this.setAttribute("uv",new ht(H.uvs,2)),this.setIndex(K)}_extractPathPoints(){let t=yV(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(n=>{e[e.length-1].distanceToSquared(n)>.001&&e.push(n)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],n=t.length,i=this.inputs.path.isClosed,r=new O,s=new O,o=new O,a=new O,l=new O(0,1,0);for(let m=0;m<n;m++){let x=t[m],y;m===0?y=i?t[t.length-2]:x.clone().multiplyScalar(2).sub(t[1]):y=t[m-1];let v;m===n-1?v=i?t[1]:x.clone().multiplyScalar(2).sub(t[m-1]):v=t[m+1];let _=x.clone().sub(y).normalize(),w=v.clone().sub(x).normalize(),b=_.clone().add(w).normalize();o.copy(b),m===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let E=l.clone().cross(b).normalize(),A=b.clone().cross(E).normalize();l.copy(A),a.copy(E),m===0&&(r.copy(A),s.copy(b));let T=new Ue().makeBasis(E,A,b);e.push(T)}let u=i?s:o,d=i?r:new O(0,1,0),c=u.clone().cross(a).normalize(),h=Math.acos(d.dot(c));if(isNaN(h))return e;let f=d.clone().cross(c);u.dot(f)>0&&(h*=-1);for(let m=1;m<e.length;m++){let x=new Ue().makeRotationZ(h*m/e.length);e[m].multiply(x)}return e}_applyPathModifiers(t,e,n){let i=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new Ue,u=new Ue;return t.forEach((d,c)=>{let h=c===0?0:c===i-1?1:(c-e)/(i-(n===0?0:1)-(e+(1-n)));l.makeRotationZ(Ut.lerp(r,r+s,h)*Ut.DEG2RAD);let f=Ut.lerp(o,a,h);u.makeScale(f,f,f),d.multiply(l).multiply(u)}),t}_computeShapePoints(t=12,e=un.ODD){let n=this.inputs.shapeData,i=n.extractShapePointsToFlatArray([],t),r=n.shapeHoles.map(u=>{let d=u.extractShapePointsToFlatArray([],t),c=[];for(let h=d.length-1;h>=1;h-=2){let f=d[h-1],m=d[h-0];c.push(f,m)}return c}),s;try{s=Ul({windingRule:e,elementType:ci.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=wC}let o;try{o=Ul({windingRule:un.ODD,elementType:ci.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=AV}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let u=0;u<o.elements.length;u++){let d=o.elements[u],c=u%2===0?s.vertexCount:0;s.elements.push(d+c)}for(let u=0;u<o.vertexIndices.length;u++){let d=o.vertexIndices[u],c=s.vertexCount;s.vertexIndices.push(d+c)}for(let u=0;u<o.vertices.length;u++){let d=o.vertices[u];s.vertices.push(d)}}for(let u=0,d=s.vertexCount;u<d;u++){let c=u*2;s.vertices[c+0],s.vertices[c+1]}let l=[];for(let u=s.elementCount-1;u>=0;u--){let d=u>=a,c=u*2,h=s.elements[c+0],f=s.elements[c+1],m=h+f,x={start:h,count:f,normals:[],isHole:d,continuous:[],verticesStart:0,verticesCount:0};l.push(x);let y=h,v=m-1,_=h+1,w=n.roundedCurves.length;do{let b=y-h;s.vertices[v*2+0],s.vertices[v*2+1];let E=s.vertices[y*2+0],A=s.vertices[y*2+1],T=s.vertices[_*2+0],L=s.vertices[_*2+1],P=E-T,C=A-L,D=Math.sqrt(P*P+C*C);P/=D,C/=D,x.normals[b*2+0]=-C,x.normals[b*2+1]=P;let U=s.vertexIndices[y];if(Array.isArray(U))x.continuous[b]=!1;else{let[G,k]=n.getCurveIndexFromVertexId(U-1,!0);if(k>0&&k<1)x.continuous[b]=!0;else{let H=k===1?G+1:G-1;H=(H+w)%w;let K=k===1?0:1,q=n.roundedCurves[G].getTangent(k),N=n.roundedCurves[H].getTangent(K);x.continuous[b]=q.dot(N)>.95}}d&&(x.normals[b*2+0]*=-1,x.normals[b*2+1]*=-1),[v,y,_]=[y,_,_+1],_>=m&&(_-=f)}while(_!==h+1)}return{regions:[i,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,n,i,r){let s=e*2,o=e*3;t.positions[o+0]=n.x,t.positions[o+1]=n.y,t.positions[o+2]=n.z,t.normals[o+0]=i.x,t.normals[o+1]=i.y,t.normals[o+2]=i.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,n,i,r,s,o){let a=new O,l=new O,u=new O,d=new O,c=new ee;n.forEach((f,m)=>{let x=i[m],y=t.verticesStart*n.length+t.verticesCount*m;for(let v=0;v<t.count;v++){let _=(t.start+v)*2;if(a.set(e[_+0],e[_+1],0),u.copy(a).applyMatrix4(f).add(x),t.continuous[v])d.set(t.normals[v*2+0],t.normals[v*2+1],0);else{let w=v===0?(t.start+t.count-1)*2:_-2;l.set(e[w+0],e[w+1],0),d.copy(a).sub(l),d.set(-d.y,d.x,0),t.isHole||d.negate()}if(d.applyMatrix4(f).normalize(),c.set(v===0?1:v/t.count,m/(n.length-1)),this._insertVertex(r,y,u,d,c),y++,!t.continuous[v]||v===0){if(v===0)d.set(t.normals[v*2+0],t.normals[v*2+1],0),c.set(0,m/(n.length-1));else{let w=v===t.count-1?t.start*2:_+2;l.set(e[w+0],e[w+1],0),d.copy(l).sub(a),d.set(-d.y,d.x,0),t.isHole||d.negate()}d.applyMatrix4(f).normalize(),this._insertVertex(r,y,u,d,c),y++}}});let h=n.length-1;for(let f=0;f<h;f++){let m=t.verticesStart*n.length+t.verticesCount*f,x=t.verticesStart*n.length+t.verticesCount*(f+1),y=0;for(let v=0;v<t.count;v++){(!t.continuous[v]||v===0)&&y++;let _=v===t.count-1?0:y+1,w=m+y,b=m+_,E=x+_,A=x+y;t.isHole?s.push(w,E,b,w,A,E):s.push(w,b,E,w,E,A),y++}}}_closeEnd(t,e,n,i,r,s,o){let a=t.vertexCount,l=new O(0,0,o?-1:1).applyMatrix4(r),u=new O,d=new ee;for(let h=0;h<a;h++){let f=2*h;u.set(t.vertices[f+0],t.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(i,e+h,u,l,d)}let c=t.elements;for(let h=0;h<t.elementCount;h++){let f=3*h,m=c[f+0]+e,x=c[f+(o?1:2)]+e,y=c[f+(o?2:1)]+e;n.push(m,x,y)}}applyMatrix4OnRange(t,e,n){let i=t.elements,r=new St().getNormalMatrix(t).elements,s,o,a,l,u=this.attributes.position,d=this.attributes.normal;if(!u||!d)return;let c=u.array,h=d.array,f=u.itemSize;for(let m=e*f,x=n*f;m<x;m+=f){if(m===e)debugger;s=c[m+0],o=c[m+1],a=c[m+2],l=1/(i[3]*s+i[7]*o+i[11]*a+i[15]),c[m+0]=(i[0]*s+i[4]*o+i[8]*a+i[12])*l,c[m+1]=(i[1]*s+i[5]*o+i[9]*a+i[13])*l,c[m+2]=(i[2]*s+i[6]*o+i[10]*a+i[14])*l,s=h[m+0],o=h[m+1],a=h[m+2],h[m+0]=r[0]*s+r[3]*o+r[6]*a,h[m+1]=r[1]*s+r[4]*o+r[7]*a,h[m+2]=r[2]*s+r[5]*o+r[8]*a}u.needsUpdate=!0,d.needsUpdate=!0}reverseIndicesOnRange(t,e){let n=this.index;if(n){for(let i=t;i<e;i+=3){let r=n.getX(i),s=n.getX(i+1),o=n.getX(i+2);n.setXYZ(i,o,s,r)}n.needsUpdate=!0}}};function zV(){let t=new Ke;return t.setAttribute("position",new ht(new Float32Array([]),3)),t.setIndex(new ht(new Uint16Array([]),1)),t}var kde=zV().attributes,Ude=12,zde=1,FV=class extends Ke{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,kde),this.userData={parameters:t,type:"TextGeometry"};let n=e.getFont(t.font);n!=null&&n.isLoaded?(this.font=n,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let n=e.getFont(t);n&&(this.font=n,await n.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,u=fA.getDisplayedValue(a),d=l===2?u.toUpperCase():l===3?u.toLowerCase():u,c=Fde(t,e,d),{shapes:h,charWidths:f,charCoords:m}=e.generateShapes(c,t),x=(typeof n=="number"?n:1)*.5,y=(typeof i=="number"?i:1)*.5,v=h.map(b=>new qn().fromShape(b,!0));this.vectorShapes=v;let _=v.map(b=>qc.create({shape:b,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?un.NONZERO:un.ODD,subdivisions:this.isLowResolution&&r>0?zde:Ude}})),w=_.length?m5(_):zV();w.translate(-x,y,0),this.dispose(),this.wrappedText=c,this.charCoords=m,this.charWidths=f,this.deleteAttribute("extrudeNormal"),Object.entries(w.attributes).forEach(([b,E])=>{this.setAttribute(b,E)}),this.setIndex(w.index),this.computeBoundingSphere()}clone(){let t=Ya(new Ke,FV.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,n])=>{this.setAttribute(e,n)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function Fde(t,e,n){let i=[""],r="";for(let s of n)r+=s,s===" "||s===`
`?(i[i.length-1]+=r,r="",s===`
`&&i.push("")):e.getTextWidth(i[i.length-1]+r,t)>t.width&&(i[i.length-1].length&&i.push(""),e.getTextWidth(i[i.length-1]+r,t)>t.width&&(r.length===1?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}var BV,MC=new Promise(t=>{BV=t}),JO=!1,ey;function Bde(){if(JO)return;if(ey)return ey;async function t(){let e="https://unpkg.com/@splinetool/modelling-wasm@0.9.507/build",n=d5(()=>import("./process-0cd968c5.js"),[],import.meta.url),[i,r]=await Promise.all([n,fetch(`${e}/process.wasm`).then(a=>a.arrayBuffer())]),s=i.default,o=await s({wasmBinary:r});BV(o),JO=!0}return ey=t(),ey}function X1(t,e,n,i){var u;let r,s,o;t.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(t)),o=[[],["extrusion"]]):(s={...t},o=[[]]);for(let d of o){let c=s;for(let h of d)c=c[h];for(r in c){let h=c[r];dce(h)&&(c[r]=e.getVariable(h,[i.uuid,"geometry",...d,r]))}}let a={parameters:s,type:s.type};if(s.type==="PathGeometry")a.path=s.path;else if(s.type==="VectorGeometry"){let d=qn.createFromState(s.shape,s.width,s.height);a.shape=d}else if(s.type==="NonParametricGeometry")s.data.groups&&((u=s.data.groups)==null||u.forEach(d=>d.materialIndex=Math.max(d.materialIndex??0,0))),a.geometry=new Bx().parse(s);else if(s.type==="SubdivGeometry"){let d=new gr(s,n);return d.data=t,d}else if(s.type==="TextGeometry")return new FV(s,e);let l;try{l=rN(a)}catch(d){console.error(d)}if(!l){let d=qn.createFromState(F1.defaultData(),100,100);a.shape=d,l=rN(a)}return l}var Vde=new Ue;function MA(t,e,n,i){let r=t.position.array,s=t.normal.array,o=Vde.makeScale(e,n,i).invert().elements,a,l,u;for(var d=0,c=r.length;d<c;d+=3)r[d]*=e,r[d+1]*=n,r[d+2]*=i,a=s[d],l=s[d+1],u=s[d+2],s[d]=o[0]*a+o[4]*l+o[8]*u,s[d+1]=o[1]*a+o[5]*l+o[9]*u,s[d+2]=o[2]*a+o[6]*l+o[10]*u;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var ty=new Hi,kh=new O,dt;MC.then(t=>{dt=t});var eN=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),tN=new Uint32Array([0,1,2,3]),nN=new Uint8Array([4]),gr=class extends Ke{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let n=this.data.scaleBaked,i=Md.div(e,n);this.subdividedGeometry&&MA(this.subdividedGeometry.attributes,...i),this.originalGeometry&&MA(this.originalGeometry.attributes,...i),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(kh.fromArray(i));let s=kh.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,n;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:n}=gr.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new us(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(gr.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new Gi,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;ty.setFromBufferAttribute(e),ty.getCenter(n),t.boundingSphere.radius=n.distanceTo(ty.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),ty.getSize(kh);let i={width:kh.x,height:kh.y,depth:kh.z};return this.userData.parameters=i,i}static build(t,e,n,i){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;n===!1&&(a=-1),e&&(dt.free_bvh(e),dt.free_subdivision_surface(e));try{r=gr.allocate(t,i)}catch(l){console.error(l,t),r=gr.allocate({positionWASM:eN,indexWASM:tN,verticesPerFaceWASM:nN},i)}if(dt.set_destination_refinement_level(r,0),s=gr.buildLevel(r,!0,a),t.subdivisions>0)try{dt.set_destination_refinement_level(r,t.subdivisions),o=gr.buildLevel(r,!1,a)}catch{try{dt.set_destination_refinement_level(r,t.subdivisions-1),o=gr.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,n){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let i=t.shape!==void 0||t.path!==void 0?e.geometry:X1(t,n,!1),r;t.type==="TorusGeometry"&&t.arc===Math.PI*2?r=i.getClosedTorusIndicesForBooleanOrSubdiv():r=i.getIndex();let s,o,a,l;({positions:s,triIndices:l}=VV(i.getAttribute("position"),r));let u;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let d=t.radialSegments*t.heightSegments*3*2,c=d+t.radialSegments*3;u=[d,c]}return{indices:o,verticesPerFace:a}=jV(s,l,i,u),{positions:s,indices:o,verticesPerFace:a}}static allocate(t,e){var w;let n,i,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(n=t.positionWASM,i=t.indexWASM,r=t.verticesPerFaceWASM):(n=eN,i=tN,r=nN);let a=n.length,l=i.length,u=r.length,d=n.length+s.length+o.length,c=i.length+r.length,h=d*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,f=d*Float32Array.BYTES_PER_ELEMENT,m=dt._malloc(h),x=new Float32Array(dt.HEAPF32.buffer,m,d),y=new Uint32Array(dt.HEAPU32.buffer,m+f,c);x.set(n,0),x.set(s,n.length),x.set(o,n.length+s.length),y.set(i,0),y.set(r,i.length);let v;(w=t==null?void 0:t.scaleBaked)!=null&&w.some(b=>b!==1)&&(v=new Ue().makeScale(...t.scaleBaked)),e&&(v?v.premultiply(e):v=e);let _=v?dt.alloc_subdivision_surface2(m,a,m+f,l,m+f+i.length*Uint32Array.BYTES_PER_ELEMENT,u,v.elements):dt.alloc_subdivision_surface(m,a,m+f,l,m+f+i.length*Uint32Array.BYTES_PER_ELEMENT,u);return dt._free(m),_}static buildLevel(t,e,n,i,r){let s=r?dt.get_mesh_data2(t,e?dt.Level.CONTROL:dt.Level.REFINED,n,r.elements):dt.get_mesh_data(t,e?dt.Level.CONTROL:dt.Level.REFINED,n),o=8,a=dt.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),u=0,d=dt.HEAPU32[a[u]>>2],c=dt.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let h=dt.HEAPU32[a[u]>>2],f=dt.HEAPF32.subarray(h>>2,(h>>2)+l[u]);u++;let m=dt.HEAPU32[a[u]>>2],x=dt.HEAPU32.subarray(m>>2,(m>>2)+l[u]);u++;let y=dt.HEAPU32[a[u]>>2],v=dt.HEAPU32.subarray(y>>2,(y>>2)+l[u]);if(u++,i===void 0){let _=new Ke;if(_.setIndex(new pc(v,1)),_.setAttribute("position",new Ne(c,3)),_.setAttribute("normal",new Ne(f,3)),e){_.setAttribute("faceMap",new pc(x,1));let w=new Float32Array(f.length/3*4).fill(0);_.setAttribute("color",new ht(w,4))}return dt.free_mesh_data(s),_.userData.type="SubdivGeometry",_}i.getAttribute("position").copyArray(c),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,dt.free_mesh_data(s)}static freeSubdivPointer(t){dt.free_bvh(t),dt.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,n){let i=dt.get_wireframe_data_for_base_level(t),r=4,s=dt.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(2,2+2),a=0,l=dt.HEAPU32[s[a]>>2],u=dt.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let d=dt.HEAPU32[s[a]>>2],c=dt.HEAPU32.subarray(d>>2,(d>>2)+o[a]);if(e===void 0){let h=new Ke;h.setAttribute("position",new Ne(u,3));let f=new Float32Array(u.length);for(let m=0,x=u.length;m<x;)f[m++]=n.r,f[m++]=n.g,f[m++]=n.b;return h.setAttribute("color",new ht(f,3)),h.setIndex(new pc(c,1)),dt.free_wireframe_data_for_base_level(i),h}e.getAttribute("position").copyArray(u),e.attributes.position.needsUpdate=!0,dt.free_wireframe_data_for_base_level(i)}static updateCollabMesh(t,e,n){let i=e===0;i||dt.set_destination_refinement_level(t,e);let r=n?dt.get_topological_data2(t,i?dt.Level.CONTROL:dt.Level.REFINED,n.elements):dt.get_topological_data(t,i?dt.Level.CONTROL:dt.Level.REFINED),s=6,o=dt.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,u=dt.HEAPU32[o[l]>>2],d=new Float32Array(dt.HEAPF32.subarray(u>>2,(u>>2)+a[l]));l++;let c=dt.HEAPU32[o[l]>>2],h=new Uint32Array(dt.HEAPU32.subarray(c>>2,(c>>2)+a[l]));l++;let f=dt.HEAPU32[o[l]>>2],m=new Uint8Array(dt.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return dt.free_topological_data(r),{positions:d,indices:h,verticesPerFace:m}}},iN=["getX","getY","getZ"];function VV(t,e){let n={},i=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let u=0;u<i;u++){let d=e?e.getX(u):u,c="";for(let h=0;h<3;h++)c+=`${~~(t[iN[h]](d)*a)},`;if(c in n)s.push(n[c]);else{for(let h=0;h<3;h++)o.push(t[iN[h]](d));n[c]=r,s.push(r),r++}}let l=[];for(let u=0;u<s.length;u+=3)s[u]===s[u+1]||s[u]===s[u+2]||s[u+1]===s[u+2]||l.push(s[u],s[u+1],s[u+2]);return{positions:o,triIndices:l}}var ny=new O,_b=new O,wb=new O,Sb=new O;function jV(t,e,n,i){let r=[],s=[];if(n.userData.shape!==void 0&&n.userData.parameters.depth===0&&n.userData.shape.shapeHoles.length===0){let l=n.userData.shape.extractShapePointsToFlatArray([]),u=n.userData.parameters.spikes;if(n.userData.type==="EllipseGeometry"&&u<=24&&u%4===0&&n.userData.parameters.angle>=360){let h=l.length/2/u;l=l.filter((f,m)=>Math.floor(m/2)%h===0)}let d=0;for(let h=0;h<l.length;h+=2)d+=(l[h]-l[(h===0?l.length:h)-2])*(l[h+1]+l[(h===0?l.length:h)-1]);t.length=0;let c=0;if(d<0)for(let h=0;h<l.length;h+=2)t.push(l[h],l[h+1],0),r.push(c++);else for(let h=l.length-2;h>=0;h-=2)t.push(l[h],l[h+1],0),r.push(c++);return s.push(c),{indices:r,verticesPerFace:s}}let o=new Float32Array([n.userData.parameters.depth])[0],a=0;for(;a<e.length;){if(n.useNgonForTopBottomFaceDuringBake){let l=0;if((t[e[a]*3+2]===o||t[e[a]*3+2]===0)&&l++,(t[e[a+1]*3+2]===o||t[e[a+1]*3+2]===0)&&l++,(t[e[a+2]*3+2]===o||t[e[a+2]*3+2]===0)&&l++,l===3)break}if(e[a+1]===e[a+3]&&e[a+2]===e[a+5]||e[a+0]===e[a+3]&&e[a+2]===e[a+4]){ny.set(t[e[a]*3],t[e[a]*3+1],t[e[a]*3+2]),_b.set(t[e[a+1]*3],t[e[a+1]*3+1],t[e[a+1]*3+2]),wb.set(t[e[a+4]*3],t[e[a+4]*3+1],t[e[a+4]*3+2]),Sb.set(t[e[a+5]*3],t[e[a+5]*3+1],t[e[a+5]*3+2]),_b.sub(ny).normalize(),wb.sub(ny).normalize(),Sb.sub(ny).normalize();let l=_b.cross(wb).dot(Sb);Math.abs(l)>.005||i&&i.some((u,d)=>d%2===1?!1:a>=i[d]&&a<i[d+1])?(r.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3):(r.push(e[a],e[a+1],e[a+4],e[a+5]),s.push(4),a+=6)}else r.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3}if(n.useNgonForTopBottomFaceDuringBake){let l=[],u=[],d=0;for(let c=0,h=0;c<t.length;c+=3,h++)t[c+2]===0&&(l.push(h),d++),t[c+2]===o&&u.push(h);if(n.userData.parameters.extrudeBevelSize===0){let c=u[0];u[0]=u[1],u[1]=c}l.reverse(),r.push(...l,...u),s.push(d,d)}return{indices:r,verticesPerFace:s}}var Aa={};Hte(Aa,{calcBoolean:()=>Wde,calcBooleanTopological:()=>Hde,freeMeshSet:()=>Yde,getMeshSet:()=>$de,hasOpenEdges:()=>qde,transformMeshSet:()=>Xde});var jde=new Promise(t=>{}),Vt,Dd;jde.then(t=>Vt=t);function Gde(t,e,n){let i,r;t.userData.parameters.type==="TorusGeometry"&&t.userData.parameters.arc===Math.PI*2?r=t.getClosedTorusIndicesForBooleanOrSubdiv():r=t.getIndex();let{positions:s,triIndices:o}=VV(t.getAttribute("position"),r),a;if(e&&n){let{indices:l,verticesPerFace:u}=jV(s,o,t);a=u.length,i=[];for(let d=0,c=0;d<a;d++){i.push(u[d]);for(let h=0;h<u[d];h++)i.push(l[c++])}}else{let l=o.length;i=Array(l+l/3),a=0;for(let u=0,d=0;d<i.length;)i[d++]=3,a++,i[d++]=o[u++],i[d++]=o[u++],i[d++]=o[u++]}return{positions:s,faceIndices:i,nFaces:a}}function GV(t){let e=t.length,n=e*Uint32Array.BYTES_PER_ELEMENT,i=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?n:i,s=Vt._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(Vt.HEAPU32.buffer,s,e):new Float32Array(Vt.HEAPF32.buffer,s,e)).set(t,0),s}function HV(t){switch(t){case 0:return Vt.OP.UNION;case 1:return Vt.OP.INTERSECTION;case 2:return Vt.OP.A_MINUS_B;case 3:return Vt.OP.B_MINUS_A;case 4:return Vt.OP.SYMMETRIC_DIFFERENCE;case 5:return Vt.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function Hde(t,e){Dd===void 0&&(Dd=Vt.init_csg());let n=GV(t),i=Vt.csg_calc_topological(Dd,n,t.length,HV(e));Vt._free(n);let r=6,s=Vt.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(3,3+3),a=0,l=Vt.HEAPU32[s[a]>>2],u=new Float32Array(Vt.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let d=Vt.HEAPU32[s[a]>>2],c=new Uint32Array(Vt.HEAPU32.subarray(d>>2,(d>>2)+o[a]));a++;let h=Vt.HEAPU32[s[a]>>2],f=new Uint8Array(Vt.HEAPU32.subarray(h>>2,(h>>2)+o[a]));return Vt.free_mesh_data(i),{positions:u,indices:c,verticesPerFace:f}}function Wde(t,e,n,i){Dd===void 0&&(Dd=Vt.init_csg());let r=GV(t),s=Vt.csg_calc(Dd,r,t.length,i,HV(e));Vt._free(r);let o=5,a=Vt.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),u=0,d=Vt.HEAPU32[a[u]>>2],c=Vt.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let h=Vt.HEAPU32[a[u]>>2],f=Vt.HEAPF32.subarray(h>>2,(h>>2)+l[u]);u++;let m=l[u];n.setAttribute("position",new Ne(c,3)),n.setAttribute("normal",new Ne(f,3));let x=Vt.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return n.boundingSphere===null&&(n.boundingSphere=new Gi),n.boundingSphere.radius=-1,n.userData.parameters={width:x[3]*2,height:x[4]*2,depth:x[5]*2},Vt.free_mesh_data(s),m}function $de(t,e,n){if(Vt===void 0)return-1;let i,r,s;if(e&&t.userData.positions!==void 0){let x=t.userData;s=x.verticesPerFace.length,i=x.positions,r=Array(x.verticesPerFace.reduce((y,v)=>y+v,0)+s);for(let y=0,v=0,_=0;y<x.verticesPerFace.length;y++){r[_++]=x.verticesPerFace[y];for(let w=0;w<x.verticesPerFace[y];w++)r[_++]=x.indices[v++]}}else({positions:i,faceIndices:r,nFaces:s}=Gde(t,e,n));let o=i.length,a=r.length,l=i.length,u=r.length,d=l*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,c=l*Float32Array.BYTES_PER_ELEMENT,h=Vt._malloc(d),f=new Float32Array(Vt.HEAPF32.buffer,h,l),m=new Uint32Array(Vt.HEAPU32.buffer,h+c,u);return f.set(i,0),m.set(r,0),Vt.get_csg_mesh(h,o,h+c,a,s)}function qde(t){return Vt.has_open_edges(t)}function Xde(t,e){Vt.transform_csg_mesh(t,e.elements)}function Yde(t){Vt.free_csg_mesh(t)}var Zde={ConeGeometry:The,CubeGeometry:Che,CylinderGeometry:Ehe,DodecahedronGeometry:Rhe,EllipseGeometry:bC,HelixGeometry:lde,IcosahedronGeometry:ude,LatheGeometry:cde,NonParametricGeometry:vde,PolygonGeometry:NV,PyramidGeometry:yde,RectangleGeometry:kV,SphereGeometry:wde,PlaneGeometry:Sde,BackdropGeometry:bde,StarGeometry:UV,TextFrameGeometry:Ade,TorusGeometry:Ede,TorusKnotGeometry:Cde,TriangleGeometry:Pde,PathGeometry:Ode,VectorGeometry:qc},rN=t=>Zde[t.type].create(t);function Uh(t){return t!==null&&"booleanOp"in t}var WV=class extends vC(yi){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Ue}updateVisible(t){super.updateVisible(t),this.visible=!Uh(this.parent)&&this.visible,Uh(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Aa.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Uh(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof WV&&(t.freeBooleanPointer(),Uh(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t,e){let n=super.updateTransformState(t,e);return n&&Uh(this.parent)&&this.invalidateDownstreamBooleanData(!0),n}onVariableUpdate(t=!1){super.onVariableUpdate(t),Uh(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},iy=new Hi;function AC(t,e=0,n=t.count,i,r){let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,d=-1/0;for(let c=e;c<n;c++){let h=t.getX(c),f=t.getY(c),m=t.getZ(c);h<s&&(s=h),f<o&&(o=f),m<a&&(a=m),h>l&&(l=h),f>u&&(u=f),m>d&&(d=m)}iy.min.set(s,o,a),iy.max.set(l,u,d),iy.getCenter(i),iy.getSize(r).multiplyScalar(.5)}var Kde=new Ke,Qde=new oa,lu=class extends WV{constructor(t,e){super(Kde,Qde),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?AC(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},sN=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},gu=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=Ut.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,n){return n=n??{},this.analyze(t,n),this.flow(t,e,n)}flow(t,e,n){n=n??{},t.addFlow(n.slot,n.cache,n.context);let i={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),i}build(t,e,n){e=e??this.getType(t,e);let i=t.getNodeData(n??this);return t.analyzing&&this.appendDepsNode(t,i,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,n)}updateFrame(t){}generateReadonly(t,e,n,i,r,s){return""}generate(t,e,n,i,r){return""}parse(t,e,n,i){}appendDepsNode(t,e,n){e.deps=(e.deps||0)+1;let i=t.getTypeLength(n);(i>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=i,e.output=n)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,n;for(e in this)n=this[e],n instanceof gu&&(t+='"'+e+'":'+n.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)e=this.hashProperties[i],n=this[e],t+='"'+e+'":"'+String(n)+'",';return t+='"id":"'+this.uuid+'"}',t}},Jde=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,n){n=n!==void 0?n:!0,this.keywords[t]={callback:e,cache:n}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},zr=new Jde,hn=class extends gu{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=e.shared!==void 0?e.shared:!0,this.unique=e.unique!==void 0?e.unique:!1}build(t,e,n,i){if(e=e??this.getType(t),this.getShared(t,e)){let r=this.getUnique(t,e);r&&this.uuid===void 0&&(this.uuid=Ut.generateUUID()),n=t.getUUID(n??this.getUUID(),!r);let s=t.getNodeData(n),o=s.output||this.getType(t);if(t.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,s,e),this.generate(t,e,n)):super.build(t,e,n);if(r)return s.name=s.name||super.build(t,e,n),s.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||s.deps===1))return super.build(t,e,n);n=this.getUUID(!1);let a=this.getTemp(t,n);if(a)return t.format(a,o,e);{a=super.generate(t,e,n,s.output,i);let l=this.generate(t,o,n);return t.addNodeCode(a+" = "+l+";"),t.format(a,o,e)}}return super.build(t,e,n)}getShared(t,e){return e!=="sampler2D"&&e!=="samplerCube"&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return typeof this.scope=="string"&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let n=t.getVars()[e];return n?n.name:void 0}generate(t,e,n,i,r){return this.getShared(t,e)||console.error("TempNode is not shared"),n=n??this.uuid,t.getTempVar(n,i??this.getType(t),r,this.getLabel()).name}},$r=class extends hn{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}},Fi=class extends $r{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof ee?t:new ee(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,n,i,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",i,e)}},Ps=class extends $r{constructor(t=0,e,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof O?t:new O(t,e,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,e)}},go=class extends We{constructor(t,e,n,i){super(t,e,n),this.isColorA=!0,this.a=i}setRGBA(t,e,n,i){super.setRGB(t,e,n),this.a=i}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let n;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(n=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let i,r=n[1],s=n[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(i[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(i[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Ea=class extends $r{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof go?t:new go(t.r,t.g,t.b,t.a)}generateReadonly(t,e,n,i,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,e)}},efe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,oN=/[a-z_0-9]+/gi,qe=class extends hn{constructor(t,e,n,i,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(t,e,n,i)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,n,i,r){let s,o=0,a=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)t.include(this.includes[u],this);for(let u in this.extensions)t.extensions[u]=!0;let l=[];for(;s=oN.exec(this.src);)l.push(s);for(let u=0;u<l.length;u++){let d=l[u],c=d[0],h=this.isMethod?!this.getInputByName(c):!0,f=c;if(this.keywords[c]||this.useKeywords&&h&&zr.containsKeyword(c)){let m=this.keywords[c];if(!m){let x=zr.getKeywordData(c);x.cache&&(m=t.keywords[c]),m=m||zr.getKeyword(c,t),x.cache&&(t.keywords[c]=m)}f=m.build(t)}c!==f&&a[d.index+o-1]!=="."&&(a=a.substring(0,d.index+o)+f+a.substring(d.index+c.length+o),o+=f.length-c.length),this.getIncludeByName(f)===void 0&&zr.contains(f)&&t.include(zr.get(f))}return e==="source"?a:this.isMethod?(this.isInterface||t.include(this,void 0,a),this.name):t.format("( "+a+" )",this.getType(t),e)}parse(t,e,n,i){if(this.src=t||"",this.includes=e??[],this.extensions=n??{},this.keywords=i??{},this.isMethod){let r=efe.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(oN);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let u=s[o++];this.inputs.push({name:u,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},tfe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,$V=class extends hn{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||$V.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,n,i,r){this.src=t||"";let s,o,a="",l=tfe.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,n,i,r){return t.format(this.name,this.getType(t),e)}},an=$V;an.PI="PI",an.PI2="PI2",an.RECIPROCAL_PI="RECIPROCAL_PI",an.RECIPROCAL_PI2="RECIPROCAL_PI2",an.LOG2="LOG2",an.EPSILON="EPSILON";var nfe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),ife=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),qV=class extends hn{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,n,i,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=nfe.exec(t);if(e){let n=e[2],i;for(;i=ife.exec(n);)this.inputs.push({type:i[1],name:i[2]});this.name=e[1]}else this.name="";this.type=this.name}},EC=class extends hn{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=t.isShader("vertex")?"uv"+n:"vUv"+n;return t.format(i,this.getType(t),e)}};zr.addKeyword("uv",function(){return new EC});zr.addKeyword("uv2",function(){return new EC(1)});var $h=class extends hn{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??$h.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case Gd:return["Linear"];case ea:return["sRGB"];default:return[]}}generate(t,e){var o;let n=this.input.build(t,"v4"),i=this.getType(t),r=$h.Nodes[this.method],s=t.include(r);if(s===$h.LINEAR_TO_LINEAR)return t.format(n,i,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+n+", "+a+" )",i,e)}else return t.format(s+"( "+n+" )",i,e)}fromEncoding(t){let e=$h.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=$h.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},Yo=$h;Yo.Nodes={LinearToLinear:new qe(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new qe(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new qe(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Yo.LINEAR_TO_LINEAR="LinearToLinear",Yo.SRGB_TO_LINEAR="sRGBToLinear",Yo.LINEAR_TO_SRGB="LinearTosRGB";var vn=class extends qe{constructor(t="",e,n,i,r){super(t,r,i,n,e),this.nodeType="Expression"}},Da=class extends $r{constructor(t=new Tn,e,n,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new EC,this.bias=n,this.project=i!==void 0?i:!1}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if(e==="sampler2D")return this.getTexture(t,e);let n=this.getTexture(t,e),i=this.uv.build(t,this.project?"v4":"v2"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s,o;this.project?s="texture2DProj":s=r?"tex2DBias":"tex2D",r?o=s+"( "+n+", "+i+", "+r+" )":o=s+"( "+n+", "+i+" )";let a={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace??new Yo(new vn("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(t,l),t.removeContext(),t.format(o,l,e)}},Je=class extends $r{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,n,i,r,s){return t.format(this.value+(this.value%1?"":".0"),i,e)}},aN=class extends hn{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,n,i,r){i=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let u=s.inputs[l],d=this.inputs[l]||this.inputs[u.name];a.push(d.build(t,t.getTypeByFormat(u.type)))}o+=a.join(", ")+" )"}return t.format(o,i,e)}},XV=class extends hn{constructor(t,e,n=XV.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=n}getType(t){let e=this.a.getType(t),n=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(n)>t.getTypeLength(e)?n:e}generate(t,e){let n=this.getType(t);this.type=n;let i=this.a.build(t,n),r=this.b.build(t,n);return t.format("( "+i+" "+this.op+" "+r+" )",n,e)}},Dr=XV;Dr.ADD="+",Dr.SUB="-",Dr.MUL="*",Dr.DIV="/";var on=class extends hn{constructor(t,e=on.ABS,n,i){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:i=e,typeof n!="string"?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case on.MIX:case on.CLAMP:case on.REFRACT:case on.SMOOTHSTEP:case on.FACEFORWARD:return 3;case on.MIN:case on.MAX:case on.MOD:case on.STEP:case on.REFLECT:case on.DISTANCE:case on.DOT:case on.CROSS:case on.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),n=this.b?t.getTypeLength(this.b.getType(t)):0,i=this.c?t.getTypeLength(this.c.getType(t)):0;return e>n&&e>i?this.a.getType(t):n>i?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case on.LENGTH:case on.DISTANCE:case on.DOT:return"f";case on.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let n,i,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),u=this.getType(t);switch(this.type=u,this.method){case on.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case on.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case on.CROSS:n=this.a.build(t,"v3"),i=this.b.build(t,"v3");break;case on.STEP:n=this.a.build(t,s===1?"f":l),i=this.b.build(t,l);break;case on.MIN:case on.MAX:case on.MOD:n=this.a.build(t,l),i=this.b.build(t,o===1?"f":l);break;case on.REFRACT:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,"f");break;case on.MIX:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:n=this.a.build(t,l),this.b&&(i=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let d=[];d.push(n),i&&d.push(i),r&&d.push(r);let c=this.getNumInputs(t);if(d.length!==c)throw Error(`Arguments not match used in "${this.method}". Require ${c}, currently ${d.length}.`);return t.format(this.method+"( "+d.join(", ")+" )",u,e)}},Et=on;Et.RAD="radians",Et.DEG="degrees",Et.EXP="exp",Et.EXP2="exp2",Et.LOG="log",Et.LOG2="log2",Et.SQRT="sqrt",Et.INV_SQRT="inversesqrt",Et.FLOOR="floor",Et.CEIL="ceil",Et.NORMALIZE="normalize",Et.FRACT="fract",Et.SATURATE="saturate",Et.SIN="sin",Et.COS="cos",Et.TAN="tan",Et.ASIN="asin",Et.ACOS="acos",Et.ARCTAN="atan",Et.ABS="abs",Et.SIGN="sign",Et.LENGTH="length",Et.NEGATE="negate",Et.INVERT="invert",Et.MIN="min",Et.MAX="max",Et.MOD="mod",Et.STEP="step",Et.REFLECT="reflect",Et.DISTANCE="distance",Et.DOT="dot",Et.CROSS="cross",Et.POW="pow",Et.MIX="mix",Et.CLAMP="clamp",Et.REFRACT="refract",Et.SMOOTHSTEP="smoothstep",Et.FACEFORWARD="faceforward";var kp=class extends hn{constructor(t,e,n){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=n}bilinearCubeUV(t,e,n,i){let r=new aN(kp.Nodes.bilinearCubeUV,[e,n,i]);this.colorSpaceTL=this.colorSpaceTL??new Yo(new vn("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Yo(new vn("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Yo(new vn("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Yo(new vn("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new vn(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new vn(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new vn(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new vn(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new vn("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let n=this.uv,i=this.bias||t.context.roughness,r=new aN(kp.Nodes.roughnessToMip,[i]),s=new Et(r,kp.Nodes.m0,kp.Nodes.cubeUV_maxMipLevel,Et.CLAMP),o=new Et(s,Et.FLOOR),a=new Et(s,Et.FRACT),l=this.bilinearCubeUV(t,this.value,n,o),u=this.bilinearCubeUV(t,this.value,n,new Dr(o,new Je(1).setReadonly(!0),Dr.ADD)),d=new Et(l,u,a,Et.MIX);return t.format(d.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},AA=kp;AA.Nodes=function(){let t=new qV(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new an("float cubeUV_maxMipLevel 8.0",!0),n=new an("float cubeUV_minMipLevel 4.0",!0),i=new an("float cubeUV_maxTileSize 256.0",!0),r=new an("float cubeUV_minTileSize 16.0",!0),s=new qe(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new qe(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new qe(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,n,i,r]);a.useKeywords=!1;let l=new an("float r0 1.0",!0),u=new an("float v0 0.339",!0),d=new an("float m0 -2.0",!0),c=new an("float r1 0.8",!0),h=new an("float v1 0.276",!0),f=new an("float m1 -1.0",!0),m=new an("float r4 0.4",!0),x=new an("float v4 0.046",!0),y=new an("float m4 2.0",!0),v=new an("float r5 0.305",!0),_=new an("float v5 0.016",!0),w=new an("float m5 3.0",!0),b=new an("float r6 0.21",!0),E=new an("float v6 0.0038",!0),A=new an("float m6 4.0",!0),T=[l,u,d,c,h,f,m,x,y,v,_,w,b,E,A],L=new qe(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,T);return{bilinearCubeUV:a,roughnessToMip:L,m0:d,cubeUV_maxMipLevel:e}}();var qh=class extends hn{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??qh.VIEW}getShared(){return this.scope===qh.WORLD}build(t,e,n,i){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,n,i):super.build(t,e,n)}generate(t,e,n,i,r){let s;switch(this.scope){case qh.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case qh.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case qh.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},Br=qh;Br.LOCAL="local",Br.WORLD="world",Br.VIEW="view",Br.NORMAL="normal";zr.addKeyword("viewNormal",function(){return new Br(Br.VIEW)});zr.addKeyword("localNormal",function(){return new Br(Br.NORMAL)});zr.addKeyword("worldNormal",function(){return new Br(Br.WORLD)});var Sa=class extends hn{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??Sa.LOCAL}getType(){switch(this.scope){case Sa.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Sa.LOCAL:case Sa.WORLD:return!1}return!0}generate(t,e,n,i,r){let s;switch(this.scope){case Sa.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case Sa.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case Sa.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Sa.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},ao=Sa;ao.LOCAL="local",ao.WORLD="world",ao.VIEW="view",ao.PROJECTION="projection";zr.addKeyword("position",function(){return new ao});zr.addKeyword("worldPosition",function(){return new ao(ao.WORLD)});zr.addKeyword("viewPosition",function(){return new ao(ao.VIEW)});var Vo=class extends hn{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??Vo.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case Vo.SPHERE:return"v2"}return this.type}generate(t,e){let n=this.getUnique(t);if(t.isShader("fragment")){let i;switch(this.scope){case Vo.VECTOR:{let r=new Br(Br.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new ao(ao.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,u=`reflect( -normalize( ${a} ), ${o} )`;l&&(u=`normalize( mix( ${u}, ${o}, ${l} * ${l} ) )`);let d=`inverseTransformDirection( ${u}, viewMatrix )`;n?(t.addNodeCode(`vec3 reflectVec = ${d};`),i="reflectVec"):i=d;break}case Vo.CUBE:{let r=new Vo(Vo.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";n?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Vo.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new Vo(Vo.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),i="reflectSphereVec"):i=r;break}}return t.format(i,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},Id=Vo;Id.CUBE="cube",Id.SPHERE="sphere",Id.VECTOR="vector";var rfe=class extends hn{constructor(t=new Da,e,n){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new AA(this.value,e??new Id(Id.VECTOR),n),this.irradianceNode=new AA(this.value,new Br(Br.WORLD),new Je(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},sfe=class extends $r{constructor(t=new hf,e,n){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new Id,this.bias=n}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let n=this.getTexture(t,e),i=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+n+", "+i+", "+r+" )":s="texCube( "+n+", "+i+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new Yo(new vn("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},ofe=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,afe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,lfe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,ufe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,lN=["x","y","z","w"],cfe=["float","vec2","vec3","vec4"],hfe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},dfe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},ffe=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function t(e,n){return e.deps.length-n.deps.length}return function(e,n){let i=this.getIncludes(e,n);if(!i)return"";let r="";i=i.sort(t);for(let s=0;s<i.length;s++)i[s].src&&(r+=i[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.addVertexParsCode(ofe),this.addFragmentParsCode(afe),this.buildShader("vertex",t),this.buildShader("fragment",e);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let i=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(lfe),this.addFragmentFinalCode(ufe)),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,n){return this.addSlot(t).addCache(e).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,n,i="varying",r="V",s=""){let o=this.getVars(i),a=o[t];if(!a){let l=o.length;a={name:n||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,n,i){return this.getVar(t,e,n,this.shader,"T",i)}getAttribute(t,e){if(!this.attributes[t]){let n=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let n="";for(let i=0,r=t.length;i<r;++i){let s=t[i],o=s.type,a=s.name,l=s.size,u=this.getFormatByType(o);if(u===void 0)throw new Error("Node pars "+u+" not found.");u.includes("[]")?n+=e+" "+u.substring(0,u.length-2)+" "+a+`[${l}];
`:n+=e+" "+u+" "+a+`;
`}return n}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof gu?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,n,i,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new sN({type:e,size:n.size,name:i||"nodeUA"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new sN({type:e,name:i||"nodeU"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,n,i,r){return this.createUniform("vertex",t,e,n,i,r)}createFragmentUniform(t,e,n,i,r){return this.createUniform("fragment",t,e,n,i,r)}include(t,e,n){var s;let i;if(t=typeof t=="string"?zr.get(t):t,this.context.include===!1)return t.name;t instanceof qe?i=this.includes.functions:t instanceof an?i=this.includes.consts:t instanceof qV&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof qe&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return n&&(o.src=n),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return cfe[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!=null&&n.isNode)return n}}resolve(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!==void 0){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case ia:case $a:return new sfe(n);case Oc:return new rfe(new Da(n));default:return new Da(n)}else{if(n.isVector2)return new Fi(n);if(n.isVector3)return new Ps(n);if(n.isVector4)return new Ea(n)}}}}format(t,e,n){switch(this.colorToVector(n+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return hfe[t]||t}getFormatByType(t){return dfe[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return lN[t]}getIndexByElement(t){return lN.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=Gd,e===Gd&&this.context.gamma&&(e=ea),e}},Xn=class extends $r{constructor(t=0,e,n,i){super("c"),this.nodeType="Color",this.value=t instanceof go?t:new go(t||0,e,n,i)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,e)}},fn=class extends $r{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,n,i,r,s){return t.format(this.value.toString(),i,e)}},xr=class extends $r{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,n,i){return t.format(this.value?"true":"false",i,e)}},qu=class extends $r{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},TC=class extends $r{},pfe=class extends TC{constructor(t){super("v3"),this.image=t,this._value=new O}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},EA=class extends TC{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},YV=class extends $r{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new St}generateReadonly(t,e,n,i,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",i,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},ra=class extends $r{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new Ue}generateReadonly(t,e,n,i,r,s){return t.format("mat4("+this.value.elements.join(", ")+")",i,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function uN(t,e,n){t.setUvTransform(n[0],n[1],e[0],e[1],0,0,0)}var mfe=class extends YV{constructor(t,e){super(new St),this.repeat=t,this.offset=e,uN(this.value,t,e)}updateMatrix(){uN(this.value,this.repeat,this.offset)}},Xu=class extends $r{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof Ct?new Array(t).fill(e):new Array(t).fill(new Ct(0))}},cN=class extends hn{constructor(t,e,n,i){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=n,this.mode=i}generate(t,e){if(t.isShader("fragment")){let n=[];return n.push(this.a.build(t,"c")),n.push(this.b.build(t,"c")),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),t.format("spe_blend("+n.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},ZV=class extends hn{constructor(t,e){super("v3"),this.nodeType="CustomColor",this.color=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let n=t.include(ZV.Nodes.customColor);t.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(t,"v3")),i.push(this.mask?`luminance(${this.mask.build(t,"v3")})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("CustomColorNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},TA=ZV;TA.Nodes=function(){return{customColor:new qe(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var KV=class extends hn{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let n=t.include(KV.Nodes.customNormal);t.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(t,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},QV=KV;QV.Nodes=function(){return{customNormal:new qe(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Up=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d,c){super("v3"),this.nodeType="CustomTexture",this.texture=t,this.textureSize=e,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=o,this.blending=a,this.mat=l,this.isMask=c,this.alpha=u,this.mode=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let n=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=t.include(Up.Nodes.cylindrical);break;case 2:i=t.include(Up.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],a=new qe(`
		vec3 ${n}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=t.include(a);break;case 4:i=t.include(Up.Nodes.triplanar);break;default:i=t.include(Up.Nodes.uv);break}t.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.blending.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.projection.value===4){let s=`${n}_writeUvs`,o=s+"0",a=s+"1",l=s+"2",u=`${n}_triplanarWeights`;t.addFragmentVariable(o,"vec2"),t.addFragmentVariable(a,"vec2"),t.addFragmentVariable(l,"vec2"),t.addFragmentVariable(u,"vec3"),r.push(o),r.push(a),r.push(l),r.push(u)}else{let s=`${n}_writeUvs`;t.addFragmentVariable(s,"vec2"),r.push(s)}return t.format(i+"("+r.join(",")+")",this.getType(t),e)}},CC=Up;CC.Nodes=function(){let t=new qe(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),e=new qe(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),n=new qe(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new qe(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:t,spherical:e,uv:n,triplanar:i}}();var zp=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d,c){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=u,this.isMask=c,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new qe(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${n}_IS_VECTOR
                   #ifdef ${n}_LINEAR
                       #ifdef ${n}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${n}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${n}_SMOOTH
				for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[zp.Nodes.vectorLinearWorldSpaceDepth,zp.Nodes.vectorLinearObjectSpaceDepth,zp.Nodes.vectorSphericalObjectSpaceDepth,zp.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${n}_SMOOTH`),this.isVector.value>.5&&t.define(`${n}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${n}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(i),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.isMask.build(t,"b")),s.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},JV=zp;JV.Nodes=function(){let t=new qe(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new qe(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),n=new qe(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new qe(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:n,vectorSphericalObjectSpaceDepth:i}}();var gfe=class extends hn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=n,this.intensity=i,this.factor=r,this.isMask=a,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=new qe(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=t.include(n),r=[];return r.push(this.color.build(t,"c")),r.push(this.bias.build(t,"f")),r.push(this.scale.build(t,"f")),r.push(this.intensity.build(t,"f")),r.push(this.factor.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},e6=class extends hn{constructor(t,e,n,i,r,s,o,a,l){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=o,this.isMask=l,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(e6.Nodes.gradient),i=[];return i.push(this.gradientType.build(t,"i")),i.push(this.smooth.build(t,"b")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.offset.build(t,"v2")),i.push(this.morph.build(t,"v2")),i.push(this.angle.build(t,"f")),i.push(this.isMask.build(t,"b")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},t6=e6;t6.Nodes=function(){return{gradient:new qe(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var n6=class extends hn{constructor(t,e,n,i){super("v3"),this.nodeType="Matcap",this.texture=t,this.isMask=i,this.alpha=e,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(n6.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let i=[];return i.push(this.texture.generate(t,"t")),i.push("normal"),i.push(this.isMask.build(t,"b")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},i6=n6;i6.Nodes=function(){return{matcap:new qe(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var PC=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t.VORONOI="voronoi",t))(PC||{}),Nr=function(){let t=new qe(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new qe(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new an("float F3 0.3333333"),e.keywords.G3=new an("float G3 0.1666667");let n=new qe(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),i=new qe("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new qe("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new qe(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,r]),o=new qe("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new qe("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new qe(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),u=new qe(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);u.keywords.NUM_OCTAVES=new an("int NUM_OCTAVES 5");let d=new qe("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),c=new qe(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,r,d]),h=new qe(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new qe(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),m=new qe(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),x=new qe(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),y=new qe(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new qe(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),_=new qe(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[h,f,m,x,y,v]);return{simplex:e,simplexFractal:n,simplexAshima:s,fbm:u,perlin:c,voronoi:_}}(),r6=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y,v,_){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=u,this.noiseType=c,this.voronoiStyle=f,this.highCut=m,this.lowCut=x,this.smoothness=y,this.seed=v,this.quality=_,this.isMask=h,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,n,i,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(PC)[this.noiseType.value],o=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,a=new qe(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Nr.simplex,Nr.simplexFractal,Nr.simplexAshima,Nr.fbm,Nr.perlin,Nr.voronoi]),l=t.include(a),u=[];return u.push(this.scale.build(t,"f")),u.push(this.size.build(t,"v3")),u.push(this.move.build(t,"f")),u.push(this.fA.build(t,"v2")),u.push(this.fB.build(t,"v2")),u.push(this.distortion.build(t,"v2")),u.push(this.colorA.build(t,"v4")),u.push(this.colorB.build(t,"v4")),u.push(this.colorC.build(t,"v4")),u.push(this.colorD.build(t,"v4")),u.push(this.voronoiStyle.build(t,"i")),u.push(this.highCut.build(t,"f")),u.push(this.lowCut.build(t,"f")),u.push(this.smoothness.build(t,"f")),u.push(this.seed.build(t,"f")),u.push(this.quality.build(t,"i")),u.push(this.isMask.build(t,"b")),u.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),u.push(this.alpha.build(t,"f")),u.push(this.calpha),t.format(l+"("+u.join(",")+")",this.getType(t),e)}};r6.numOctaves=5;var s6=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h,f,m,x){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=u,this.compensation=d,this.resolution=c,this.normalMap=h,this.depthMap=f,this.pixelRatio=m,this.alpha=x,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let n=`g${this.uuid.toString().replace(/-/g,"")}`;if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.compensation.value&&t.define("OUTLINE_COMPENSATION",`${n}_offset`),this.firstTime){let i=this.outlineWidth.build(t,"f"),r=this.resolution.build(t,"v2"),s=this.compensation.build(t,"b"),o=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(i,"uniform float"),t.addVertexParsVariable(r,"uniform vec2"),t.addVertexParsVariable(s,"uniform bool"),t.addVertexParsVariable(o,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float"),t.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${n}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${n}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${n}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${n}_offset = normalize(${n}_clipNormal.xy) / ${r} * (${i} / 2.0) * ${n}_clipPosition.w * 2.0 * ${o};
                    ${n}_clipPosition.xy += ${n}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${n}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(s6.Nodes.outline),r=[];return r.push(this.outlineColor.build(t,"c")),r.push(this.contourColor.build(t,"c")),r.push(this.outlineWidth.build(t,"f")),r.push(this.contourWidth.build(t,"f")),r.push(this.contourThreshold.build(t,"f")),r.push(this.outlineThreshold.build(t,"f")),r.push(this.contourFrequency.build(t,"f")),r.push(this.outlineSmoothing.build(t,"f")),r.push(this.contourDirection.build(t,"v3")),r.push(this.positionalLines.build(t,"b")),r.push(this.resolution.build(t,"v2")),r.push(this.normalMap.getTexture(t,"t")),r.push(this.depthMap.getTexture(t,"t")),r.push(this.pixelRatio.build(t,"f")),r.push(this.compensation.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},o6=s6;o6.Nodes=function(){let t=new qe(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new qe(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[t])}}();var ba=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y,v){super("v3"),this.nodeType="Pattern",this.style=t,this.projection=e,this.axis=n,this.blending=i,this.offset=r,this.colorA=s,this.colorB=o,this.frequency=a,this.size=l,this.variation=u,this.smoothness=d,this.zigzag=c,this.rotation=h,this.vertical=f,this.horizontal=m,this.sides=x,this.isMask=v,this.alpha=y,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.require("position"),t.require("uv"),t.requires.uv=[!0],t.require("normal"),t.requires.normal=!0,t.addFragmentVariable(this.calpha,"float");let n;switch(this.style.value){case 0:n="circle";break;case 1:n="ring";break;case 2:n="polygon";break;case 3:n="xcross";break;case 4:n="diamond";break;case 5:n="checkerboard";break;case 6:n="line";break;case 7:n="wave";break;default:n="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,r=new qe(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new qe(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let d=this.style.value===2?`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,c=this.style.value===2?`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${d};
				float d1 = ${c};
				float d2 = ${h};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let d=this.style.value===2?`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,c="";this.axis.value===0?c=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?c=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,c=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let h="";switch(this.projection.value){case 0:h="custom_uv = vUv.st;";break;case 1:break;case 2:h=`
							vec3 p = position;
							${c}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${h}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${d};
				`}let a=new qe(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,r,ba.DrawFunctions.circle,ba.DrawFunctions.ring,ba.DrawFunctions.polygon,ba.DrawFunctions.cross,ba.DrawFunctions.diamond,ba.DrawFunctions.checkerboard,ba.DrawFunctions.line,ba.DrawFunctions.wave]),l=t.include(a),u=[];return u.push("normal"),u.push(this.blending.build(t,"f")),u.push(this.style.build(t,"i")),u.push(this.offset.build(t,"v2")),u.push(this.colorA.build(t,"v4")),u.push(this.colorB.build(t,"v4")),u.push(this.frequency.build(t,"v2")),u.push(this.size.build(t,"f")),u.push(this.variation.build(t,"f")),u.push(this.smoothness.build(t,"f")),u.push(this.zigzag.build(t,"f")),u.push(this.rotation.build(t,"f")),u.push(this.vertical.build(t,"v2")),u.push(this.horizontal.build(t,"v2")),u.push(this.sides.build(t,"i")),u.push(this.isMask.build(t,"b")),u.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),u.push(this.alpha.build(t,"f")),u.push(this.calpha),t.format(l+"("+u.join(",")+")",this.getType(t),e)}else return console.warn("PatterNode is not compatible with "+t.shader+" shader."),t.format("vec3(0.0)",this.getType(t),e)}},a6=ba;a6.DrawFunctions=function(){let t=new qe(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),e=new qe(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[t]),n=new qe(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[e]),i=new qe(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[e]),r=new qe(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[e]),s=new qe(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[e]),o=new qe(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[e]),a=new qe(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new qe(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[e]),u=new qe(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:e,circle:n,ring:i,polygon:r,cross:s,diamond:o,checkerboard:a,line:l,wave:u}}();var l6=class extends hn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.isMask=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(l6.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(t,"f")),i.push(this.movement.build(t,"f")),i.push(this.wavelengths.build(t,"v3")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.offset.build(t,"v3")),i.push(this.isMask.build(t,"b")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},u6=l6;u6.Nodes=function(){let t=new qe(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Nr.simplex]);return{rainbow:new qe(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[t])}}();var c6=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let n=t.include(c6.Nodes.toon),i=[];return i.push(this.positioning.build(t,"i")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.source.build(t,"v3")),i.push(this.isWorldSpace.build(t,"b")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.shadowColor.build(t,"v4")),i.push(this.offset.build(t,"v3")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},h6=c6;h6.Nodes=function(){let t=new qe(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new qe(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),n=new qe(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),i=new qe(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new qe(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new qe(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Nr.simplex,t,n,r])}}();var vfe=function(){return{textureBicubic:new qe(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function yfe(t,e){return t>=e?new ee(e/t,1):new ee(1,t/e)}var d6=class extends hn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",6),t.define("BLUR_SLOD",Math.pow(2,qt.transmissionLod.value)),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let n=t.include(d6.Nodes.transmission),i=[];return i.push(this.thickness.build(t,"f")),i.push(this.ior.build(t,"f")),i.push(this.roughness.build(t,"f")),i.push(this.transmissionSamplerSize.build(t,"v2")),i.push(this.transmissionSamplerMap.getTexture(t,"t")),i.push(this.transmissionDepthMap.getTexture(t,"t")),i.push(this.aspectRatio.build(t,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},f6=d6;f6.Nodes=function(){let t=new qe(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),e=new qe(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),n=new qe(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new qe(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[vfe.textureBicubic,n,t]),r=new qe(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,e]);return{transmission:new qe(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[r])}}();var CA=(t=>(t.NOISE="noise",t.MAP="map",t))(CA||{}),p6=class extends hn{constructor(t,e,n,i,r,s,o,a,l,u,d){super("v3"),this.displacementTypeIndex=new fn(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(CA)[this.displacementTypeIndex.value]==="map"&&(this.mat=new YV(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=u,this.noiseFunctionIndex=d,this.voronoiStyle=i,this.smoothness=r,this.seed=s,this.highCut=o,this.lowCut=a,this.quality=l}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(CA)[this.displacementTypeIndex.value]){case"map":{n=t.include(p6.Nodes.map),i.push(this.movementOrTexture.getTexture(t,"t")),i.push("uv"),i.push(this.cropOrOffset.build(t,"f")),this.mat&&i.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(PC)[this.noiseFunctionIndex.value],s=new qe(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=r=="voronoi"?`
					float v = ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,a=new qe(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[Nr.simplex,Nr.simplexFractal,Nr.simplexAshima,Nr.fbm,Nr.perlin,Nr.voronoi]),l=new qe(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);n=t.include(l),i.push(this.scale.build(t,"f")),i.push(this.cropOrOffset.build(t,"v3")),i.push(this.movementOrTexture.build(t,"f")),i.push(this.voronoiStyle.build(t,"i")),i.push(this.smoothness.build(t,"f")),i.push(this.seed.build(t,"f")),i.push(this.highCut.build(t,"f")),i.push(this.lowCut.build(t,"f")),i.push(this.quality.build(t,"i"));break}}return i.push(this.intensity.build(t,"f")),i.push("displaced_normal"),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},m6=p6;m6.Nodes=function(){let t=new qe(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new qe(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new qe(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var qt={normalRenderTarget:new Da,normalRenderTargetDepth:new Da,transmissionRenderTarget:new Da,aspectRatio:new Fi,transmissionSize:new Fi(2048,2048),transmissionRenderTargetDepth:new Da,aoRenderTarget:new Da,aoEnabled:new xr,pixelRatioNode:new Je(1),resolution:new Fi,penumbraSize:new qu(5,.5),frameIndex:new fn(0),transmissionLod:new fn(2)};for(let t of Object.values(qt))t.isRenderGlobal=!0;var g6=class extends gu{constructor(){super("basic"),this.nodeType="Basic",this.color=new Xn($s),this.shadingAlpha=new Je(1),this.shadingBlend=new fn(0),this.previousModelViewMatrix=new ra,this.previouseProjectionMatrix=new ra}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({resolution:qt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(Nc.merge([Ve.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{this.color===void 0&&(this.color=new Xn($s)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let n=this.color.flow(t,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,s=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=i!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",n.code];i&&o.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?o.push(s.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${n.result};`);let a="1.0";this.mask&&(this.mask.analyze(t),a=`luminance(${this.mask.flow(t,"v3").result})`),i?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${a} );`):o.push("gl_FragColor = vec4("+n.result+", 1.0 );"),r&&o.push(`gl_FragColor.a *= ${r.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),e=o.join(`
`)}return e}},xfe=class extends gu{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Xn($s),this.emissive=new Xn(0),this.emissiveIntensity=new Je(1),this.previousModelViewMatrix=new ra,this.previouseProjectionMatrix=new ra,this.shadingAlpha=new Je(1),this.shadingBlend=new fn(0),this.occlusion=new xr(!0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({resolution:qt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(Nc.merge([Ve.fog,Ve.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qt.penumbraSize}),t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({aoMap:qt.aoRenderTarget}),t.mergeUniform({aoEnabled:qt.aoEnabled}),this.color===void 0&&(this.color=new Xn($s)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.occlusion.flow(t,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(t,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=u!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];c.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),u&&c.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),c.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&c.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),c.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let h="1.0";this.mask&&(this.mask.analyze(t),h=`luminance(${this.mask.flow(t,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${a.result} );

					outgoingLight *= ao;
				}
				`),l&&c.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&c.push(`gl_FragColor.a *= ${d.result};`),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},of=function(){let t=new qe(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),e=new qe(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:t,perturbNormalArb:e}}(),_fe=class extends gu{constructor(){super("phong"),this.nodeType="Phong",this.color=new Xn($s),this.specular=new Xn(1118481),this.shininess=new Je(30),this.previousModelViewMatrix=new ra,this.previouseProjectionMatrix=new ra,this.shadingAlpha=new Je(1),this.shadingBlend=new fn(0),this.occlusion=new xr(!0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({resolution:qt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(Nc.merge([Ve.fog,Ve.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qt.penumbraSize}),t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({aoMap:qt.aoRenderTarget}),t.mergeUniform({aoEnabled:qt.aoEnabled}),this.color===void 0&&(this.color=new Xn($s)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t);let n=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),r=this.specular.flow(t,"c"),s=this.shininess.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(t,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=u!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){t.include(of.dHdxy),t.include(of.perturbNormalArb);let f=this.bumpMap.texture.flow(t,"t"),m=this.bumpMap.flow(t,"v3"),x=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${x});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${x});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${x});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${x});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,c.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),u&&c.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let h="1.0";this.mask&&(this.mask.analyze(t),h=`luminance(${this.mask.flow(t,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${a.result} );
					
					outgoingLight *= ao;
				}
				`),l&&c.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result});`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&c.push(`gl_FragColor.a *= ${d.result};`),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},wfe=class extends gu{constructor(){super("standard"),this.nodeType="Standard",this.color=new Xn($s),this.roughness=new Je(.3),this.metalness=new Je(0),this.reflectivity=new Je(.5),this.previousModelViewMatrix=new ra,this.previouseProjectionMatrix=new ra,this.shadingAlpha=new Je(1),this.shadingBlend=new fn(0),this.occlusion=new xr(!0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({resolution:qt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(Nc.merge([Ve.fog,Ve.lights])),Ve.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qt.penumbraSize}),t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({aoMap:qt.aoRenderTarget}),t.mergeUniform({aoEnabled:qt.aoEnabled});let n={gamma:!0};this.color===void 0&&(this.color=new Xn($s)),this.color.analyze(t,{slot:"color",context:n}),this.roughness.analyze(t),this.metalness.analyze(t);let i=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let r=this.color.flow(t,"c",{slot:"color",context:n}),s=this.roughness.flow(t,"f"),o=this.metalness.flow(t,"f"),a=this.shadingAlpha.flow(t,"f"),l=this.shadingBlend.flow(t,"i"),u=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,d=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=d!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){t.include(of.dHdxy),t.include(of.perturbNormalArb);let x=this.bumpMap.texture.flow(t,"t"),y=this.bumpMap.flow(t,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",_="";this.bumpMap.projection.value===4?_=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${x.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${x.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${x.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:_=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${x.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${y.result};
					${_}
					`)}if(f.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let x=this.roughnessMap.texture.flow(t,"t"),y=this.roughnessMap.flow(t,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${x.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${x.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${x.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${x.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${y.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else f.push(s.code,"	float roughnessFactor = "+s.result+";");d&&f.push(d.code,"#ifdef ALPHATEST","	if ( "+d.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?f.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let m="1.0";this.mask&&(this.mask.analyze(t),m=`luminance(${this.mask.flow(t,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${m} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${m}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),u&&f.push(u.code,`outgoingLight = spe_blend(outgoingLight, ${u.result}, 1.0, SPE_BLENDING_NORMAL);`),d?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${d.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&f.push(`gl_FragColor.a *= ${c.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=f.join(`
`)}return e}},Sfe=class extends gu{constructor(){super("toon"),this.nodeType="Toon",this.color=new Xn($s),this.specular=new Xn(1118481),this.shininess=new Je(30),this.previousModelViewMatrix=new ra,this.previouseProjectionMatrix=new ra,this.shadingAlpha=new Je(1),this.shadingBlend=new fn(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({resolution:qt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(Nc.merge([Ve.fog,Ve.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qt.penumbraSize}),t.mergeUniform({frameIndex:qt.frameIndex}),t.mergeUniform({aoMap:qt.aoRenderTarget}),t.mergeUniform({aoEnabled:qt.aoEnabled}),this.color===void 0&&(this.color=new Xn($s)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){t.include(of.dHdxy),t.include(of.perturbNormalArb);let h=this.bumpMap.texture.flow(t,"t"),f=this.bumpMap.flow(t,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",x="";this.bumpMap.projection.value===4?x=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${h.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${h.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${h.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:x=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${h.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${x}
					`)}d.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&d.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let c="1.0";this.mask&&(this.mask.analyze(t),c=`luminance(${this.mask.flow(t,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${c} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${c}, ${o.result} );
				}
				`),a&&d.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&d.push(`gl_FragColor.a *= ${u.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=d.join(`
`)}return e}},bfe=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),n=this.cache.get(t);return n===void 0?(n={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,n)):(n.time=e,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},Mfe=class extends bfe{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},bb;function Afe(t){return typeof t=="string"?t:(bb||(bb=new Mfe),bb.load(t))}var Efe=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},Tfe=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},v6=class extends Efe{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type==="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let r of i){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var n=new FileReader;n.readAsDataURL(new Blob([t],{type:"video/mp4"}));let i;await new Promise(r=>{n.onloadend=s=>{var o;i=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=i}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=Afe(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let n;return this.isVideo?n=new NF(this.img,void 0,t,t):n=new Tn(this.img,void 0,t,t),this.loaded&&(n.needsUpdate=!0),this[t]=n,n}}disposeTextures(){var t,e,n;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(n=this[1002])==null||n.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},uc=class extends v6{};function _r(t,e){return e.color(t)}function Cfe(t,e){switch(t.type){case"fresnel":return Lfe(t,e);case"gradient":return Dfe(t,e);case"depth":return Ife(t,e);case"normal":return Ofe(t,e);case"noise":return Nfe(t,e);case"rainbow":return kfe(t,e);case"toon":return Ufe(t,e);case"outline":return zfe(t,e);case"transmission":return Ffe(t,e);case"color":return Rfe(t,e);case"pattern":return Bfe(t,e)}}function Pfe(t){return{type:t.type}}function bo(t,e){let{alpha:n,mode:i,isMask:r}=t,s=typeof n=="string"?(Number(e.getVariable(n))??100)/100:n;return{...Pfe(t),alpha:s,mode:i,isMask:r}}function Rfe(t,e){return{...bo(t,e),color:_r(t.color,e)}}function Lfe(t,e){let{bias:n,scale:i,intensity:r,factor:s,color:o}=t;return{...bo(t,e),color:_r(o,e),bias:n,scale:i,intensity:r,factor:s}}function Dfe(t,e){let{gradientType:n,smooth:i,colors:r,steps:s,angle:o,offset:a,morph:l}=t;return{...bo(t,e),gradientType:n,smooth:i,colors:r.map(u=>new Ct(u[0],u[1],u[2],u[3])),num:r.length,steps:s,offset:new ee(...a),morph:new ee(...l),angle:o}}function Ife(t,e){let{gradientType:n,near:i,far:r,isVector:s,isWorldSpace:o,origin:a,direction:l,colors:u,steps:d,smooth:c}=t;return{...bo(t,e),gradientType:n,near:i,far:r,isVector:s,isWorldSpace:o,origin:new O(...a),direction:l?new O(...l):new O(1,0,0),colors:u.map(h=>h!==void 0?new Ct(h[0],h[1],h[2],h[3]):new Ct(0,0,0,0)),steps:d.slice(0,u.length),smooth:c}}function Ofe(t,e){let{cnormal:n}=t;return{...bo(t,e),cnormal:new O(n[0],n[1],n[2])}}function Nfe(t,e){return{...bo(t,e),scale:t.scale,move:t.move,fA:new ee(...t.fA),fB:new ee(...t.fB),size:new O(...t.size),distortion:new ee(...t.distortion),colorA:_r(t.colorA,e),colorB:_r(t.colorB,e),colorC:_r(t.colorC,e),colorD:_r(t.colorD,e),noiseType:t.noiseType,voronoiStyle:t.voronoiStyle,highCut:t.highCut,lowCut:t.lowCut,smoothness:t.smoothness,seed:t.seed,quality:t.quality}}function kfe(t,e){return{...bo(t,e),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new O(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new O(...t.offset)}}function Ufe(t,e){return{...bo(t,e),positioning:t.positioning,colors:t.colors.map(n=>new Ct(n[0],n[1],n[2],n[3])),num:t.colors.length,steps:t.steps,source:new O(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:_r(t.shadowColor,e),offset:new O(...t.offset)}}function zfe(t,e){return{...bo(t,e),outlineColor:_r(t.outlineColor,e),contourColor:_r(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new O(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function Ffe(t,e){return{...bo(t,e),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}function Bfe(t,e){return{...bo(t,e),style:t.style,projection:t.projection,axis:t.axis,blending:t.blending,offset:new ee(...t.offset),colorA:_r(t.colorA,e),colorB:_r(t.colorB,e),frequency:new ee(...t.frequency),size:t.size,variation:t.variation,smoothness:t.smoothness,zigzag:t.zigzag,rotation:t.rotation,vertical:new ee(...t.vertical),horizontal:new ee(...t.horizontal),sides:t.sides}}var Y1=class extends go{},y6={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},x6={depth:["colors"]};function Vfe(t,e,n){var s,o;if(e==="isMask")return!0;let i=y6[t.type],r=x6[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==n.length)return!0}}return i!==void 0?i.includes(e):!1}function _6(t,e,n){let i=n.uniforms[`f${n.id}_texture`];if(!i)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=i;l.image instanceof uc||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=i;l.image instanceof uc||l.image.deref(),l.image=a}if("wrapping"in s){let o=i;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=n.uniforms[`f${n.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function jfe(t,e,n,i){let r=!1;for(let[s,o]of Object.entries(t)){if(s==="bumpMap"||s==="roughnessMap"){r=!0;continue}if(!s||o===void 0)continue;if(S6(s,n,i,e)){s==="visible"&&n.type==="light"&&(r=!0);continue}n.visible=i.visible;let a=n.uniforms[`f${n.id}_${s}`];if(a&&!(a instanceof TC))switch(r=r||Vfe(n,s,o),a.constructor){case Xn:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof Y1?a.value=new go(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Ea:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof Y1?a.value=new go(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case Fi:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Ps:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case Da:{_6(o,e,n);break}case Xu:{a.value=o.map(l=>new Ct(...l));break}default:{a.value=o;break}}}return r}var Lc=(t,e,n)=>Math.max(0,Math.min(1,Number(e.getVariable(typeof t=="number"?t*100:t,n)??100)/100))??1,vc=class{constructor(t,e,n,i,r){this.id=t,this.uuid=e,this.data=n,this.uniforms={};for(let s in i)this.uniforms[`f${this.id}_${s}`]=i[s];for(let s in n)S6(s,this,n,r)}get type(){return this.data.type}static create(t,e,n,i){if(n.type==="light")return Ta.createLigherLayer(t,e,n,i);if(n.type==="texture"||n.type==="video"){let r=n.type==="texture"?i.image(n.texture.image):i.video(n.texture.video),s=new EA(r,n.texture.wrapping),o=new pfe(r),a=new mfe(n.texture.repeat,n.texture.offset),l=new Je(n.crop?1:0),u=new fn(n.projection??0),d=new fn(["x","y","z"].indexOf(n.axis)??0),c=new fn(n.side??0),h=new Fi(n.size?new ee(n.size[0],n.size[1]):new ee(100,100)),f=new Je(n.blending??0),m=new Je(Lc(n.alpha,i)),x=new fn(n.mode??0),y=new xr(n.isMask??!1),v=new CC(s,o,l,u,d,c,h,f,a,m,x,y),_=new vn(v.calpha,"f");return new jn(t,e,n,{texture:s,textureSize:o,crop:l,projection:u,axis:d,side:c,size:h,blending:f,mat:a,alpha:m,mode:x,isMask:y},v,x,_,y,i)}else if(n.type==="matcap"){let r=i.image(n.texture.image),s=new EA(r,n.texture.wrapping),o=new Je(Lc(n.alpha,i)),a=new fn(n.mode??0),l=new xr(n.isMask??!1),u=new i6(s,o,a,l),d=new vn(u.calpha,"f");return new jn(t,e,n,{texture:s,alpha:o,mode:a,isMask:l},u,a,d,l,i)}else if(n.type==="displace")if(n.displacementType==="noise"){let r=new Ps(new O(...n.offset)),s=new Je(n.scale??10),o=new Je(n.intensity??8),a=new Je(n.movement??1),l=new fn(n.noiseType??0),u=new fn(n.voronoiStyle??0),d=new Je(n.smoothness??.5),c=new Je(n.seed??0),h=new Je(n.highCut??1),f=new Je(n.lowCut??0),m=new fn(n.quality??1),x=new m6(o,a,r,u,d,c,h,f,m,s,l);return new w6(t,e,n,{offset:r,scale:s,intensity:o,movement:a,noiseType:l,voronoiStyle:u,smoothness:d,seed:c,highCut:h,lowCut:f,quality:m},x,i)}else throw new Error;else return Wfe(t,e,n,i)}updateByOp(t,e,n){let i=t;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(n.scene.markNeedsUpdateRendererDirty(),!0):jfe(i.props,n.shared,this,e)}else if(i.path[0]==="texture")return"texture"in e||"video"in e?_6(i.props,n.shared,this):!0;return!1}dispose(){if(Gfe(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof uc||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let n=`f${this.id}_${t}`;this.hasValueByKey(n)&&e!==void 0&&(this.uniforms[n].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let n=this.getName(e);n&&t.push(n)}return t}},jn=class extends vc{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,l),this.params=i,this.color=r,this.mode=s,this.alpha=o,this.isMask=a}},w6=class extends vc{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this.position=r}},Ta=class extends vc{constructor(t,e,n,i,r,s){super(t,e,n,r,s),this.node=i}static createLigherLayer(t,e,n,i){let r,s=new Je(Lc(n.alpha,i)),o=new fn(n.mode),a=new Je(n.bumpMapIntensity),l=new Je(Lc(n.alphaOverride,i)),u;if(!n.visible)r=new g6,u={};else if(n.category==="lambert"){r=new xfe;let d=new Xn(i.color(n.emissive)??0),c=new xr(n.occlusion??!0);u={emissive:d,occlusion:c},r.emissive=d,r.occlusion=c}else if(n.category==="toon"){r=new Sfe;let d=new Je(n.shininess??30),c=new Xn(i.color(n.specular)??1118481);u={shininess:d,specular:c},r.shininess=d,r.specular=c}else if(n.category==="physical"){r=new wfe;let d=new Je(n.roughness??.3),c=new Je(n.metalness??0),h=new Je(n.reflectivity??.5),f=new xr(n.occlusion??!0);u={roughness:d,metalness:c,reflectivity:h,occlusion:f},r.roughness=d,r.metalness=c,r.reflectivity=h,r.occlusion=f}else{r=new _fe;let d=new Je(n.shininess??30),c=new Xn(n.specular!==void 0?i.color(n.specular)??1118481:1118481),h=new xr(n.occlusion??!0);u={shininess:d,specular:c,occlusion:h},r.shininess=d,r.specular=c,r.occlusion=h}return r.alpha=new Je(1),r.shadingAlpha=s,r.shadingBlend=o,r.bumpMapIntensity=a,r.alphaOverride=l,u.alpha=r.shadingAlpha,u.mode=r.shadingBlend,u.bumpMapIntensity=r.bumpMapIntensity,u.alphaOverride=r.alphaOverride,new Ta(t,e,n,r,u,i)}get category(){return this.node.category}};function Gfe(t){let e=t instanceof vc?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function Es(t){return{alpha:new Je(t.alpha??1),mode:new fn(t.mode??0),isMask:new xr(t.isMask??!1)}}function Hfe(t,e,n,i,r){switch(t.type){case"color":{let s=new Xn(i.color??$s),o=Es(i),a=new TA(s,o.alpha),l=new vn(a.calpha,"f");return new jn(e,n,t,{color:s,...o},a,o.mode,l,o.isMask,r)}case"fresnel":{let s=new Xn(i.color??16777215),o=new Je(i.bias??.1),a=new Je(i.scale??1),l=new Je(i.intensity??2),u=new Je(i.factor??1),d=Es(i),c=new gfe(s,o,a,l,u,d.alpha,d.mode,d.isMask),h=new vn(c.calpha,"f");return new jn(e,n,t,{color:s,bias:o,scale:a,intensity:l,factor:u,...d},c,d.mode,h,d.isMask,r)}case"rainbow":{let s=new Je(i.filmThickness??30),o=new Je(i.movement??0),a=new Ps(i.wavelengths??new O(0,0,0)),l=new Je(i.noiseStrength??0),u=new Je(i.noiseScale??1),d=new Ps(i.offset??new O(0,0,0)),c=Es(i),h=new u6(s,o,a,l,u,d,c.alpha,c.isMask),f=new vn(h.calpha,"f");return new jn(e,n,t,{filmThickness:s,movement:o,wavelengths:a,noiseStrength:l,noiseScale:u,offset:d,...c},h,c.mode,f,c.isMask,r)}case"transmission":{let s=new Je(i.thickness??10),o=new Je(i.ior??1.5),a=new Je(i.roughness??.5),l=qt.transmissionSize,u=qt.transmissionRenderTarget,d=qt.transmissionRenderTargetDepth,c=window.innerWidth,h=window.innerHeight,f=c>=h?new Fi(h/c,1):new Fi(1,c/h),m=Es(i),x=new f6(s,o,a,l,u,d,f,m.alpha),y=new vn(x.calpha,"f");return new jn(e,n,t,{thickness:s,ior:o,roughness:a,aspectRatio:f,...m},x,m.mode,y,m.isMask,r)}case"toon":{let s=new fn(i.positioning??0),o;i.colors?o=new Xu(i.colors.length,i.colors):(o=new Xu(10,new Ct(0,0,0,1)),o.value[1]=new Ct(1,1,1,1));let a;i.steps?a=new qu(i.steps.length,i.steps):(a=new qu(10,1),a.value[0]=0);let l=new Ps(i.source??new O(0,0,0)),u=new xr(i.isWorldSpace??!0),d=new Je(i.noiseStrength??0),c=new Je(i.noiseScale??1),h=new Ea(i.shadowColor),f=new Ps(i.offset??new O(0,0,0)),m=Es(i),x=new h6(s,o,a,l,u,d,c,h,f,m.alpha),y=new vn(x.calpha,"f");return new jn(e,n,t,{positioning:s,colors:o,steps:a,source:l,isWorldSpace:u,noiseStrength:d,noiseScale:c,shadowColor:h,offset:f,...m},x,m.mode,y,m.isMask,r)}case"outline":{let s=new Xn(i.outlineColor??16777215),o=new Xn(i.contourColor??16777215),a=new Je(i.outlineWidth??.1),l=new Je(i.contourWidth??.1),u=new Je(i.outlineThreshold??.1),d=new Je(i.contourThreshold??.1),c=new Je(i.outlineSmoothing??.1),h=new Je(i.contourFrequency??.1),f=new Ps(i.contourDirection??new O(0,1,0)),m=new xr(i.positionalLines??!1),x=new xr(i.compensation??!0),y=qt.normalRenderTarget,v=qt.normalRenderTargetDepth,_=qt.pixelRatioNode,w=qt.resolution,b=Es(i),E=new o6(s,o,a,l,u,d,c,h,f,m,x,w,y,v,_,b.alpha),A=new vn(E.calpha,"f");return new jn(e,n,t,{outlineColor:s,contourColor:o,outlineWidth:a,contourWidth:l,outlineThreshold:u,contourThreshold:d,outlineSmoothing:c,contourFrequency:h,contourDirection:f,positionalLines:m,compensation:x,...b},E,b.mode,A,b.isMask,r)}case"depth":{let s=new fn(i.gradientType??0),o=new xr(i.smooth??!1),a=new Je(i.near??50),l=new Je(i.far??200),u=new Je(i.isVector??1),d=new Je(i.isWorldSpace??0),c=new Ps(i.origin??new O),h=new Ps(i.direction??new O),f;i.colors?f=new Xu(i.colors.length,i.colors):(f=new Xu(2,new Ct(0,0,0,1)),f.value[1]=new Ct(1,1,1,1));let m;i.steps?m=new qu(i.steps.length,i.steps):(m=new qu(2,1),m.value[0]=0);let x=Es(i),y=new JV(s,o,a,l,u,d,c,h,f,m,x.alpha,x.isMask),v=new vn(y.calpha,"f");return new jn(e,n,t,{gradientType:s,smooth:o,near:a,far:l,isVector:u,isWorldSpace:d,origin:c,direction:h,colors:f,steps:m,...x},y,x.mode,v,x.isMask,r)}case"noise":{let s=new Je(i.scale??1),o=new Ps(i.size??new O(100,100,100)),a=new Je(i.move??1),l=new Fi(i.fA??new ee(1.7,9.2)),u=new Fi(i.fB??new ee(8.3,2.8)),d=new Fi(i.distortion??new ee(1,1)),c=new Ea(i.colorA),h=new Ea(i.colorB),f=new Ea(i.colorC),m=new Ea(i.colorD),x=new fn(i.noiseType??0),y=new fn(i.voronoiStyle??0),v=new Je(i.highCut??1),_=new Je(i.lowCut??0),w=new Je(i.smoothness??.5),b=new Je(i.seed??.5),E=new fn(i.quality??1),A=Es(i),T=new r6(s,o,a,l,u,d,c,h,f,m,A.alpha,x,A.isMask,y,v,_,w,b,E),L=new vn(T.calpha,"f");return new jn(e,n,t,{scale:s,size:o,move:a,fA:l,fB:u,distortion:d,colorA:c,colorB:h,colorC:f,colorD:m,noiseType:x,...A,voronoiStyle:y,highCut:v,lowCut:_,smoothness:w,seed:b,quality:E},T,A.mode,L,A.isMask,r)}case"normal":{let s=new Ps(i.cnormal??new O(1,1,1)),o=Es(i),a=new QV(s,o.alpha),l=new vn(a.calpha,"f");return new jn(e,n,t,{cnormal:s,...o},a,o.mode,l,o.isMask,r)}case"gradient":{let s=new fn(i.gradientType??0),o=new xr(i.smooth??!1),a;i.colors?a=new Xu(i.colors.length,i.colors):(a=new Xu(10,new Ct(0,0,0,1)),a.value[1]=new Ct(1,1,1,1));let l;i.steps?l=new qu(i.steps.length,i.steps):(l=new qu(10,1),l.value[0]=0);let u=new Fi(i.offset??new ee(0,0)),d=new Fi(i.morph??new ee(0,0)),c=new Je(i.angle??0),h=Es(i),f=new t6(s,o,a,l,u,d,c,h.alpha,h.isMask),m=new vn(f.calpha,"f");return new jn(e,n,t,{gradientType:s,smooth:o,colors:a,steps:l,offset:u,morph:d,angle:c,...h},f,h.mode,m,h.isMask,r)}case"pattern":{let s=new fn(i.style??0),o=new fn(i.projection??0),a=new fn(["x","y","z"].indexOf(i.axis)??0),l=new Je(i.blending??0),u=new Fi(i.offset??new ee(0,0)),d=new Ea(i.colorA),c=new Ea(i.colorB),h=new Fi(i.frequency??new ee(10,10)),f=new Je(i.size??.5),m=new Je(i.variation??0),x=new Je(i.smoothness??.5),y=new Je(i.zigzag??0),v=new Je(i.rotation??0),_=new Fi(i.vertical??new ee(0,1)),w=new Fi(i.horizontal??new ee(0,1)),b=new fn(i.sides??6),E=Es(i),A=new a6(s,o,a,l,u,d,c,h,f,m,x,y,v,_,w,b,E.alpha,E.isMask),T=new vn(A.calpha,"f");return new jn(e,n,t,{style:s,projection:o,axis:a,blending:l,offset:u,colorA:d,colorB:c,frequency:h,size:f,variation:m,smoothness:x,zigzag:y,rotation:v,vertical:_,horizontal:w,sides:b,...E},A,E.mode,T,E.isMask,r)}default:{let s=new Xn(1,0,0,1),o=Es(i),a=new TA(s,o.alpha),l=new vn(a.calpha,"f");return new jn(e,n,t,{color:s,...o},a,o.mode,l,o.isMask,r)}}}function Wfe(t,e,n,i){let r=Cfe(n,i);return Hfe(n,t,e,r,i)}function S6(t,e,n,i){if(n.type==="displace"&&(t==="intensity"||t==="visible")){let r=e.uniforms[`f${e.id}_intensity`];return r?(r.value=n.intensity*(n.visible?1:0),r):void 0}if(n.type!=="displace"&&(t==="alpha"||t==="visible")){let r=e.uniforms[`f${e.id}_alpha`];if(!r)return;if(r.value=Lc(n.alpha,i)*(n.visible?1:0),n.type==="outline"&&t==="visible"){let s=e.uniforms[`f${e.id}_compensation`];s&&(s.value=n.compensation&&n.visible)}return r}}function ry(t,e){let n=0,i=t.layers.find(r=>r.data.type==="light");if(i){let r=i.data,s=Number(e.getVariable(r.alphaOverride));if((typeof r.alphaOverride=="string"?s/100:r.alphaOverride)<1)return!0}for(let r of t.layers){if(r.data.type!=="displace"&&r.data.isMask)return!0;if(r.data.type!=="displace"&&"alpha"in r.data&&r.data.type!=="light"&&r.data.type!=="fresnel"&&r.data.type!=="texture"&&r.data.type!=="matcap"&&r.data.type!=="rainbow"&&r.data.type!=="outline"&&r.data.type!=="pattern"){let s=r.data.visible?r.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(e.getVariable(s)??100)/100))),s===1&&r.data.type==="depth"||r.data.type==="gradient"){for(let o of r.data.colors)if(o[3]<1){s=o[3];break}}else if(s===1&&r.data.type==="noise"){let o=e.color(r.data.colorA).a,a=e.color(r.data.colorB).a,l=e.color(r.data.colorC).a,u=e.color(r.data.colorD).a,d=Math.min(o,Math.min(a,Math.min(l,u)));d<1&&(s=d)}n+=(1-n)*s}}return n<1}var uu=class extends Gs{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},$fe=class extends uu{constructor(t,e,n,i){super(),this.flatShading=t,this.side=e,this.wireframe=n,this.root=i}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(t,e,n){return this.root.getFlavor(t,e,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,n){this.root.updateByOp(t,e,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},b6=class extends uu{constructor(t,e,n=!0){super(),this.data=t,this.allowVariableSaves=n,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,n){let i=n?6:(t?3:0)+e;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let r=this.flavors[i];return r===void 0&&(r=new $fe(t,e,n,this),this.flavors[i]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var t;return((t=this.lightLayer.getNode("occlusion"))==null?void 0:t.value)??!1}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let n=t.layers??as.defaultTwoLayerData("phong").layers;try{this.layers=n.map(i=>vc.create(this.layerIdGen++,i.id,i.data,e.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(e.shared),this.transparent=ry(t,e.shared),this.saveVariableLocations(e)}onVariableUpdate(t,e,n){if(t[0]==="alphaOverride")this.transparent=ry(this.data,n.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(e)/100,1)));else if(t[0]==="layer"){let i=t[1],r=t[2];if(i&&r){let s=this.layers.find(o=>o.uuid===i);s!=null&&s.hasValue(r)&&(r==="alpha"?(this.transparent=ry(this.data,n.shared),s.setValue(r,Math.max(0,Math.min(Number(e)/100,1)))):s.setValue(r,e))}}}saveVariableLocations(t){if(!this.allowVariableSaves)return;let e=this.data.layers.find(n=>n.data.type==="light");e&&t.shared.getVariable(e.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(n=>{"alpha"in n.data&&typeof n.data.alpha=="string"&&t.shared.getVariable(n.data.alpha,["material",this.uuid,"layer",n.id,"alpha"])})}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(t){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof Ta),this.lightLayer===void 0&&(this.lightLayer=new Ta(0,"",{...Os.defaultData("light","phong"),visible:!1},new g6,{},t)),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let t=this.layers.find(r=>r instanceof Ta);if(!t)return;let e=t.data,n=e.bumpMap,i=e.roughnessMap;t.node.bumpMap=void 0,t.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let s=this.layers[r];s instanceof jn&&s.color instanceof CC&&(s.uuid===n&&(t.node.bumpMap=s.color),s.uuid===i&&(t.node.roughnessMap=s.color))}}updateByOp(t,e,n){if(e!==void 0?this.data=e:e=this.data,this.transparent=ry(e,n.shared),t.path[0]==="layers"){this.data=e;let i=n.shared,r=t.path[1];if(r===void 0){if(this.layers.reverse(),t.type===4){let s=vc.create(this.layerIdGen++,t.id,t.data,n.shared);this.layers.splice(t.localIndex,0,s),n.scene.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),n.scene.markNeedsUpdateRendererDirty();else if(t.type===6){let s=this.layers.findIndex(a=>a.uuid===t.id),o=this.layers[s];this.layers.splice(s,1),this.layers.splice(t.localIndex,0,o),n.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate(n.shared)}else{t.type===0&&t.props.occlusion!==void 0&&n.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(o=>o.uuid===r);if(s){let o=e.layers.data(r),a;if(t.type===0&&("alpha"in t.props||"alphaOverride"in t.props)&&("alpha"in t.props?a={...t.props,alpha:Lc(t.props.alpha,i,["material",this.uuid,"layer",r,"alpha"])}:a={...t.props,alphaOverride:Lc(t.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...t,...a?{props:a}:{},path:t.path.slice(2)},o,n)){let l=vc.create(this.layerIdGen++,r,o,i);this.layers.splice(this.layers.findIndex(u=>u.uuid===r),1,l),this.onUpdate(n.shared)}}}}else this.reset(e,n)}applyMasks(){for(let t=0;t<this.layers.length;++t){let e=this.layers[t];e instanceof jn?e.color.mask=void 0:e instanceof Ta&&(e.node.mask=void 0)}for(let t=0;t<this.layers.length;++t){let e=this.layers[t];if(e instanceof jn&&e.isMask.value&&e.data.visible&&t>0){let n=t-1,i=this.layers[n];i instanceof Ta?i.node.mask=new Dr(e.color,e.alpha,Dr.MUL):i instanceof jn&&(i.isMask.value||(i.color.mask=new Dr(e.color,e.alpha,Dr.MUL)))}}}blendColors(){let t=this.layers.findIndex(n=>n instanceof jn),e=this.layers.findIndex(n=>n instanceof Ta);if(t!==-1&&t<e){let n=this.layers[t].color;for(let i=t+1;i<e;++i){let r=this.layers[i];if(r instanceof jn){if(r.isMask.value)continue;n=new cN(n,r.color,r.alpha,r.mode)}}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let t=new vn("outgoingLight","f"),e=this.layers.findIndex(n=>n instanceof Ta);if(this.layers.length>e+1){for(let n=e+1;n<this.layers.length;++n){let i=this.layers[n];if(i instanceof jn){if(i.isMask.value)continue;t=new cN(t,i.color,i.alpha,i.mode)}}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof w6);if(t.length>0){let e=t[0].position;for(let n=1;n<t.length;++n)t[n]&&(e=new Dr(e,t[n].position,Dr.ADD),e=new Dr(e,new Je(.5).setReadonly(!0),Dr.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let n=(i,r,s)=>Math.min(Math.max(i,r),s);for(let i of this.layers)if(i.type==="displace"){let r=n(i.uniforms[`f${i.id}_intensity`].value,t,e);i.uniforms[`f${i.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let n=(y6[e.type]??[]).map(a=>e[a]),i=(x6[e.type]??[]).map(a=>{var l;return((l=e[a])==null?void 0:l.length)??0}),r=[...n,...i],s="isMask"in e&&e.isMask,o=`"${e.type}-${e.visible}-${s}"`;r.length?t+=`[${o}, "${r.join('","')}"],`:t+=o}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new ffe;t.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof jn){let e=t.params.texture;if(e instanceof EA&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(uu.prototype,{properties:{get:function(){return this.fragment.properties}}});var PA=class extends b6{constructor(t,e,n){super(t,e,!1),this.uuid=n,this.allowVariableSaves=!0,this.saveVariableLocations(e)}},qfe=Tr(Zte()),hN=new Map;function Xfe(t){if(typeof t=="string")return t;let e=hN.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},hN.set(t,e)),e.url}var sy=class{constructor({src:t,volume:e,delay:n,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:Xfe(t),format:"wav"},this.sound=new qfe.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),n!==void 0&&(this.delay=n),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,n){this.sound.on(t,e,n)}off(t,e,n){this.sound.off(t,e,n)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},Yfe=class{constructor(){this.type="ShapePath",this.color=new We,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Ec,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var n;return(n=this.currentPath)==null||n.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function n(f,m,x,y){let v=f.x,_=m.x,w=x.x,b=y.x,E=f.y,A=m.y,T=x.y,L=y.y,P=(b-w)*(E-T)-(L-T)*(v-w),C=(_-v)*(E-T)-(A-E)*(v-w),D=(L-T)*(_-v)-(b-w)*(A-E),U=P/D,G=C/D;if(D===0&&P!==0||U<=0||U>=1||G<0||G>1)return null;if(P===0&&D===0){for(let k=0;k<2;k++)if(i(k===0?x:y,f,m),e.loc===t.ORIGIN){let H=k===0?x:y;return{x:H.x,y:H.y,t:e.t}}else if(e.loc===t.BETWEEN){let H=+(v+e.t*(_-v)).toPrecision(10),K=+(E+e.t*(A-E)).toPrecision(10);return{x:H,y:K,t:e.t}}return null}else{for(let K=0;K<2;K++)if(i(K===0?x:y,f,m),e.loc===t.ORIGIN){let q=K===0?x:y;return{x:q.x,y:q.y,t:e.t}}let k=+(v+U*(_-v)).toPrecision(10),H=+(E+U*(A-E)).toPrecision(10);return{x:k,y:H,t:U}}}function i(f,m,x){let y=x.x-m.x,v=x.y-m.y,_=f.x-m.x,w=f.y-m.y,b=y*w-_*v;if(f.x===m.x&&f.y===m.y){e.loc=t.ORIGIN,e.t=0;return}if(f.x===x.x&&f.y===x.y){e.loc=t.DESTINATION,e.t=1;return}if(b<-Number.EPSILON){e.loc=t.LEFT;return}if(b>Number.EPSILON){e.loc=t.RIGHT;return}if(y*_<0||v*w<0){e.loc=t.BEHIND;return}if(Math.sqrt(y*y+v*v)<Math.sqrt(_*_+w*w)){e.loc=t.BEYOND;return}let E;y!==0?E=_/y:E=w/v,e.loc=t.BETWEEN,e.t=E}function r(f,m){let x=[],y=[];for(let v=1;v<f.length;v++){let _=f[v-1],w=f[v];for(let b=1;b<m.length;b++){let E=m[b-1],A=m[b],T=n(_,w,E,A);T!==null&&x.find(L=>L.t<=T.t+Number.EPSILON&&L.t>=T.t-Number.EPSILON)===void 0&&(x.push(T),y.push(new ee(T.x,T.y)))}}return y}function s(f,m,x){let y=new ee;m.getCenter(y);let v=[];return x.forEach(_=>{_.boundingBox.containsPoint(y)&&r(f,_.points).forEach(w=>{v.push({identifier:_.identifier,isCW:_.isCW,point:w})})}),v.sort((_,w)=>_.point.x-w.point.x),v}function o(f,m,x,y,v){(v==null||v==="")&&(v="nonzero");let _=new ee;f.boundingBox.getCenter(_);let w=[new ee(x,_.y),new ee(y,_.y)],b=s(w,f.boundingBox,m);b.sort((C,D)=>C.point.x-D.point.x);let E=[],A=[];b.forEach(C=>{C.identifier===f.identifier?E.push(C):A.push(C)});let T=E[0].point.x,L=[],P=0;for(;P<A.length&&A[P].point.x<T;)L.length>0&&L[L.length-1]===A[P].identifier?L.pop():L.push(A[P].identifier),P++;if(L.push(f.identifier),v==="evenodd"){let C=L.length%2===0,D=L[L.length-2];return{identifier:f.identifier,isHole:C,for:D}}else if(v==="nonzero"){let C=!0,D=null,U=null;for(let G=0;G<L.length;G++){let k=L[G];m[k]&&(C?(U=m[k].isCW,C=!1,D=k):U!==m[k].isCW&&(U=m[k].isCW,C=!0))}return{identifier:f.identifier,isHole:C,for:D}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let a=0,l=999999999,u=-999999999,d=[];this.subPaths.forEach(f=>{let m=f.getPoints(),x=-999999999,y=999999999,v=-999999999,_=999999999;for(let w=0;w<m.length;w++){let b=m[w];b.y>x&&(x=b.y),b.y<y&&(y=b.y),b.x>v&&(v=b.x),b.x<_&&(_=b.x)}u<=v&&(u=v+1),l>=_&&(l=_-1),m.length&&d.push({curves:f.curves,points:m,isCW:po.isClockWise(m),identifier:a++,boundingBox:new yT(new ee(_,y),new ee(v,x))})});let c=d.map(f=>{var m;return o(f,d,l,u,(m=this.userData)==null?void 0:m.style.fillRule)}),h=[];return d.forEach(f=>{let m=c[f.identifier];if(m&&!m.isHole){let x=new fo;x.curves=f.curves,c.filter(y=>(y==null?void 0:y.isHole)&&y.for===f.identifier).forEach(y=>{if(y){let v=d[y.identifier],_=new Ec;_.curves=v.curves,x.holes.push(_)}}),h.push(x)}}),h}},M6,dN=new Promise(t=>{M6=t}),fN=!1,oy;function Zfe(){if(fN)return;if(oy)return oy;async function t(){let e=await d5(()=>import("./opentype-fc28cde9.js"),[],import.meta.url);M6(e),fN=!0}return oy=t(),oy}var Kfe=class{async load(t,e,n=()=>{}){let{load:i}=await dN;i(t,(r,s)=>{r||!s?n(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:n}=await dN;try{let i=e(t),r=new n,s=o=>i.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(i){console.error(i)}}};async function Qfe(t){return await(await fetch(t)).arrayBuffer()}var Jfe=new Kfe;async function pN(t){let e,n,i=!1;if(t.url?(e=await Qfe(t.url),n=t.url,i=t.url.startsWith("/")):t.data&&(e=t.data.buffer.slice(t.data.byteOffset,t.data.byteOffset+t.data.byteLength)),e){let r=await Jfe.parse(e);if(r)return{font:r.font,url:n,intercepted:i,arr:e,bidi:r.bidi}}}function epe(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var tpe=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=pN(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=pN(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(e);let r=i.tokenizer.tokens,s=[],o=0,a=n.length===r.length;for(let l=0;l<n.length;l++){let u=n[l].index,d=String.fromCharCode(n[l].unicode),c=r[o];if(epe(u,c)||a)s.push({char:d,index:u,replacements:[c.state.glyphIndex],replacementChars:[c.char]}),o++;else{let h=c.char,f="",m=[c.state.glyphIndex],x=[],y=!1;for(;!y;)o++,f=e.charAt(o),h+=f,m.push(t.charToGlyphIndex(f)),x=t.stringToGlyphs(h),x.length===1&&x[0].index===u&&(y=!0),o>e.length&&(y=!0);s.push({char:d,index:u,replacements:m,replacementChars:Array.from(h)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let n=this.font,i=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(v=>this.getTextWidth(v,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,u=this.computeSpaceWidthForLine(t,0,e),d=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),c=this.getLineInitialOffsetY(r,t.length,e.height,i,e.verticalAlign),h=[],f=t.map(v=>[]),m=t.map(v=>[]),x;for(let v=0;v<t.length;v++){let _=t[v],w={features:{liga:!0}},b=[];try{b=n.stringToGlyphs(_,w)}catch(A){console.warn(A)}d=this.getLineInitialOffsetX(s[v],o,e.horizontalAlign,_,a);let E=[];try{E=this.reverseLigaturesTable(n,_,b)}catch(A){console.warn(A)}u=this.computeSpaceWidthForLine(t,v,e);for(let A=0;A<b.length;A++){let T=b[A],L=T.index===0?`
`:T.unicode?String.fromCharCode(T.unicode):void 0,P=E[A],C=0,D=0;A===0&&e.horizontalAlign===2&&T.leftSideBearing!==void 0&&(D=-T.leftSideBearing*i),x&&(C=n.getKerningValue(T,x)*i),d+=D+C;let U=0;if(L===`
`)U=l;else if(L===" ")U=u;else{let G=this.createPath(T,i,d,c,e);G&&(U=G.offsetX-(C+D),h.push(G.path))}if(P.replacements.length===1)m[v].push([d,c]),f[v].push(U);else{let G=P.replacements.map(q=>(n.glyphs.get(q).advanceWidth??0)*i),k=G.reduce((q,N)=>q+=N,0),H=G.map(q=>q/k),K=d;for(let q=0;q<H.length;q++){let N=U*H[q];m[v].push([K,c]),f[v].push(N),K+=N}}d+=U,x=T}c-=r}let y=[];for(let v=0,_=h.length;v<_;v++)y.push(...h[v].toShapes());return{shapes:y,charWidths:f,lineWidths:s,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,n,i,r){return(n===3||n===2)&&i.indexOf(`
`)>=0&&(t-=r),n===3?e*.5-t*.5:n===2?e-t:0}getLineInitialOffsetY(t,e,n,i,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*i,a=t-o,l=-this.ascender*i-a/2;return r===3?-(n-s-l):r===2?-(n*.5-s*.5-l):l}createPath(t,e,n,i,r){var l;let s=t.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new Yfe,a=(t.advanceWidth??1)*e;if(t)for(let u of s.commands){let d=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(d&&u.type!=="Z"&&d.x===u.x&&-d.y===u.y))switch(u.type){case"M":o.moveTo(u.x,-u.y);break;case"L":o.lineTo(u.x,-u.y);break;case"Q":o.quadraticCurveTo(u.x1,-u.y1,u.x,-u.y);break;case"C":o.bezierCurveTo(u.x1,-u.y1,u.x2,-u.y2,u.x,-u.y);break}}return o.subPaths.forEach(u=>{let d=npe(u.curves);d!==void 0&&u.currentPoint.distanceTo(d)>0&&u.lineTo(d.x,d.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,n){let i=this.getCharWidth(" ",n),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(n.horizontalAlign===4&&e<t.length-1&&s){let o=n.width,a=this.getTextWidth(r,n);return(o-(a-s*i))/s}}return i}countSpaces(t){return(t.match(/ /g)||[]).length}};function npe(t){if(t.length){let e=t[0];if(e instanceof ho)return e.v1;if(e instanceof zs||e instanceof qa)return e.v0}}var ipe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e,n){let i=this.objects.get(t);return i===void 0?(i=this.createObject(t,e,n),this.objects.set(t,i)):i.isShared=!0,i}forceDelete(t){let e=this.objects.get(t);e&&(this.disposeObject(e),this.objects.delete(t))}mutateIfUnique(t,e){let n=this.objects.get(t);if(n&&n.isShared!==!0)return this.objects.delete(t),this.objects.set(e,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let n=this.objects.get(t);e===n&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},mN=class extends ipe{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e,n){let i=X1(t,e,this.flatShading,n);return i.computeBoundingSphere(),i}},rpe={markNeedsUpdateRendererDirty:()=>{}},spe=class extends Tfe{constructor(t){super(),this.shared=t}create(t){return new v6(t,this.shared)}},RC=class{constructor(t,e={}){if(this.data=t,this.geometryCache=new mN(!0),this.geometryCache2=new mN(!1),this.imageHolderCache=new spe(this),this.thisContext={scene:rpe,shared:this},this.deletedMaterial=new PA(as.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new uc(W1.emptyImage,this),this.deletedVideo=new uc(z1.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[n,i]of Object.entries(e.images))this.addImage(n,i);if(e.videos)for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);if(e.audios)for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i);this.reset(t)}setRequestRender(t){this._requestRender=t}setEntityOpContext(t){this.entityOpContext=t}reset(t,e=!1){this.resetLib(t.lib);for(let{id:n,data:i}of t.variables)this.addVariableHolder(n,i),e&&this.updateVariableHolder(n,i);for(let[n,i]of Object.entries(t.images))this.addImage(n,i);for(let[n,i]of Object.entries(t.videos))this.addVideo(n,i);for(let[n,i]of Object.entries(t.colors))this.addColor(n,i);for(let[n,i]of Object.entries(t.materials))this.addMaterial(n,i);for(let[n,i]of Object.entries(t.audios))this.addAudio(n,i);for(let[n,i]of Object.entries(t.fonts))this.addFont(n,i)}addMaterial(t,e){if(this.materials[t]){let n=this.materials[t];n.reset(e,this.thisContext),n.dispose()}else{let n=new PA(e,this.thisContext,t);this.materials[t]=n}}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):t==null?(console.error("material is undefined or null"),this.deletedMaterial):new b6(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new uc(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new uc(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new Y1(e.r,e.g,e.b,e.a):this.colors[t]=new Y1(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[t];return this.colors[t].r=e.r??n.r,this.colors[t].g=e.g??n.g,this.colors[t].b=e.b??n.b,this.colors[t].a=e.a??n.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let n=this.getColor(t);n?e=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new go(0,0,0,0))}else return"a"in t?new go(t.r,t.g,t.b,t.a):new go(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof sy)return e;{let n=new sy({src:e.data});return this.audios[t]=n,n}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof sy&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new tpe(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof sy&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(t,e){return this.variables[t]===void 0?(this.variables[t]={value:e.value,locations:[]},"dynamicVariableType"in e&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0),!0):(this.variables[t].value=e.value,!1)}resetDynamicVariablePlayState(){for(let t in this.variables)this.variables[t].dynamicVariablePlayState!==void 0&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(t,e){this.updateVariable(t,e.value)}updateVariable(t,e){if(this.variables[t]===void 0)return!1;this.variables[t].value=e;let n=e;for(;typeof n=="string";)n=this.variables[n].value;let i=this.entityOpContext.scene;for(let r=this.variables[t].locations.length-1;r>=0;r--){let s=this.variables[t].locations[r];if(s[0]==="material"){let o=s[1],a=n,l={scene:i,shared:this},u=s.slice(2);i.traverseMaterial(c=>{let h=c.root??c;h.uuid===o&&h.onVariableUpdate(u,a,l)});let d=this.materials[o];d&&d.onVariableUpdate(u,a,l)}else{let o=i.find(s[0]);if(o===void 0){this.variables[t].locations.splice(r,1);continue}if(s[1]!=="geometry"){for(let a=1;a<s.length-1;a++)o=o[s[a]];s[1]==="rotation"?o[s[s.length-1]]=n*Ut.DEG2RAD:o[s[s.length-1]]=n}if(o=i.find(s[0]),rn.is(o)){if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")o.onVariableUpdate();else if(s[1]==="geometry"){let a=o;o.component&&(a=o.component);let l=a.dataPatched;a.chooseGeoemtryCache(this).forceDelete(l.geometry),a.createGeometryDelayed(this.entityOpContext),a.onVariableUpdate(!0),a.instances.forEach(u=>{let d=u.dataPatched;u.chooseGeoemtryCache(this).forceDelete(d.geometry),u.createGeometryDelayed(this.entityOpContext),u.onVariableUpdate(!0)})}}}}return!0}deleteVariable(t){this.variables[t]&&delete this.variables[t]}getVariable(t,e){var n,i,r;if(Array.isArray(t)){if(t[0]==="mouse")return((n=this.mouseProperty)==null?void 0:n[t[1]])??0;if(t[0]==="raycast")return((i=this.raycastProperty)==null?void 0:i[t[1]])??0;let s=this.entityOpContext.scene.find(t[0]);if(t[1]==="width"||t[1]==="height"||t[1]==="depth")return s.geometry.userData.parameters[t[1]];for(let o=1;o<t.length;o++)s=s[t[o]];return t[1]==="rotation"&&(s*=Ut.RAD2DEG),s}for(let s in this.variables){if(e===void 0)break;let o=this.variables[s],a=(r=o.locations)==null?void 0:r.findIndex(l=>yr.equal(l,e));a!==void 0&&a!==-1&&o.locations.splice(a,1)}if(typeof t=="string"){let s=t,o=t;do{if(o=s,this.variables[s]===void 0)break;s=this.variables[s].value}while(typeof s=="string");return e&&this.variables[o]!==void 0&&this.variables[o].locations.push(e),s}else return t}getVariables(){return this.variables}getDynamicVariablePlayState(t){var e;return(e=this.variables[t])==null?void 0:e.dynamicVariablePlayState}setDynamicVariablePlayState(t,e){this.variables[t]!==void 0&&(this.variables[t].dynamicVariablePlayState=e)}getDynamicVariableToggleIsForward(t){var e;return(e=this.variables[t])==null?void 0:e.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(t,e){this.variables[t]!==void 0&&(this.variables[t].dynamicVariableToggleIsForward=e)}resetLib(t){for(let[e,n]of Object.entries(t.images))this.addImage(e,n.asset);for(let[e,n]of Object.entries(t.audios))this.addAudio(e,n.asset);for(let[e,n]of Object.entries(t.colors))this.addColor(e,n.asset);for(let[e,n]of Object.entries(t.fonts))this.addFont(e,n.asset);for(let[e,n]of Object.entries(t.materials))this.addMaterial(e,n.asset);for(let[e,n]of Object.entries(t.videos))this.addVideo(e,n.asset);for(let[e,n]of Object.entries(t.variables))this.addVariableHolder(e,n.asset)}updateLibByOp(t,e){t.path[0]==="images"?t.path.length===1&&t.type===1?this.addImage(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteImage(t.id):t.path[0]==="videos"?t.path.length===1&&t.type===1?this.addVideo(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteVideo(t.id):t.path[0]==="audios"?t.path.length===1&&t.type===1?this.addAudio(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteAudio(t.id):t.path[0]==="colors"?t.path.length===1&&t.type===1?this.addColor(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteColor(t.id):t.path[0]==="materials"?t.path.length===1&&t.type===1?this.addMaterial(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteMaterial(t.id):t.path[0]==="fonts"?t.path.length===1&&t.type===1?this.addFont(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteFont(t.id):t.path[0]==="variables"?t.path.length===1&&t.type===1?this.addVariableHolder(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteVariable(t.id):t.path[0]==="components"&&e.updateByLibOp(t,this)}updateByOp(t,e,n){this.data=e,t.path[0]==="images"?t.path.length===2&&t.type===0?t.props.data&&this.getImage(t.path[1]).updateSrc(t.props.data):t.path.length===1&&t.type===1?this.addImage(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteImage(t.id):t.path[0]==="videos"?t.path.length===2&&t.type===0?t.props.data&&this.getVideo(t.path[1]).updateSrc(t.props.data):t.path.length===1&&t.type===1?this.addVideo(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteVideo(t.id):t.path[0]==="audios"?t.path.length===2&&t.type===0?t.props.data&&this.addAudio(t.path[1],e.audios[t.path[1]]):t.path.length===1&&t.type===1?this.addAudio(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteAudio(t.id):t.path[0]==="colors"?t.path.length===2&&t.type===0?this.updateColor(t.path[1],t.props):t.path.length===1&&t.type===1?this.addColor(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteColor(t.id):t.path[0]==="materials"?t.path.length===1&&t.type===1?this.addMaterial(t.id,t.data):t.path.length===1&&t.type===2?this.deleteMaterial(t.id):t.path.length>1&&this.getMaterial(t.path[1]).updateByOp(nr.drop(t,2),e.materials[t.path[1]],{shared:this,scene:n}):t.path[0]==="fonts"?t.path.length===2&&t.type===0?this.updateFont(t.path[1],t,n):t.path.length===1&&t.type===1?this.addFont(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteFont(t.id):t.path[0]==="variables"?t.path.length===2&&t.type===0&&"value"in t.props?this.updateVariable(t.path[1],t.props.value):t.path.length===1&&t.type===4?this.addVariableHolder(t.id,t.data):t.path.length===1&&t.type===5&&this.deleteVariable(t.id):t.path[0]==="lib"&&this.updateLibByOp(nr.drop(t,1),n)}updateFont(t,e,n){if(e.props.url){let i=this.getFont(t),r={...this.data.fonts[t],url:e.props.url};i.update(r),i.loadingPromise.then(()=>this.requestRender()),n.updateFont(t,this)}}},ope=new RC(Ra.emptyData()),Xc=class extends lu{updateByPatchedOp(t,e,n){if(super.updateByPatchedOp(t,e,n),Que(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[i,r]of Object.entries(t.props)){let s=n.shared.material(r);this.material[Number(i)]=s}else if(ks(t.path,["material"])&&this.material instanceof uu)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(nr.drop(t,1),e.material,n);else if(ks(t.path,["materials","*"])&&Array.isArray(this.material)){let i=t.path[1];if("materials"in e&&i<this.material.length){let r=e.materials[i];typeof r!="string"&&this.material[i].updateByOp(nr.drop(t,2),r,n)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(t,e){var i,r;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let n=this.dataPatched;if(((i=t.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe),e.scene.markNeedsUpdateRendererDirty()),((r=t.geometry)==null?void 0:r.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(s=>e.shared.material(s).getFlavor(n.flatShading,n.side,n.wireframe)),e.scene.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe)],e.scene.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(n.flatShading,n.side,n.wireframe);else this.material=this.material.getFlavor(n.flatShading,n.side,n.wireframe)}disposeMaterial(){this.material&&g5(this.material).forEach(t=>{t instanceof uu&&(t instanceof PA||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},gN=new O,vN=new Ct,yN=new Ct,ape=new O,xN=new Ue,lo=class extends Xc{constructor(t,e,n){super(t,e),this.data=e,this.localGeometry=void 0,e.bindMode&&e.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=e.bindMode,this.bindMatrix=new Ue().fromArray(e.bindMatrix),this.bindMatrixInverse=new Ue)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Ke&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof RC){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t,this)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return V1.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return V1.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),ks(t.path,["geometry"])&&this.updateByPatchedOpGeometry(nr.drop(t,1),e.geometry,n)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var i;this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if(n==="NonParametricGeometry"||n==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let u={...this.data.geometry,...r};this.localGeometry=X1(u,e,this.data.flatShading,this)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&MA(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=X1(r,e,this.data.flatShading,this)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,n){var r;let i=!1;t.type===0&&t.path.length===0&&Object.keys(t.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof gr&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),i||((r=n.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;this.is2DType?t.set(0,0,n.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let e=new Ct,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}boneTransform(t,e){let n=this.skeleton;if(n===void 0)return;let i=this.geometry;vN.fromBufferAttribute(i.attributes.skinIndex,t),yN.fromBufferAttribute(i.attributes.skinWeight,t),gN.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){let s=yN.getComponent(r);if(s!==0){let o=vN.getComponent(r);xN.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),e.addScaledVector(ape.copy(gN).applyMatrix4(xN),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};function lpe(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,n=t.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let u=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=new O(r[l],r[l+1],r[l+2]);e.has(u)?(o=e.get(u))==null||o.normals.push(d):e.set(u,{normals:[d],result:new O})}e.forEach((l,u)=>{for(let d of l.normals)l.result.add(d);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let u=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=(a=e.get(u))==null?void 0:a.result;d&&(s[l]=d.x,s[l+1]=d.y,s[l+2]=d.z)}t.geometry.setAttribute("extrudeNormal",new Ne(s,3))}function upe(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=new O;for(let r=0;r<e.length;r+=3)i.set(e[r],e[r+1],e[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;t.geometry.setAttribute("extrudeNormal",new Ne(n,3))}function LC(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof uu)||t.material.getLayersOfType("outline").length===0)return;t instanceof lo&&t.is2DAndNoDepth?upe(t):lpe(t)}function DC(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=parseInt(t.uuid.replace(/\D/g,"")),r=[Ut.seededRandom(i),Ut.seededRandom(i+1e4),Ut.seededRandom(i+2e4)];for(let s=0;s<e.length;s++)n[s]=r[s%3];t.geometry.setAttribute("randomColor",new ht(n,3))}MC.then(t=>{});var zo=new Hi,bp=new O;function cpe(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var RA=class extends lo{constructor(t,e,n){super(t,e,n),this.data=e,this.hiddenMatrixOld=new Ue,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:n,subdividedGeometry:i,subdivPointer:r}=gr.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,n!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=n),i!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,LC(this),DC(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let n=this.material;this.material=n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){gr.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&gr.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=gr.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=gr.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,lu.prototype.raycast.call(this,t,e),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new Gi,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;zo.setFromBufferAttribute(e),zo.getCenter(n),t.boundingSphere.radius=n.distanceTo(zo.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),zo.getSize(bp),this.hasNonUniformScale&&bp.divide(this.scale);let i={width:bp.x,height:bp.y,depth:bp.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(t){let e=this.originalGeometry;zo.min.set(t[0],t[2],t[4]),zo.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(zo.min.applyMatrix4(this.shearScaleInv),zo.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new Gi);let n=e.boundingSphere.center;zo.getCenter(n),e.boundingSphere.radius=n.distanceTo(zo.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(gr.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,n){super.updateByPatchedOpGeometry(t,e,n),this.localGeometry&&this.createGeometryByControls(e)}},_N=-1,hpe=1,dpe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},fpe={polygon_center:0,edge:1,vertex:2},ay=(t,e)=>(n,i)=>!e||n===0||t===0?0:t*i/100,Lt=(t,e)=>{let n=Math.abs(e),i=n*-1;return(t-_N)*(n-i)/(hpe-_N)+i};function ppe(t){let e=[],n={};for(var i=0,r=t.length;i<r;i++){var s=JSON.stringify(t[i].pos.map(o=>Math.round(o*1e4)/1e4));n[s]||(e.push(t[i]),n[s]=!0)}return e}var mpe=new O,ly=new O,gpe=new O,vpe=new O;function Od(t,e){let n=gpe.fromArray(t),i=vpe.fromArray(e);ly.copy(i).sub(n);let r=ly.length();return ly.normalize().multiplyScalar(r*.5),mpe.copy(n).add(ly).toArray()}var Ns=new Bi,uy=new O,Z1=new O,Ju=new O;function ype(t){let e=[];for(let n=0;n<=t.index.count;n++)if(uy.fromArray(t.index.array,n*3),Ns.setFromAttributeAndIndices(t.attributes.position,uy.x,uy.y,uy.z),Ns.getNormal(Z1),Ns.getMidpoint(Ju),!(isNaN(Ju.x)||isNaN(Ju.y)||isNaN(Ju.z))){let{a:i,b:r,c:s}=Ns,o=i.toArray(),a=r.toArray(),l=s.toArray(),u=i.distanceTo(r),d=r.distanceTo(s),c=s.distanceTo(i),h=Od(o,a),f=Od(a,l),m=Od(l,o),x=[u,d,c],y=Math.max(...x),v=x.filter(b=>Math.round(b)===Math.round(y)).length>1,_=[],w=Ns.getMidpoint(Ju).toArray();y===u&&!v&&(_=[f,m,m],w=h),y===d&&!v&&(_=[h,m,m],w=f),y===c&&!v&&(_=[h,f,f],w=m),v&&(_=[h,f,m]),e.push({vertices:[o,a,l],faceCenters:_,midpoint:w,norm:Ns.getNormal(Z1).toArray()})}return e}function xpe(t){let e=[],{position:n}=t.attributes;for(let i=0;i<n.count;i++){Ns.setFromAttributeAndIndices(n,i*3,i*3+1,i*3+2),Ns.getNormal(Z1),Ns.getMidpoint(Ju);let r=Ns.a.toArray(),s=Ns.b.toArray(),o=Ns.c.toArray();e.push({vertices:[r,s,o],faceCenters:[Od(r,s),Od(s,o),Od(o,r)],midpoint:Ju.toArray(),norm:Z1.toArray()})}return e}var _pe=4,wpe=.5,Mb=t=>.5*(1-Math.cos(t*Math.PI)),Spe=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,n=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let y=0;y<4095+1;y++)this.perlin[y]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),n<0&&(n=-n);let i=Math.floor(t),r=Math.floor(e),s=Math.floor(n),o=t-i,a=e-r,l=n-s,u,d,c=0,h=.5,f,m,x;for(let y=0;y<_pe;y++){let v=i+(r<<4)+(s<<8);u=Mb(o),d=Mb(a),f=this.perlin[v&4095],f+=u*(this.perlin[v+1&4095]-f),m=this.perlin[v+16&4095],m+=u*(this.perlin[v+16+1&4095]-m),f+=d*(m-f),v+=256,m=this.perlin[v&4095],m+=u*(this.perlin[v+1&4095]-m),x=this.perlin[v+16&4095],x+=u*(this.perlin[v+16+1&4095]-x),m+=d*(x-m),f+=Mb(l)*(m-f),c+=f*h,h*=wpe,i<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(i++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return c}noiseSeed(t){let e=(()=>{let n,i;return{setSeed(r){i=n=(r??Math.random()*4294967296)>>>0},getSeed(){return n},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let n=0;n<4095+1;n++)this.perlin[n]=e.rand()}},bpe=Spe,wN=new O,SN=new Ue,bN=new Qa;function Mpe(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(e=!0)}),e}var A6=class extends lo{constructor(t,e,n){super(t,e,n),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:n}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(SN.copy(n).invert(),bN.copy(t.ray).applyMatrix4(SN),bN.intersectBox(this.singleBBox,wN))){let i=wN.applyMatrix4(n),r=t.ray.origin.distanceTo(i);e.push({distance:r,point:i.clone(),object:this})}}},cr=1e-4,Fo,E6,T6,C6,MN=new O,AN=new O;MC.then(t=>{Fo=t,E6=[Fo.get_face_center,Fo.get_edge_midpoint,Fo.get_vertex_position],T6=[Fo.get_face_normal,Fo.get_edge_normal,Fo.get_vertex_normal],C6=[Fo.face_count,Fo.edge_count,Fo.vertex_count]});var Ape=new Ue,Epe=new Ue,vl=new O,zu=new O,Mp=new O,Ab=new O,Tpe=new O,Cpe=new O,_a=new bpe,P6=class extends gC(jt){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof Op&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof Op&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,r=this.children.length;i<r;++i)this.remove(this.children[0]);let n=this.children;if(n.length===e)return;if(n.length<e)for(let i=0,r=e-n.length;i<r;++i){let s=new Op(this.object);s.expand(),this.add(s)}else for(let i=0,r=n.length-e;i<r;++i)this.remove(n[i])}else{if(this.children.length===e)return;if(this.children.length<e)for(let n=0,i=e-this.children.length;n<i;++n){let r=new Op(this.object);r.expand(),this.add(r)}else for(let n=0,i=this.children.length-e;n<i;++n)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,n=e.start*Ut.DEG2RAD,i=e.end*Ut.DEG2RAD,r=n-i,s=new ta(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new O(0,0,1);break;case"y":o=new O(0,1,0);break;default:case"x":o=new O(1,0,0);break}let a=t.randomnessObject??Ol.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";_a.noiseSeed(a.seed);let u=ab((0,yp.default)(a.seed)),d=ay(a.strength,this.parameters.randomness);for(let[c,h]of this.children.entries()){let f=c*(a.freqScale/10)+a.movement,m=l?_a.noise(f):u(f,f),x=c+1;h.scale.x=e.scale[0]+d(x,Lt(m,a.scale[0]))||cr,h.scale.y=e.scale[1]+d(x,Lt(m,a.scale[1]))||cr,h.scale.z=e.scale[2]+d(x,Lt(m,a.scale[2]))||cr,h.position.setScalar(0);let y=r/t.count*c-n;switch(e.axis){case"x":h.rotation.set(0,y,0);break;case"y":h.rotation.set(0,0,y);break;case"z":h.rotation.set(y,0,0);break}h.translateOnAxis(o,e.radius),h.position.x+=e.position[0]+d(x,Lt(m,a.position[0])),h.position.y+=e.position[1]+d(x,Lt(m,a.position[1])),h.position.z+=e.position[2]+d(x,Lt(m,a.position[2]));let v=d(x,Lt(m,a.rotation[0])),_=d(x,Lt(m,a.rotation[1])),w=d(x,Lt(m,a.rotation[2]));e.alignment===!0?(h.rotation.x+=s.x+v,h.rotation.y+=s.y+_,h.rotation.z+=s.z+w):h.rotation.set(s.x+v,s.y+_,s.z+w)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,n=new ta(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??Ol.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";_a.noiseSeed(i.seed);let s=ab((0,yp.default)(i.seed)),o=ay(i.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let u=a*(i.freqScale/10)+i.movement,d=r?_a.noise(u):s(u,u),c=a+1,h=o(c,Lt(d,i.rotation[0])),f=o(c,Lt(d,i.rotation[1])),m=o(c,Lt(d,i.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(c,Lt(d,i.scale[0]))||cr,l.scale.y=1+(e.scale[1]-1)*a+o(c,Lt(d,i.scale[1]))||cr,l.scale.z=1+(e.scale[2]-1)*a+o(c,Lt(d,i.scale[2]))||cr,l.rotation.x=n.x*a+h,l.rotation.y=n.y*a+f,l.rotation.z=n.z*a+m,l.position.x=e.position[0]*a+o(c,Lt(d,i.position[0])),l.position.y=e.position[1]*a+o(c,Lt(d,i.position[1])),l.position.z=e.position[2]*a+o(c,Lt(d,i.position[2]))}}_updateGrid(t){let e=0,n=t.grid,i=t.randomnessObject??Ol.defaultData([1,1,1]).randomnessObject,r=ay(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";_a.noiseSeed(i.seed);let o=dhe((0,yp.default)(i.seed));if(n.useCenter===!0){let a={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},l=new O(n.size[0]*(n.count[0]-a.x)*.5,n.size[1]*(n.count[1]-a.y)*.5,n.size[2]*(n.count[2]-a.z)*.5);for(let u=0;u<n.count[0];u++)for(let d=0;d<n.count[1];d++)for(let c=0;c<n.count[2];c++){let h=[(u+1)*(i.freqScale/10)+i.movement,(d+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],f=s?_a.noise(...h):o(...h),m=this.children[e++];m.scale.x=1+r(e,Lt(f,i.scale[0]))||cr,m.scale.y=1+r(e,Lt(f,i.scale[1]))||cr,m.scale.z=1+r(e,Lt(f,i.scale[2]))||cr;let x=r(e,Lt(f,i.rotation[0])),y=r(e,Lt(f,i.rotation[1])),v=r(e,Lt(f,i.rotation[2]));m.rotation.set(x,y,v),m.position.x=n.size[0]*u-l.x+r(e,Lt(f,i.position[0])),m.position.y=n.size[1]*d-l.y+r(e,Lt(f,i.position[1])),m.position.z=n.size[2]*c-l.z+r(e,Lt(f,i.position[2]))}}else for(let a=0;a<n.count[0];a++)for(let l=0;l<n.count[1];l++)for(let u=0;u<n.count[2];u++){let d=[(a+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],c=s?_a.noise(...d):o(...d),h=this.children[e++];h.scale.x=1+r(e,Lt(c,i.scale[0]))||cr,h.scale.y=1+r(e,Lt(c,i.scale[1]))||cr,h.scale.z=1+r(e,Lt(c,i.scale[2]))||cr;let f=r(e,Lt(c,i.rotation[0])),m=r(e,Lt(c,i.rotation[1])),x=r(e,Lt(c,i.rotation[2]));h.rotation.set(f,m,x),h.position.x=n.size[0]*a+r(e,Lt(c,i.position[0])),h.position.y=-n.size[1]*l+r(e,Lt(c,i.position[1])),h.position.z=-n.size[2]*u+r(e,Lt(c,i.position[2]))}}_updateToObject(t){var x;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,n=new ta(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??Ol.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";_a.noiseSeed(i.seed);let s=ab((0,yp.default)(i.seed)),o=ay(i.strength,this.parameters.randomness);if(!e.object){for(let[,y]of this.children.entries())y.position.set(0,0,0),y.scale.setScalar(1),y.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof A6)if(!((x=this.objectForSample.font)!=null&&x.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],u=y=>{let v=y.length,_=y.map(E=>E[0]).reduce((E,A)=>E+A,0),w=y.map(E=>E[1]).reduce((E,A)=>E+A,0),b=y.map(E=>E[2]).reduce((E,A)=>E+A,0);return[_/v,w/v,b/v]},d=y=>Math.round(y*1e6)/1e6;a.forEach(y=>{let v=a.filter(_=>d(y.pos[0])===d(_.pos[0])&&d(y.pos[1])===d(_.pos[1])&&d(y.pos[2])===d(_.pos[2]));v.length>1?l.push({pos:y.pos,norm:u(v.map(_=>_.norm))}):l.push(y)});let c=ppe(l);if(c.length>0){let y=Math.round(c.length*e.count/100);this._updateCount(y)}else{let y=this.objectForSample.geometry.getAttribute("position");if(!y||isNaN(y.count)||y.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let h=new fhe(this.objectForSample).build(),f=dpe[e.axis],m=this.children;h.setRandomGenerator((0,yp.default)(this.object.uuid+e.seed));for(let[y,v]of m.entries()){let _=y*(i.freqScale/10)+i.movement,w=r?_a.noise(_):s(_,_),b=y+1,E=o(b,Lt(w,i.rotation[0])),A=o(b,Lt(w,i.rotation[1])),T=o(b,Lt(w,i.rotation[2]));e.spreadType==="random"?h.sample(Mp,Ab):(c.length&&(Mp.fromArray(c[y].pos),Ab.fromArray(c[y].norm)),this.objectForSample instanceof RA&&Mp.applyMatrix4(Ape.copy(this.objectForSample.matrixWorld).invert())),Mp.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(Mp),vl.fromArray(f);let L=e.align==="normal"?Ab:this.object.getWorldDirection(Cpe),P=zu.fromArray(e.position);zu.x+=zu.x+o(b,Lt(w,i.position[0])),zu.y+=zu.y+o(b,Lt(w,i.position[1])),zu.z+=zu.z+o(b,Lt(w,i.position[2]));let C=Math.acos(L.dot(vl)),D=Tpe.crossVectors(vl,L).normalize(),U=Epe.makeRotationAxis(D,C),G=L.clone().cross(this.object.up).normalize(),k=G.clone().cross(L).normalize(),H=new Ue().makeBasis(G,L,k),K=new O(vl.y,vl.z,vl.x).normalize(),q=K.clone().cross(vl).normalize(),N=new Ue().makeBasis(K,vl,q).invert(),V=new Ue().multiplyMatrices(H,N);v.rotation.setFromRotationMatrix(V),P.applyMatrix4(U),v.position.add(P),v.rotation.x=v.rotation.x+n.x+E,v.rotation.y=v.rotation.y+n.y+A,v.rotation.z=v.rotation.z+n.z+T,v.scale.setScalar(1),v.scale.x=v.scale.x+e.scale[0]+o(b,Lt(w,i.scale[0]))||cr,v.scale.y=v.scale.y+e.scale[1]+o(b,Lt(w,i.scale[1]))||cr,v.scale.z=v.scale.z+e.scale[2]+o(b,Lt(w,i.scale[2]))||cr,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof RA){let e=this.objectForSample,n=fpe[t],i=C6[n],r=E6[n],s=T6[n],o=[],a=i(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let u=r(e.subdivPointerNew,l),d=s(e.subdivPointerNew,l);MN.fromArray(u).applyMatrix4(e.matrixWorld),AN.fromArray(d),o.push({pos:MN.toArray(),norm:AN.toArray()})}return o}else return(this.objectForSample.geometry.index?ype(this.objectForSample.geometry):xpe(this.objectForSample.geometry)).map((e,n)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var n;if(this.parameters=e_(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=e.find(this.parameters.toObject.object);i instanceof lu?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new Ue,this.hiddenMatrix=new Ue,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Ig=t=>{var e;return e=class extends t{},e.geometryHelper=new us(30,30,30),e},cy=new Qa,Eb=new Gi,EN=new Ue,Og=(t,e,n,i,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),Eb.copy(s.boundingSphere),Eb.applyMatrix4(o),n.ray.intersectsSphere(Eb)===!1||(EN.copy(o).invert(),cy.copy(n.ray).applyMatrix4(EN),s.boundingBox!==null&&cy.intersectsBox(s.boundingBox)===!1))return;let a,l,u,d,c=s.index,h=s.attributes.position,f=s.drawRange,m,x;if(r===!1){let v=Math.max(0,f.start),_=Math.min(c.count,f.start+f.count);for(m=v,x=_;m<x;m+=3)if(l=c.getX(m),u=c.getX(m+1),d=c.getX(m+2),a=y(t,n,cy,h,l,u,d),a){a.faceIndex=Math.floor(m/3),i.push(a);return}}else{let v=s.attributes.position,_=new O,w=new O,b=new O,E=new O,A=2,T=1/((t.scale.x+t.scale.y+t.scale.z)/3),L=T*T,P=Math.max(0,f.start),C=Math.min(v.count,f.start+f.count);for(let D=P,U=C-1;D<U;D+=A){if(_.fromBufferAttribute(v,D),w.fromBufferAttribute(v,D+1),cy.distanceSqToSegment(_,w,E,b)>L)continue;E.applyMatrix4(t.matrixWorld);let G=n.ray.origin.distanceTo(E);G<n.near||G>n.far||i.push({distance:G,point:b.clone().applyMatrix4(t.matrixWorld),object:t})}}function y(v,_,w,b,E,A,T){let L=new O,P=new O,C=new O,D=new O,U=new O;if(L.fromBufferAttribute(b,E),P.fromBufferAttribute(b,A),C.fromBufferAttribute(b,T),w.intersectTriangle(L,P,C,!1,D)===null)return null;U.copy(D),U.applyMatrix4(v.matrixWorld);let G=_.ray.origin.distanceTo(U);return G<_.near||G>_.far?null:{faceIndex:1,distance:G,point:U.clone(),object:v}}},hy=new O,Ts=new kc,Ppe=class extends _o{constructor(t){let e=new Ke,n=new rr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},o=new We(15711266),a=new We(15711266),l=new We(2857471);u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",a),u("p","n2",a),u("p","n3",a),u("p","n4",a),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l);function u(c,h,f){d(c,f),d(h,f)}function d(c,h){i.push(0,0,0),r.push(h.r,h.g,h.b),s[c]===void 0&&(s[c]=[]),s[c].push(i.length/3-1)}e.setAttribute("position",new Ne(i,3)),e.setAttribute("color",new Ne(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;Ts.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=1,i=1,r=.8;eo("n1",e,t,Ts,-n,-i,r),eo("n2",e,t,Ts,n,-i,r),eo("n3",e,t,Ts,-n,i,r),eo("n4",e,t,Ts,n,i,r);let s=r;eo("f1",e,t,Ts,-n,-i,s),eo("f2",e,t,Ts,n,-i,s),eo("f3",e,t,Ts,-n,i,s),eo("f4",e,t,Ts,n,i,s);let o=s,a=.5;eo("u1",e,t,Ts,n*.7*a,i*1.1,o),eo("u2",e,t,Ts,-n*.7*a,i*1.1,o),eo("u3",e,t,Ts,0,i*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function eo(t,e,n,i,r,s,o){hy.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let u=0,d=a.length;u<d;u++)l.setXYZ(a[u],hy.x,hy.y,hy.z)}}var Rpe=class extends Ig(Ppe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){Og(this.object,this.geometry,t,e,!0)}},LA;(t=>t.is=e=>"objectHelper"in e)(LA||(LA={}));var Ng=(t,e)=>class extends vC(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(n,i){this.objectHelper.raycast(n,i)}showGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof Zm&&(i.visible=!0)}}updateEntityBoxSize(n,i){this.objectHelper.visible&&this.geometryHelper instanceof us?(n.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(n,i)}hideGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof Zm&&(i.visible=!1)}}},dy=790,zh=new O,Tb=new O,Cb=new xi,Pb=new O,Ap=new O,Rb=new O,K1=class extends Ng(kc,Rpe){constructor(t="",e={...ag.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=ef.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.previousProjectionMatrix=new Ue,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;this.orthoCamera=new df(n*-.5,n*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new gi(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,n){typeof t=="number"&&(t=new O(t,e,n)),super.lookAt(t),this.getWorldPosition(zh),this.targetOffset=zh.distanceTo(t)}getTarget(t=new O){return this.getWorldDirection(Tb),this.getWorldPosition(zh),Tb.multiplyScalar(this.targetOffset),t.copy(zh).add(Tb),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(zh),zh.distanceTo(t)}updateUp(){this.getWorldQuaternion(Cb),Pb.set(0,0,1).applyQuaternion(Cb),Ap.copy(jt.DEFAULT_UP),this.isUpVectorFlipped&&Ap.negate(),Ap.applyQuaternion(Cb),Rb.copy(jt.DEFAULT_UP).projectOnPlane(Pb),this.angleOffsetFromUp=Rb.angleTo(Ap),this.angleOffsetFromUp*=Rb.cross(Ap).dot(Pb)>=0?1:-1}updateTransformState(t,e){let n=super.updateTransformState(t,e);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),n}getViewFrontToObject(t){let e=t.getWorldPosition(new O),n=t.getWorldDirection(new O).multiplyScalar(this.targetOffset);return{position:e.clone().add(n),target:e}}getViewToTarget(t){let e=this.getWorldDirection(new O).multiplyScalar(this.targetOffset);return{position:t.clone().sub(e),target:t}}getViewToObject(t){let e=new O;return t.getWorldPosition(e),this.getViewToTarget(e)}setViewplaneSize(t,e,n=!1){if(this.aspect=t/e,n){let i=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-dy*.5*i,this.right=dy*.5*i,this.top=dy*.5*(1/r),this.bottom=-dy*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}copyViewPlaneSize(t){this.aspect=t.aspect,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,n,i,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,n,i,r,s):this.orthoCamera.setViewOffset(t,e,n,i,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return z2(e,t)}updateCameraSubtype(t,e){let n=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(n,e.zoom),e.near!==void 0&&this.setNear(n,e.near),e.fov!==void 0&&n==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},Fh=new Ue,Lpe=new Ue,fy=new Ue,TN=new O,CN=new O,af=class extends Xc{constructor(t,e,n){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ke,this.onAfterRender=(i,r,s,o,a,l)=>{super.onAfterRender(i,r,s,o,a,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var i;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof af&&s.dataPatched.visible===!0&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof lu&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(Fh.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Aa.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;Aa.transformMeshSet(s.booleanMeshSetAddress,Fh),s.booleanMatrixInvOld.copy(Fh).invert(),s.booleanWasTransformed=!1}else s instanceof af&&s.needsTransformForDownstream===!0?(Aa.transformMeshSet(s.booleanMeshSetAddress,Fh),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Aa.transformMeshSet(s.booleanMeshSetAddress,Lpe.multiplyMatrices(Fh,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(Fh).invert(),s.booleanWasTransformed=!1);Aa.hasOpenEdges(s.booleanMeshSetAddress)===!1||r===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Ne([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return Aa.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new Ke,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=Aa.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,LC(this),DC(this)}dispose(){super.dispose(),this.geometry.dispose()}get recursiveBBox(){var e;let t=super.recursiveBBox;return((e=this.geometry.boundingSphere)==null?void 0:e.radius)===-1&&(t.getCenter(this.geometry.boundingSphere.center),fy.copy(this.matrixWorld).invert(),this.geometry.boundingSphere.center.applyMatrix4(fy),TN.copy(t.max).applyMatrix4(fy),CN.copy(t.min).applyMatrix4(fy),this.geometry.boundingSphere.radius=TN.distanceTo(CN)/2),t}},PN;(t=>{function e(n){return rn.is(n)&&n instanceof Ja}t.is=e})(PN||(PN={}));var IC=(t,e)=>class extends Ng(t,e){updateState_Light(n,i){this.updateState_Entity(n,i),n.color!==void 0&&(this.color=i.shared.color(n.color)),n.intensity!==void 0&&(this.intensity=n.intensity),n.depth!==void 0&&(this.shadow.camera.far=n.depth,this.shadow.needsUpdate=!0),n.shadows!==void 0&&(this.castShadow=n.shadows)}},Xh=t=>t instanceof lu,Ep=t=>t!==null&&t instanceof af,DA=t=>LA.is(t),l_=class extends Ig(g4){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(t,e){Og(this.object,l_.geometryHelper,t,e)}update(){}},zy=class extends Ng(Ll,l_){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e),"buffer"in t&&Object.keys(t).length===1&&e.scene.reloadSplats()}},Dpe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,Ipe=Tt.lights_fragment_begin,Ope=Tt.shadowmask_pars_fragment,RN=null,Npe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},kpe=(t="medium")=>{if(RN===t)return!1;RN=t;let e=Npe(t);Tt.shadowmap_pars_fragment=Dpe(e);let n=Ipe.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Tt.lights_fragment_begin=n;let i=Ope.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Tt.shadowmask_pars_fragment=i,!0},R6=class extends Ig(m4){constructor(t,e=15,n=10066329){super(t,e,n),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){Og(this.object,R6.geometryHelper,t,e)}},L6=class extends Ig(p4){constructor(t,e=15,n=6710886){super(t,e,n),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){Og(this.object,L6.geometryHelper,t,e)}},IA=class extends Ig(d4){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){Og(this.object,IA.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=IA._vector,e=this.object.distance?this.object.distance:1e3,n=e*Math.tan(this.object.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},D6=IA;D6._vector=new O;function Upe(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var I6=class extends IC(cT,R6){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new Ym(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Ym&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let n=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&Upe(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),n&&this.update()}},LN=new O,DN=new O,IN=new xi,O6=class extends IC(lT,D6){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=Ut.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new Ym(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Ym&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),DN.setFromMatrixPosition(this.matrixWorld),IN.setFromRotationMatrix(this.matrixWorld),LN.copy(this.up).applyQuaternion(IN).negate().multiplyScalar(this.distance),this.target.position.copy(DN).add(LN),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Fy=class extends vC($d){constructor(t,e){super(),this.data=e,this.bgColor=new go(1,1,1,1),this.fog=null,this.backupFog=new gg(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new We,this.penumbraSizeArrayCache=null,this.super_Entity(t,e),this.personalCamera=new K1(o_,{...ag.defaultData,...e.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new oT(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=_r(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.enabled!==void 0&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(t=>{if(t instanceof Xc)if(Array.isArray(t.material))for(let e of t.material)e.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()})}updateShadow(t){t.softShadowQuality!==void 0&&this.isActive&&kpe(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,e){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let n=this.scene;n.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=_r(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,e){t.aoColor!==void 0&&(this.aoColor=_r(t.aoColor,e))}updateByOp(t,e,n,i){super.updateByOp(t,e,n,i);let r=e;ks(t.path,["fog"])?this.updateFog(r.fog,n.shared):ks(t.path,["ao"])?this.updateAo(r.ao,n.shared):ks(t.path,["ambient"])?this.updateAmbientLight(r.ambient,n.shared):ks(t.path,["shadow"])&&this.updateShadow(r.shadow)}updateState(t,e){this.updateState_Entity(t,e),t.backgroundColor!==void 0&&this.setBackgroundColor(_r(t.backgroundColor,e.shared)),t.fog!==void 0&&this.updateFog(t.fog,e.shared),t.ambient!==void 0&&this.updateAmbientLight(t.ambient,e.shared),t.ao!==void 0&&this.updateAo(t.ao,e.shared),t.shadow!==void 0&&this.updateShadow(t.shadow)}raycast(t,e){super.raycast(t,e)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){var t;return((t=this.scene)==null?void 0:t.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,e=0;this.traverseEntity(n=>{if(!n.visible)return!0;n instanceof I6&&n.visible&&t<3&&(this.penumbraSizeArrayCache[t]=n.data.penumbraSize,t+=1),n instanceof O6&&n.visible&&t<5-3&&(this.penumbraSizeArrayCache[3+e]=n.data.penumbraSize,e+=1)})}raycastWithClones(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;rn.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((Xh(r)||DA(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),OA(r,t,e,!0)),n(r))}};return n(this),e}},zpe=class extends IC(uT,L6){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new O(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new O(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new Hi(r,s),a=new Zm(o,new We(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof Zm){let n=this.shadow.camera,i=new O(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),r=new O(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);e.box.set(i,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Fpe=class extends lo{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?AC(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},N6=class extends lo{constructor(t,e,n){super(t,e,n),this._shapeId=null,this._context=n}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var i;let t={...this.data.geometry.extrusion.shape};for(let r in t)typeof t[r]=="string"&&(t[r]=this._context.shared.getVariable(t[r],[this.uuid,"geometry","extrusion","shape",r]));let e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(i=s.geometry.userData)==null?void 0:i.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=kV;break;case"Ellipse":r=bC;break;case"Polygon":r=NV;break;case"Star":r=UV;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t,e){return super.updateTransformState(t,e)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?AC(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},cm=class extends Ng(Ll,l_){constructor(t,e,n){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,n)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let n=$1.getComponentData({scene:e.scene.data,shared:e.shared.data},t.component);if(n){let i,r;for(let s of Nl.rootOverrideProps)t[s]===void 0?(i===void 0&&(i={...t}),i[s]=n.data[s]):(r===void 0&&(r={}),r[s]=t[s],i===void 0&&(i={...t}),i[s]=Jl.apply(n.data[s],t[s]));return this.overrideData=r,i}else return{...br.defaultData,...t,...Ql(br.defaultData,Nl.rootOverrideProps)}}updateByOp(t,e,n,i){let r;if(this.isInstanceRoot&&!i){if(e=this.transformAssignData(e,n),t.type===0&&t.path.length===0&&this.component)for(let s of Nl.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);else if(t.type===0&&t.path.length>0&&Nl.rootOverrideProps.includes(t.path[0])){let s=t.path[0];r===void 0&&(r={...t,path:[],props:{[s]:e[s]}})}}super.updateByOp(r??t,e,n,i)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){let n=t.scene.find(e.component)??null,i=!1;if(n!==this.oldComponent){if(this.oldComponent){let r=0;for(let s of this.children)if(rn.is(s))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),OC(s),r+=1;else break;this.children.splice(0,r)}i=!0}if(n){let r={};k6(t,[this.uuid],e.overrides,this,n,n,0,i,r);for(let s of this.children)if(rn.is(s)){let o=s.data;o.type==="Empty"&&o.animations&&s.traverseEntity(a=>{if(a instanceof lo&&a.isSkinnedMesh){let l=a.dataPatched;if(l.bones&&l.boneInverses){let u=l.bones.map(h=>t.scene.find(r[h])),d=l.boneInverses.map(h=>new Ue().fromArray(h)),c=new pf(u,d);a.bind(c,a.bindMatrix)}}else a.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function OC(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let n of t.children)rn.is(n)&&OC(n)}}function ON(t,e,n,i){return t.component===e&&Aue(t.identity,i)?t.overrideData===n?2:1:0}function k6(t,e,n,i,r,s,o,a,l){if(o>50)return!1;if(i.component!==r){if(i.component){let d=i.component.instances.indexOf(i);d>=0&&i.component.instances.splice(d,1)}r.instances.push(i),i.component=r}r instanceof cm&&r.isInstanceRoot&&r.expandInstanceChildren(t);let u=0;for(let d of r.children)if(rn.is(d)){let c=[...e,...typeof d.identity=="string"?[d.identity]:d.identity],h=G1.resolve(n,c,1);h!=null&&!(h instanceof _i)&&(Object.setPrototypeOf(h,_i.prototype),console.error("wrong prototype"));let f=null,m;if(!a){let x=i.children[u];if(f=rn.is(x)?x:null,f!==null){let y=ON(f,d,h,c);m=y>=1?f.stateSelection:void 0,y!==2&&(f=null)}if(f===null&&(f=t.scene.findInstance(c)??null,f!==null)){let y=ON(f,d,h,c);if(m=y>=1?f.stateSelection:void 0,y!==2)f=null;else{let v=f.parent.children.indexOf(f);f.parent.children.splice(v,1),i.children.splice(u,0,f),f.parent===i?v<=u&&console.error("not possible"):(f.parent=i,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),t.pendingDeletes.delete(f))}}}if(f===null){let x=h?Jl.apply(d.data,h):d.data;Rc.is(x.type)&&(x={...x,type:"Empty"}),f=kl.createEntity(c,x,t),f.overrideData=h,i.add(f),i.children.splice(i.children.length-1,1),i.children.splice(u,0,f),f.updateState(f.data,t),m&&f.changeSelectedState(m,t),t.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let x=f.identity[f.identity.length-1];l[x]=f.uuid}u+=1,k6(t,e,n,f,d,s,o+1,a,l)}if(!a){let d=u;for(;;){let c=i.children[u];if(rn.is(c))t.pendingDeletes.add(c);else break;u+=1}i.children.splice(d,u-d)}return!0}var Bpe=class extends Ng(Tx,l_){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(t,e){this.updateState_Entity(t,e)}};function Vpe(t,e,n){let i;return e.geometry.type==="TextGeometry"?new A6(t,e,n):(e.geometry.type==="SubdivGeometry"?i=new RA(t,e,n):e.geometry.type==="PathGeometry"?i=new N6(t,e,n):e.geometry.type==="VectorGeometry"?i=new Fpe(t,e,n):e.geometry.type==="BooleanGeometry"?i=new af(t,e,n):i=new lo(t,e,n),i)}function NC(t,e,n){return e.type==="Mesh"?Vpe(t,e,n):e.type==="Empty"?new zy(t,e):e.type==="Splat"?new zy(t,e):e.type==="Bone"?new Bpe(t,e):e.type==="Page"?new Fy(t,e):e.type==="PointLight"?new zpe(t,e,n):e.type==="SpotLight"?new O6(t,e,n):e.type==="DirectionalLight"?new I6(t,e,n):e.type==="Component"||e.type==="Instance"?new cm(t,e,n):Rc.is(e.type)?new K1(t,e):(console.error(e),new zy(t,e))}kl.createEntity=NC;function jpe(t,e,n){let i=NC(t.identity,e,n),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,u=t.overrideData,d=t.uuid,c=t.stateSelection;t.dispose();for(let h of Object.keys(t))delete t[h];Object.setPrototypeOf(t,Object.getPrototypeOf(i));for(let h of Object.keys(i))t[h]=i[h];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=d,t.overrideData=u,t.updateState(t.data,n),c&&t.changeSelectedState(c,n),t.resetBBoxNeedsUpdate()}kl.changeEntityProptotype=jpe;kl.Cloner=P6;function Gpe(t,e,n,i){t.updateByOp(e,n,i,!1)}function NN(t,e){let n=!1,i=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),i.length>0&&t.layers.enable(3),n=!0,DC(t),LC(t)),i.length===0&&r.length===0&&t.layers.set(0),t instanceof Xc&&t.needsAO&&t.layers.enable(5),n}function kN(t,e){if(!e.layers)return!1;let n=!1,i=e.getLayersOfType("transmission").filter(s=>s.data.visible),r=e.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),n=!0),i.length===0&&r.length===0&&t.layers.set(0),t.needsAO&&t.layers.enable(5),n}function Hpe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof Xc)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)NN(n,n.material[i])&&(e=!0);else NN(n,n.material)&&(e=!0)}),e}function Wpe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof Xc)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)kN(n,n.material[i])&&(e=!0);else kN(n,n.material)&&(e=!0)}),e}var $pe=new vT,qpe=new Ue,Xpe=new Qa;function OA(t,e,n,i=!1){let r=t.cloner;if(r)for(let s of r.children){let o=qpe.copy(s.matrixWorld).invert(),a=Xpe.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let u=$pe;u.set(a.origin,a.direction),u.near=e.near,u.far=e.far;let d=u.intersectObject(t,!1);d.length>0&&n.push({...d[0],object:i?s:t})}}var Ype=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let n=t;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===e)return!0;return!1}},Bo=Tr(Pg()),wa=Tr(Rg()),Jn=Tr(Pg()),Ot=Tr(Rg()),Q1=class{constructor(t,e,n){this._dataNormalized=t,this._minD=e,this._maxD=n}static createFromUnnormalized(t){let e=Ot.sup(t),n=Ot.inf(t),i=(0,Jn.default)(new Float32Array(t.size),t.shape),r=e-n;return r<1e-4?Ot.assigns(i,0):(Ot.subs(i,t,n),Ot.divs(i,i,r)),new Q1(i,n,e)}get data(){return this._dataNormalized}get minD(){return this._minD}get maxD(){return this._maxD}denormalize(){let t=(0,Jn.default)(new Float32Array(this._dataNormalized.size),this._dataNormalized.shape);return Ot.muls(t,this._dataNormalized,this._maxD-this._minD),Ot.adds(t,t,this._minD),t}},Ln=class{constructor(t,e){this._quantized=t,this._method=e}get quantized(){return this._quantized}static maxIntBits(t){return 2**t-1}static fromNormalized(t,e){let n=t.data,i;if(e==="norm8x"){let r=Ln.maxIntBits(8),s=(0,Jn.default)(new Float32Array(n.size),n.shape);Ot.muls(s,n,r),Ot.roundeq(s),i=(0,Jn.default)(new Uint8Array(s.data),n.shape)}else if(e==="norm565"){let r=(0,Jn.default)(new Float32Array(n.size),n.shape);Ot.assign(r,n),Ot.mulseq(r.pick(null,0),Ln.maxIntBits(5)),Ot.mulseq(r.pick(null,1),Ln.maxIntBits(6)),Ot.mulseq(r.pick(null,2),Ln.maxIntBits(5)),Ot.roundeq(r);let s=(0,Jn.default)(new Uint16Array(r.data),n.shape),o=(0,Jn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]),a=(0,Jn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]);Ot.lshifts(o,s.pick(null,0),11),Ot.lshifts(a,s.pick(null,1),5),Ot.boreq(o,a),Ot.boreq(o,s.pick(null,2)),i=o}else{let r=(0,Jn.default)(new Float32Array(n.size),n.shape);Ot.assign(r,n),Ot.mulseq(r.pick(null,0),Ln.maxIntBits(11)),Ot.mulseq(r.pick(null,1),Ln.maxIntBits(10)),Ot.mulseq(r.pick(null,2),Ln.maxIntBits(11)),Ot.roundeq(r);let s=(0,Jn.default)(new Uint32Array(r.data),n.shape),o=(0,Jn.default)(new Uint32Array(n.shape[0]),[n.shape[0]]),a=(0,Jn.default)(new Uint32Array(n.shape[0]),[n.shape[0]]);Ot.lshifts(o,s.pick(null,0),21),Ot.lshifts(a,s.pick(null,1),11),Ot.boreq(o,a),Ot.boreq(o,s.pick(null,2)),i=o}return new Ln(i,e)}dequantize(t,e){let n=this._method,i,r=this._quantized;if(n==="norm8x"){let s=Ln.maxIntBits(8);i=(0,Jn.default)(new Float32Array(r.size),r.shape),Ot.muls(i,r,1/s)}else if(n==="norm565"){let s=(0,Jn.default)(new Uint8Array(r.shape[0]),[r.shape[0]]),o=(0,Jn.default)(new Uint8Array(r.shape[0]),[r.shape[0]]),a=(0,Jn.default)(new Uint8Array(r.shape[0]),[r.shape[0]]);Ot.rrshifts(s,r,11),Ot.rrshifts(o,r,5),Ot.bandseq(o,Ln.maxIntBits(6)),Ot.bands(a,r,Ln.maxIntBits(5)),i=(0,Jn.default)(new Float32Array(r.shape[0]*3),[r.shape[0],3]),Ot.muls(i.pick(null,0),s,1/Ln.maxIntBits(5)),Ot.muls(i.pick(null,1),o,1/Ln.maxIntBits(6)),Ot.muls(i.pick(null,2),a,1/Ln.maxIntBits(5))}else{let s=(0,Jn.default)(new Uint16Array(r.shape[0]),[r.shape[0]]),o=(0,Jn.default)(new Uint16Array(r.shape[0]),[r.shape[0]]),a=(0,Jn.default)(new Uint16Array(r.shape[0]),[r.shape[0]]);Ot.rrshifts(s,r,21),Ot.rrshifts(o,r,11),Ot.bandseq(o,Ln.maxIntBits(10)),Ot.bands(a,r,Ln.maxIntBits(11)),i=(0,Jn.default)(new Float32Array(r.shape[0]*3),[r.shape[0],3]),Ot.muls(i.pick(null,0),s,1/Ln.maxIntBits(11)),Ot.muls(i.pick(null,1),o,1/Ln.maxIntBits(10)),Ot.muls(i.pick(null,2),a,1/Ln.maxIntBits(11))}return new Q1(i,t,e)}},Vn=class{constructor(t,e,n,i,r,s=!1){this._quantized=t,this._minMaxMatrix=e,this._chunkSize=n,this._quantizationMethod=i,this._variableChunkSize=r,this._isDynamicChunks=s}get length(){return this._quantized.shape[0]}get nchunks(){return this._minMaxMatrix.shape[0]}get quantized(){return this._quantized}get method(){return this._quantizationMethod}get minmaxMatrix(){return this._minMaxMatrix}_createPrunedMinMax(t){let e=t.length,n=this.minmaxMatrix.shape[0]-e,i=(0,Bo.default)(new Float32Array(n*2),[n,2]),r=0,s=n,o=0,a=this.minmaxMatrix.shape[0];for(let l=0;l<t.length;l++)a=t[l],s=a-o+r,s>r&&wa.assign(i.hi(s,2).lo(r,0),this.minmaxMatrix.hi(a,2).lo(o,0)),r=s,o=a+1;return r<n&&wa.assign(i.lo(r,0),this.minmaxMatrix.lo(o,0)),i}_createPrunedQuantized(t){let e=t.length,n=this.quantized.shape[0]-e,i=this._quantizationMethod,r,s;if(i==="norm8x"){s=this._quantized.shape[1];let d=s?n*s:n;r=(0,Bo.default)(new Uint8Array(d),s?[n,s]:[n,1])}else i==="norm565"?r=(0,Bo.default)(new Uint16Array(n),[n]):r=(0,Bo.default)(new Uint32Array(n),[n]);let o=0,a=n,l=0,u=r.shape[0];for(let d=0;d<t.length;d++)u=t[d],a=u-l+o,a>o&&(s?wa.assign(r.hi(a,s).lo(o,0),this._quantized.hi(u,s).lo(l,0)):wa.assign(r.hi(a).lo(o),this._quantized.hi(u).lo(l))),o=a,l=u+1;return o<n&&(s?wa.assign(r.lo(o,0),this._quantized.lo(l,0)):wa.assign(r.lo(o),this._quantized.lo(l))),r}pruneFeature(t,e,n){let i=this._createPrunedQuantized(t),r=this._createPrunedMinMax(e);return new Vn(i,r,this._chunkSize,this._quantizationMethod,n,!0)}static getRequiredNChunks(t,e){return Math.floor(t/e)}static fromArray(t,e,n){let i=t.shape[0],r=Math.floor(i/n),s=(0,Bo.default)(new Float32Array(r*2),[r,2],[2,1]),o;e==="norm8x"?o=(0,Bo.default)(new Uint8Array(t.size),t.shape):e==="norm565"?o=(0,Bo.default)(new Uint16Array(t.shape[0]),[t.shape[0]]):o=(0,Bo.default)(new Uint32Array(t.shape[0]),[t.shape[0]]);for(let a=0;a<r;a++){let l=a*n,u=a+1<r?(a+1)*n:i,d;t.shape.length>1?d=Q1.createFromUnnormalized(t.hi(u,t.shape[1]).lo(l,0)):d=Q1.createFromUnnormalized(t.hi(u).lo(l)),s.set(a,0,d.minD),s.set(a,1,d.maxD),o.shape.length>1?wa.assign(o.hi(u,o.shape[1]).lo(l,0),Ln.fromNormalized(d,e).quantized):wa.assign(o.hi(u).lo(l),Ln.fromNormalized(d,e).quantized)}return new Vn(o,s,n,e)}denormDequant(){let t=this._minMaxMatrix.shape[0],e=this._quantized,n=e.shape[0],i=this._quantizationMethod,r=this._chunkSize,s;if(this._isDynamicChunks){if(!this._variableChunkSize)throw new Error("variable chunk must exists if chunkSize isDynamic");s=this._variableChunkSize}let o;i==="norm8x"?o=(0,Bo.default)(new Float32Array(e.size),e.shape):o=(0,Bo.default)(new Float32Array(n*3),[n,3]);let a=0,l=r;for(let u=0;u<t;u++){let[d,c]=[this._minMaxMatrix.get(u,0),this._minMaxMatrix.get(u,1)];this._isDynamicChunks&&(l=s[u]);let h=u+1<t?a+l:n,f;e.shape.length>1?f=new Ln(e.hi(h,e.shape[1]).lo(a,0),i):f=new Ln(e.hi(h).lo(a),i),wa.assign(o.hi(h,o.shape[1]).lo(a,0),f.dequantize(d,c).denormalize()),a=h}return o}static async fetchArrayBuffer(t){return await(await fetch(t,{mode:"cors"})).arrayBuffer()}},yl=Tr(Pg()),$t=Tr(Rg()),Zpe="http://127.0.0.1:8000",Nd=Tr(Pg()),li=Tr(Rg()),UN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function zN(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function FN(t,e){if(t===e)return 0;if(~~t===t&&~~e===e){if(t===0||e===0)return t<e?-1:1;if(t<0||e<0){if(e>=0)return-1;if(t>=0)return 1;t=-t,e=-e}let r=zN(t),s=zN(e),o=0;return r<s?(t*=UN[s-r-1],e/=10,o=-1):r>s&&(e*=UN[r-s-1],t/=10,o=1),t===e?o:t<e?-1:1}let n=String(t),i=String(e);return n===i?0:n<i?-1:1}function Kpe(t){let e=0;for(;t>=32;)e|=t&1,t>>=1;return t+e}function BN(t,e,n,i){let r=e+1;if(r===n)return 1;if(i(t[r++],t[e])<0){for(;r<n&&i(t[r],t[r-1])<0;)r++;Qpe(t,e,r)}else for(;r<n&&i(t[r],t[r-1])>=0;)r++;return r-e}function Qpe(t,e,n){for(n--;e<n;){let i=t[e];t[e++]=t[n],t[n--]=i}}function VN(t,e,n,i,r){for(i===e&&i++;i<n;i++){let s=t[i],o=e,a=i;for(;o<a;){let u=o+a>>>1;r(s,t[u])<0?a=u:o=u+1}let l=i-o;switch(l){case 3:t[o+3]=t[o+2];case 2:t[o+2]=t[o+1];case 1:t[o+1]=t[o];break;default:for(;l>0;)t[o+l]=t[o+l-1],l--}t[o]=s}}function Lb(t,e,n,i,r,s){let o=0,a=0,l=1;if(s(t,e[n+r])>0){for(a=i-r;l<a&&s(t,e[n+r+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),o+=r,l+=r}else{for(a=r+1;l<a&&s(t,e[n+r-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);let u=o;o=r-l,l=r-u}for(o++;o<l;){let u=o+(l-o>>>1);s(t,e[n+u])>0?o=u+1:l=u}return l}function Db(t,e,n,i,r,s){let o=0,a=0,l=1;if(s(t,e[n+r])<0){for(a=r+1;l<a&&s(t,e[n+r-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);let u=o;o=r-l,l=r-u}else{for(a=i-r;l<a&&s(t,e[n+r+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),o+=r,l+=r}for(o++;o<l;){let u=o+(l-o>>>1);s(t,e[n+u])<0?l=u:o=u+1}return l}var Jpe=class{constructor(t,e){pr(this,"array",null),pr(this,"compare",null),pr(this,"minGallop",7),pr(this,"length",0),pr(this,"tmpStorageLength",256),pr(this,"stackLength",0),pr(this,"runStart",null),pr(this,"runLength",null),pr(this,"stackSize",0),this.array=t,this.compare=e,this.length=t.length,this.length<2*256&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}pushRun(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1}mergeRuns(){for(;this.stackSize>1;){let t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}}forceMergeRuns(){for(;this.stackSize>1;){let t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}}mergeAt(t){let e=this.compare,n=this.array,i=this.runStart[t],r=this.runLength[t],s=this.runStart[t+1],o=this.runLength[t+1];this.runLength[t]=r+o,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;let a=Db(n[s],n,i,r,0,e);i+=a,r-=a,r!==0&&(o=Lb(n[i+r-1],n,s,o,o-1,e),o!==0&&(r<=o?this.mergeLow(i,r,s,o):this.mergeHigh(i,r,s,o)))}mergeLow(t,e,n,i){let r=this.compare,s=this.array,o=this.tmp,a=0;for(a=0;a<e;a++)o[a]=s[t+a];let l=0,u=n,d=t;if(s[d++]=s[u++],--i===0){for(a=0;a<e;a++)s[d+a]=o[l+a];return}if(e===1){for(a=0;a<i;a++)s[d+a]=s[u+a];s[d+i]=o[l];return}let c=this.minGallop;for(;;){let h=0,f=0,m=!1;do if(r(s[u],o[l])<0){if(s[d++]=s[u++],f++,h=0,--i===0){m=!0;break}}else if(s[d++]=o[l++],h++,f=0,--e===1){m=!0;break}while((h|f)<c);if(m)break;do{if(h=Db(s[u],o,l,e,0,r),h!==0){for(a=0;a<h;a++)s[d+a]=o[l+a];if(d+=h,l+=h,e-=h,e<=1){m=!0;break}}if(s[d++]=s[u++],--i===0){m=!0;break}if(f=Lb(o[l],s,u,i,0,r),f!==0){for(a=0;a<f;a++)s[d+a]=s[u+a];if(d+=f,u+=f,i-=f,i===0){m=!0;break}}if(s[d++]=o[l++],--e===1){m=!0;break}c--}while(h>=7||f>=7);if(m)break;c<0&&(c=0),c+=2}if(this.minGallop=c,c<1&&(this.minGallop=1),e===1){for(a=0;a<i;a++)s[d+a]=s[u+a];s[d+i]=o[l]}else{if(e===0)throw new Error("mergeLow preconditions were not respected");for(a=0;a<e;a++)s[d+a]=o[l+a]}}mergeHigh(t,e,n,i){let r=this.compare,s=this.array,o=this.tmp,a=0;for(a=0;a<i;a++)o[a]=s[n+a];let l=t+e-1,u=i-1,d=n+i-1,c=0,h=0;if(s[d--]=s[l--],--e===0){for(c=d-(i-1),a=0;a<i;a++)s[c+a]=o[a];return}if(i===1){for(d-=e,l-=e,h=d+1,c=l+1,a=e-1;a>=0;a--)s[h+a]=s[c+a];s[d]=o[u];return}let f=this.minGallop;for(;;){let m=0,x=0,y=!1;do if(r(o[u],s[l])<0){if(s[d--]=s[l--],m++,x=0,--e===0){y=!0;break}}else if(s[d--]=o[u--],x++,m=0,--i===1){y=!0;break}while((m|x)<f);if(y)break;do{if(m=e-Db(o[u],s,t,e,e-1,r),m!==0){for(d-=m,l-=m,e-=m,h=d+1,c=l+1,a=m-1;a>=0;a--)s[h+a]=s[c+a];if(e===0){y=!0;break}}if(s[d--]=o[u--],--i===1){y=!0;break}if(x=i-Lb(s[l],o,0,i,i-1,r),x!==0){for(d-=x,u-=x,i-=x,h=d+1,c=u+1,a=0;a<x;a++)s[h+a]=o[c+a];if(i<=1){y=!0;break}}if(s[d--]=s[l--],--e===0){y=!0;break}f--}while(m>=7||x>=7);if(y)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),i===1){for(d-=e,l-=e,h=d+1,c=l+1,a=e-1;a>=0;a--)s[h+a]=s[c+a];s[d]=o[u]}else{if(i===0)throw new Error("mergeHigh preconditions were not respected");for(c=d-(i-1),a=0;a<i;a++)s[c+a]=o[a]}}};function eme(t,e,n,i){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");e?typeof e!="function"&&(i=n,n=e,e=FN):e=FN,n||(n=0),i||(i=t.length);let r=i-n;if(r<2)return;let s=0;if(r<32){s=BN(t,n,i,e),VN(t,n,i,n+s,e);return}let o=new Jpe(t,e),a=Kpe(r);do{if(s=BN(t,n,i,e),s<a){let l=r;l>a&&(l=a),VN(t,n,n+l,n+s,e),s=l}o.pushRun(n,s),o.mergeRuns(),r-=s,n+=s}while(r!==0);o.forceMergeRuns()}function Ib(t){let e=(0,Nd.default)(new Int32Array(t.shape[0]),[t.shape[0]]),n=(0,Nd.default)(new Int32Array(t.shape[0]),[t.shape[0]]);return li.bands(e,t,1023),li.lshifts(n,e,16),li.bxoreq(e,n),li.bandseq(e,4278190335),li.lshifts(n,e,8),li.bxoreq(e,n),li.bandseq(e,50393103),li.lshifts(n,e,4),li.bxoreq(e,n),li.bandseq(e,51130563),li.lshifts(n,e,2),li.bxoreq(e,n),li.bandseq(e,153391689),e}function tme(t){let e=Ib(t.pick(null,0)),n=Ib(t.pick(null,1));li.lshiftseq(n,1);let i=Ib(t.pick(null,2));return li.lshiftseq(i,2),li.boreq(e,n),li.boreq(e,i),e}function Bh(t,e){if(t.shape[0]!==e.shape[0])throw new Error("wrong length");let n=(0,Nd.default)(new Float32Array(t.size),t.shape,t.stride,t.offset);for(let i=0;i<e.shape[0];i++){let r=e.get(i);if(t.shape.length>1)for(let s=0;s<t.shape[1];s++)n.set(i,s,t.get(r,s));else n.set(i,t.get(r))}return n}function nme(t){let e=li.sup(t),n=li.inf(t),i=1e3/Math.min(1e3,e-n),r=(0,Nd.default)(new Float32Array(t.data),t.shape);li.mulseq(r,i);let s=(0,Nd.default)(new Int32Array(r.data),t.shape),o=tme(s),a=Array.from(o.data).map((u,d)=>[u,d]);eme(a,(u,d)=>u[0]-d[0]);let l=a.map(([u,d])=>d);return(0,Nd.default)(Uint32Array.from(l))}var Yu=class{constructor(t,e,n,i,r,s,o,a,l,u){this.propertyDescs=t,this.format=e,this.nsplats=n,this.xyz=i,this.colors=r,this.harmonics=s,this.opacity=o,this.scaling=a,this.rotation=l,this.maxSHDegree=u}getPlyBinary(){let t=Yu._generateHeaderString(this.propertyDescs,this.format,this.nsplats),e=new TextEncoder().encode(t),n=Object.keys(this.propertyDescs).length,i=(0,yl.default)(new Float32Array(this.nsplats*n),[this.nsplats,n]);if($t.assign(i.pick(null,this.propertyDescs.x.index),this.xyz.pick(null,0)),$t.assign(i.pick(null,this.propertyDescs.y.index),this.xyz.pick(null,1)),$t.assign(i.pick(null,this.propertyDescs.z.index),this.xyz.pick(null,2)),$t.assign(i.pick(null,this.propertyDescs.f_dc_0.index),this.colors.pick(null,0)),$t.assign(i.pick(null,this.propertyDescs.f_dc_1.index),this.colors.pick(null,1)),$t.assign(i.pick(null,this.propertyDescs.f_dc_2.index),this.colors.pick(null,2)),$t.assign(i.pick(null,this.propertyDescs.opacity.index),this.opacity.pick(null,0)),$t.assign(i.pick(null,this.propertyDescs.scale_0.index),this.scaling.pick(null,0)),$t.assign(i.pick(null,this.propertyDescs.scale_1.index),this.scaling.pick(null,1)),$t.assign(i.pick(null,this.propertyDescs.scale_2.index),this.scaling.pick(null,2)),$t.assign(i.pick(null,this.propertyDescs.rot_0.index),this.rotation.pick(null,0)),$t.assign(i.pick(null,this.propertyDescs.rot_1.index),this.rotation.pick(null,1)),$t.assign(i.pick(null,this.propertyDescs.rot_2.index),this.rotation.pick(null,2)),$t.assign(i.pick(null,this.propertyDescs.rot_3.index),this.rotation.pick(null,3)),this.harmonics&&this.harmonics.length>0)for(let o=0;o<this.harmonics.length;o++){let a=o*3;$t.assign(i.pick(null,this.propertyDescs[`f_rest_${a}`].index),this.harmonics[o].pick(null,0)),$t.assign(i.pick(null,this.propertyDescs[`f_rest_${a+1}`].index),this.harmonics[o].pick(null,1)),$t.assign(i.pick(null,this.propertyDescs[`f_rest_${a+2}`].index),this.harmonics[o].pick(null,2))}let r=new Uint8Array(i.data.buffer),s=new Uint8Array(r.length+e.length);return s.set(e),s.set(r,e.length),s.buffer}save(t,e){let n=this.getPlyBinary(),i=new Blob([n],{type:"application/octet-stream"}),r=new File([i],t),s=new FormData;s.append("file",r),s.append("filename",t),s.append("basedir",e),fetch(`${Zpe}/push_file`,{method:"POST",body:s})}static async loadFile(t){return await(await fetch(t)).arrayBuffer()}mortonPositionSplatsSort(){let t=nme(this.xyz),e=Bh(this.xyz,t),n=Bh(this.colors,t),i=Bh(this.opacity,t),r=Bh(this.scaling,t),s=Bh(this.rotation,t),o=[];for(let a=0;a<this.harmonics.length;a++)o.push(Bh(this.harmonics[a],t));return new Yu(this.propertyDescs,this.format,this.nsplats,e,n,o,i,r,s,this.maxSHDegree)}static _generateHeaderString(t,e,n){let i=`ply
format ${e.format} ${e.version}
element vertex ${n}`,r=Object.keys(t).length,s=Array(r);for(let o in t){let a=t[o];s[a.index]={name:o,dtype:a.dtype}}for(let o=0;o<s.length;o++)i=`${i}
property ${s[o].dtype} ${s[o].name}`;return`${i}
end_header
`}static fromArrayBuffer(t,e=3){let{splatCount:n,vertexData:i,propertiesDesc:r,format:s}=Yu.decodeHeader(t),o=i.buffer.slice(i.byteOffset),a=Object.keys(r).length,l=(0,yl.default)(new Float32Array(o),[n,a]),u=0,d={},c={double:8,int:4,uint:4,float:4,short:2,ushort:2,uchar:1};for(let w in r)if(r.hasOwnProperty(w)){let b=r[w].dtype;d[w]=u,u+=c[b]}let h=(0,yl.default)(new Float32Array(n*3),[n,3]);$t.assign(h.pick(null,0),l.pick(null,d.x/4)),$t.assign(h.pick(null,1),l.pick(null,d.y/4)),$t.assign(h.pick(null,2),l.pick(null,d.z/4));let f=(0,yl.default)(new Float32Array(n*3),[n,3]);$t.assign(f.pick(null,0),l.pick(null,d.scale_0/4)),$t.assign(f.pick(null,1),l.pick(null,d.scale_1/4)),$t.assign(f.pick(null,2),l.pick(null,d.scale_2/4));let m=(0,yl.default)(new Float32Array(n*3),[n,3]);$t.assign(m.pick(null,0),l.pick(null,d.f_dc_0/4)),$t.assign(m.pick(null,1),l.pick(null,d.f_dc_1/4)),$t.assign(m.pick(null,2),l.pick(null,d.f_dc_2/4));let x=(0,yl.default)(new Float32Array(n*4),[n,4]);$t.assign(x.pick(null,0),l.pick(null,d.rot_1/4)),$t.assign(x.pick(null,1),l.pick(null,d.rot_2/4)),$t.assign(x.pick(null,2),l.pick(null,d.rot_3/4)),$t.assign(x.pick(null,3),l.pick(null,d.rot_0/4));for(let w=0;w<n;w++){let b=x.pick(w,null),E=Math.sqrt(b.get(0)**2+b.get(1)**2+b.get(2)**2+b.get(3)**2);$t.divseq(b,E)}let y=(0,yl.default)(new Float32Array(n*1),[n,1]);$t.assign(y.pick(null,0),l.pick(null,d.opacity/4));let v=(Math.min(Math.max(e,0),3)+1)**2-1,_=[];for(let w=0;w<v;w++){let b=(0,yl.default)(new Float32Array(n*3),[n,3]),E=w*3;$t.assign(b.pick(null,0),l.pick(null,d[`f_rest_${E}`]/4)),$t.assign(b.pick(null,1),l.pick(null,d[`f_rest_${E+1}`]/4)),$t.assign(b.pick(null,2),l.pick(null,d[`f_rest_${E+2}`]/4)),_.push(b)}return new Yu(r,s,n,h,m,_,y,f,x,e)}static async fromPLYFile(t,e=3){let n=await Yu.loadFile(t);return Yu.fromArrayBuffer(n,e)}static decodeHeader(t){let e=new TextDecoder,n=0,i="",r=100;for(;;){if(n+r>=t.byteLength)throw new Error("End of file reached while searching for end of header");let h=new Uint8Array(t,n,r);i+=e.decode(h),n+=r;let f=n-r*2,m=new Uint8Array(t,Math.max(0,f),f>0?r*2:r);if(e.decode(m).includes("end_header"))break}let s=i.split(`
`),o=0,a={},l=0,u;for(let h=0;h<s.length;h++){let f=s[h].trim();if(f.startsWith("element vertex")){let m=f.match(/\d+/);m&&(o=parseInt(m[0]))}else if(f.startsWith("property")){let m=f.match(/(\w+)\s+(\w+)\s+(\w+)/);if(m){let x=m[2],y=m[3];a[y]={dtype:x,index:l},l++}}else if(f.startsWith("format")){let m=f.match(/(\w+)\s+(\w+)\s+(\d+\.?\d*)/);m&&(u={format:m[2],version:m[3]})}else if(f==="end_header")break}let d=i.indexOf("end_header")+10+1,c=new DataView(t,d);return{splatCount:o,vertexData:c,headerOffset:n,propertiesDesc:a,format:u}}},NA=class{constructor(t,e,n,i,r,s,o,a){this.config=t,this.xyz=e,this.scaling=n,this.color=i,this.opacity=r,this.harmonics=o,this.quaternion=s,this.variableChunkSize=a}get isDynamicChunks(){return this.variableChunkSize&&this.variableChunkSize.length>0}get nchunks(){return this.xyz.nchunks}get nsplats(){return this.xyz.length}get chunkSize(){return this.config.chunkSize}static compressFromGaussianData(t,e){let n=Vn.fromArray(t.xyz,e.xyz,e.chunkSize),i=Vn.fromArray(t.scaling,e.scaling,e.chunkSize),r=Vn.fromArray(t.colors,e.color,e.chunkSize),s=Vn.fromArray(t.opacity,e.opacity,e.chunkSize),o=Vn.fromArray(t.rotation,e.quaternion,e.chunkSize),a=t.harmonics,l=[];if(e.harmonics)for(let u=0;u<a.length;u++){let d=Vn.fromArray(a[u],e.harmonics,e.chunkSize);l.push(d)}return new NA(e,n,i,r,s,o,l)}_countIndexesInChunks(t){let e=[],n=this.nchunks,i=this.chunkSize,r=this.nsplats,s=Vn.getRequiredNChunks(r,i);if(n===s)for(let o=0;o<t.length;o++){let a=t[o],l=Math.floor(a/this.chunkSize);l in e?e[l].push(a):e[l]=[a]}else{let o=this.variableChunkSize,a={},l=0;for(let u=0;u<n;u++)a[u]=l,l+=o[u];for(let u=0;u<t.length;u++){let d=t[u],c=Math.min(Math.floor(d/i),n-1);for(;d>=a[c]+o[c];)c++;c in e?e[c].push(d):e[c]=[d]}}return e}pruneSplats(t){let e=this._countIndexesInChunks(t),n,i=[];return e.length>0&&(n=this.variableChunkSize?[...this.variableChunkSize]:Array(this.nchunks).fill(this.chunkSize),e.forEach((r,s)=>{n[s]-=r.length,n[s]<=0&&i.push(s)}),n=n.filter(r=>r>0)),new NA(this.config,this.xyz.pruneFeature(t,i,n),this.scaling.pruneFeature(t,i,n),this.color.pruneFeature(t,i,n),this.opacity.pruneFeature(t,i,n),this.quaternion.pruneFeature(t,i,n),this.harmonics?this.harmonics.map(r=>r.pruneFeature(t,i,this.variableChunkSize)):void 0,n)}static async loadConfig(t){return await(await fetch(t,{method:"GET",mode:"cors",headers:{Accept:"application/json"}})).json()}toGaussians(){var r;let t={format:"binary_little_endian",version:"1.0"},e={},n=0;if(e.x={dtype:"float",index:n},n++,e.y={dtype:"float",index:n},n++,e.z={dtype:"float",index:n},n++,e.f_dc_0={dtype:"float",index:n},n++,e.f_dc_1={dtype:"float",index:n},n++,e.f_dc_2={dtype:"float",index:n},n++,this.harmonics&&this.harmonics.length>0)for(let s=0;s<this.harmonics.length;s++)e[`f_rest_${s}`]={dtype:"float",index:n},n++,e[`f_rest_${s+1}`]={dtype:"float",index:n},n++,e[`f_rest_${s+2}`]={dtype:"float",index:n},n++;e.opacity={dtype:"float",index:n},n++,e.scale_0={dtype:"float",index:n},n++,e.scale_1={dtype:"float",index:n},n++,e.scale_2={dtype:"float",index:n},n++,e.rot_0={dtype:"float",index:n},n++,e.rot_1={dtype:"float",index:n},n++,e.rot_2={dtype:"float",index:n},n++,e.rot_3={dtype:"float",index:n},n++;let i=(r=this.harmonics)==null?void 0:r.map(s=>s.denormDequant());return new Yu(e,t,this.xyz.length,this.xyz.denormDequant(),this.color.denormDequant(),i||[],this.opacity.denormDequant(),this.scaling.denormDequant(),this.quaternion.denormDequant(),3)}},Vh=Tr(Pg()),Cs=Tr(Rg()),jN={xyz:3,color:3,opacity:1,scaling:3,quaternion:4,harmonics:3},kA=class{constructor(t){this._buffer=t}get buffer(){return this._buffer}get decoded(){return this._decoded||(this._decoded=this.decodeBuffer()),this._decoded}get colorsA(){let t=.28209479177387814,e=this.decoded.color.denormDequant(),n=this.decoded.opacity.denormDequant(),i=(0,Vh.default)(new Float32Array(e.shape[0]*4),[e.shape[0],4]);return Cs.mulseq(e,t),Cs.addseq(e,.5),Cs.mulseq(e,255),Cs.maxseq(e,0),Cs.minseq(e,255),Cs.negeq(n),Cs.expeq(n),Cs.addseq(n,1),Cs.recipeq(n),Cs.mulseq(n,255),Cs.assign(i.hi(e.shape[0],3).lo(0,0),e),Cs.assign(i.hi(e.shape[0],4).lo(0,3),n),(0,Vh.default)(new Uint8Array(i.data),[e.shape[0],4]).data}get nsplats(){return this.decoded.nsplats}getSplatCount(){return this.decoded.nsplats}get precomputedCovarianceBufferData(){return this._precomputedCovarianceBufferData}decodeBuffer(){let{splatCount:t,chunkCount:e,chunkSize:n,typeChunks:i,vertexData:r,propertiesDesc:s}=this.decodeHeader(),o={xyz:s.xyz.compressionMethod,color:s.color.compressionMethod,opacity:s.opacity.compressionMethod,scaling:s.scaling.compressionMethod,quaternion:s.quaternion.compressionMethod,chunkSize:n};s.harmonics_0&&(o.harmonics=s.harmonics_0.compressionMethod);let a=r.byteOffset,l=Array(Object.keys(s).length);for(let y in s)l[s[y].index]={name:y,method:s[y].compressionMethod};let u=e*2*4,d=a,c=i==="dynamic"?e*2:0,h,f=!1;if(c>0){let y=new Uint16Array(r.buffer.slice(d,d+c));d+=c,h=Array.from(y),f=!0}let m={};for(let y of l){let v=0,_=!0;if(y.method==="norm8x")v=t*1*jN[y.name];else if(y.method==="norm11")v=t*4;else if(y.method==="norm565")v=t*2;else throw _=!1,new Error(`Not Implemented format: ${y.method}`);let w;if(_){let A=r.buffer.slice(d,d+u);w=(0,Vh.default)(new Float32Array(A),[e,2]),d+=u}else throw new Error("loading chunk byt hasnot minmax!");let b=r.buffer.slice(d,d+v);d+=v;let E;if(y.method==="norm8x")E=(0,Vh.default)(new Uint8Array(b),[t,jN[y.name]]);else if(y.method==="norm11")E=(0,Vh.default)(new Uint32Array(b));else if(y.method==="norm565")E=(0,Vh.default)(new Uint16Array(b));else throw new Error(`Not Implemented format: ${y.method}`);m[y.name]=new Vn(E,w,n,y.method,h,f)}let x=[];for(let y=0;y<15;y++){let v=m[`harmonics_${y}`];v&&(x.push(v),delete m[`harmonics_${y}`])}return x.length>0&&(m.harmonics=x),new NA(o,m.xyz,m.scaling,m.color,m.opacity,m.quaternion,m.harmonics,h)}buildPreComputedBuffers(){let t=this.decoded,e=t.nsplats,n=new ArrayBuffer(24*e),i=new Float32Array(n),r=t.scaling.denormDequant(),s=t.quaternion.denormDequant(),o=new xi,a=new St,l=new St,u=new St,d=new Ue;for(let c=0;c<e;c++){d.makeScale(Math.exp(r.get(c,0)),Math.exp(r.get(c,1)),Math.exp(r.get(c,2))),l.setFromMatrix4(d),o.set(s.get(c,0),s.get(c,1),s.get(c,2),s.get(c,3)),d.makeRotationFromQuaternion(o),a.setFromMatrix4(d),u.copy(a).multiply(l);let h=u.elements;i[6*c]=h[0]*h[0]+h[3]*h[3]+h[6]*h[6],i[6*c+1]=h[0]*h[1]+h[3]*h[4]+h[6]*h[7],i[6*c+2]=h[0]*h[2]+h[3]*h[5]+h[6]*h[8],i[6*c+3]=h[1]*h[1]+h[4]*h[4]+h[7]*h[7],i[6*c+4]=h[1]*h[2]+h[4]*h[5]+h[7]*h[8],i[6*c+5]=h[2]*h[2]+h[5]*h[5]+h[8]*h[8]}this._precomputedCovarianceBufferData=n}decodeHeader(){let t=this._buffer,e=new TextDecoder,n=0,i="",r=100;for(;;){if(n+r>=t.byteLength)throw new Error("End of file reached while searching for end of header");let m=new Uint8Array(t,n,r);i+=e.decode(m),n+=r;let x=n-r*2,y=new Uint8Array(t,Math.max(0,x),x>=0?r*2:r);if(e.decode(y).includes("end_header"))break}let s=i.split(`
`),o=0,a=0,l=0,u=0,d="",c={};for(let m=0;m<s.length;m++){let x=s[m].trim();if(x.startsWith("element vertex")){let y=x.match(/\d+/);y&&(o=parseInt(y[0]))}else if(x.startsWith("property")){let y=x.match(/(\w+)\s+(\w+)\s+(\w+)/);if(y){let v=y[2],_=y[3];c[v]={compressionMethod:_,index:u},u++}}else if(x.startsWith("element chunks")){let y=x.match(/\d+/);y&&(a=parseInt(y[0]))}else if(x.startsWith("element chunkSize")){let y=x.match(/\d+/);y&&(l=parseInt(y[0]))}else if(x.startsWith("element typeChunks")){let y=x.match(/(\w+)\s+(\w+)\s+(\w+)/);y&&(d=y[3])}else if(x==="end_header")break}let h=i.indexOf("end_header")+10+1,f=new DataView(t,h);return{splatCount:o,chunkCount:a,chunkSize:l,typeChunks:d,vertexData:f,propertiesDesc:c}}pruneSplats(t){let e=this.decodeBuffer().pruneSplats(t);return kA.fromCompressedGaussianSplats(e)}static fromCompressedGaussianSplats(t){let e=t.xyz.length,n=t.xyz.nchunks,i=`gspline
element vertex ${e}
element chunks ${n}
element chunkSize ${t.chunkSize}
element typeChunks ${t.isDynamicChunks?"dynamic":"static"}
property xyz ${t.xyz.method}
property color ${t.color.method}
property opacity ${t.opacity.method}
property scaling ${t.scaling.method}
property quaternion ${t.quaternion.method}`;if(t.harmonics&&t.harmonics.length>0)for(let T=0;T<t.harmonics.length;T++)i=`${i}
property harmonics_${T} ${t.harmonics[T].method}`;i=`${i}
end_header
`;let r=new TextEncoder().encode(i),s=n*2*4,o=t.xyz.quantized.data.buffer.byteLength,a=t.xyz instanceof Vn?s:0,l=t.color.quantized.data.buffer.byteLength,u=t.color instanceof Vn?s:0,d=t.opacity.quantized.data.buffer.byteLength,c=t.opacity instanceof Vn?s:0,h=t.scaling.quantized.data.buffer.byteLength,f=t.scaling instanceof Vn?s:0,m=t.quaternion.quantized.data.buffer.byteLength,x=t.quaternion instanceof Vn?s:0,y=t.variableChunkSize?Uint16Array.from(t.variableChunkSize):void 0,v=y?y.byteLength:0,_=r.byteLength+v+o+a+l+u+d+c+h+f+m+x,w=0,b=0;if(t.harmonics&&t.harmonics.length>0)for(let T=0;T<t.harmonics.length;T++)w+=t.harmonics[T].quantized.data.buffer.byteLength,b+=t.harmonics[T]instanceof Vn?s:0;w=0,b=0,_+=w+b;let E=new Uint8Array(_),A=0;if(E.set(r,A),A+=r.byteLength,v>0&&(E.set(new Uint8Array(y.buffer),A),A+=v),t.xyz instanceof Vn&&(E.set(new Uint8Array(t.xyz.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(t.xyz.quantized.data.buffer),A),A+=o,t.color instanceof Vn&&(E.set(new Uint8Array(t.color.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(t.color.quantized.data.buffer),A),A+=l,t.opacity instanceof Vn&&(E.set(new Uint8Array(t.opacity.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(t.opacity.quantized.data.buffer),A),A+=d,t.scaling instanceof Vn&&(E.set(new Uint8Array(t.scaling.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(t.scaling.quantized.data.buffer),A),A+=h,t.quaternion instanceof Vn&&(E.set(new Uint8Array(t.quaternion.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(t.quaternion.quantized.data.buffer),A),A+=m,w>0&&t.harmonics&&t.harmonics.length>0)for(let T=0;T<t.harmonics.length;T++){let L=t.harmonics[T];L instanceof Vn&&(E.set(new Uint8Array(L.minmaxMatrix.data.buffer),A),A+=s),E.set(new Uint8Array(L.quantized.data.buffer),A),A+=L.quantized.data.byteLength}return new kA(E.buffer)}},ime="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",zl=class{};pr(zl,"DepthMapRange",65536),pr(zl,"MemoryPageSize",65536),pr(zl,"BytesPerFloat",4),pr(zl,"BytesPerInt",4);function rme(t){let e,n,i,r,s,o,a,l,u,d,c,h,f,m,x,y;function v(D){let U=new Float64Array(d,o,16);for(let k=0;k<16;k++)U[k]=D[k];let G;if(i>1){e.exports.sortIndexes(r,s,u,o,a,l,h.DepthMapRange,i);let k=new Uint32Array(i);G=k.buffer,k.set(new Uint32Array(d,l,i))}else if(i===1){let k=new Uint32Array(i);k[0]=new Uint32Array(d,r,n)[0],G=k.buffer}else G=new ArrayBuffer(0);t.postMessage({sortDone:!0,indexesBuffer:G},[G])}function _(D,U,G){let k=new Float32Array(d,s,n*3);i=0;let H=new Uint32Array(d,r,n);for(let K=0;K<G.length-1;K++){let q=U[K],N=D[K].elements,V=q.filter(z=>z.enabled&&z.mode==="Include").map(z=>z.type==="Box"?A(z):P(z)),j=q.filter(z=>z.enabled&&z.mode==="Exclude").map(z=>z.type==="Box"?A(z):P(z));for(let z=G[K];z<G[K+1];z++){let $=f[z*3],te=f[z*3+1],Q=f[z*3+2];if((V.length===0||b($,te,Q,V))&&(j.length===0||!b($,te,Q,j))){let J=1/(N[3]*$+N[7]*te+N[11]*Q+N[15]);k[i*3]=(N[0]*$+N[4]*te+N[8]*Q+N[12])*J,k[i*3+1]=(N[1]*$+N[5]*te+N[9]*Q+N[13])*J,k[i*3+2]=(N[2]*$+N[6]*te+N[10]*Q+N[14])*J,H[i]=z,i++}}}}function w(D,U){let G=[],k=U.filter(q=>q.enabled&&q.mode==="Include").map(q=>q.type==="Box"?A(q):P(q)),H=U.filter(q=>q.enabled&&q.mode==="Exclude").map(q=>q.type==="Box"?A(q):P(q)),K=D.length;for(let q=0;q<K;q+=3){let N=D[q],V=D[q+1],j=D[q+2];(k.length===0||b(N,V,j,k))&&(H.length===0||!b(N,V,j,H))||G.push(q/3)}return console.log(G),G}function b(D,U,G,k,H){return k[H==="Intersect"?"every":"some"](K=>{let q=E(D,U,G,K.invRotationMatrix,K.cropCenter);return Array.isArray(K)?L(q.x,q.y,q.z,K):C(q.x,q.y,q.z,K)})}function E(D,U,G,k,H){let K=D-H[0],q=U-H[1],N=G-H[2],V=1/(k[3]*K+k[7]*q+k[11]*N+k[15]);return{x:(k[0]*K+k[4]*q+k[8]*N+k[12])*V+H[0],y:(k[1]*K+k[5]*q+k[9]*N+k[13])*V+H[1],z:(k[2]*K+k[6]*q+k[10]*N+k[14])*V+H[2]}}function A(D){let U=D.cropSize[0]/2,G=D.cropSize[1]/2,k=D.cropSize[2]/2,H=[D.cropCenter[0]-U,D.cropCenter[1]-G,D.cropCenter[2]-k,D.cropCenter[0]+U,D.cropCenter[1]+G,D.cropCenter[2]+k],K=T(D.cropRotation);return Object.assign(H,{invRotationMatrix:K,cropCenter:D.cropCenter})}function T(D){let U=[],G=D[0]*Math.PI/180,k=D[1]*Math.PI/180,H=D[2]*Math.PI/180,K=Math.cos(G),q=Math.sin(G),N=Math.cos(k),V=Math.sin(k),j=Math.cos(H),z=Math.sin(H),$=K*j,te=K*z,Q=q*j,J=q*z;return U[0]=N*j,U[1]=-N*z,U[2]=V,U[4]=te+Q*V,U[5]=$-J*V,U[6]=-q*N,U[8]=J-$*V,U[9]=Q+te*V,U[10]=K*N,U[12]=0,U[13]=0,U[14]=0,U[3]=0,U[7]=0,U[11]=0,U[15]=1,U}function L(D,U,G,k){return D>=k[0]&&D<=k[3]&&U>=k[1]&&U<=k[4]&&G>=k[2]&&G<=k[5]}function P(D){let U=2/D.cropSize[0],G=2/D.cropSize[1],k=2/D.cropSize[2],H=T(D.cropRotation);return{invRadiusX:U,invRadiusY:G,invRadiusZ:k,cropCenter:D.cropCenter,invRotationMatrix:H}}function C(D,U,G,k){let H=(D-k.cropCenter[0])*k.invRadiusX,K=(U-k.cropCenter[1])*k.invRadiusY,q=(G-k.cropCenter[2])*k.invRadiusZ;return H*H+K*K+q*q<=1}t.onmessage=D=>{if(D.data.getCroppedIndexes){let U=new Uint32Array(w(new Float32Array(D.data.positions),D.data.crops)).buffer;t.postMessage({outOfBoundsIndexes:U},[U])}else if(D.data.positions)c=D.data.positions,f=new Float32Array(c),x=D.data.meshMatrixWorlds,y=D.data.cropsArray,m=D.data.meshIndexIntervals,_(x,y,m),t.postMessage({sortSetupComplete:!0});else if(D.data.sort||D.data.newMatrixWorlds||D.data.newCropsArray)(D.data.newMatrixWorlds||D.data.newCropsArray)&&(y=D.data.newCropsArray||y,x=D.data.newMatrixWorlds||x,_(x,y,m)),v(D.data.sort.view,D.data.sort.cameraPosition);else if(D.data.init){h=D.data.init.Constants,n=D.data.init.splatCount;let U=h.BytesPerInt,G=h.BytesPerFloat*3,k=new Uint8Array(D.data.init.sorterWasmBytes),H=U+G,K=n*H,q=n*h.BytesPerInt*2+h.DepthMapRange*h.BytesPerInt*2,N=h.MemoryPageSize*32,V=K+q+N,j=Math.floor(V/h.MemoryPageSize)+1,z={module:{},env:{memory:new WebAssembly.Memory({initial:j*2,maximum:j*3,shared:!0})}};WebAssembly.compile(k).then($=>WebAssembly.instantiate($,z)).then($=>{e=$,r=0,s=n*U,o=s+n*G,u=o+16*h.BytesPerFloat*2,a=u+n*h.BytesPerInt,l=a+h.DepthMapRange*h.BytesPerInt,d=z.env.memory.buffer,t.postMessage({sortSetupPhase1Complete:!0})})}}}function sme(t){let e=new Worker(URL.createObjectURL(new Blob(["(",rme.toString(),")(self)"],{type:"application/javascript"}))),n=atob(ime),i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return e.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:t,Constants:{BytesPerFloat:zl.BytesPerFloat,BytesPerInt:zl.BytesPerInt,DepthMapRange:zl.DepthMapRange,MemoryPageSize:zl.MemoryPageSize}}}),e}var Ob=function(){let t=new Float32Array(1),e=new Int32Array(t.buffer);return function(n){return t[0]=n,e[0]}}(),ome=function(t,e,n,i){return t+(e<<8)+(n<<16)+(i<<24)},py=new ee,By=class extends yi{constructor(t,e,n,i,r=!1,s=1,o,a){super(n,i),this.splatCount=e,this.meshIndexIntervals=o,this.meshMatrixWorlds=a,this.splatBuffers=t,this.geometry=n,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=r,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(t,e,n=!1,i=1,r,s){let o=By.buildGeomtery(e),a=By.buildMaterial(r);return new By(t,e,o,a,n,i,r,s)}static buildMaterial(t){let e=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,n=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:t},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new ee},viewport:{type:"v2",value:new ee},basisViewport:{type:"v2",value:new ee},debugColor:{type:"v3",value:new We},covariancesTextureSize:{type:"v2",value:new ee(1024,1024)},centersColorsTextureSize:{type:"v2",value:new ee(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Gs({uniforms:i,vertexShader:e,fragmentShader:n,transparent:!0,alphaTest:1,blending:Xl,depthTest:!0,depthWrite:!1,side:so})}static buildGeomtery(t){let e=new Ke;e.setIndex([0,1,2,0,2,3]);let n=new Float32Array(4*3),i=new ht(n,3);e.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let r=new hT().copy(e),s=new Uint32Array(t),o=new Ac(s,1,!1);return o.setUsage(cF),r.setAttribute("splatIndex",o),r.instanceCount=t,r}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let t=0,e=0,n=0;for(let i of this.splatBuffers){let r=i.nsplats;this.colors.subarray(t,t+r*4).set(i.colorsA),t+=r*4,this.centers.subarray(e,e+r*3).set(i.decoded.xyz.denormDequant().data),e+=r*3,this.covariances.subarray(n,n+r*6).set(new Float32Array(i.precomputedCovarianceBufferData)),n+=r*6}}allocateAndStoreLocalSplatDataInTextures(){let t=this.splatCount,e=new ee(4096,1024);for(;e.x*e.y*2<t*6;)e.y*=2;let n=new ee(4096,1024);for(;n.x*n.y*4<t*4;)n.y*=2;let i,r;if(this.halfPrecisionCovariancesOnGPU){r=new Uint16Array(e.x*e.y*2);for(let d=0;d<this.covariances.length;d++)r[d]=gF.toHalfFloat(this.covariances[d]);i=new Xo(r,e.x,e.y,p1,ru)}else r=new Float32Array(e.x*e.y*2),r.set(this.covariances),i=new Xo(r,e.x,e.y,p1,rs);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(e);let s=new Uint32Array(n.x*n.y*4);for(let d=0;d<t;d++){let c=d*4,h=d*3,f=d*4;s[f]=ome(this.colors[c],this.colors[c+1],this.colors[c+2],this.colors[c+3]),s[f+1]=Ob(this.centers[h]),s[f+2]=Ob(this.centers[h+1]),s[f+3]=Ob(this.centers[h+2])}let o=new Xo(s,n.x,n.y,xx,$o);o.internalFormat="RGBA32UI",o.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=o,this.material.uniforms.centersColorsTextureSize.value.copy(n);let a=256*4,l=new Float32Array(256*16);for(let d=0;d<this.meshMatrixWorlds.length;d++)l.set(this.meshMatrixWorlds[d].elements,d*16);let u=new Xo(l,a,1,vr,rs);u.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=u,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:r,texture:i,size:e},centerColors:{data:s,texture:o,size:n},meshMatrixWorlds:{data:l,texture:u}}}updateIndexes(t){let e=this.geometry;e.attributes.splatIndex.set(t),e.attributes.splatIndex.needsUpdate=!0,e.instanceCount=t.length}updateUniforms(t,e,n,i){this.splatCount>0&&(py.set(t.x*this.devicePixelRatio,t.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(py),this.material.uniforms.basisViewport.value.set(2/py.x,2/py.y),this.material.uniforms.focal.value.set(e,n),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose())}},ame=class{constructor(t={}){pr(this,"updateSplatMeshUniforms",function(){let e=new ee;return function(){this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(this.renderer.getSize(e),this.cameraFocalLengthX=this.camera.projectionMatrix.elements[0]*this.devicePixelRatio*e.x*.45,this.cameraFocalLengthY=this.camera.projectionMatrix.elements[5]*this.devicePixelRatio*e.y*.45,this.splatMesh.updateUniforms(e,this.cameraFocalLengthX,this.cameraFocalLengthY,this.camera.isPerspectiveCamera?-1:this.camera.zoom*this.devicePixelRatio))}}()),pr(this,"updateView",function(){let e=new Ue,n=[],i=new O(0,0,-1),r=new O(0,0,-1),s=new O,o=new O;return function(a=!1){let l=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!a){r.set(0,0,-1).applyQuaternion(this.camera.quaternion);let c=!1,h=!1;if(r.dot(i)<=.95&&(c=!0),o.copy(this.camera.position).sub(s).length()>=1&&(h=!0),!c&&!h&&!l&&!u)return}s.copy(this.camera.position),i.copy(r),e.copy(this.camera.matrixWorld).invert(),e.premultiply(this.camera.perspCamera.projectionMatrix),n[0]=this.camera.position.x,n[1]=this.camera.position.y,n[2]=this.camera.position.z;let d={sort:{view:e.elements,cameraPosition:n,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...l?{newMatrixWorlds:this.meshMatrixWorlds}:{},...u?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=d:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(d))}}()),this.scene=t.scene,this.currentPage=null,this.renderer=t.renderer,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.splatRenderingInitialized=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null}get camera(){return this.scene.activeCamera}reloadSplats(){this.splatRenderingInitialized=!1;let t=this.loadSplat();this.renderer.pipeline.opaquePass.splatViewer=t?this:null}loadSplat(t={}){this.activePage=this.scene.activePage,t.position&&(t.position=new O().fromArray(t.position)),t.orientation&&(t.orientation=new xi().fromArray(t.orientation)),t.halfPrecisionCovariances=!!t.halfPrecisionCovariances;let e=[];if(this.splatEntries=e,this.activePage.traverseEntity(s=>{if(s.data.type==="Splat"){let o=s.visible;s.traverseAncestors(a=>{o&&(o=a.visible)}),o&&e.push(s)}}),this.splatMesh&&this.splatMesh.dispose(),e.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=e.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=e.map(s=>s.matrixWorld.clone()),this.cropsArray=e.map(s=>s.data.crops.map(o=>o.data));let n=e.map(s=>new kA(new Uint8Array(s.data.buffer).buffer)),i=0,r=[0];for(let s of n)i+=s.getSplatCount(),r.push(i);return this.setupSplatMesh(n,i,t.position,t.orientation,t.halfPrecisionCovariances,this.devicePixelRatio,r,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let t=this.splatDataTextures.meshMatrixWorlds.data;for(let e=0;e<this.meshMatrixWorlds.length;e++)t.set(this.meshMatrixWorlds[e].elements,e*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((e,n)=>e.equals(this.meshMatrixWorldsOld[n]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(e=>e.clone()),!0)}cropsChanged(){let t=!1;return this.splatEntries.forEach((e,n)=>{var i;e.data.crops.forEach((r,s)=>{this.cropsArray[n][s]===void 0?(t=!0,this.cropsArray[n][s]=r.data):Object.entries(r.data).forEach(([o,a])=>{var l;Array.isArray(a)&&a.some((u,d)=>u!==this.cropsArray[n][s][o][d])?(t=!0,this.cropsArray[n][s][o]=a):a!==((l=this.cropsArray[n][s])==null?void 0:l[o])&&(t=!0,this.cropsArray[n][s][o]=a)})}),e.data.crops.length!==((i=this.cropsArray[n])==null?void 0:i.length)&&(this.cropsArray[n].length=e.data.crops.length,t=!0)}),t}setupSplatMesh(t,e,n=new O,i=new xi,r=!1,s=1,o,a){this.splatMesh=By.buildMesh(t,e,r,s,o,a),this.splatMesh.position.copy(n),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=10,this.updateSplatMeshUniforms(),this.splatRenderCount=e}setupSortWorker(t){this.sortWorker=sme(t),this.sortWorker.onmessage=e=>{var n;e.data.sortDone?(this.sortRunning=!1,(n=this.splatMesh)==null||n.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.updateView(!0,!0),this.splatRenderingInitialized=!0)}}update(){this.splatRenderingInitialized!==!1&&(this.updateSplatMeshUniforms(),this.updateView())}getSplatMesh(){return this.splatMesh}},lme=new oa;lme.wireframe=!0;var GN=new O,ume=class extends $d{constructor(t,e){super(),this.data=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new Ype,this.errorPage=new Fy("fdasfa",{...rf.defaultData,name:""}),this.invisibleObjects=new zy("jflkdsafjasdifjaslk",{...lA.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=Wpe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=Hpe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),n=this.entityIdentityToEntity[e];n&&(t.uuid=n.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}markPenumbraSizeDirty(){for(let t of this.children)t instanceof Fy&&(t.penumbraSizeArrayCache=null)}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let n=[],i=e;for(;i!==this;){let r=i;i=i.parent;let s=i.children.indexOf(r);n.splice(0,0,s)}return{entity:e,sortKey:n}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push(i)}return e.sort((n,i)=>sne(n.sortKey,i.sortKey)),e.map(n=>n.entity)}nonExistOrDescendantOf(t,e){let n=this.find(t);if(n===void 0)return!0;for(;n;){if(n.uuid===e)return!0;n=n.parent}return!1}find(t){if(this.activePage&&this.activePage.personalCamera.parent){if(t==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(t===o_)return this.activePage.personalCamera}if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateByLibOp(t,e){t.path.length===1&&t.path[0]==="components"&&t.type===1&&this.createChildrenObjects([{...t.data.asset,id:t.id}],this.invisibleObjects,e)}updateTreeByOp(t,e){var n;if(t.path.length===0&&t.type===7){let i=t.parent===null?this:this.find(t.parent);if(i===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,i,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),Xh(r)&&Ep(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r),this.markPenumbraSizeDirty(),r.updatePathSnapping()}else if(t.path.length===0&&t.type===8){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),Ep(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Xh(i)&&(i.freeBooleanPointer(),r instanceof af&&r.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof N6&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid),i.updatePathSnapping()}else if(t.path.length===0&&t.type===9){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),(n=i.cloner)==null||n.resetOnMove(),this.markToExpandCloner(i);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),Xh(i)&&(i.invalidateUpstreamBooleanData(),Ep(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof af&&r.invalidateDownstreamBooleanData().recomputeBoolean()),i.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(t){var e;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let n of this.children)n instanceof Fy&&(n.visible=n.uuid===t,n.visible&&(this.activePage=n,this.activePage.onActive(this)));this.activePage!==((e=this.splatViewer)==null?void 0:e.activePage)&&this.reloadSplats()}updateEntityByOp(t,e,n,i){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),"visible"in e.props&&this.markPenumbraSizeDirty(),e.path.includes("overrides")&&"states"in e.props){let{rest:s}=e.props;e={...e,props:s},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{Gpe(r,e,n,{scene:this,shared:i}),r instanceof lo&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(t){this.activePage.switchActiveCamera(t)}isInvisibleObjects(t){return t===this.invisibleObjects||t.hasAnccestor(this.invisibleObjects)}init(t,e){let n=Object.entries(e.data.lib.components).map((i,r)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:r}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:e}),this.add(this.invisibleObjects),this.createChildrenObjects(n,this.invisibleObjects,e),this.createChildrenObjects(t.objects,this,e),this.updatePage(t.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(e,!0),this.traverseEntity(i=>{Ep(i)&&i.recomputeBoolean(),i instanceof K1&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){rn.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{rn.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,n,i,r,s,o){if(t){let a=i.find(t);a&&a!==i&&r.forInstancesRec(l=>{l.data=og(l.data,u=>{let d=u.events.data(o.id),c=l.goUp(s);if(c){let h=[...g5(c.identity),t].join("-"),f=this.entityIdentityToEntity[h];if(f){let m=f.uuid,x=yr.zoom(d,e);x[n]=m}else console.warn("cannot find instance")}}).data})}}rewriteActions(t,e,n,i,r,s){t.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...e,o.id],"object",n,i,r,s):o.data.type==="Animation"&&this.relativeizeInner(o.data.object,[...e,o.id],"object",n,i,r,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof cm&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,n)=>{e.data.events.forEach(i=>{if(i.data.type==="GameControl"){let r=!1;if(e.forInstancesRec(s=>{s.data=og(s.data,o=>{s.isInstanceRoot||(o.events.delete(i.id),r=!0)}).data}),r===!1)for(let s of mA.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],t,e,n,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",t,e,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",t,e,n,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",t,e,n,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,n,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,n,i)),this.rewriteActions(i.data.inActions,["inActions"],t,e,n,i),this.rewriteActions(i.data.outActions,["outActions"],t,e,n,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],t,e,n,i)})}),!0})}expandInstances(t,e,n){let i=new Set;this.traverseEntity(r=>{if(r instanceof cm&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:t,pendingDeletes:i}),e||r.resetBBoxNeedsUpdate(),n&&r.traverseEntity(s=>{n.addClip(s)}),!0});for(let r of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),OC(r)}recomputeInstances(t,e){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(n=>{n instanceof cm&&n.isInstanceRoot&&(n.component=void 0)}),this.expandInstances(t,!1,e))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let n=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[n]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[n]),e.dispose()})}clearScene(){for(let t of this.children)rn.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}raycast(t){return this.raycast1(t,!1)}raycast1(t,e){let n=[],i=r=>{for(let s of r.children){let o=s.cloner;if(rn.is(s)&&!s.raycastLock&&(s.visible||o!=null&&o.object.data.visible))if(e===!0&&s.isInstanceRoot){let a=[];if(t.intersectObject(s,!0,a),a.length){let l=a[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let u=s.matrixWorld.clone().invert();l.point.applyMatrix4(u),n.push(l)}}else(Xh(s)||DA(s)&&this.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,n),OA(s,t,n)),i(s)}};return i(this),n}raycastWithClones(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;rn.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((Xh(r)||DA(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),OA(r,t,e,!0)),n(r))}};return n(this),e}forEachEntity(t){for(let e of this.children)rn.is(e)&&t(e)}traverseConcreteEntity(t){for(let e of this.children)rn.is(e)&&e.isConcreteEntity&&e.traverseEntity(t)}traverseEntity(t){for(let e of this.children)rn.is(e)&&e.traverseEntity(t)}updateFont(t,e){this.traverseEntity(n=>{if(n instanceof lo&&n.data.type==="Mesh"&&n.data.geometry.type==="TextGeometry"&&n.data.geometry.font===t){let i=n.geometry,r=n.data.geometry;i.updateFont(t,e).then(()=>{i.update(r);let s=n.invalidateDownstreamBooleanData();Ep(s)&&s.recomputeBoolean()})}})}traverseObject(t){for(let e of this.children)lg.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)rn.is(e)&&e.visible&&e.traverseVisibleEntity(t)}dispose(){this.clearScene()}createChildrenObjects(t,e,n){let i=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,i,n),i+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,n,i,r,s){var l;let o={scene:this,shared:s},a=NC(t,e,o);return a&&(this.entityByUuid[t]=a,i.add(a),i.children.splice(r,0,i.children.pop()),n.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,a,s)),a.updateState(e,o),a instanceof lo&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),e.type==="Empty"&&e.animations&&a.traverseEntity(u=>{if(u instanceof lo&&u.isSkinnedMesh){let d=u.dataPatched;if(d.bones&&d.boneInverses){let c=d.bones.map(m=>this.find(m)),h=d.boneInverses.map(m=>new Ue().fromArray(m)),f=new pf(c,h);u.bind(f,u.bindMatrix)}}else u.matrixAutoUpdate=!0}),a}getCenter(t){let e=[];for(let i=0,r=t.length;i<r;++i){let{id:s,recursive:o}=t[i],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let n=new Hi;return n.setFromPoints(e),n.getCenter(GN),GN}copyMatrixWorld(t,e){if(t===null){e.identity();return}let n=this.find(t);n?e.copy(n.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var i;if(t===null){e.identity();return}let n=(i=this.find(t))==null?void 0:i.parent;n?e.copy(n.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof lu)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)e.material[n]instanceof uu&&t(e.material[n]);else e.material instanceof uu&&t(e.material)})}updateViewPlaneSize(t,e,n=!1){this.traverseConcreteEntity(i=>{i instanceof K1&&i.setViewplaneSize(t,e,n)})}initializeSplatViewer(t){this.splatViewer=new ame({scene:this,renderer:t}),this.reloadSplats()}reloadSplats(){var t;(t=this.splatViewer)==null||t.reloadSplats()}},Fl;function cme(){return Fl||(Fl=new kte,Fl.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),Fl.decoderPending}async function hme(t){if(Fl){let e={attributeIDs:Fl.defaultAttributeIDs,attributeTypes:Fl.defaultAttributeTypes,useUniqueIDs:!1},n;try{n=await Fl.decodeGeometry(new Int8Array(t).buffer,e)}catch(i){console.error(i)}if(n)return{index:n.index?{array:n.index.array}:void 0,attributes:Object.entries(n.attributes).map(([i,r])=>({name:i,itemSize:r.itemSize,array:r.array}))}}return null}async function dme(t,e){let[n,i]=Q5(W2.deserialize(new Uint8Array(t)));mV(n);let r=[];n.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await cme();for(let s of r){let o=await hme(di(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:u,itemSize:d})=>{a[l]={array:u,itemSize:d,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(n),i.result().data}function fme(t){let e;if(t.index)for(let n=0;n<t.index.array.length;n+=3)e=t.index.array[n],t.index.array[n]=t.index.array[n+2],t.index.array[n+2]=e}function pme(t){let e=new Set;return t.traverse(n=>{if(n instanceof Xc)if(xo(n.material))n.material.forEach(i=>{let r=i;e.has(r)||e.add(r)});else{let i=n.material;e.has(i)||e.add(i)}}),e.forEach(n=>{if(n instanceof Array)return;let i=n.onBeforeCompile.bind(n);if(mme(n)){Object.assign(n,{isMeshStandardMaterial:!0,isMeshPhysicalMaterial:!0,transmission:1,attenuationColor:new We,specularColor:new We});let r=0;n.onBeforeCompile=(s,o)=>{i&&i(s,o),s.uniforms=Object.assign({},Is.physical.uniforms,s.uniforms),n.getLayersOfType("transmission").forEach(a=>{if(s.uniforms.transmissionSamplerMap.value){let l=a.color;l&&(l.transmissionSamplerMap.value=s.uniforms.transmissionSamplerMap.value,l.transmissionSamplerSize.value=s.uniforms.transmissionSamplerSize.value,l.aspectRatio.value=yfe(window.innerWidth,window.innerHeight),n.defines.IS_THREEJS_EXPORT=!0)}else r++,r<2&&(n.needsUpdate=!0)})}}else gme(n)||(n.onBeforeCompile=(r,s)=>{i&&i(r,s),n.transparent=!1})}),t}function mme(t){return t.getLayersOfType("transmission").length>0}function gme(t){let e=0;for(let n of t.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.type!=="light"&&n.type!=="fresnel"){let i=n.uniforms["f"+n.id+"_alpha"];i&&(e+=(1-e)*i.value)}}return e<1}function vme(t){return t.traverse(e=>{if(e.type==="Camera"){let n=e;n.type=n.cameraType}}),t}function yme(t){let e=[],n=(i,r=0)=>{let s=r>0?i+r:i;return e.includes(s)?n(i,r+1):s};return t.traverse(i=>{if(e.includes(i.name)){let r=i.name,s=n(i.name);if(i.name=s,i.isMesh){let o=i;o.material instanceof Array?o.material.forEach(a=>{a.name=a.name.replace(r,s)}):o.material.isAsset||(o.material.name=o.material.name.replace(r,s))}}e.push(i.name)}),t}function xme(t){let e=[];return t.traverse(n=>{n instanceof P6&&e.push(n)}),e.forEach(n=>{let i=n.object,r=[...n.children.map(s=>{s.updateMatrix();let o;if(s.geometry!==void 0)try{o=s.geometry.clone().applyMatrix4(s.matrix)}catch(a){console.error(a)}return o!==void 0&&s.matrix.determinant()<0&&fme(o),o}).filter(s=>s!==void 0)];if(!n.parameters.hideBase&&i instanceof lu&&r.unshift(i.geometry),r.length){let s=m5(r);i instanceof lu&&(i.geometry=s)}n.removeFromParent(),i.setFromClonerState(null,{scene:t,shared:ope})}),t}function _me(t){return t.traverse(e=>{e.matrixAutoUpdate=!0}),t}function wme(t){Object.values(t.shared.materials).forEach(e=>{Nb(e)}),t.scene.objects.traverse((e,n)=>{"material"in n?Nb(n.material):"materials"in n&&n.materials.forEach(i=>{Nb(i)})})}function Nb(t){if(typeof t=="string")return;let e=[];t.layers.forEach((n,i)=>{n.type==="outline"&&e.push(i)}),e.reverse().forEach(n=>{t.layers.delete(n)}),e.length&&console.warn("The Spline Loader currently does not support the outline layer.")}var Sme=Tr(ine(),1);function bme(t){return t.traverseMaterial(e=>{e.needsJitter=!1}),t}var HN="The SplineLoader only accepts .splinecode files that are generated from Spline export panel.",Mme=class extends sr{load(t,e,n,i=console.error){let r=new Hs(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),t.endsWith(".spline")?console.warn(HN+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(HN),r.load(t,async s=>{try{if(typeof s=="string")throw new Error("The .spline file is not binary!");let o=await this.parse(s);e(o)}catch(o){i(o)}},n,i)}async parse(t){let e=await dme(t,wme);e.version&&(0,Sme.default)(e.version,"0.9.507")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/loader to the latest version."),await Promise.all([cpe(e)&&Bde(),Mpe(e)&&Zfe()].filter(Boolean));let n=new RC(e.shared);Object.values(n.getMaterials()).forEach(s=>Object.assign(s,{isAsset:!0}));let i=new ume(e.scene,n),r=i.activeCamera;return r&&Object.assign(r,{makeDefault:!0}),i=xme(i),i=pme(i),i=vme(i),i=yme(i),i=_me(i),i=bme(i),i}};function Ame(t){const e=_T(Mme,t);return eZ(e)}const bi={hidden:{scale:0,duration:1.2},visible:{scale:1}},Eme="https://prod.spline.design/5X4XfZHhkrjs7zN9/scene.splinecode",Tme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Embody Chair",position:[-37.98,-53.79,-38.78],rotation:[-Math.PI,.37,-Math.PI],scale:1.73,initial:"hidden",animate:{scale:1.73},transition:{delay:3.5},variants:bi,children:[F.jsxs("group",{name:"Arms",position:[-8.64,-1.21,-.42],children:[F.jsxs("group",{name:"Arm 2",position:[-.07,0,-27.97],rotation:[3.06,-.06,3.14],scale:[-1,1,1.01],children:[F.jsx("mesh",{name:"Cube 22",geometry:t["Cube 22"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-6.31,19.87,-1.06],rotation:[-1.67,-.13,1.58],scale:1}),F.jsx("mesh",{name:"Cube 21",geometry:t["Cube 21"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[10.24,4.19,3.31],rotation:[-1.68,-.12,1.56]}),F.jsx("mesh",{name:"Cube 20",geometry:t["Cube 20"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[11.81,-13.84,3.52],rotation:[.08,.02,.18],scale:1}),F.jsx("mesh",{name:"Cube 19",geometry:t["Cube 19"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[12.4,-17.03,1.54],rotation:[-.13,-.02,.16],scale:1})]}),F.jsxs("group",{name:"Arm",position:[.57,-.09,29.42],rotation:[.05,.01,0],scale:[1,1,1.03],children:[F.jsx("mesh",{name:"Cube 221",geometry:t["Cube 221"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-6.31,19.85,-1.34],rotation:[-1.67,-.13,1.58],scale:1}),F.jsx("mesh",{name:"Cube 211",geometry:t["Cube 211"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[10.24,4.19,3.31],rotation:[-1.68,-.12,1.56]}),F.jsx("mesh",{name:"Cube 201",geometry:t["Cube 201"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[11.81,-13.84,3.52],rotation:[.08,.02,.18],scale:1}),F.jsx("mesh",{name:"Cube 191",geometry:t["Cube 191"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[12.4,-17.09,1.1],rotation:[-.13,-.02,.16],scale:1})]})]}),F.jsxs("group",{name:"Sit",position:[-14.72,-20.53,-.33],children:[F.jsx("mesh",{name:"Cylinder 5",geometry:t["Cylinder 5"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[18.62,.57,15.18],rotation:[-1.49,-.07,0],scale:1}),F.jsx("mesh",{name:"Cylinder 41",geometry:t["Cylinder 41"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[18.1,.13,-15.43],rotation:[-1.63,-.07,-.01],scale:1}),F.jsx("mesh",{name:"Cube 18",geometry:t["Cube 18"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[12.49,-6.63,-12.81],rotation:[-1.43,-.22,.03],scale:[1.01,1.01,1.11]}),F.jsx("mesh",{name:"Cube 17",geometry:t["Cube 17"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[12.53,-6.39,12.64],rotation:[-1.13,-.24,.16],scale:[.94,1.07,1.13]}),F.jsx("mesh",{name:"Cube 16",geometry:t["Cube 16"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[11.96,-4.51,13.07],rotation:[-.03,0,-2.74],scale:[1.01,1.11,1.01]}),F.jsx("mesh",{name:"Cube 15",geometry:t["Cube 15"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[13.29,-4.7,-12.64],rotation:[3.13,0,-.23],scale:[1.01,1.13,1]}),F.jsx("mesh",{name:"Cube 14",geometry:t["Cube 14"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[19.53,.74,-20.83],rotation:[-Math.PI/2,-.02,.02],scale:1}),F.jsx("mesh",{name:"Cube 13",geometry:t["Cube 13"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[19.46,.8,21.45],rotation:[-Math.PI/2,-.08,0],scale:1}),F.jsx("mesh",{name:"Cube 202",geometry:t["Cube 202"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[.59,12.83,.9],rotation:[-1.57,.18,0],scale:[.93,1,1]}),F.jsx("mesh",{name:"Cube 12",geometry:t["Cube 12"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[.14,7.83,.17],rotation:[-1.57,.08,0],scale:[.93,1,1]}),F.jsx("mesh",{name:"Cube 82",geometry:t["Cube 82"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[-14.79,8.38,.1],rotation:[1.02,-1.44,2.75],scale:[1.09,1.05,.98]}),F.jsx("mesh",{name:"Cube 9",geometry:t["Cube 9"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[5.44,7.25,-23.18],rotation:[-1.08,0,.02],scale:[1.15,1.23,1.74]}),F.jsx("mesh",{name:"Cube 72",geometry:t["Cube 72"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[5.57,7.61,23.37],rotation:[-2.12,-.01,0],scale:[1.19,1.35,1.61]}),F.jsx("mesh",{name:"Cube 63",geometry:t["Cube 63"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[4.41,-.64,-.14],rotation:[-1.57,-.3,0],scale:[1.02,1,1.11]}),F.jsx("mesh",{name:"Cube 192",geometry:t["Cube 192"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[26.68,9.66,1.23],rotation:[1.57,1.42,3.14],scale:[1,1.1,1]})]}),F.jsxs("group",{name:"Back sit",position:[12.7,22.58,-.15],children:[F.jsx("mesh",{name:"Cube 203",geometry:t["Cube 203"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[5.81,0,-.18],rotation:[-Math.PI/2,.12,0],scale:[1,1.07,1]}),F.jsx("mesh",{name:"Cube 101",geometry:t["Cube 101"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[2.94,.77,.01],rotation:[-Math.PI/2,.16,0],scale:[1,1.07,1]})]}),F.jsxs("group",{name:"Bottom Side",position:[-13.47,-44.96,1.72],children:[F.jsxs("group",{name:"Chair Leg Instance",position:[.96,-4.44,15.92],rotation:[0,1.55,0],scale:1,children:[F.jsx("mesh",{name:"Wheel",geometry:t.Wheel.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-17.26,-5.72,1.69],rotation:[1.57,.05,0],scale:1}),F.jsxs("group",{name:"Wheel mechanism",position:[-18.33,-3.6,1.78],children:[F.jsx("mesh",{name:"Cylinder 51",geometry:t["Cylinder 51"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.34,0]}),F.jsx("mesh",{name:"Cylinder 42",geometry:t["Cylinder 42"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[.01,.34,.26]}),F.jsx("mesh",{name:"Cylinder 36",geometry:t["Cylinder 36"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,.37,-.22]})]}),F.jsxs("group",{name:"Group2",position:[0,0,0],rotation:[0,0,.03],scale:1,children:[F.jsx("mesh",{name:"Cube 111",geometry:t["Cube 111"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-17.74,-2.63,1.83],rotation:[-.02,.12,.21],scale:1}),F.jsx("mesh",{name:"Cube 64",geometry:t["Cube 64"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[3.15,-5.91,-.25],rotation:[.65,-1.42,.65],scale:1})]})]}),F.jsxs("group",{name:"Chair Leg Instance1",position:[17.01,-4.44,3.19],rotation:[-Math.PI,.39,-Math.PI],scale:1,children:[F.jsx("mesh",{name:"Wheel1",geometry:t.Wheel1.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-17.26,-5.72,1.69],rotation:[1.57,.05,0],scale:1}),F.jsxs("group",{name:"Wheel mechanism1",position:[-18.33,-3.6,1.78],children:[F.jsx("mesh",{name:"Cylinder 52",geometry:t["Cylinder 52"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.34,0]}),F.jsx("mesh",{name:"Cylinder 43",geometry:t["Cylinder 43"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[.01,.34,.26]}),F.jsx("mesh",{name:"Cylinder 37",geometry:t["Cylinder 37"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,.37,-.22]})]}),F.jsxs("group",{name:"Group3",position:[0,0,0],rotation:[0,0,.03],scale:1,children:[F.jsx("mesh",{name:"Cube 112",geometry:t["Cube 112"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-17.74,-2.63,1.83],rotation:[-.02,.12,.21],scale:1}),F.jsx("mesh",{name:"Cube 65",geometry:t["Cube 65"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[3.15,-5.91,-.25],rotation:[.65,-1.42,.65],scale:1})]})]}),F.jsxs("group",{name:"Chair Leg Instance2",position:[9.97,-4.44,-15.75],rotation:[Math.PI,-.84,Math.PI],scale:1,children:[F.jsx("mesh",{name:"Wheel2",geometry:t.Wheel2.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-17.26,-5.72,1.69],rotation:[1.57,.05,0],scale:1}),F.jsxs("group",{name:"Wheel mechanism2",position:[-18.33,-3.6,1.78],children:[F.jsx("mesh",{name:"Cylinder 53",geometry:t["Cylinder 53"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.34,0]}),F.jsx("mesh",{name:"Cylinder 44",geometry:t["Cylinder 44"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[.01,.34,.26]}),F.jsx("mesh",{name:"Cylinder 38",geometry:t["Cylinder 38"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,.37,-.22]})]}),F.jsxs("group",{name:"Group4",position:[0,0,0],rotation:[0,0,.03],scale:1,children:[F.jsx("mesh",{name:"Cube 113",geometry:t["Cube 113"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-17.74,-2.63,1.83],rotation:[-.02,.12,.21],scale:1}),F.jsx("mesh",{name:"Cube 66",geometry:t["Cube 66"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[3.15,-5.91,-.25],rotation:[.65,-1.42,.65],scale:1})]})]}),F.jsxs("group",{name:"Chair Leg Instance3",position:[-9.53,-4.44,-15.75],rotation:[0,-1.07,0],scale:1,children:[F.jsx("mesh",{name:"Wheel3",geometry:t.Wheel3.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-17.26,-5.72,1.69],rotation:[1.57,.05,0],scale:1}),F.jsxs("group",{name:"Wheel mechanism3",position:[-18.33,-3.6,1.78],children:[F.jsx("mesh",{name:"Cylinder 54",geometry:t["Cylinder 54"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.34,0]}),F.jsx("mesh",{name:"Cylinder 45",geometry:t["Cylinder 45"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[.01,.34,.26]}),F.jsx("mesh",{name:"Cylinder 39",geometry:t["Cylinder 39"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,.37,-.22]})]}),F.jsxs("group",{name:"Group5",position:[0,0,0],rotation:[0,0,.03],scale:1,children:[F.jsx("mesh",{name:"Cube 114",geometry:t["Cube 114"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-17.74,-2.63,1.83],rotation:[-.02,.12,.21],scale:1}),F.jsx("mesh",{name:"Cube 67",geometry:t["Cube 67"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[3.15,-5.91,-.25],rotation:[.65,-1.42,.65],scale:1})]})]}),F.jsxs("group",{name:"Chair Leg",position:[-16.71,-4.44,3.3],rotation:[0,.21,0],scale:1,children:[F.jsx("mesh",{name:"Wheel4",geometry:t.Wheel4.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-17.26,-5.72,1.69],rotation:[1.57,.05,0],scale:1}),F.jsxs("group",{name:"Wheel mechanism4",position:[-18.33,-3.6,1.78],children:[F.jsx("mesh",{name:"Cylinder 55",geometry:t["Cylinder 55"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.34,0]}),F.jsx("mesh",{name:"Cylinder 46",geometry:t["Cylinder 46"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[.01,.34,.26]}),F.jsx("mesh",{name:"Cylinder 310",geometry:t["Cylinder 310"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,.37,-.22]})]}),F.jsxs("group",{name:"Group6",position:[0,0,0],rotation:[0,0,.03],scale:1,children:[F.jsx("mesh",{name:"Cube 115",geometry:t["Cube 115"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-17.74,-2.63,1.83],rotation:[-.02,.12,.21],scale:1}),F.jsx("mesh",{name:"Cube 68",geometry:t["Cube 68"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[3.15,-5.91,-.25],rotation:[.65,-1.42,.65],scale:1})]})]}),F.jsx("mesh",{name:"Cylinder 25",geometry:t["Cylinder 25"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[.05,10.18,-1.73]}),F.jsx("mesh",{name:"Cylinder8",geometry:t.Cylinder8.geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[.23,-.14,-1.72],scale:[1.23,1,1]})]})]}),Cme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Sennheiser",position:[99.22,1.2,71.35],rotation:[0,-.58,0],scale:[.87,.79,.87],initial:"hidden",animate:{scale:.87},transition:{delay:1.8},variants:bi,children:[F.jsxs("group",{name:"Headphone Speaker 2",position:[0,-9.24,-9.49],rotation:[2.78,-.57,3.11],scale:1,children:[F.jsxs("group",{name:"Headphone Single Speaker support",position:[-.66,3.75,1.76],children:[F.jsx("mesh",{name:"Cube 116",geometry:t["Cube 116"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.39,4.39,.34],rotation:[-.14,-.53,1.5],scale:[1.03,1,1]}),F.jsx("mesh",{name:"Cube 102",geometry:t["Cube 102"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[.48,7.44,-1.08],rotation:[-1.82,.14,1.06],scale:1}),F.jsx("mesh",{name:"Cube 91",geometry:t["Cube 91"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[.08,4.1,-.43],rotation:[-1.67,.07,1.05]}),F.jsx("mesh",{name:"Cube 83",geometry:t["Cube 83"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.15,.83,-.13],rotation:[-Math.PI/2,.02,1.04],scale:[.73,.97,1]})]}),F.jsx("mesh",{name:"Cylinder 26",geometry:t["Cylinder 26"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[4.92,-4.36,5.02],rotation:[0,-.58,1.56],scale:1}),F.jsx("mesh",{name:"Cylinder9",geometry:t.Cylinder9.geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[-6.55,-4.38,-1.49],rotation:[0,-.48,1.56],scale:1}),F.jsxs("group",{name:"Headphone Single Speaker",position:[.29,-4.28,-.03],children:[F.jsx("mesh",{name:"Cube 73",geometry:t["Cube 73"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.89,0,1.41],rotation:[.01,-.54,1.56],scale:[.97,1.06,.99]}),F.jsx("mesh",{name:"Cube 69",geometry:t["Cube 69"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[1.04,0,-1.64],rotation:[.01,-.54,1.56],scale:[.97,1.06,.99]})]})]}),F.jsxs("group",{name:"Headphone Speaker",position:[-.13,-9.35,9.56],rotation:[.36,.53,-.02],scale:1,children:[F.jsxs("group",{name:"Headphone Single Speaker support1",position:[-.66,3.75,1.76],children:[F.jsx("mesh",{name:"Cube 117",geometry:t["Cube 117"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.39,4.39,.34],rotation:[-.14,-.53,1.5],scale:[1.03,1,1]}),F.jsx("mesh",{name:"Cube 103",geometry:t["Cube 103"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[.48,7.44,-1.08],rotation:[-1.82,.14,1.06],scale:1}),F.jsx("mesh",{name:"Cube 92",geometry:t["Cube 92"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[.13,3.95,-.41],rotation:[-1.67,.07,1.05]}),F.jsx("mesh",{name:"Cube 84",geometry:t["Cube 84"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.15,.77,-.13],rotation:[-Math.PI/2,.02,1.04],scale:[.73,.97,1]})]}),F.jsx("mesh",{name:"Cylinder 27",geometry:t["Cylinder 27"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[4.92,-4.36,5.02],rotation:[0,-.58,1.56],scale:1}),F.jsx("mesh",{name:"Cylinder10",geometry:t.Cylinder10.geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[-6.55,-4.38,-1.49],rotation:[0,-.48,1.56],scale:1}),F.jsxs("group",{name:"Headphone Single Speaker1",position:[.29,-4.28,-.03],children:[F.jsx("mesh",{name:"Cube 74",geometry:t["Cube 74"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-.89,0,1.41],rotation:[.01,-.54,1.56],scale:[.97,1.06,.99]}),F.jsx("mesh",{name:"Cube 610",geometry:t["Cube 610"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[1.04,0,-1.64],rotation:[.01,-.54,1.56],scale:[.97,1.06,.99]})]})]}),F.jsx("mesh",{name:"Cube 121",geometry:t["Cube 121"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[.33,9.79,7.92],rotation:[-2.23,.01,1.59],scale:[1,1,3.29]})]}),Pme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Headphone Support (Wood)",position:[98.87,-9.08,71.37],rotation:[0,-.55,0],scale:.52,initial:"hidden",animate:{scale:.52},transition:{delay:1.5},variants:bi,children:[F.jsx("mesh",{name:"Cube 611",geometry:t["Cube 611"].geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[.23,7.86,-9.69],rotation:[-Math.PI/2,.01,Math.PI/2],scale:[1,1.22,1]}),F.jsx("mesh",{name:"Cylinder 28",geometry:t["Cylinder 28"].geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[.59,-17.18,-12.24],rotation:[0,0,1.56]}),F.jsx("mesh",{name:"Cylinder11",geometry:t.Cylinder11.geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[1.06,-17.18,11.18],rotation:[0,0,1.56]})]}),Rme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Mouse",position:[79.75,-15.81,24.86],rotation:[0,-.13,-.01],scale:.67,initial:"hidden",animate:{scale:.67},transition:{delay:1.8},variants:bi,children:[F.jsx("mesh",{name:"Rectangle 71",geometry:t["Rectangle 71"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[.64,1.17,.07],rotation:[-Math.PI/2,.04,0],scale:1}),F.jsx("mesh",{name:"Rectangle 62",geometry:t["Rectangle 62"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[2.48,1.04,.07],rotation:[-Math.PI/2,.13,0],scale:1}),F.jsx("mesh",{name:"Cube 25",geometry:t["Cube 25"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[5.82,1.23,-.05],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube4",geometry:t.Cube4.geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[.64,-1.33,-.84],rotation:[-Math.PI/2,0,0]})]}),Lme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Keyboard",position:[83.85,-16.79,-23.49],initial:"hidden",animate:"visible",transition:{delay:1.8},variants:bi,children:[F.jsxs("group",{name:"Group 2",position:[-1.44,.93,13.24],children:[F.jsx("mesh",{name:"Rectangle 27",geometry:t["Rectangle 27"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-5.01,-.26,3.27],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 25",geometry:t["Rectangle 25"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[3.8,-.26,3.27],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 271",geometry:t["Rectangle 271"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-5.01,-.26,-3.27],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 251",geometry:t["Rectangle 251"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[3.8,-.26,-3.27],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 272",geometry:t["Rectangle 272"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-5.01,-.26,.07],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 28",geometry:t["Rectangle 28"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.88,-.24,.07],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 252",geometry:t["Rectangle 252"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[3.8,-.26,.07],rotation:[-Math.PI/2,0,0],scale:1})]}),F.jsxs("group",{name:"Group7",position:[-2.04,.95,4.64],children:[F.jsx("mesh",{name:"Rectangle 17",geometry:t["Rectangle 17"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.47,-.51,.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 24",geometry:t["Rectangle 24"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-4.47,-.26,1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 22",geometry:t["Rectangle 22"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-4.47,-.26,-1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 19",geometry:t["Rectangle 19"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.54,-.26,-1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 23",geometry:t["Rectangle 23"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-.01,-.5,1.59],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 18",geometry:t["Rectangle 18"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.42,-.26,-1.61],rotation:[-Math.PI/2,0,0],scale:1})]}),F.jsxs("group",{name:"Group 3",position:[-2.08,.94,-8.71],children:[F.jsx("mesh",{name:"Rectangle 191",geometry:t["Rectangle 191"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 181",geometry:t["Rectangle 181"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 16",geometry:t["Rectangle 16"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 192",geometry:t["Rectangle 192"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,-4.79],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 182",geometry:t["Rectangle 182"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,-4.79],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 15",geometry:t["Rectangle 15"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,-4.79],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 193",geometry:t["Rectangle 193"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 183",geometry:t["Rectangle 183"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 161",geometry:t["Rectangle 161"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,1.61],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 20",geometry:t["Rectangle 20"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-4.51,-.25,-8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 194",geometry:t["Rectangle 194"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,-8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 184",geometry:t["Rectangle 184"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,-8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 14",geometry:t["Rectangle 14"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,-8.01],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 195",geometry:t["Rectangle 195"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,4.88],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 185",geometry:t["Rectangle 185"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,4.88],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 162",geometry:t["Rectangle 162"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,4.88],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 21",geometry:t["Rectangle 21"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-4.51,-.5,1.59],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 196",geometry:t["Rectangle 196"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[-1.5,-.25,-1.52],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 186",geometry:t["Rectangle 186"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[1.46,-.25,-1.52],rotation:[-Math.PI/2,0,0],scale:1}),F.jsx("mesh",{name:"Rectangle 163",geometry:t["Rectangle 163"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[4.51,-.25,-1.52],rotation:[-Math.PI/2,0,0],scale:1})]}),F.jsx("mesh",{name:"Table base",geometry:t["Table base"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[-1.73,-1.46,.19],rotation:[-Math.PI/2,0,0]})]}),Dme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Phone",position:[83.28,-17.58,-82.26],rotation:[0,.27,0],initial:"hidden",animate:"visible",transition:{delay:2},variants:bi,children:[F.jsx("mesh",{name:"Ellipse 2",geometry:t["Ellipse 2"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[9.14,.52,.35],rotation:[-Math.PI/2,0,-1.58],scale:[.86,.86,1.17]}),F.jsx("mesh",{name:"Cube 31",geometry:t["Cube 31"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.04,.07,-.01],rotation:[-Math.PI/2,0,-1.58],scale:.86}),F.jsx("mesh",{name:"Cube 26",geometry:t["Cube 26"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-.07,0],rotation:[-Math.PI/2,0,-1.58],scale:.86})]}),Ime=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Laptop",position:[114.09,-5.67,-125.3],rotation:[0,.2,0],initial:"hidden",animate:"visible",transition:{delay:2},variants:bi,children:[F.jsx("mesh",{name:"Rectangle 31",geometry:t["Rectangle 31"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[7.13,-12.63,-7.78],rotation:[-1.56,-.01,-.86],scale:.76}),F.jsx("mesh",{name:"Rectangle 26",geometry:t["Rectangle 26"].geometry,material:e["White Gray Steel 3"],castShadow:!0,receiveShadow:!0,position:[.84,-12.72,-2.54],rotation:[-1.56,-.01,-.86],scale:.76}),F.jsx("mesh",{name:"Rectangle 72",geometry:t["Rectangle 72"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[-15.36,-12.07,-9.68],rotation:[-1.56,-.01,-.86],scale:.76}),F.jsx("mesh",{name:"Rectangle 63",geometry:t["Rectangle 63"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[-16.84,-12.07,-11.41],rotation:[-1.56,-.01,-.86],scale:.76}),F.jsx("mesh",{name:"Rectangle 53",geometry:t["Rectangle 53"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[-9.7,-12.12,1.8],rotation:[-1.56,-.01,-.86],scale:.76}),F.jsx("mesh",{name:"Ellipse 21",geometry:t["Ellipse 21"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[8.83,12.64,-9.45],rotation:[0,-.86,0],scale:.76}),F.jsx("mesh",{name:"Rectangle1",geometry:t.Rectangle1.geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[8.92,1.42,-9.41],rotation:[0,-.86,0],scale:.76}),F.jsx("mesh",{name:"Cube 27",geometry:t["Cube 27"].geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[-.9,-13.23,-.98],rotation:[.03,-.86,.02],scale:.76}),F.jsx("mesh",{name:"Cube5",geometry:t.Cube5.geometry,material:e["White Gray Steel 2"],castShadow:!0,receiveShadow:!0,position:[8.8,1.19,-9.42],rotation:[-Math.PI/2,0,-.86],scale:.76})]}),Ome=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Desk",position:[108.2,-87.34,-32.89],rotation:[0,.01,0],scale:[.94,.94,1.04],initial:{x:30},animate:{x:108.2},transition:{delay:1.5},children:[F.jsx("mesh",{name:"Table",geometry:t.Table.geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[0,59.36,0],rotation:[-Math.PI/2,0,0],scale:1}),F.jsxs("group",{name:"Desk Leg Instance",position:[55.16,-5.49,111.57],rotation:[Math.PI,-1.56,Math.PI],scale:[1.32,1,1.08],children:[F.jsx("mesh",{name:"Sphere 3",geometry:t["Sphere 3"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.7,-63.19,103.63],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Sphere 31",geometry:t["Sphere 31"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.79,-63.19,1.88],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube6",geometry:t.Cube6.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.73,-61.29,52.73],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube7",geometry:t.Cube7.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.71,-58.31,51.6],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube8",geometry:t.Cube8.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.81,3.98,51.62],rotation:[-Math.PI/2,0,0]})]}),F.jsxs("group",{name:"Desk Leg",position:[58.34,-5.49,-114.63],rotation:[Math.PI,-1.56,Math.PI],scale:[1.32,1,1.08],children:[F.jsx("mesh",{name:"Sphere 32",geometry:t["Sphere 32"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.7,-63.19,103.63],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Sphere 33",geometry:t["Sphere 33"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.79,-63.19,1.88],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube9",geometry:t.Cube9.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.73,-61.29,52.73],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube10",geometry:t.Cube10.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.71,-58.31,51.6],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cube11",geometry:t.Cube11.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[1.81,3.98,51.62],rotation:[-Math.PI/2,0,0]})]})]}),Nme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Gym Stuff",position:[-68.4,-41.62,-137.42],initial:"hidden",animate:"visible",transition:{delay:1.5},variants:bi,children:[F.jsxs("group",{name:"Disc",position:[-89.55,-100.46,18.88],rotation:[0,1.01,0],scale:1,children:[F.jsx("mesh",{name:"Cylinder 4",geometry:t["Cylinder 4"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[0,0,12.39],rotation:[.58,0,0]}),F.jsx("mesh",{name:"Cylinder 3",geometry:t["Cylinder 3"].geometry,material:e["Bag Main Color"],castShadow:!0,receiveShadow:!0,position:[0,-4.44,-9.67]}),F.jsx("mesh",{name:"Cylinder 2",geometry:t["Cylinder 2"].geometry,material:e.Red,castShadow:!0,receiveShadow:!0,position:[0,-7.6,-5.99]}),F.jsx("mesh",{name:"Cylinder",geometry:t.Cylinder.geometry,material:e.Blue,castShadow:!0,receiveShadow:!0,position:[0,-10.96,-9.82]})]}),F.jsxs("group",{name:"Barbell 2",position:[6.74,-108.96,-35.54],rotation:[1.43,Math.PI/2,0],scale:[1,1,1.01],children:[F.jsx("mesh",{name:"Cylinder 31",geometry:t["Cylinder 31"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,0,77.57],rotation:[Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cylinder 21",geometry:t["Cylinder 21"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,0,-72.59],rotation:[Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cylinder1",geometry:t.Cylinder1.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,rotation:[Math.PI/2,0,0],scale:[1,1.27,1]})]}),F.jsxs("group",{name:"Barbell",position:[-72.84,.69,-18.66],rotation:[1.43,0,0],scale:[1,1,1.01],children:[F.jsx("mesh",{name:"Cylinder 32",geometry:t["Cylinder 32"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,0,77.57],rotation:[Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cylinder 22",geometry:t["Cylinder 22"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,0,-72.59],rotation:[Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cylinder2",geometry:t.Cylinder2.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,rotation:[Math.PI/2,0,0],scale:[1,1.27,1]})]}),F.jsx("mesh",{name:"Gym Ball",geometry:t["Gym Ball"].geometry,material:e.Blue,castShadow:!0,receiveShadow:!0,position:[5.19,-78.86,-6.67],rotation:[-Math.PI/2,0,0]}),F.jsxs("group",{name:"Dumbbells",position:[-32.59,-98.32,-13.36],scale:.64,children:[F.jsxs("group",{name:"Dumbbell 3",position:[-22.22,0,1.28],rotation:[1.62,-.75,.07],scale:1,children:[F.jsx("mesh",{name:"Cylinder 23",geometry:t["Cylinder 23"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-1.53,.8,3.25],rotation:[-2.91,-1.4,-1.34],scale:1}),F.jsx("mesh",{name:"Cylinder 33",geometry:t["Cylinder 33"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-2.8,.11,16.43],rotation:[-2.91,-1.4,-1.34],scale:1}),F.jsx("mesh",{name:"Cylinder3",geometry:t.Cylinder3.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[2.8,-.11,-16.43],rotation:[-2.91,-1.4,-1.34],scale:1})]}),F.jsxs("group",{name:"Dumbbell",position:[-4.2,-10.36,2.76],rotation:[0,.12,0],children:[F.jsx("mesh",{name:"Cylinder 24",geometry:t["Cylinder 24"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-1.53,.8,3.25],rotation:[-2.91,-1.4,-1.34],scale:1}),F.jsx("mesh",{name:"Cylinder 34",geometry:t["Cylinder 34"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-2.8,.11,16.43],rotation:[-2.91,-1.4,-1.34],scale:1}),F.jsx("mesh",{name:"Cylinder4",geometry:t.Cylinder4.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[2.8,-.11,-16.43],rotation:[-2.91,-1.4,-1.34],scale:1})]})]})]}),kme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Air Conditioning",position:[-84.41,144.44,-166.13],scale:[.96,1,1],initial:"hidden",animate:"visible",transition:{delay:1.5},variants:bi,children:[F.jsxs("group",{name:"Group",position:[-1.95,6.03,6.73],rotation:[.04,0,0],scale:[1,.89,.66],children:[F.jsx("mesh",{name:"Text",geometry:t.Text.geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[-50.95,-10.15,.29]}),F.jsx("mesh",{name:"Rectangle 5",geometry:t["Rectangle 5"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[0,0,-.54]})]}),F.jsx("mesh",{name:"Rectangle 6",geometry:t["Rectangle 6"].geometry,material:e["Air Conditioning 2"],castShadow:!0,receiveShadow:!0,position:[-1.74,-12.26,1.65],rotation:[-.59,0,0],scale:[1.06,.67,.87]}),F.jsx("mesh",{name:"Cube",geometry:t.Cube.geometry,material:e["Air Conditioning"],castShadow:!0,receiveShadow:!0,position:[-1.25,2.1,-9.09],scale:[1.03,1,1]})]}),Ume=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Bag",position:[112.3,-125.94,62.31],rotation:[.04,.11,-.15],scale:[1.12,1.12,1.08],initial:"hidden",animate:"visible",transition:{delay:3},variants:bi,children:[F.jsx("mesh",{name:"Cube 6",geometry:t["Cube 6"].geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[-8.22,-19.46,-10.99],rotation:[2.91,0,.5],scale:[.85,1,.29]}),F.jsx("mesh",{name:"Cube 5",geometry:t["Cube 5"].geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[8.27,-19.2,-10.65],rotation:[-3.1,.29,-.46],scale:[.85,1.06,.29]}),F.jsx("mesh",{name:"Cube 4",geometry:t["Cube 4"].geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[4.41,3.52,-10.17],rotation:[-2.99,.23,-.14],scale:[.85,1,.29]}),F.jsx("mesh",{name:"Cube 3",geometry:t["Cube 3"].geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[-4.34,3.49,-10.51],rotation:[-3.01,.01,.11],scale:[.85,1,.29]}),F.jsx("mesh",{name:"Cylinder5",geometry:t.Cylinder5.geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[-.49,22.75,-4.78],rotation:[2.44,-1.47,-2.26],scale:1}),F.jsx("mesh",{name:"Cube 2",geometry:t["Cube 2"].geometry,material:e["Bag Main Color"],castShadow:!0,receiveShadow:!0,position:[0,-3.47,2.39],rotation:[-Math.PI/2,0,0],scale:[.8,1,1]}),F.jsx("mesh",{name:"Cube1",geometry:t.Cube1.geometry,material:e["Bag Main Color"],castShadow:!0,receiveShadow:!0,position:[0,-3.56,-5.69],rotation:[-Math.PI/2,0,0],scale:[.8,1,1]})]}),zme=({nodes:t,materials:e})=>F.jsx("group",{name:"Plant Stuff",position:[109.04,-120.87,136.02],children:F.jsxs(Yn.group,{name:"Plant Type 1",position:[0,.18,0],scale:.53,initial:"hidden",animate:{scale:.53},transition:{delay:2},variants:bi,children:[F.jsxs("group",{name:"Group1",position:[0,11.35,0],children:[F.jsx("mesh",{name:"Cube 7",geometry:t["Cube 7"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[16.28,-14.11,-.36],rotation:[-1.57,.08,-1.63],scale:1}),F.jsx("mesh",{name:"Cube 11",geometry:t["Cube 11"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[7.58,-28.59,14.32],rotation:[-1.43,.05,-2.83],scale:1}),F.jsx("mesh",{name:"Cube 10",geometry:t["Cube 10"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[-7.71,-31.08,10.05],rotation:[-Math.PI/2,0,2.3],scale:1}),F.jsx("mesh",{name:"Cube 8",geometry:t["Cube 8"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[-6.85,-26.05,-11.07],rotation:[-1.74,-.15,.74],scale:1}),F.jsx("mesh",{name:"Cube 61",geometry:t["Cube 61"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[3.21,-15.52,-12.77],rotation:[-1.62,.06,0],scale:1})]}),F.jsx("mesh",{name:"Ellipse",geometry:t.Ellipse.geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[2.29,-18.38,.25],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Cylinder6",geometry:t.Cylinder6.geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[2.29,-37.67,.23]})]})}),Fme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Extra Stuff 1",position:[72.83,87.63,-147.83],rotation:[0,1.56,0],initial:"hidden",animate:"visible",transition:{delay:2.5},variants:bi,children:[F.jsxs("group",{name:"Wifi",position:[4,1.1,11.16],rotation:[0,.38,0],scale:1,children:[F.jsx("mesh",{name:"Light 4",geometry:t["Light 4"].geometry,material:e["Bag Main Color"],castShadow:!0,receiveShadow:!0,position:[-11.16,-13.53,6.01],rotation:[Math.PI,-Math.PI/2,0],scale:1}),F.jsx("mesh",{name:"Light 3",geometry:t["Light 3"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[-11.16,-13.53,9.52],rotation:[Math.PI,-Math.PI/2,0],scale:1}),F.jsx("mesh",{name:"Light 2",geometry:t["Light 2"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[-11.16,-13.53,13.22],rotation:[Math.PI,-Math.PI/2,0],scale:1}),F.jsx("mesh",{name:"Light",geometry:t.Light.geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[-11.16,-13.53,-13.49],rotation:[Math.PI,-Math.PI/2,0],scale:1}),F.jsx("mesh",{name:"Cube 81",geometry:t["Cube 81"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[10.47,1.72,-11.94],rotation:[-1.75,0,Math.PI/2],scale:1}),F.jsx("mesh",{name:"Cube 71",geometry:t["Cube 71"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[10.47,1.67,10.21],rotation:[-1.48,0,Math.PI/2],scale:1}),F.jsx("mesh",{name:"Cylinder 35",geometry:t["Cylinder 35"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[8.38,-13.1,-9.3],rotation:[-Math.PI/2,-.04,Math.PI/2],scale:1}),F.jsx("mesh",{name:"Cylinder7",geometry:t.Cylinder7.geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[8.38,-13.1,8.87],rotation:[-Math.PI/2,-.04,Math.PI/2],scale:1}),F.jsx("mesh",{name:"Cube 62",geometry:t["Cube 62"].geometry,material:e["White Gray Steel 4"],castShadow:!0,receiveShadow:!0,position:[-2.69,-13.82,0],rotation:[-Math.PI/2,0,Math.PI/2],scale:1})]}),F.jsxs("group",{name:"Books",position:[12.43,2.35,-22.89],children:[F.jsx("mesh",{name:"Rectangle 8",geometry:t["Rectangle 8"].geometry,material:e.Barbell,castShadow:!0,receiveShadow:!0,position:[1.43,-.69,7.22],rotation:[0,-.02,0]}),F.jsx("mesh",{name:"Rectangle 7",geometry:t["Rectangle 7"].geometry,material:e["Plant Leaf"],castShadow:!0,receiveShadow:!0,position:[1.5,-.69,2.65],rotation:[0,-.02,0]}),F.jsx("mesh",{name:"Rectangle 61",geometry:t["Rectangle 61"].geometry,material:e["Bag Color 2"],castShadow:!0,receiveShadow:!0,position:[.85,.28,-6.63],rotation:[0,-.02,0]}),F.jsx("mesh",{name:"Rectangle 51",geometry:t["Rectangle 51"].geometry,material:e["Dark Blue chair"],castShadow:!0,receiveShadow:!0,position:[1.69,-1.71,-16.03],rotation:[.09,-.02,0],scale:1})]}),F.jsx("mesh",{name:"Support",geometry:t.Support.geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[12.2,-21.24,-5.58],rotation:[-Math.PI/2,0,Math.PI/2],scale:1})]}),Bme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"Monitor Ultrawide",position:[150.69,20.01,-34.14],initial:"hidden",animate:"visible",transition:{delay:2.5},variants:bi,children:[F.jsx("mesh",{name:"Rectangle 52",geometry:t["Rectangle 52"].geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[-3.39,7.76,.16],rotation:[0,-1.57,0]}),F.jsx("mesh",{name:"Cube 612",geometry:t["Cube 612"].geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[-5.46,7.81,-.02],rotation:[0,-1.57,0]}),F.jsx("mesh",{name:"Monitor Base",geometry:t["Monitor Base"].geometry,material:t["Monitor Base"].material,castShadow:!0,receiveShadow:!0,position:[-1.58,-38.94,6.85],rotation:[0,-1.57,0],scale:1.29})]}),Vme=({nodes:t,materials:e})=>F.jsxs("group",{name:"Walls",children:[F.jsx("mesh",{name:"Rectangle 32",geometry:t["Rectangle 32"].geometry,material:e.Wall,castShadow:!0,receiveShadow:!0,position:[0,-177.5,0],rotation:[-Math.PI/2,0,0]}),F.jsx("mesh",{name:"Rectangle 29",geometry:t["Rectangle 29"].geometry,material:e.Wall,castShadow:!0,receiveShadow:!0,position:[200,2.5,0],rotation:[0,-Math.PI/2,0]}),F.jsx("mesh",{name:"Rectangle2",geometry:t.Rectangle2.geometry,material:e.Wall,castShadow:!0,receiveShadow:!0,position:[0,2.5,-200]})]}),jme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"TV",position:[164.36,101.44,-33.09],rotation:[0,-1.56,0],scale:[1.11,1,1],initial:"hidden",animate:"visible",transition:{delay:2.5},variants:bi,children:[F.jsx("mesh",{name:"Rectangle 3",geometry:t["Rectangle 3"].geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[0,-2.15,-10.9],rotation:[.22,0,0]}),F.jsx("mesh",{name:"Rectangle 2",geometry:t["Rectangle 2"].geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[0,-1.34,-13.67]}),F.jsx("mesh",{name:"Rectangle",geometry:t.Rectangle.geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[0,.51,.83],rotation:[.2,0,0],scale:[1.65,1,1]})]}),Gme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"OVNI",position:[145.08,27.91,79.35],rotation:[.21,0,0],scale:[.48,.45,.41],animate:{rotateY:-90},transition:{duration:10,ease:"linear",repeat:1/0},children:[F.jsx("mesh",{name:"Cube 24",geometry:t["Cube 24"].geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[-.02,8.16,.99],rotation:[1.6,0,0],scale:1}),F.jsx("mesh",{name:"Cube3",geometry:t.Cube3.geometry,material:e["White Gray (Steel)"],castShadow:!0,receiveShadow:!0,position:[0,-15.55,0],rotation:[-Math.PI/2,0,0]})]}),Hme=({nodes:t,materials:e})=>F.jsxs(Yn.group,{name:"OVNI 2",position:[105.94,-15.96,134.56],rotation:[-.09,0,0],scale:[.48,.45,.41],animate:{rotateY:90},transition:{duration:10,ease:"linear",repeat:1/0},children:[F.jsx("mesh",{name:"Cube 23",geometry:t["Cube 23"].geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[-.02,8.16,.99],rotation:[1.6,0,0],scale:1}),F.jsx("mesh",{name:"Cube2",geometry:t.Cube2.geometry,material:e["White Gray Steel Darker"],castShadow:!0,receiveShadow:!0,position:[0,-15.55,0],rotation:[-Math.PI/2,0,0]})]}),Wme=({nodes:t,materials:e})=>F.jsx(Yn.mesh,{name:"Hand Keyboard Support",geometry:t["Hand Keyboard Support"].geometry,material:e.Wood,castShadow:!0,receiveShadow:!0,position:[63.87,-16.45,-24.13],rotation:[-Math.PI/2,0,0],initial:"hidden",animate:"visible",transition:{delay:1.8},variants:bi}),$me=({nodes:t,materials:e})=>F.jsx(Yn.mesh,{name:"Pad Keyboard",geometry:t["Pad Keyboard"].geometry,material:e.Rug,castShadow:!0,receiveShadow:!0,position:[80.75,-19.35,-27.95],rotation:[-Math.PI/2,0,0],initial:"hidden",animate:"visible",transition:{delay:1.5},variants:bi}),qme=({nodes:t,materials:e})=>F.jsx(Yn.mesh,{name:"I want to believe poster",geometry:t["I want to believe poster"].geometry,material:e["I want to believe poster Material"],castShadow:!0,receiveShadow:!0,position:[-68.41,40.7,-177.78],initial:"hidden",animate:"visible",transition:{delay:2.5},variants:bi}),Xme=({nodes:t,materials:e})=>F.jsx(Yn.mesh,{name:"Rug",geometry:t.Rug.geometry,material:e["Monitor Black"],castShadow:!0,receiveShadow:!0,position:[32.75,-155.56,-32.76],rotation:[-Math.PI/2,0,0],initial:"hidden",animate:"visible",transition:{delay:2},variants:bi}),Yme=({roomRef:t})=>{const{nodes:e,materials:n}=Ame(Eme);return F.jsxs(Yn.scene,{name:"Scene",ref:t,position:[0,0,0],rotation:[0,0,0],initial:"hidden",animate:"visible",transition:{delay:1.2},variants:bi,children:[F.jsx(jme,{nodes:e,materials:n}),F.jsx(Nme,{nodes:e,materials:n}),F.jsx(kme,{nodes:e,materials:n}),F.jsx(Ume,{nodes:e,materials:n}),F.jsx(zme,{nodes:e,materials:n}),F.jsx(Fme,{nodes:e,materials:n}),F.jsx(qme,{nodes:e,materials:n}),F.jsx(Tme,{materials:n,nodes:e}),F.jsx(Hme,{materials:n,nodes:e}),F.jsx(Gme,{materials:n,nodes:e}),F.jsx(Cme,{materials:n,nodes:e}),F.jsx(Pme,{materials:n,nodes:e}),F.jsx(Wme,{materials:n,nodes:e}),F.jsx(Rme,{materials:n,nodes:e}),F.jsx(Lme,{materials:n,nodes:e}),F.jsx($me,{materials:n,nodes:e}),F.jsx(Dme,{materials:n,nodes:e}),F.jsx(Bme,{materials:n,nodes:e}),F.jsx(Ime,{materials:n,nodes:e}),F.jsx(Ome,{materials:n,nodes:e}),F.jsx(Xme,{materials:n,nodes:e}),F.jsx(Vme,{materials:n,nodes:e})]})};function Zme(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function Kme(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var Qme=typeof window<"u",Jme=Qme?window:null,WN=function(t){return!!t.addEventListener},$N=function(t){return!!t.on},ege=function(t,e,n,i){n===void 0&&(n=Jme),Se.useEffect(function(){if(e&&n)return WN(n)?Zme(n,t,e,i):$N(n)&&n.on(t,e,i),function(){WN(n)?Kme(n,t,e,i):$N(n)&&n.off(t,e,i)}},[t,e,n,JSON.stringify(i)])};const tge=ege,nge=(t=.1)=>{const e=Se.useRef(new ee);tge("pointermove",i=>{const{mapLinear:r}=Ut,s=r(i.pageX,0,window.innerWidth,-1,1),o=r(i.pageY,0,window.innerHeight,-1,1);e.current.set(s,o)});const n=Se.useRef(e.current.clone());return y1(()=>{n.current.lerp(e.current,t)}),n},ige=({scroll:t,setIsRoomCanvasInDom:e,...n})=>{const i=Se.useRef(null),r=Se.useRef(null),s=Se.useRef(null),o=nge(),l=bd(c=>c.size).width<768,u=new O(0,l?150:-45,-70),d=Se.useRef(0);return y1(()=>{d.current+=(t.current-d.current)*.08;const c=l?1500:1100,h=l?200:150,f=l?-600:-800,m=l?-200:-350,x=l?-50:-300,y=l?1100:500,v=l?400:1e3,_=d.current,w=Math.sin(_*Math.PI);i.current.position.set(Ut.lerp(m,f,w),w*v+y,Ut.lerp(c,h,_)),u.x=Ut.lerp(0,x,w),i.current.lookAt(u),r.current.position.x=(1-_)*150,r.current.rotation.y=o.current.x*Math.PI*.07}),y1(()=>{s.current.shadow.mapSize.width=l?1024:4096,s.current.shadow.mapSize.height=l?1024:4096}),Se.useLayoutEffect(()=>{e(!0)},[]),F.jsxs(F.Fragment,{children:[F.jsx("color",{attach:"background",args:["#FDF7ED"]}),F.jsxs("group",{...n,dispose:null,children:[F.jsx(Yme,{roomRef:r}),F.jsx(vte,{name:"Camera",ref:i,makeDefault:!0,far:8e3,near:5,fov:40,position:[0,0,0]}),F.jsx("directionalLight",{name:"Directional Light",ref:s,color:"#ffffff",castShadow:!0,intensity:3.5,"shadow-camera-near":-1e4,"shadow-camera-far":1e5,"shadow-camera-left":-1e3,"shadow-camera-right":1e3,"shadow-camera-top":1e3,"shadow-camera-bottom":-1e3,position:[-125,158,-25]}),F.jsx("hemisphereLight",{name:"Default Ambient Light",intensity:1.5,color:"#D3D3D3"})]})]})},rge="_root_1b2u0_1",sge="_container_1b2u0_49",oge="_flex_1b2u0_89",age="_column_1b2u0_93",lge="_skillChunk_tech_1b2u0_121",uge="_skillChunk_tech_level_1b2u0_129",cge="_skillChunk_tech_name_1b2u0_134",hge="_skillChunk_experience_1b2u0_139",dge="_skillChunk_experience_date_1b2u0_143",fge="_skillChunk_experience_companyName_1b2u0_147",pge="_skillChunk_experience_role_1b2u0_151",Fu={root:rge,container:sge,"text-secondary":"_text-secondary_1b2u0_77","font-weight-200":"_font-weight-200_1b2u0_81","font-weight-500":"_font-weight-500_1b2u0_85",flex:oge,column:age,"space-between":"_space-between_1b2u0_97","align-item-start":"_align-item-start_1b2u0_101","align-items-center":"_align-items-center_1b2u0_105","justify-center":"_justify-center_1b2u0_109","gap-5":"_gap-5_1b2u0_113","gap-10":"_gap-10_1b2u0_117",skillChunk_tech:lge,skillChunk_tech_level:uge,skillChunk_tech_name:cge,skillChunk_experience:hge,skillChunk_experience_date:dge,skillChunk_experience_companyName:fge,skillChunk_experience_role:pge},qN=({skillLevel:t,skillName:e,companyName:n,date:i,role:r})=>F.jsxs(F.Fragment,{children:[t&&e&&F.jsxs("div",{className:Fu.skillChunk_tech,children:[t&&F.jsx("div",{className:Fu.skillChunk_tech_level,style:{backgroundColor:t==="basic"?"#EEC4ED":t==="intermediate"?"#CE45C9":"#FF006A"}}),e&&F.jsx("p",{className:Fu.skillChunk_tech_name,children:e})]}),i&&n&&r&&F.jsxs("div",{className:Fu.skillChunk_experience,children:[F.jsx("p",{className:Fu.skillChunk_experience_date,children:i}),F.jsx("p",{className:Fu.skillChunk_experience_companyName,children:n}),F.jsx("p",{className:Fu.skillChunk_experience_role,children:r})]})]}),mge=()=>{const t=Se.useRef(0),[e,n]=Se.useState(!1);return F.jsxs(Mee,{transition:{type:"spring",mass:3,stiffness:300,damping:80,restDelta:1e-4},children:[F.jsx(SZ,{id:"roomCanvas",shadows:!0,flat:!0,linear:!0,children:F.jsx(Se.Suspense,{fallback:null,children:F.jsx(ige,{scroll:t,setIsRoomCanvasInDom:n})})}),e&&F.jsx(Sge,{scroll:t})]})},gge="_root_11921_1",vge="_container_11921_49",yge="_flex_11921_89",xge="_column_11921_93",_ge="_overlayContainer_11921_121",wge={root:gge,container:vge,"text-secondary":"_text-secondary_11921_77","font-weight-200":"_font-weight-200_11921_81","font-weight-500":"_font-weight-500_11921_85",flex:yge,column:xge,"space-between":"_space-between_11921_97","align-item-start":"_align-item-start_11921_101","align-items-center":"_align-items-center_11921_105","justify-center":"_justify-center_11921_109","gap-5":"_gap-5_11921_113","gap-10":"_gap-10_11921_117",overlayContainer:_ge},Sge=({scroll:t})=>F.jsxs("div",{className:wge.overlayContainer,onScroll:e=>{const n=e.target,i=n.scrollTop/(n.scrollHeight-window.innerHeight);t.current=i},children:[F.jsx(Aee,{}),F.jsx(qee,{}),F.jsx(ite,{}),F.jsx(fte,{}),F.jsx(Uee,{})]});const bge=()=>F.jsx(F.Fragment,{children:F.jsx(mge,{})}),Mge=document.getElementById("root"),Age=lz(Mge);Age.render(F.jsx(bge,{}));
